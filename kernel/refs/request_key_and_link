<dec f='linux-4.14.y/security/keys/internal.h' l='151' type='struct key * request_key_and_link(struct key_type * type, const char * description, const void * callout_info, size_t callout_len, void * aux, struct key * dest_keyring, unsigned long flags)'/>
<use f='linux-4.14.y/security/keys/keyctl.c' l='213' u='c' c='SYSC_request_key'/>
<def f='linux-4.14.y/security/keys/request_key.c' l='537' ll='605' type='struct key * request_key_and_link(struct key_type * type, const char * description, const void * callout_info, size_t callout_len, void * aux, struct key * dest_keyring, unsigned long flags)'/>
<use f='linux-4.14.y/security/keys/request_key.c' l='657' u='c' c='request_key'/>
<use f='linux-4.14.y/security/keys/request_key.c' l='693' u='c' c='request_key_with_auxdata'/>
<use f='linux-4.14.y/security/keys/request_key.c' l='725' u='c' c='request_key_async'/>
<use f='linux-4.14.y/security/keys/request_key.c' l='751' u='c' c='request_key_async_with_auxdata'/>
<doc f='linux-4.14.y/security/keys/request_key.c' l='510'>/**
 * request_key_and_link - Request a key and cache it in a keyring.
 * @type: The type of key we want.
 * @description: The searchable description of the key.
 * @callout_info: The data to pass to the instantiation upcall (or NULL).
 * @callout_len: The length of callout_info.
 * @aux: Auxiliary data for the upcall.
 * @dest_keyring: Where to cache the key.
 * @flags: Flags to key_alloc().
 *
 * A key matching the specified criteria is searched for in the process&apos;s
 * keyrings and returned with its usage count incremented if found.  Otherwise,
 * if callout_info is not NULL, a key will be allocated and some service
 * (probably in userspace) will be asked to instantiate it.
 *
 * If successfully found or created, the key will be linked to the destination
 * keyring if one is provided.
 *
 * Returns a pointer to the key if successful; -EACCES, -ENOKEY, -EKEYREVOKED
 * or -EKEYEXPIRED if an inaccessible, negative, revoked or expired key was
 * found; -ENOKEY if no key was found and no @callout_info was given; -EDQUOT
 * if insufficient key quota was available to create a new key; or -ENOMEM if
 * insufficient memory was available.
 *
 * If the returned key was created, then it may still be under construction,
 * and wait_for_key_construction() should be used to wait for that to complete.
 */</doc>
