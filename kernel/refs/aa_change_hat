<dec f='linux-4.14.y/security/apparmor/include/domain.h' l='40' type='int aa_change_hat(const char ** hats, int count, u64 token, int flags)'/>
<def f='linux-4.14.y/security/apparmor/domain.c' l='1016' ll='1103' type='int aa_change_hat(const char ** hats, int count, u64 token, int flags)'/>
<doc f='linux-4.14.y/security/apparmor/domain.c' l='999'>/**
 * aa_change_hat - change hat to/from subprofile
 * @hats: vector of hat names to try changing into (MAYBE NULL if @count == 0)
 * @count: number of hat names in @hats
 * @token: magic value to validate the hat change
 * @flags: flags affecting behavior of the change
 *
 * Returns %0 on success, error otherwise.
 *
 * Change to the first profile specified in @hats that exists, and store
 * the @hat_magic in the current task context.  If the count == 0 and the
 * @token matches that stored in the current task context, return to the
 * top level profile.
 *
 * change_hat only applies to profiles in the current ns, and each profile
 * in the ns must make the same transition otherwise change_hat will fail.
 */</doc>
<use f='linux-4.14.y/security/apparmor/procattr.c' l='141' u='c' c='aa_setprocattr_changehat'/>
<dec f='linux-4.14.y/security/apparmor/include/domain.h' l='40' type='int aa_change_hat(const char ** hats, int count, u64 token, int flags)'/>
<def f='linux-4.14.y/security/apparmor/domain.c' l='1016' ll='1103' type='int aa_change_hat(const char ** hats, int count, u64 token, int flags)'/>
<doc f='linux-4.14.y/security/apparmor/domain.c' l='999'>/**
 * aa_change_hat - change hat to/from subprofile
 * @hats: vector of hat names to try changing into (MAYBE NULL if @count == 0)
 * @count: number of hat names in @hats
 * @token: magic value to validate the hat change
 * @flags: flags affecting behavior of the change
 *
 * Returns %0 on success, error otherwise.
 *
 * Change to the first profile specified in @hats that exists, and store
 * the @hat_magic in the current task context.  If the count == 0 and the
 * @token matches that stored in the current task context, return to the
 * top level profile.
 *
 * change_hat only applies to profiles in the current ns, and each profile
 * in the ns must make the same transition otherwise change_hat will fail.
 */</doc>
<use f='linux-4.14.y/security/apparmor/procattr.c' l='141' u='c' c='aa_setprocattr_changehat'/>
