<dec f='linux-4.18.y/security/apparmor/include/policy.h' l='193' type='ssize_t aa_replace_profiles(struct aa_ns * view, struct aa_label * label, u32 mask, struct aa_loaddata * udata)'/>
<use f='linux-4.18.y/security/apparmor/apparmorfs.c' l='426' u='c' c='policy_update'/>
<def f='linux-4.18.y/security/apparmor/policy.c' l='858' ll='1079' type='ssize_t aa_replace_profiles(struct aa_ns * policy_ns, struct aa_label * label, u32 mask, struct aa_loaddata * udata)'/>
<doc f='linux-4.18.y/security/apparmor/policy.c' l='844'>/**
 * aa_replace_profiles - replace profile(s) on the profile list
 * @policy_ns: namespace load is occurring on
 * @label: label that is attempting to load/replace policy
 * @mask: permission mask
 * @udata: serialized data stream  (NOT NULL)
 *
 * unpack and replace a profile on the profile list and uses of that profile
 * by any task creds via invalidating the old version of the profile, which
 * tasks will notice to update their own cred.  If the profile does not exist
 * on the profile list it is added.
 *
 * Returns: size of data consumed else error code on failure.
 */</doc>
