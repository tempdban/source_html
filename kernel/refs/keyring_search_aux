<dec f='linux-4.14.y/security/keys/internal.h' l='138' type='key_ref_t keyring_search_aux(key_ref_t keyring_ref, struct keyring_search_context * ctx)'/>
<def f='linux-4.14.y/security/keys/keyring.c' l='878' ll='906' type='key_ref_t keyring_search_aux(key_ref_t keyring_ref, struct keyring_search_context * ctx)'/>
<use f='linux-4.14.y/security/keys/keyring.c' l='939' u='c' c='keyring_search'/>
<doc f='linux-4.14.y/security/keys/keyring.c' l='846'>/**
 * keyring_search_aux - Search a keyring tree for a key matching some criteria
 * @keyring_ref: A pointer to the keyring with possession indicator.
 * @ctx: The keyring search context.
 *
 * Search the supplied keyring tree for a key that matches the criteria given.
 * The root keyring and any linked keyrings must grant Search permission to the
 * caller to be searchable and keys can only be found if they too grant Search
 * to the caller. The possession flag on the root keyring pointer controls use
 * of the possessor bits in permissions checking of the entire tree.  In
 * addition, the LSM gets to forbid keyring searches and key matches.
 *
 * The search is performed as a breadth-then-depth search up to the prescribed
 * limit (KEYRING_SEARCH_MAX_DEPTH).
 *
 * Keys are matched to the type provided and are then filtered by the match
 * function, which is given the description to use in any way it sees fit.  The
 * match function may use any attributes of a key that it wishes to to
 * determine the match.  Normally the match function from the key type would be
 * used.
 *
 * RCU can be used to prevent the keyring key lists from disappearing without
 * the need to take lots of locks.
 *
 * Returns a pointer to the found key and increments the key usage count if
 * successful; -EAGAIN if no matching keys were found, or if expired or revoked
 * keys were found; -ENOKEY if only negative keys were found; -ENOTDIR if the
 * specified keyring wasn&apos;t a keyring.
 *
 * In the case of a successful return, the possession attribute from
 * @keyring_ref is propagated to the returned key reference.
 */</doc>
<use f='linux-4.14.y/security/keys/process_keys.c' l='356' u='c' c='search_my_process_keyrings'/>
<use f='linux-4.14.y/security/keys/process_keys.c' l='374' u='c' c='search_my_process_keyrings'/>
<use f='linux-4.14.y/security/keys/process_keys.c' l='395' u='c' c='search_my_process_keyrings'/>
<use f='linux-4.14.y/security/keys/process_keys.c' l='417' u='c' c='search_my_process_keyrings'/>
