<dec f='linux-4.14.y/security/apparmor/include/file.h' l='160' type='int aa_audit_file(struct aa_profile * profile, struct aa_perms * perms, const char * op, u32 request, const char * name, const char * target, struct aa_label * tlabel, kuid_t ouid, const char * info, int error)'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='590' u='c' c='profile_transition'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='681' u='c' c='profile_onexec'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='732' u='c' c='handle_onexec'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='838' u='c' c='apparmor_bprm_set_creds'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='887' u='c' c='build_change_hat'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='979' u='c' c='change_hat'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='1098' u='c' c='aa_change_hat'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='1133' u='c' c='change_profile_perms_wrapper'/>
<use f='linux-4.14.y/security/apparmor/domain.c' l='1275' u='c' c='aa_change_profile'/>
<def f='linux-4.14.y/security/apparmor/file.c' l='103' ll='153' type='int aa_audit_file(struct aa_profile * profile, struct aa_perms * perms, const char * op, u32 request, const char * name, const char * target, struct aa_label * tlabel, kuid_t ouid, const char * info, int error)'/>
<use f='linux-4.14.y/security/apparmor/file.c' l='180' u='c' c='path_name'/>
<use f='linux-4.14.y/security/apparmor/file.c' l='296' u='c' c='__aa_path_perm'/>
<use f='linux-4.14.y/security/apparmor/file.c' l='450' u='c' c='profile_path_link'/>
<doc f='linux-4.14.y/security/apparmor/file.c' l='88'>/**
 * aa_audit_file - handle the auditing of file operations
 * @profile: the profile being enforced  (NOT NULL)
 * @perms: the permissions computed for the request (NOT NULL)
 * @op: operation being mediated
 * @request: permissions requested
 * @name: name of object being mediated (MAYBE NULL)
 * @target: name of target (MAYBE NULL)
 * @tlabel: target label (MAY BE NULL)
 * @ouid: object uid
 * @info: extra information message (MAYBE NULL)
 * @error: 0 if operation allowed else failure error code
 *
 * Returns: %0 or error on failure
 */</doc>
