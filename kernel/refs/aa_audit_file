<dec f='linux-4.18.y/security/apparmor/include/file.h' l='160' type='int aa_audit_file(struct aa_profile * profile, struct aa_perms * perms, const char * op, u32 request, const char * name, const char * target, struct aa_label * tlabel, kuid_t ouid, const char * info, int error)'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='733' u='c' c='profile_transition'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='809' u='c' c='profile_onexec'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='860' u='c' c='handle_onexec'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='988' u='c' c='apparmor_bprm_set_creds'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='1037' u='c' c='build_change_hat'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='1129' u='c' c='change_hat'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='1270' u='c' c='aa_change_hat'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='1290' u='c' c='change_profile_perms_wrapper'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='1465' u='c' c='aa_change_profile'/>
<def f='linux-4.18.y/security/apparmor/file.c' l='104' ll='154' type='int aa_audit_file(struct aa_profile * profile, struct aa_perms * perms, const char * op, u32 request, const char * name, const char * target, struct aa_label * tlabel, kuid_t ouid, const char * info, int error)'/>
<use f='linux-4.18.y/security/apparmor/file.c' l='181' u='c' c='path_name'/>
<use f='linux-4.18.y/security/apparmor/file.c' l='291' u='c' c='__aa_path_perm'/>
<use f='linux-4.18.y/security/apparmor/file.c' l='445' u='c' c='profile_path_link'/>
<doc f='linux-4.18.y/security/apparmor/file.c' l='89'>/**
 * aa_audit_file - handle the auditing of file operations
 * @profile: the profile being enforced  (NOT NULL)
 * @perms: the permissions computed for the request (NOT NULL)
 * @op: operation being mediated
 * @request: permissions requested
 * @name: name of object being mediated (MAYBE NULL)
 * @target: name of target (MAYBE NULL)
 * @tlabel: target label (MAY BE NULL)
 * @ouid: object uid
 * @info: extra information message (MAYBE NULL)
 * @error: 0 if operation allowed else failure error code
 *
 * Returns: %0 or error on failure
 */</doc>
