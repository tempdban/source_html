<dec f='linux-4.14.y/include/linux/key.h' l='297' type='key_ref_t key_create_or_update(key_ref_t keyring, const char * type, const char * description, const void * payload, size_t plen, key_perm_t perm, unsigned long flags)'/>
<def f='linux-4.14.y/security/keys/key.c' l='805' ll='960' type='key_ref_t key_create_or_update(key_ref_t keyring_ref, const char * type, const char * description, const void * payload, size_t plen, key_perm_t perm, unsigned long flags)'/>
<dec f='linux-4.14.y/security/keys/key.c' l='961' type='key_ref_t key_create_or_update(key_ref_t , const char * , const char * , const void * , size_t , key_perm_t , unsigned long )'/>
<use f='linux-4.14.y/security/keys/key.c' l='961' c='key_create_or_update'/>
<use f='linux-4.14.y/security/keys/key.c' l='961' u='a'/>
<use f='linux-4.14.y/security/keys/key.c' l='961' u='a'/>
<doc f='linux-4.14.y/security/keys/key.c' l='780'>/**
 * key_create_or_update - Update or create and instantiate a key.
 * @keyring_ref: A pointer to the destination keyring with possession flag.
 * @type: The type of key.
 * @description: The searchable description for the key.
 * @payload: The data to use to instantiate or update the key.
 * @plen: The length of @payload.
 * @perm: The permissions mask for a new key.
 * @flags: The quota flags for a new key.
 *
 * Search the destination keyring for a key of the same description and if one
 * is found, update it, otherwise create and instantiate a new one and create a
 * link to it from that keyring.
 *
 * If perm is KEY_PERM_UNDEF then an appropriate key permissions mask will be
 * concocted.
 *
 * Returns a pointer to the new key if successful, -ENODEV if the key type
 * wasn&apos;t available, -ENOTDIR if the keyring wasn&apos;t a keyring, -EACCES if the
 * caller isn&apos;t permitted to modify the keyring or the LSM did not permit
 * creation of the key.
 *
 * On success, the possession flag from the keyring ref will be tacked on to
 * the key ref before it is returned.
 */</doc>
<use f='linux-4.14.y/security/keys/keyctl.c' l='122' u='c' c='SYSC_add_key'/>
