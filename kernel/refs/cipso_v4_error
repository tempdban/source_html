<dec f='linux-4.14.y/include/net/cipso_ipv4.h' l='207' type='void cipso_v4_error(struct sk_buff * skb, int error, u32 gateway)'/>
<def f='linux-4.14.y/net/ipv4/cipso_ipv4.c' l='1733' ll='1742' type='void cipso_v4_error(struct sk_buff * skb, int error, u32 gateway)'/>
<doc f='linux-4.14.y/net/ipv4/cipso_ipv4.c' l='1706'>/**
 * cipso_v4_error - Send the correct response for a bad packet
 * @skb: the packet
 * @error: the error code
 * @gateway: CIPSO gateway flag
 *
 * Description:
 * Based on the error code given in @error, send an ICMP error message back to
 * the originating host.  From the IETF draft ...
 *
 *  &quot;If the contents of the CIPSO [option] are valid but the security label is
 *   outside of the configured host or port label range, the datagram is
 *   discarded and an ICMP &apos;destination unreachable&apos; (type 3) is generated and
 *   returned.  The code field of the ICMP is set to &apos;communication with
 *   destination network administratively prohibited&apos; (code 9) or to
 *   &apos;communication with destination host administratively prohibited&apos;
 *   (code 10).  The value of the code is dependent on whether the originator
 *   of the ICMP message is acting as a CIPSO host or a CIPSO gateway.  The
 *   recipient of the ICMP message MUST be able to handle either value.  The
 *   same procedure is performed if a CIPSO [option] can not be added to an
 *   IP packet because it is too large to fit in the IP options area.&quot;
 *
 *  &quot;If the error is triggered by receipt of an ICMP message, the message is
 *   discarded and no response is permitted (consistent with general ICMP
 *   processing rules).&quot;
 *
 */</doc>
<use f='linux-4.14.y/net/netlabel/netlabel_kapi.c' l='1405' u='c' c='netlbl_skbuff_err'/>
<dec f='linux-4.14.y/include/net/cipso_ipv4.h' l='207' type='void cipso_v4_error(struct sk_buff * skb, int error, u32 gateway)'/>
<def f='linux-4.14.y/net/ipv4/cipso_ipv4.c' l='1733' ll='1742' type='void cipso_v4_error(struct sk_buff * skb, int error, u32 gateway)'/>
<doc f='linux-4.14.y/net/ipv4/cipso_ipv4.c' l='1706'>/**
 * cipso_v4_error - Send the correct response for a bad packet
 * @skb: the packet
 * @error: the error code
 * @gateway: CIPSO gateway flag
 *
 * Description:
 * Based on the error code given in @error, send an ICMP error message back to
 * the originating host.  From the IETF draft ...
 *
 *  &quot;If the contents of the CIPSO [option] are valid but the security label is
 *   outside of the configured host or port label range, the datagram is
 *   discarded and an ICMP &apos;destination unreachable&apos; (type 3) is generated and
 *   returned.  The code field of the ICMP is set to &apos;communication with
 *   destination network administratively prohibited&apos; (code 9) or to
 *   &apos;communication with destination host administratively prohibited&apos;
 *   (code 10).  The value of the code is dependent on whether the originator
 *   of the ICMP message is acting as a CIPSO host or a CIPSO gateway.  The
 *   recipient of the ICMP message MUST be able to handle either value.  The
 *   same procedure is performed if a CIPSO [option] can not be added to an
 *   IP packet because it is too large to fit in the IP options area.&quot;
 *
 *  &quot;If the error is triggered by receipt of an ICMP message, the message is
 *   discarded and no response is permitted (consistent with general ICMP
 *   processing rules).&quot;
 *
 */</doc>
<use f='linux-4.14.y/net/netlabel/netlabel_kapi.c' l='1405' u='c' c='netlbl_skbuff_err'/>
