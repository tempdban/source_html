<dec f='linux-4.18.y/security/apparmor/include/path.h' l='29' type='int aa_path_name(const struct path * path, int flags, char * buffer, const char ** name, const char ** info, const char * disconnected)'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='635' u='c' c='profile_transition'/>
<use f='linux-4.18.y/security/apparmor/domain.c' l='768' u='c' c='profile_onexec'/>
<use f='linux-4.18.y/security/apparmor/file.c' l='177' u='c' c='path_name'/>
<use f='linux-4.18.y/security/apparmor/mount.c' l='335' u='c' c='match_mnt_path_str'/>
<use f='linux-4.18.y/security/apparmor/mount.c' l='390' u='c' c='match_mnt'/>
<use f='linux-4.18.y/security/apparmor/mount.c' l='570' u='c' c='profile_umount'/>
<use f='linux-4.18.y/security/apparmor/mount.c' l='629' u='c' c='build_pivotroot'/>
<use f='linux-4.18.y/security/apparmor/mount.c' l='634' u='c' c='build_pivotroot'/>
<def f='linux-4.18.y/security/apparmor/path.c' l='201' ll='221' type='int aa_path_name(const struct path * path, int flags, char * buffer, const char ** name, const char ** info, const char * disconnected)'/>
<doc f='linux-4.18.y/security/apparmor/path.c' l='181'>/**
 * aa_path_name - get the pathname to a buffer ensure dir / is appended
 * @path: path the file  (NOT NULL)
 * @flags: flags controlling path name generation
 * @buffer: buffer to put name in (NOT NULL)
 * @name: Returns - the generated path name if !error (NOT NULL)
 * @info: Returns - information on why the path lookup failed (MAYBE NULL)
 * @disconnected: string to prepend to disconnected paths
 *
 * @name is a pointer to the beginning of the pathname (which usually differs
 * from the beginning of the buffer), or NULL.  If there is an error @name
 * may contain a partial or invalid name that can be used for audit purposes,
 * but it can not be used for mediation.
 *
 * We need PATH_IS_DIR to indicate whether the file is a directory or not
 * because the file may not yet exist, and so we cannot check the inode&apos;s
 * file type.
 *
 * Returns: %0 else error code if could retrieve name
 */</doc>
