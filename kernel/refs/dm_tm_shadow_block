<dec f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.h' l='85' type='int dm_tm_shadow_block(struct dm_transaction_manager * tm, dm_block_t orig, struct dm_block_validator * v, struct dm_block ** result, int * inc_children)'/>
<doc f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.h' l='69'>/*
 * dm_tm_shadow_block() allocates a new block and copies the data from @orig
 * to it.  It then decrements the reference count on original block.  Use
 * this to update the contents of a block in a data structure, don&apos;t
 * confuse this with a clone - you shouldn&apos;t access the orig block after
 * this operation.  Because the tm knows the scope of the transaction it
 * can optimise requests for a shadow of a shadow to a no-op.  Don&apos;t forget
 * to unlock when you&apos;ve finished with the shadow.
 *
 * The @inc_children flag is used to tell the caller whether it needs to
 * adjust reference counts for children.  (Data in the block may refer to
 * other blocks.)
 *
 * Shadowing implicitly drops a reference on @orig so you must not have
 * it locked when you call this.
 */</doc>
<use f='linux-4.14.y/drivers/md/dm-thin-metadata.c' l='1221' u='c' c='__reserve_metadata_snap'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-array.c' l='286' u='c' c='__shadow_ablock'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-btree-remove.c' l='152' u='c' c='init_child'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-btree-spine.c' l='107' u='c' c='bn_shadow'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-space-map-common.c' l='402' u='c' c='sm_ll_mutate'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-space-map-common.c' l='584' u='c' c='metadata_ll_commit'/>
<def f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.c' l='303' ll='325' type='int dm_tm_shadow_block(struct dm_transaction_manager * tm, dm_block_t orig, struct dm_block_validator * v, struct dm_block ** result, int * inc_children)'/>
<dec f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.c' l='326' type='int dm_tm_shadow_block(struct dm_transaction_manager * , dm_block_t , struct dm_block_validator * , struct dm_block ** , int * )'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.c' l='326' c='dm_tm_shadow_block'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.c' l='326' u='a'/>
<use f='linux-4.14.y/drivers/md/persistent-data/dm-transaction-manager.c' l='326' u='a'/>
