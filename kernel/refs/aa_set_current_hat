<dec f='linux-4.14.y/security/apparmor/include/context.h' l='53' type='int aa_set_current_hat(struct aa_label * label, u64 token)'/>
<def f='linux-4.14.y/security/apparmor/context.c' l='164' ll='191' type='int aa_set_current_hat(struct aa_label * label, u64 token)'/>
<doc f='linux-4.14.y/security/apparmor/context.c' l='154'>/**
 * aa_set_current_hat - set the current tasks hat
 * @label: label to set as the current hat  (NOT NULL)
 * @token: token value that must be specified to change from the hat
 *
 * Do switch of tasks hat.  If the task is currently in a hat
 * validate the token to match.
 *
 * Returns: 0 or error on failure
 */</doc>
<use f='linux-4.14.y/security/apparmor/domain.c' l='1067' u='c' c='aa_change_hat'/>
