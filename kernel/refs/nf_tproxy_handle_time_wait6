<dec f='linux-4.18.y/include/net/netfilter/nf_tproxy.h' l='99' type='struct sock * nf_tproxy_handle_time_wait6(struct sk_buff * skb, int tproto, int thoff, struct net * net, const struct in6_addr * laddr, const __be16 lport, struct sock * sk)'/>
<doc f='linux-4.18.y/include/net/netfilter/nf_tproxy.h' l='78'>/**
 * nf_tproxy_handle_time_wait6 - handle IPv6 TCP TIME_WAIT reopen redirections
 * @skb:	The skb being processed.
 * @tproto:	Transport protocol.
 * @thoff:	Transport protocol header offset.
 * @net:	Network namespace.
 * @laddr:	IPv6 address to redirect to.
 * @lport:	TCP port to redirect to or zero.
 * @sk:		The TIME_WAIT TCP socket found by the lookup.
 *
 * We have to handle SYN packets arriving to TIME_WAIT sockets
 * differently: instead of reopening the connection we should rather
 * redirect the new connection to the proxy if there&apos;s a listener
 * socket present.
 *
 * nf_tproxy_handle_time_wait6() consumes the socket reference passed in.
 *
 * Returns the listener socket if there&apos;s one, the TIME_WAIT socket if
 * no such listener is found, or NULL if the TCP header is incomplete.
 */</doc>
