<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>page_alloc.c source code [linux-4.14.y/mm/page_alloc.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux-4.14.y/mm/page_alloc.c'; var root_path = '../..'; var data_path = '../../../data';</script>
<script src='../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='..'>linux-4.14.y</a>/<a href='./'>mm</a>/<a href='page_alloc.c.html'>page_alloc.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> *  linux/mm/page_alloc.c</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> *  Manages the free list, the system allocates free pages here.</i></td></tr>
<tr><th id="5">5</th><td><i> *  Note that kmalloc() lives in slab.c</i></td></tr>
<tr><th id="6">6</th><td><i> *</i></td></tr>
<tr><th id="7">7</th><td><i> *  Copyright (C) 1991, 1992, 1993, 1994  Linus Torvalds</i></td></tr>
<tr><th id="8">8</th><td><i> *  Swap reorganised 29.12.95, Stephen Tweedie</i></td></tr>
<tr><th id="9">9</th><td><i> *  Support of BIGMEM added by Gerhard Wichert, Siemens AG, July 1999</i></td></tr>
<tr><th id="10">10</th><td><i> *  Reshaped it to be a zoned allocator, Ingo Molnar, Red Hat, 1999</i></td></tr>
<tr><th id="11">11</th><td><i> *  Discontiguous memory support, Kanoj Sarcar, SGI, Nov 1999</i></td></tr>
<tr><th id="12">12</th><td><i> *  Zone balancing, Kanoj Sarcar, SGI, Jan 2000</i></td></tr>
<tr><th id="13">13</th><td><i> *  Per cpu hot/cold page lists, bulk allocation, Martin J. Bligh, Sept 2002</i></td></tr>
<tr><th id="14">14</th><td><i> *          (lots of bits borrowed from Ingo Molnar &amp; Andrew Morton)</i></td></tr>
<tr><th id="15">15</th><td><i> */</i></td></tr>
<tr><th id="16">16</th><td></td></tr>
<tr><th id="17">17</th><td><u>#include <a href="../include/linux/stddef.h.html">&lt;linux/stddef.h&gt;</a></u></td></tr>
<tr><th id="18">18</th><td><u>#include <a href="../include/linux/mm.h.html">&lt;linux/mm.h&gt;</a></u></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="../include/linux/swap.h.html">&lt;linux/swap.h&gt;</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../include/linux/interrupt.h.html">&lt;linux/interrupt.h&gt;</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="../include/linux/pagemap.h.html">&lt;linux/pagemap.h&gt;</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="../include/linux/jiffies.h.html">&lt;linux/jiffies.h&gt;</a></u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="../include/linux/bootmem.h.html">&lt;linux/bootmem.h&gt;</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../include/linux/memblock.h.html">&lt;linux/memblock.h&gt;</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../include/linux/compiler.h.html">&lt;linux/compiler.h&gt;</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../include/linux/kernel.h.html">&lt;linux/kernel.h&gt;</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../include/linux/kasan.h.html">&lt;linux/kasan.h&gt;</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../include/linux/module.h.html">&lt;linux/module.h&gt;</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../include/linux/suspend.h.html">&lt;linux/suspend.h&gt;</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../include/linux/pagevec.h.html">&lt;linux/pagevec.h&gt;</a></u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../include/linux/blkdev.h.html">&lt;linux/blkdev.h&gt;</a></u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="../include/linux/slab.h.html">&lt;linux/slab.h&gt;</a></u></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="../include/linux/ratelimit.h.html">&lt;linux/ratelimit.h&gt;</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../include/linux/oom.h.html">&lt;linux/oom.h&gt;</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="../include/linux/notifier.h.html">&lt;linux/notifier.h&gt;</a></u></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="../include/linux/topology.h.html">&lt;linux/topology.h&gt;</a></u></td></tr>
<tr><th id="37">37</th><td><u>#include <a href="../include/linux/sysctl.h.html">&lt;linux/sysctl.h&gt;</a></u></td></tr>
<tr><th id="38">38</th><td><u>#include <a href="../include/linux/cpu.h.html">&lt;linux/cpu.h&gt;</a></u></td></tr>
<tr><th id="39">39</th><td><u>#include <a href="../include/linux/cpuset.h.html">&lt;linux/cpuset.h&gt;</a></u></td></tr>
<tr><th id="40">40</th><td><u>#include <a href="../include/linux/memory_hotplug.h.html">&lt;linux/memory_hotplug.h&gt;</a></u></td></tr>
<tr><th id="41">41</th><td><u>#include <a href="../include/linux/nodemask.h.html">&lt;linux/nodemask.h&gt;</a></u></td></tr>
<tr><th id="42">42</th><td><u>#include <a href="../include/linux/vmalloc.h.html">&lt;linux/vmalloc.h&gt;</a></u></td></tr>
<tr><th id="43">43</th><td><u>#include <a href="../include/linux/vmstat.h.html">&lt;linux/vmstat.h&gt;</a></u></td></tr>
<tr><th id="44">44</th><td><u>#include <a href="../include/linux/mempolicy.h.html">&lt;linux/mempolicy.h&gt;</a></u></td></tr>
<tr><th id="45">45</th><td><u>#include <a href="../include/linux/memremap.h.html">&lt;linux/memremap.h&gt;</a></u></td></tr>
<tr><th id="46">46</th><td><u>#include <a href="../include/linux/stop_machine.h.html">&lt;linux/stop_machine.h&gt;</a></u></td></tr>
<tr><th id="47">47</th><td><u>#include <a href="../include/linux/sort.h.html">&lt;linux/sort.h&gt;</a></u></td></tr>
<tr><th id="48">48</th><td><u>#include <a href="../include/linux/pfn.h.html">&lt;linux/pfn.h&gt;</a></u></td></tr>
<tr><th id="49">49</th><td><u>#include <a href="../include/linux/backing-dev.h.html">&lt;linux/backing-dev.h&gt;</a></u></td></tr>
<tr><th id="50">50</th><td><u>#include <a href="../include/linux/fault-inject.h.html">&lt;linux/fault-inject.h&gt;</a></u></td></tr>
<tr><th id="51">51</th><td><u>#include <a href="../include/linux/page-isolation.h.html">&lt;linux/page-isolation.h&gt;</a></u></td></tr>
<tr><th id="52">52</th><td><u>#include <a href="../include/linux/page_ext.h.html">&lt;linux/page_ext.h&gt;</a></u></td></tr>
<tr><th id="53">53</th><td><u>#include <a href="../include/linux/debugobjects.h.html">&lt;linux/debugobjects.h&gt;</a></u></td></tr>
<tr><th id="54">54</th><td><u>#include <a href="../include/linux/kmemleak.h.html">&lt;linux/kmemleak.h&gt;</a></u></td></tr>
<tr><th id="55">55</th><td><u>#include <a href="../include/linux/compaction.h.html">&lt;linux/compaction.h&gt;</a></u></td></tr>
<tr><th id="56">56</th><td><u>#include <a href="../include/trace/events/kmem.h.html">&lt;trace/events/kmem.h&gt;</a></u></td></tr>
<tr><th id="57">57</th><td><u>#include <a href="../include/trace/events/oom.h.html">&lt;trace/events/oom.h&gt;</a></u></td></tr>
<tr><th id="58">58</th><td><u>#include <a href="../include/linux/prefetch.h.html">&lt;linux/prefetch.h&gt;</a></u></td></tr>
<tr><th id="59">59</th><td><u>#include <a href="../include/linux/mm_inline.h.html">&lt;linux/mm_inline.h&gt;</a></u></td></tr>
<tr><th id="60">60</th><td><u>#include <a href="../include/linux/migrate.h.html">&lt;linux/migrate.h&gt;</a></u></td></tr>
<tr><th id="61">61</th><td><u>#include <a href="../include/linux/hugetlb.h.html">&lt;linux/hugetlb.h&gt;</a></u></td></tr>
<tr><th id="62">62</th><td><u>#include <a href="../include/linux/sched/rt.h.html">&lt;linux/sched/rt.h&gt;</a></u></td></tr>
<tr><th id="63">63</th><td><u>#include <a href="../include/linux/sched/mm.h.html">&lt;linux/sched/mm.h&gt;</a></u></td></tr>
<tr><th id="64">64</th><td><u>#include <a href="../include/linux/page_owner.h.html">&lt;linux/page_owner.h&gt;</a></u></td></tr>
<tr><th id="65">65</th><td><u>#include <a href="../include/linux/kthread.h.html">&lt;linux/kthread.h&gt;</a></u></td></tr>
<tr><th id="66">66</th><td><u>#include <a href="../include/linux/memcontrol.h.html">&lt;linux/memcontrol.h&gt;</a></u></td></tr>
<tr><th id="67">67</th><td><u>#include <a href="../include/linux/ftrace.h.html">&lt;linux/ftrace.h&gt;</a></u></td></tr>
<tr><th id="68">68</th><td><u>#include <a href="../include/linux/lockdep.h.html">&lt;linux/lockdep.h&gt;</a></u></td></tr>
<tr><th id="69">69</th><td><u>#include <a href="../include/linux/nmi.h.html">&lt;linux/nmi.h&gt;</a></u></td></tr>
<tr><th id="70">70</th><td></td></tr>
<tr><th id="71">71</th><td><u>#include <a href="../arch/x86/include/asm/sections.h.html">&lt;asm/sections.h&gt;</a></u></td></tr>
<tr><th id="72">72</th><td><u>#include <a href="../arch/x86/include/asm/tlbflush.h.html">&lt;asm/tlbflush.h&gt;</a></u></td></tr>
<tr><th id="73">73</th><td><u>#include <a href="../arch/x86/include/asm/div64.h.html">&lt;asm/div64.h&gt;</a></u></td></tr>
<tr><th id="74">74</th><td><u>#include <a href="internal.h.html">"internal.h"</a></u></td></tr>
<tr><th id="75">75</th><td></td></tr>
<tr><th id="76">76</th><td><i  data-doc="pcp_batch_high_lock">/* prevent &gt;1 _updater_ of zone percpu pageset -&gt;high and -&gt;batch fields */</i></td></tr>
<tr><th id="77">77</th><td><em>static</em> <a class="macro" href="../include/linux/mutex.h.html#131" title="struct mutex pcp_batch_high_lock = { .owner = { (0) } , .wait_lock = (spinlock_t ) { { .rlock = { .raw_lock = { { (0) } }, } } } , .wait_list = { &amp;(pcp_batch_high_lock.wait_list), &amp;(pcp_batch_high_lock.wait_list) } }" data-ref="_M/DEFINE_MUTEX">DEFINE_MUTEX</a>(<dfn class="tu decl def" id="pcp_batch_high_lock" title='pcp_batch_high_lock' data-type='struct mutex' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock"><a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='m' data-ref="pcp_batch_high_lock">pcp_batch_high_lock</a></a></a></a></a></a></a></a></dfn>);</td></tr>
<tr><th id="78">78</th><td><u>#define <dfn class="macro" id="_M/MIN_PERCPU_PAGELIST_FRACTION" data-ref="_M/MIN_PERCPU_PAGELIST_FRACTION">MIN_PERCPU_PAGELIST_FRACTION</dfn>	(8)</u></td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td><u>#<span data-ppcond="80">ifdef</span> <span class="macro" data-ref="_M/CONFIG_USE_PERCPU_NUMA_NODE_ID">CONFIG_USE_PERCPU_NUMA_NODE_ID</span></u></td></tr>
<tr><th id="81">81</th><td>DEFINE_PER_CPU(<em>int</em>, numa_node);</td></tr>
<tr><th id="82">82</th><td>EXPORT_PER_CPU_SYMBOL(numa_node);</td></tr>
<tr><th id="83">83</th><td><u>#<span data-ppcond="80">endif</span></u></td></tr>
<tr><th id="84">84</th><td></td></tr>
<tr><th id="85">85</th><td><u>#<span data-ppcond="85">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HAVE_MEMORYLESS_NODES">CONFIG_HAVE_MEMORYLESS_NODES</span></u></td></tr>
<tr><th id="86">86</th><td><i>/*</i></td></tr>
<tr><th id="87">87</th><td><i> * N.B., Do NOT reference the '_numa_mem_' per cpu variable directly.</i></td></tr>
<tr><th id="88">88</th><td><i> * It will not be defined when CONFIG_HAVE_MEMORYLESS_NODES is not defined.</i></td></tr>
<tr><th id="89">89</th><td><i> * Use the accessor functions set_numa_mem(), numa_mem_id() and cpu_to_mem()</i></td></tr>
<tr><th id="90">90</th><td><i> * defined in &lt;linux/topology.h&gt;.</i></td></tr>
<tr><th id="91">91</th><td><i> */</i></td></tr>
<tr><th id="92">92</th><td>DEFINE_PER_CPU(<em>int</em>, _numa_mem_);		<i>/* Kernel "local memory" node */</i></td></tr>
<tr><th id="93">93</th><td>EXPORT_PER_CPU_SYMBOL(_numa_mem_);</td></tr>
<tr><th id="94">94</th><td><em>int</em> _node_numa_mem_[MAX_NUMNODES];</td></tr>
<tr><th id="95">95</th><td><u>#<span data-ppcond="85">endif</span></u></td></tr>
<tr><th id="96">96</th><td></td></tr>
<tr><th id="97">97</th><td><i>/* work_structs for global per-cpu drains */</i></td></tr>
<tr><th id="98">98</th><td><a class="macro" href="../include/linux/mutex.h.html#131" title="struct mutex pcpu_drain_mutex = { .owner = { (0) } , .wait_lock = (spinlock_t ) { { .rlock = { .raw_lock = { { (0) } }, } } } , .wait_list = { &amp;(pcpu_drain_mutex.wait_list), &amp;(pcpu_drain_mutex.wait_list) } }" data-ref="_M/DEFINE_MUTEX">DEFINE_MUTEX</a>(<dfn class="decl def" id="pcpu_drain_mutex" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex"><a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex">pcpu_drain_mutex</a></a></a></a></a></a></a></a></dfn>);</td></tr>
<tr><th id="99">99</th><td><a class="macro" href="../include/linux/percpu-defs.h.html#115" title=" __attribute__((section(&quot;.data..percpu&quot; &quot;&quot;))) __typeof__(struct work_struct) pcpu_drain" data-ref="_M/DEFINE_PER_CPU">DEFINE_PER_CPU</a>(<b>struct</b> <a class="type" href="../include/linux/workqueue.h.html#work_struct" title='work_struct' data-ref="work_struct">work_struct</a>, <dfn class="decl def" id="pcpu_drain" title='pcpu_drain' data-ref="pcpu_drain">pcpu_drain</dfn>);</td></tr>
<tr><th id="100">100</th><td></td></tr>
<tr><th id="101">101</th><td><u>#<span data-ppcond="101">ifdef</span> <span class="macro" data-ref="_M/CONFIG_GCC_PLUGIN_LATENT_ENTROPY">CONFIG_GCC_PLUGIN_LATENT_ENTROPY</span></u></td></tr>
<tr><th id="102">102</th><td><em>volatile</em> <em>unsigned</em> <em>long</em> latent_entropy __latent_entropy;</td></tr>
<tr><th id="103">103</th><td>EXPORT_SYMBOL(latent_entropy);</td></tr>
<tr><th id="104">104</th><td><u>#<span data-ppcond="101">endif</span></u></td></tr>
<tr><th id="105">105</th><td></td></tr>
<tr><th id="106">106</th><td><i>/*</i></td></tr>
<tr><th id="107">107</th><td><i> * Array of node states.</i></td></tr>
<tr><th id="108">108</th><td><i> */</i></td></tr>
<tr><th id="109">109</th><td><a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> <dfn class="decl def" id="node_states" title='node_states' data-ref="node_states">node_states</dfn>[<a class="enum" href="../include/linux/nodemask.h.html#NR_NODE_STATES" title='NR_NODE_STATES' data-ref="NR_NODE_STATES">NR_NODE_STATES</a>] <a class="macro" href="../arch/x86/include/asm/cache.h.html#11" title="__attribute__((__section__(&quot;.data..read_mostly&quot;)))" data-ref="_M/__read_mostly">__read_mostly</a> = {</td></tr>
<tr><th id="110">110</th><td>	[<a class="enum" href="../include/linux/nodemask.h.html#N_POSSIBLE" title='N_POSSIBLE' data-ref="N_POSSIBLE">N_POSSIBLE</a>] = <a class="macro" href="../include/linux/nodemask.h.html#300" title="((nodemask_t) { { [((((1 &lt;&lt; 0)) + (8 * sizeof(long)) - 1) / (8 * sizeof(long)))-1] = (~0UL &gt;&gt; (-((1 &lt;&lt; 0)) &amp; (64 - 1))) } })" data-ref="_M/NODE_MASK_ALL">NODE_MASK_ALL</a>,</td></tr>
<tr><th id="111">111</th><td>	[<a class="enum" href="../include/linux/nodemask.h.html#N_ONLINE" title='N_ONLINE' data-ref="N_ONLINE">N_ONLINE</a>] = { { [<var>0</var>] = <var>1UL</var> } },</td></tr>
<tr><th id="112">112</th><td><u>#<span data-ppcond="112">ifndef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="113">113</th><td>	[<a class="enum" href="../include/linux/nodemask.h.html#N_NORMAL_MEMORY" title='N_NORMAL_MEMORY' data-ref="N_NORMAL_MEMORY">N_NORMAL_MEMORY</a>] = { { [<var>0</var>] = <var>1UL</var> } },</td></tr>
<tr><th id="114">114</th><td><u>#<span data-ppcond="114">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="115">115</th><td>	[N_HIGH_MEMORY] = { { [<var>0</var>] = <var>1UL</var> } },</td></tr>
<tr><th id="116">116</th><td><u>#<span data-ppcond="114">endif</span></u></td></tr>
<tr><th id="117">117</th><td>	[<a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a>] = { { [<var>0</var>] = <var>1UL</var> } },</td></tr>
<tr><th id="118">118</th><td>	[<a class="enum" href="../include/linux/nodemask.h.html#N_CPU" title='N_CPU' data-ref="N_CPU">N_CPU</a>] = { { [<var>0</var>] = <var>1UL</var> } },</td></tr>
<tr><th id="119">119</th><td><u>#<span data-ppcond="112">endif</span>	/* NUMA */</u></td></tr>
<tr><th id="120">120</th><td>};</td></tr>
<tr><th id="121">121</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(node_states) node_states; static const char __kstrtab_node_states[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;node_states&quot;; static const struct kernel_symbol __ksymtab_node_states __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;node_states&quot;), used)) = { (unsigned long)&amp;node_states, __kstrtab_node_states }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states" id="node_states"><a class="ref" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states"><a class="ref" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states"><a class="ref" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states">node_states</a></a></a></a>);</td></tr>
<tr><th id="122">122</th><td></td></tr>
<tr><th id="123">123</th><td><i  data-doc="managed_page_count_lock">/* Protect totalram_pages and zone-&gt;managed_pages */</i></td></tr>
<tr><th id="124">124</th><td><em>static</em> <a class="macro" href="../include/linux/spinlock_types.h.html#84" title="spinlock_t managed_page_count_lock = (spinlock_t ) { { .rlock = { .raw_lock = { { (0) } }, } } }" data-ref="_M/DEFINE_SPINLOCK">DEFINE_SPINLOCK</a>(<dfn class="tu decl def" id="managed_page_count_lock" title='managed_page_count_lock' data-type='spinlock_t' data-ref="managed_page_count_lock">managed_page_count_lock</dfn>);</td></tr>
<tr><th id="125">125</th><td></td></tr>
<tr><th id="126">126</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def" id="totalram_pages" title='totalram_pages' data-ref="totalram_pages">totalram_pages</dfn> <a class="macro" href="../arch/x86/include/asm/cache.h.html#11" title="__attribute__((__section__(&quot;.data..read_mostly&quot;)))" data-ref="_M/__read_mostly">__read_mostly</a>;</td></tr>
<tr><th id="127">127</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def" id="totalreserve_pages" title='totalreserve_pages' data-ref="totalreserve_pages">totalreserve_pages</dfn> <a class="macro" href="../arch/x86/include/asm/cache.h.html#11" title="__attribute__((__section__(&quot;.data..read_mostly&quot;)))" data-ref="_M/__read_mostly">__read_mostly</a>;</td></tr>
<tr><th id="128">128</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def" id="totalcma_pages" title='totalcma_pages' data-ref="totalcma_pages">totalcma_pages</dfn> <a class="macro" href="../arch/x86/include/asm/cache.h.html#11" title="__attribute__((__section__(&quot;.data..read_mostly&quot;)))" data-ref="_M/__read_mostly">__read_mostly</a>;</td></tr>
<tr><th id="129">129</th><td></td></tr>
<tr><th id="130">130</th><td><em>int</em> <dfn class="decl def" id="percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</dfn>;</td></tr>
<tr><th id="131">131</th><td><a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="decl def" id="gfp_allowed_mask" title='gfp_allowed_mask' data-ref="gfp_allowed_mask">gfp_allowed_mask</dfn> <a class="macro" href="../arch/x86/include/asm/cache.h.html#11" title="__attribute__((__section__(&quot;.data..read_mostly&quot;)))" data-ref="_M/__read_mostly">__read_mostly</a> = <a class="macro" href="internal.h.html#31" title="((( gfp_t)((1 &lt;&lt; (25 + 0)) - 1)) &amp; ~((( gfp_t)(0x400000u|0x1000000u))|(( gfp_t)0x40u)|(( gfp_t)0x80u)))" data-ref="_M/GFP_BOOT_MASK">GFP_BOOT_MASK</a>;</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td><i  data-doc="get_pcppage_migratetype">/*</i></td></tr>
<tr><th id="134">134</th><td><i  data-doc="get_pcppage_migratetype"> * A cached value of the page's pageblock's migratetype, used when the page is</i></td></tr>
<tr><th id="135">135</th><td><i  data-doc="get_pcppage_migratetype"> * put on a pcplist. Used to avoid the pageblock migratetype lookup when</i></td></tr>
<tr><th id="136">136</th><td><i  data-doc="get_pcppage_migratetype"> * freeing from pcplists in most cases, at the cost of possibly becoming stale.</i></td></tr>
<tr><th id="137">137</th><td><i  data-doc="get_pcppage_migratetype"> * Also the migratetype set in the page does not necessarily match the pcplist</i></td></tr>
<tr><th id="138">138</th><td><i  data-doc="get_pcppage_migratetype"> * index, e.g. page might have MIGRATE_CMA set but be on a pcplist with any</i></td></tr>
<tr><th id="139">139</th><td><i  data-doc="get_pcppage_migratetype"> * other index - this ensures that it will be put on the correct CMA freelist.</i></td></tr>
<tr><th id="140">140</th><td><i  data-doc="get_pcppage_migratetype"> */</i></td></tr>
<tr><th id="141">141</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="get_pcppage_migratetype" title='get_pcppage_migratetype' data-type='int get_pcppage_migratetype(struct page * page)' data-ref="get_pcppage_migratetype">get_pcppage_migratetype</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="361page" title='page' data-type='struct page *' data-ref="361page">page</dfn>)</td></tr>
<tr><th id="142">142</th><td>{</td></tr>
<tr><th id="143">143</th><td>	<b>return</b> <a class="local col1 ref" href="#361page" title='page' data-ref="361page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::index" title='page::(anonymous union)::index' data-ref="page::(anonymous)::index">index</a>;</td></tr>
<tr><th id="144">144</th><td>}</td></tr>
<tr><th id="145">145</th><td></td></tr>
<tr><th id="146">146</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="set_pcppage_migratetype" title='set_pcppage_migratetype' data-type='void set_pcppage_migratetype(struct page * page, int migratetype)' data-ref="set_pcppage_migratetype">set_pcppage_migratetype</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="362page" title='page' data-type='struct page *' data-ref="362page">page</dfn>, <em>int</em> <dfn class="local col3 decl" id="363migratetype" title='migratetype' data-type='int' data-ref="363migratetype">migratetype</dfn>)</td></tr>
<tr><th id="147">147</th><td>{</td></tr>
<tr><th id="148">148</th><td>	<a class="local col2 ref" href="#362page" title='page' data-ref="362page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::index" title='page::(anonymous union)::index' data-ref="page::(anonymous)::index">index</a> = <a class="local col3 ref" href="#363migratetype" title='migratetype' data-ref="363migratetype">migratetype</a>;</td></tr>
<tr><th id="149">149</th><td>}</td></tr>
<tr><th id="150">150</th><td></td></tr>
<tr><th id="151">151</th><td><u>#<span data-ppcond="151">ifdef</span> <span class="macro" data-ref="_M/CONFIG_PM_SLEEP">CONFIG_PM_SLEEP</span></u></td></tr>
<tr><th id="152">152</th><td><i>/*</i></td></tr>
<tr><th id="153">153</th><td><i> * The following functions are used by the suspend/hibernate code to temporarily</i></td></tr>
<tr><th id="154">154</th><td><i> * change gfp_allowed_mask in order to avoid using I/O during memory allocations</i></td></tr>
<tr><th id="155">155</th><td><i> * while devices are suspended.  To avoid races with the suspend/hibernate code,</i></td></tr>
<tr><th id="156">156</th><td><i> * they should always be called with pm_mutex held (gfp_allowed_mask also should</i></td></tr>
<tr><th id="157">157</th><td><i> * only be modified with pm_mutex held, unless the suspend/hibernate code is</i></td></tr>
<tr><th id="158">158</th><td><i> * guaranteed not to run in parallel with that modification).</i></td></tr>
<tr><th id="159">159</th><td><i> */</i></td></tr>
<tr><th id="160">160</th><td></td></tr>
<tr><th id="161">161</th><td><em>static</em> gfp_t saved_gfp_mask;</td></tr>
<tr><th id="162">162</th><td></td></tr>
<tr><th id="163">163</th><td><em>void</em> pm_restore_gfp_mask(<em>void</em>)</td></tr>
<tr><th id="164">164</th><td>{</td></tr>
<tr><th id="165">165</th><td>	WARN_ON(!mutex_is_locked(&amp;pm_mutex));</td></tr>
<tr><th id="166">166</th><td>	<b>if</b> (saved_gfp_mask) {</td></tr>
<tr><th id="167">167</th><td>		gfp_allowed_mask = saved_gfp_mask;</td></tr>
<tr><th id="168">168</th><td>		saved_gfp_mask = <var>0</var>;</td></tr>
<tr><th id="169">169</th><td>	}</td></tr>
<tr><th id="170">170</th><td>}</td></tr>
<tr><th id="171">171</th><td></td></tr>
<tr><th id="172">172</th><td><em>void</em> pm_restrict_gfp_mask(<em>void</em>)</td></tr>
<tr><th id="173">173</th><td>{</td></tr>
<tr><th id="174">174</th><td>	WARN_ON(!mutex_is_locked(&amp;pm_mutex));</td></tr>
<tr><th id="175">175</th><td>	WARN_ON(saved_gfp_mask);</td></tr>
<tr><th id="176">176</th><td>	saved_gfp_mask = gfp_allowed_mask;</td></tr>
<tr><th id="177">177</th><td>	gfp_allowed_mask &amp;= ~(__GFP_IO | __GFP_FS);</td></tr>
<tr><th id="178">178</th><td>}</td></tr>
<tr><th id="179">179</th><td></td></tr>
<tr><th id="180">180</th><td>bool pm_suspended_storage(<em>void</em>)</td></tr>
<tr><th id="181">181</th><td>{</td></tr>
<tr><th id="182">182</th><td>	<b>if</b> ((gfp_allowed_mask &amp; (__GFP_IO | __GFP_FS)) == (__GFP_IO | __GFP_FS))</td></tr>
<tr><th id="183">183</th><td>		<b>return</b> false;</td></tr>
<tr><th id="184">184</th><td>	<b>return</b> true;</td></tr>
<tr><th id="185">185</th><td>}</td></tr>
<tr><th id="186">186</th><td><u>#<span data-ppcond="151">endif</span> /* CONFIG_PM_SLEEP */</u></td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td><u>#<span data-ppcond="188">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HUGETLB_PAGE_SIZE_VARIABLE">CONFIG_HUGETLB_PAGE_SIZE_VARIABLE</span></u></td></tr>
<tr><th id="189">189</th><td><em>unsigned</em> <em>int</em> pageblock_order __read_mostly;</td></tr>
<tr><th id="190">190</th><td><u>#<span data-ppcond="188">endif</span></u></td></tr>
<tr><th id="191">191</th><td></td></tr>
<tr><th id="192">192</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#__free_pages_ok" title='__free_pages_ok' data-type='void __free_pages_ok(struct page * page, unsigned int order)' data-ref="__free_pages_ok">__free_pages_ok</a>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="364page" title='page' data-type='struct page *' data-ref="364page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="365order" title='order' data-type='unsigned int' data-ref="365order">order</dfn>);</td></tr>
<tr><th id="193">193</th><td></td></tr>
<tr><th id="194">194</th><td><i>/*</i></td></tr>
<tr><th id="195">195</th><td><i> * results with 256, 32 in the lowmem_reserve sysctl:</i></td></tr>
<tr><th id="196">196</th><td><i> *	1G machine -&gt; (16M dma, 800M-16M normal, 1G-800M high)</i></td></tr>
<tr><th id="197">197</th><td><i> *	1G machine -&gt; (16M dma, 784M normal, 224M high)</i></td></tr>
<tr><th id="198">198</th><td><i> *	NORMAL allocation will leave 784M/256 of ram reserved in the ZONE_DMA</i></td></tr>
<tr><th id="199">199</th><td><i> *	HIGHMEM allocation will leave 224M/32 of ram reserved in ZONE_NORMAL</i></td></tr>
<tr><th id="200">200</th><td><i> *	HIGHMEM allocation will leave (224M+784M)/256 of ram reserved in ZONE_DMA</i></td></tr>
<tr><th id="201">201</th><td><i> *</i></td></tr>
<tr><th id="202">202</th><td><i> * TBD: should special case ZONE_DMA32 machines here - in those we normally</i></td></tr>
<tr><th id="203">203</th><td><i> * don't need any ZONE_NORMAL reservation</i></td></tr>
<tr><th id="204">204</th><td><i> */</i></td></tr>
<tr><th id="205">205</th><td><em>int</em> <dfn class="decl def" id="sysctl_lowmem_reserve_ratio" title='sysctl_lowmem_reserve_ratio' data-ref="sysctl_lowmem_reserve_ratio">sysctl_lowmem_reserve_ratio</dfn>[<a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>-<var>1</var>] = {</td></tr>
<tr><th id="206">206</th><td><u>#<span data-ppcond="206">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#291" data-ref="_M/CONFIG_ZONE_DMA">CONFIG_ZONE_DMA</a></u></td></tr>
<tr><th id="207">207</th><td>	 <var>256</var>,</td></tr>
<tr><th id="208">208</th><td><u>#<span data-ppcond="206">endif</span></u></td></tr>
<tr><th id="209">209</th><td><u>#<span data-ppcond="209">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#1164" data-ref="_M/CONFIG_ZONE_DMA32">CONFIG_ZONE_DMA32</a></u></td></tr>
<tr><th id="210">210</th><td>	 <var>256</var>,</td></tr>
<tr><th id="211">211</th><td><u>#<span data-ppcond="209">endif</span></u></td></tr>
<tr><th id="212">212</th><td><u>#<span data-ppcond="212">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="213">213</th><td>	 <var>32</var>,</td></tr>
<tr><th id="214">214</th><td><u>#<span data-ppcond="212">endif</span></u></td></tr>
<tr><th id="215">215</th><td>	 <var>32</var>,</td></tr>
<tr><th id="216">216</th><td>};</td></tr>
<tr><th id="217">217</th><td></td></tr>
<tr><th id="218">218</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(totalram_pages) totalram_pages; static const char __kstrtab_totalram_pages[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;totalram_pages&quot;; static const struct kernel_symbol __ksymtab_totalram_pages __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;totalram_pages&quot;), used)) = { (unsigned long)&amp;totalram_pages, __kstrtab_totalram_pages }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages" id="totalram_pages"><a class="ref" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages"><a class="ref" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages"><a class="ref" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages">totalram_pages</a></a></a></a>);</td></tr>
<tr><th id="219">219</th><td></td></tr>
<tr><th id="220">220</th><td><em>static</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="zone_names" title='zone_names' data-type='char *const [4]' data-ref="zone_names">zone_names</dfn>[<a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>] = {</td></tr>
<tr><th id="221">221</th><td><u>#<span data-ppcond="221">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#291" data-ref="_M/CONFIG_ZONE_DMA">CONFIG_ZONE_DMA</a></u></td></tr>
<tr><th id="222">222</th><td>	 <q>"DMA"</q>,</td></tr>
<tr><th id="223">223</th><td><u>#<span data-ppcond="221">endif</span></u></td></tr>
<tr><th id="224">224</th><td><u>#<span data-ppcond="224">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#1164" data-ref="_M/CONFIG_ZONE_DMA32">CONFIG_ZONE_DMA32</a></u></td></tr>
<tr><th id="225">225</th><td>	 <q>"DMA32"</q>,</td></tr>
<tr><th id="226">226</th><td><u>#<span data-ppcond="224">endif</span></u></td></tr>
<tr><th id="227">227</th><td>	 <q>"Normal"</q>,</td></tr>
<tr><th id="228">228</th><td><u>#<span data-ppcond="228">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="229">229</th><td>	 <q>"HighMem"</q>,</td></tr>
<tr><th id="230">230</th><td><u>#<span data-ppcond="228">endif</span></u></td></tr>
<tr><th id="231">231</th><td>	 <q>"Movable"</q>,</td></tr>
<tr><th id="232">232</th><td><u>#<span data-ppcond="232">ifdef</span> <span class="macro" data-ref="_M/CONFIG_ZONE_DEVICE">CONFIG_ZONE_DEVICE</span></u></td></tr>
<tr><th id="233">233</th><td>	 <q>"Device"</q>,</td></tr>
<tr><th id="234">234</th><td><u>#<span data-ppcond="232">endif</span></u></td></tr>
<tr><th id="235">235</th><td>};</td></tr>
<tr><th id="236">236</th><td></td></tr>
<tr><th id="237">237</th><td><em>char</em> * <em>const</em> <dfn class="decl def" id="migratetype_names" title='migratetype_names' data-ref="migratetype_names">migratetype_names</dfn>[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>] = {</td></tr>
<tr><th id="238">238</th><td>	<q>"Unmovable"</q>,</td></tr>
<tr><th id="239">239</th><td>	<q>"Movable"</q>,</td></tr>
<tr><th id="240">240</th><td>	<q>"Reclaimable"</q>,</td></tr>
<tr><th id="241">241</th><td>	<q>"HighAtomic"</q>,</td></tr>
<tr><th id="242">242</th><td><u>#<span data-ppcond="242">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="243">243</th><td>	<q>"CMA"</q>,</td></tr>
<tr><th id="244">244</th><td><u>#<span data-ppcond="242">endif</span></u></td></tr>
<tr><th id="245">245</th><td><u>#<span data-ppcond="245">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMORY_ISOLATION">CONFIG_MEMORY_ISOLATION</span></u></td></tr>
<tr><th id="246">246</th><td>	<q>"Isolate"</q>,</td></tr>
<tr><th id="247">247</th><td><u>#<span data-ppcond="245">endif</span></u></td></tr>
<tr><th id="248">248</th><td>};</td></tr>
<tr><th id="249">249</th><td></td></tr>
<tr><th id="250">250</th><td><a class="typedef" href="../include/linux/mm.h.html#compound_page_dtor" title='compound_page_dtor' data-type='void (struct page *)' data-ref="compound_page_dtor">compound_page_dtor</a> * <em>const</em> <dfn class="decl def" id="compound_page_dtors" title='compound_page_dtors' data-ref="compound_page_dtors">compound_page_dtors</dfn>[] = {</td></tr>
<tr><th id="251">251</th><td>	<a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="252">252</th><td>	<a class="ref fn" href="#free_compound_page" title='free_compound_page' data-ref="free_compound_page">free_compound_page</a>,</td></tr>
<tr><th id="253">253</th><td><u>#<span data-ppcond="253">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#493" data-ref="_M/CONFIG_HUGETLB_PAGE">CONFIG_HUGETLB_PAGE</a></u></td></tr>
<tr><th id="254">254</th><td>	<a class="ref fn" href="../include/linux/hugetlb.h.html#free_huge_page" title='free_huge_page' data-ref="free_huge_page">free_huge_page</a>,</td></tr>
<tr><th id="255">255</th><td><u>#<span data-ppcond="253">endif</span></u></td></tr>
<tr><th id="256">256</th><td><u>#<span data-ppcond="256">ifdef</span> <span class="macro" data-ref="_M/CONFIG_TRANSPARENT_HUGEPAGE">CONFIG_TRANSPARENT_HUGEPAGE</span></u></td></tr>
<tr><th id="257">257</th><td>	free_transhuge_page,</td></tr>
<tr><th id="258">258</th><td><u>#<span data-ppcond="256">endif</span></u></td></tr>
<tr><th id="259">259</th><td>};</td></tr>
<tr><th id="260">260</th><td></td></tr>
<tr><th id="261">261</th><td><em>int</em> <dfn class="decl def" id="min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</dfn> = <var>1024</var>;</td></tr>
<tr><th id="262">262</th><td><em>int</em> <dfn class="decl def" id="user_min_free_kbytes" title='user_min_free_kbytes' data-ref="user_min_free_kbytes">user_min_free_kbytes</dfn> = -<var>1</var>;</td></tr>
<tr><th id="263">263</th><td><em>int</em> <dfn class="decl def" id="watermark_scale_factor" title='watermark_scale_factor' data-ref="watermark_scale_factor">watermark_scale_factor</dfn> = <var>10</var>;</td></tr>
<tr><th id="264">264</th><td></td></tr>
<tr><th id="265">265</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a> <dfn class="tu decl def" id="nr_kernel_pages" title='nr_kernel_pages' data-type='unsigned long' data-ref="nr_kernel_pages">nr_kernel_pages</dfn>;</td></tr>
<tr><th id="266">266</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a> <dfn class="tu decl def" id="nr_all_pages" title='nr_all_pages' data-type='unsigned long' data-ref="nr_all_pages">nr_all_pages</dfn>;</td></tr>
<tr><th id="267">267</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a> <dfn class="tu decl def" id="dma_reserve" title='dma_reserve' data-type='unsigned long' data-ref="dma_reserve">dma_reserve</dfn>;</td></tr>
<tr><th id="268">268</th><td></td></tr>
<tr><th id="269">269</th><td><u>#<span data-ppcond="269">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a></u></td></tr>
<tr><th id="270">270</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a> <dfn class="tu decl def" id="arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-type='unsigned long [4]' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</dfn>[<a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>];</td></tr>
<tr><th id="271">271</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a> <dfn class="tu decl def" id="arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-type='unsigned long [4]' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</dfn>[<a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>];</td></tr>
<tr><th id="272">272</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#51" title="__attribute__ ((__section__(&quot;.init.data&quot;)))" data-ref="_M/__initdata">__initdata</a> <dfn class="tu decl def" id="required_kernelcore" title='required_kernelcore' data-type='unsigned long' data-ref="required_kernelcore">required_kernelcore</dfn>;</td></tr>
<tr><th id="273">273</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#51" title="__attribute__ ((__section__(&quot;.init.data&quot;)))" data-ref="_M/__initdata">__initdata</a> <dfn class="tu decl def" id="required_movablecore" title='required_movablecore' data-type='unsigned long' data-ref="required_movablecore">required_movablecore</dfn>;</td></tr>
<tr><th id="274">274</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a> <dfn class="tu decl def" id="zone_movable_pfn" title='zone_movable_pfn' data-type='unsigned long [1]' data-ref="zone_movable_pfn">zone_movable_pfn</dfn>[<a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>];</td></tr>
<tr><th id="275">275</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def" id="mirrored_kernelcore" title='mirrored_kernelcore' data-type='bool' data-ref="mirrored_kernelcore">mirrored_kernelcore</dfn>;</td></tr>
<tr><th id="276">276</th><td></td></tr>
<tr><th id="277">277</th><td><i>/* movable_zone is the "real" zone pages in ZONE_MOVABLE are taken from */</i></td></tr>
<tr><th id="278">278</th><td><em>int</em> <dfn class="decl def" id="movable_zone" title='movable_zone' data-ref="movable_zone">movable_zone</dfn>;</td></tr>
<tr><th id="279">279</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(movable_zone) movable_zone; static const char __kstrtab_movable_zone[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;movable_zone&quot;; static const struct kernel_symbol __ksymtab_movable_zone __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;movable_zone&quot;), used)) = { (unsigned long)&amp;movable_zone, __kstrtab_movable_zone }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone" id="movable_zone"><a class="ref" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone"><a class="ref" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone"><a class="ref" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone">movable_zone</a></a></a></a>);</td></tr>
<tr><th id="280">280</th><td><u>#<span data-ppcond="269">endif</span> /* CONFIG_HAVE_MEMBLOCK_NODE_MAP */</u></td></tr>
<tr><th id="281">281</th><td></td></tr>
<tr><th id="282">282</th><td><u>#<span data-ppcond="282">if</span> <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a> &gt; 1</u></td></tr>
<tr><th id="283">283</th><td><em>int</em> nr_node_ids __read_mostly = MAX_NUMNODES;</td></tr>
<tr><th id="284">284</th><td><em>int</em> nr_online_nodes __read_mostly = <var>1</var>;</td></tr>
<tr><th id="285">285</th><td>EXPORT_SYMBOL(nr_node_ids);</td></tr>
<tr><th id="286">286</th><td>EXPORT_SYMBOL(nr_online_nodes);</td></tr>
<tr><th id="287">287</th><td><u>#<span data-ppcond="282">endif</span></u></td></tr>
<tr><th id="288">288</th><td></td></tr>
<tr><th id="289">289</th><td><em>int</em> <dfn class="decl def" id="page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</dfn> <a class="macro" href="../arch/x86/include/asm/cache.h.html#11" title="__attribute__((__section__(&quot;.data..read_mostly&quot;)))" data-ref="_M/__read_mostly">__read_mostly</a>;</td></tr>
<tr><th id="290">290</th><td></td></tr>
<tr><th id="291">291</th><td><u>#<span data-ppcond="291">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEFERRED_STRUCT_PAGE_INIT">CONFIG_DEFERRED_STRUCT_PAGE_INIT</span></u></td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td><i>/*</i></td></tr>
<tr><th id="294">294</th><td><i> * Determine how many pages need to be initialized durig early boot</i></td></tr>
<tr><th id="295">295</th><td><i> * (non-deferred initialization).</i></td></tr>
<tr><th id="296">296</th><td><i> * The value of first_deferred_pfn will be set later, once non-deferred pages</i></td></tr>
<tr><th id="297">297</th><td><i> * are initialized, but for now set it ULONG_MAX.</i></td></tr>
<tr><th id="298">298</th><td><i> */</i></td></tr>
<tr><th id="299">299</th><td><em>static</em> <b>inline</b> <em>void</em> reset_deferred_meminit(pg_data_t *pgdat)</td></tr>
<tr><th id="300">300</th><td>{</td></tr>
<tr><th id="301">301</th><td>	phys_addr_t start_addr, end_addr;</td></tr>
<tr><th id="302">302</th><td>	<em>unsigned</em> <em>long</em> max_pgcnt;</td></tr>
<tr><th id="303">303</th><td>	<em>unsigned</em> <em>long</em> reserved;</td></tr>
<tr><th id="304">304</th><td></td></tr>
<tr><th id="305">305</th><td>	<i>/*</i></td></tr>
<tr><th id="306">306</th><td><i>	 * Initialise at least 2G of a node but also take into account that</i></td></tr>
<tr><th id="307">307</th><td><i>	 * two large system hashes that can take up 1GB for 0.25TB/node.</i></td></tr>
<tr><th id="308">308</th><td><i>	 */</i></td></tr>
<tr><th id="309">309</th><td>	max_pgcnt = max(<var>2UL</var> &lt;&lt; (<var>30</var> - PAGE_SHIFT),</td></tr>
<tr><th id="310">310</th><td>			(pgdat-&gt;node_spanned_pages &gt;&gt; <var>8</var>));</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td>	<i>/*</i></td></tr>
<tr><th id="313">313</th><td><i>	 * Compensate the all the memblock reservations (e.g. crash kernel)</i></td></tr>
<tr><th id="314">314</th><td><i>	 * from the initial estimation to make sure we will initialize enough</i></td></tr>
<tr><th id="315">315</th><td><i>	 * memory to boot.</i></td></tr>
<tr><th id="316">316</th><td><i>	 */</i></td></tr>
<tr><th id="317">317</th><td>	start_addr = PFN_PHYS(pgdat-&gt;node_start_pfn);</td></tr>
<tr><th id="318">318</th><td>	end_addr = PFN_PHYS(pgdat-&gt;node_start_pfn + max_pgcnt);</td></tr>
<tr><th id="319">319</th><td>	reserved = memblock_reserved_memory_within(start_addr, end_addr);</td></tr>
<tr><th id="320">320</th><td>	max_pgcnt += PHYS_PFN(reserved);</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td>	pgdat-&gt;static_init_pgcnt = min(max_pgcnt, pgdat-&gt;node_spanned_pages);</td></tr>
<tr><th id="323">323</th><td>	pgdat-&gt;first_deferred_pfn = ULONG_MAX;</td></tr>
<tr><th id="324">324</th><td>}</td></tr>
<tr><th id="325">325</th><td></td></tr>
<tr><th id="326">326</th><td><i>/* Returns true if the struct page for the pfn is uninitialised */</i></td></tr>
<tr><th id="327">327</th><td><em>static</em> <b>inline</b> bool __meminit early_page_uninitialised(<em>unsigned</em> <em>long</em> pfn)</td></tr>
<tr><th id="328">328</th><td>{</td></tr>
<tr><th id="329">329</th><td>	<em>int</em> nid = early_pfn_to_nid(pfn);</td></tr>
<tr><th id="330">330</th><td></td></tr>
<tr><th id="331">331</th><td>	<b>if</b> (node_online(nid) &amp;&amp; pfn &gt;= NODE_DATA(nid)-&gt;first_deferred_pfn)</td></tr>
<tr><th id="332">332</th><td>		<b>return</b> true;</td></tr>
<tr><th id="333">333</th><td></td></tr>
<tr><th id="334">334</th><td>	<b>return</b> false;</td></tr>
<tr><th id="335">335</th><td>}</td></tr>
<tr><th id="336">336</th><td></td></tr>
<tr><th id="337">337</th><td><i>/*</i></td></tr>
<tr><th id="338">338</th><td><i> * Returns false when the remaining initialisation should be deferred until</i></td></tr>
<tr><th id="339">339</th><td><i> * later in the boot cycle when it can be parallelised.</i></td></tr>
<tr><th id="340">340</th><td><i> */</i></td></tr>
<tr><th id="341">341</th><td><em>static</em> <b>inline</b> bool update_defer_init(pg_data_t *pgdat,</td></tr>
<tr><th id="342">342</th><td>				<em>unsigned</em> <em>long</em> pfn, <em>unsigned</em> <em>long</em> zone_end,</td></tr>
<tr><th id="343">343</th><td>				<em>unsigned</em> <em>long</em> *nr_initialised)</td></tr>
<tr><th id="344">344</th><td>{</td></tr>
<tr><th id="345">345</th><td>	<i>/* Always populate low zones for address-contrained allocations */</i></td></tr>
<tr><th id="346">346</th><td>	<b>if</b> (zone_end &lt; pgdat_end_pfn(pgdat))</td></tr>
<tr><th id="347">347</th><td>		<b>return</b> true;</td></tr>
<tr><th id="348">348</th><td>	(*nr_initialised)++;</td></tr>
<tr><th id="349">349</th><td>	<b>if</b> ((*nr_initialised &gt; pgdat-&gt;static_init_pgcnt) &amp;&amp;</td></tr>
<tr><th id="350">350</th><td>	    (pfn &amp; (PAGES_PER_SECTION - <var>1</var>)) == <var>0</var>) {</td></tr>
<tr><th id="351">351</th><td>		pgdat-&gt;first_deferred_pfn = pfn;</td></tr>
<tr><th id="352">352</th><td>		<b>return</b> false;</td></tr>
<tr><th id="353">353</th><td>	}</td></tr>
<tr><th id="354">354</th><td></td></tr>
<tr><th id="355">355</th><td>	<b>return</b> true;</td></tr>
<tr><th id="356">356</th><td>}</td></tr>
<tr><th id="357">357</th><td><u>#<span data-ppcond="291">else</span></u></td></tr>
<tr><th id="358">358</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="reset_deferred_meminit" title='reset_deferred_meminit' data-type='void reset_deferred_meminit(pg_data_t * pgdat)' data-ref="reset_deferred_meminit">reset_deferred_meminit</dfn>(<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col6 decl" id="366pgdat" title='pgdat' data-type='pg_data_t *' data-ref="366pgdat">pgdat</dfn>)</td></tr>
<tr><th id="359">359</th><td>{</td></tr>
<tr><th id="360">360</th><td>}</td></tr>
<tr><th id="361">361</th><td></td></tr>
<tr><th id="362">362</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="early_page_uninitialised" title='early_page_uninitialised' data-type='bool early_page_uninitialised(unsigned long pfn)' data-ref="early_page_uninitialised">early_page_uninitialised</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="367pfn" title='pfn' data-type='unsigned long' data-ref="367pfn">pfn</dfn>)</td></tr>
<tr><th id="363">363</th><td>{</td></tr>
<tr><th id="364">364</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="365">365</th><td>}</td></tr>
<tr><th id="366">366</th><td></td></tr>
<tr><th id="367">367</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="update_defer_init" title='update_defer_init' data-type='bool update_defer_init(pg_data_t * pgdat, unsigned long pfn, unsigned long zone_end, unsigned long * nr_initialised)' data-ref="update_defer_init">update_defer_init</dfn>(<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col8 decl" id="368pgdat" title='pgdat' data-type='pg_data_t *' data-ref="368pgdat">pgdat</dfn>,</td></tr>
<tr><th id="368">368</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="369pfn" title='pfn' data-type='unsigned long' data-ref="369pfn">pfn</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="370zone_end" title='zone_end' data-type='unsigned long' data-ref="370zone_end">zone_end</dfn>,</td></tr>
<tr><th id="369">369</th><td>				<em>unsigned</em> <em>long</em> *<dfn class="local col1 decl" id="371nr_initialised" title='nr_initialised' data-type='unsigned long *' data-ref="371nr_initialised">nr_initialised</dfn>)</td></tr>
<tr><th id="370">370</th><td>{</td></tr>
<tr><th id="371">371</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="372">372</th><td>}</td></tr>
<tr><th id="373">373</th><td><u>#<span data-ppcond="291">endif</span></u></td></tr>
<tr><th id="374">374</th><td></td></tr>
<tr><th id="375">375</th><td><i  data-doc="get_pageblock_bitmap">/* Return a pointer to the bitmap storing bits affecting a block of pages */</i></td></tr>
<tr><th id="376">376</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>long</em> *<dfn class="tu decl def fn" id="get_pageblock_bitmap" title='get_pageblock_bitmap' data-type='unsigned long * get_pageblock_bitmap(struct page * page, unsigned long pfn)' data-ref="get_pageblock_bitmap">get_pageblock_bitmap</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="372page" title='page' data-type='struct page *' data-ref="372page">page</dfn>,</td></tr>
<tr><th id="377">377</th><td>							<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="373pfn" title='pfn' data-type='unsigned long' data-ref="373pfn">pfn</dfn>)</td></tr>
<tr><th id="378">378</th><td>{</td></tr>
<tr><th id="379">379</th><td><u>#<span data-ppcond="379">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#950" data-ref="_M/CONFIG_SPARSEMEM">CONFIG_SPARSEMEM</a></u></td></tr>
<tr><th id="380">380</th><td>	<b>return</b> <a class="ref fn" href="../include/linux/mmzone.h.html#__pfn_to_section" title='__pfn_to_section' data-ref="__pfn_to_section">__pfn_to_section</a>(<a class="local col3 ref" href="#373pfn" title='pfn' data-ref="373pfn">pfn</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mem_section::pageblock_flags" title='mem_section::pageblock_flags' data-ref="mem_section::pageblock_flags">pageblock_flags</a>;</td></tr>
<tr><th id="381">381</th><td><u>#<span data-ppcond="379">else</span></u></td></tr>
<tr><th id="382">382</th><td>	<b>return</b> page_zone(page)-&gt;pageblock_flags;</td></tr>
<tr><th id="383">383</th><td><u>#<span data-ppcond="379">endif</span> /* CONFIG_SPARSEMEM */</u></td></tr>
<tr><th id="384">384</th><td>}</td></tr>
<tr><th id="385">385</th><td></td></tr>
<tr><th id="386">386</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="pfn_to_bitidx" title='pfn_to_bitidx' data-type='int pfn_to_bitidx(struct page * page, unsigned long pfn)' data-ref="pfn_to_bitidx">pfn_to_bitidx</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="374page" title='page' data-type='struct page *' data-ref="374page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="375pfn" title='pfn' data-type='unsigned long' data-ref="375pfn">pfn</dfn>)</td></tr>
<tr><th id="387">387</th><td>{</td></tr>
<tr><th id="388">388</th><td><u>#<span data-ppcond="388">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#950" data-ref="_M/CONFIG_SPARSEMEM">CONFIG_SPARSEMEM</a></u></td></tr>
<tr><th id="389">389</th><td>	<a class="local col5 ref" href="#375pfn" title='pfn' data-ref="375pfn">pfn</a> &amp;= (<a class="macro" href="../include/linux/mmzone.h.html#1089" title="(1UL &lt;&lt; (27 - 12))" data-ref="_M/PAGES_PER_SECTION">PAGES_PER_SECTION</a>-<var>1</var>);</td></tr>
<tr><th id="390">390</th><td>	<b>return</b> (<a class="local col5 ref" href="#375pfn" title='pfn' data-ref="375pfn">pfn</a> &gt;&gt; <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a>) * <a class="enum" href="../include/linux/pageblock-flags.h.html#NR_PAGEBLOCK_BITS" title='NR_PAGEBLOCK_BITS' data-ref="NR_PAGEBLOCK_BITS">NR_PAGEBLOCK_BITS</a>;</td></tr>
<tr><th id="391">391</th><td><u>#<span data-ppcond="388">else</span></u></td></tr>
<tr><th id="392">392</th><td>	pfn = pfn - round_down(page_zone(page)-&gt;zone_start_pfn, pageblock_nr_pages);</td></tr>
<tr><th id="393">393</th><td>	<b>return</b> (pfn &gt;&gt; pageblock_order) * NR_PAGEBLOCK_BITS;</td></tr>
<tr><th id="394">394</th><td><u>#<span data-ppcond="388">endif</span> /* CONFIG_SPARSEMEM */</u></td></tr>
<tr><th id="395">395</th><td>}</td></tr>
<tr><th id="396">396</th><td></td></tr>
<tr><th id="397">397</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask">/**</i></td></tr>
<tr><th id="398">398</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> * get_pfnblock_flags_mask - Return the requested group of flags for the pageblock_nr_pages block of pages</i></td></tr>
<tr><th id="399">399</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> *<span class="command"> @page</span>: The page within the block of interest</i></td></tr>
<tr><th id="400">400</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> * <span class="command">@pf</span>n:<span class="verb"> The target page frame number</span></i></td></tr>
<tr><th id="401">401</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> *<span class="command"> @end</span>_bitidx: The last bit of interest to retrieve</i></td></tr>
<tr><th id="402">402</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> *<span class="command"> @mask</span>: mask of bits that the caller is interested in</i></td></tr>
<tr><th id="403">403</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> *</i></td></tr>
<tr><th id="404">404</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> * Return: pageblock_bits flags</i></td></tr>
<tr><th id="405">405</th><td><i class="doc" data-doc="__get_pfnblock_flags_mask"> */</i></td></tr>
<tr><th id="406">406</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#103" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function)) __attribute__((always_inline))" data-ref="_M/__always_inline">__always_inline</a> <em>unsigned</em> <em>long</em> <dfn class="tu decl def fn" id="__get_pfnblock_flags_mask" title='__get_pfnblock_flags_mask' data-type='unsigned long __get_pfnblock_flags_mask(struct page * page, unsigned long pfn, unsigned long end_bitidx, unsigned long mask)' data-ref="__get_pfnblock_flags_mask">__get_pfnblock_flags_mask</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="376page" title='page' data-type='struct page *' data-ref="376page">page</dfn>,</td></tr>
<tr><th id="407">407</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="377pfn" title='pfn' data-type='unsigned long' data-ref="377pfn">pfn</dfn>,</td></tr>
<tr><th id="408">408</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="378end_bitidx" title='end_bitidx' data-type='unsigned long' data-ref="378end_bitidx">end_bitidx</dfn>,</td></tr>
<tr><th id="409">409</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="379mask" title='mask' data-type='unsigned long' data-ref="379mask">mask</dfn>)</td></tr>
<tr><th id="410">410</th><td>{</td></tr>
<tr><th id="411">411</th><td>	<em>unsigned</em> <em>long</em> *<dfn class="local col0 decl" id="380bitmap" title='bitmap' data-type='unsigned long *' data-ref="380bitmap">bitmap</dfn>;</td></tr>
<tr><th id="412">412</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="381bitidx" title='bitidx' data-type='unsigned long' data-ref="381bitidx">bitidx</dfn>, <dfn class="local col2 decl" id="382word_bitidx" title='word_bitidx' data-type='unsigned long' data-ref="382word_bitidx">word_bitidx</dfn>;</td></tr>
<tr><th id="413">413</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="383word" title='word' data-type='unsigned long' data-ref="383word">word</dfn>;</td></tr>
<tr><th id="414">414</th><td></td></tr>
<tr><th id="415">415</th><td>	<a class="local col0 ref" href="#380bitmap" title='bitmap' data-ref="380bitmap">bitmap</a> = <a class="tu ref fn" href="#get_pageblock_bitmap" title='get_pageblock_bitmap' data-use='c' data-ref="get_pageblock_bitmap">get_pageblock_bitmap</a>(<a class="local col6 ref" href="#376page" title='page' data-ref="376page">page</a>, <a class="local col7 ref" href="#377pfn" title='pfn' data-ref="377pfn">pfn</a>);</td></tr>
<tr><th id="416">416</th><td>	<a class="local col1 ref" href="#381bitidx" title='bitidx' data-ref="381bitidx">bitidx</a> = <a class="tu ref fn" href="#pfn_to_bitidx" title='pfn_to_bitidx' data-use='c' data-ref="pfn_to_bitidx">pfn_to_bitidx</a>(<a class="local col6 ref" href="#376page" title='page' data-ref="376page">page</a>, <a class="local col7 ref" href="#377pfn" title='pfn' data-ref="377pfn">pfn</a>);</td></tr>
<tr><th id="417">417</th><td>	<a class="local col2 ref" href="#382word_bitidx" title='word_bitidx' data-ref="382word_bitidx">word_bitidx</a> = <a class="local col1 ref" href="#381bitidx" title='bitidx' data-ref="381bitidx">bitidx</a> / <a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a>;</td></tr>
<tr><th id="418">418</th><td>	<a class="local col1 ref" href="#381bitidx" title='bitidx' data-ref="381bitidx">bitidx</a> &amp;= (<a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a>-<var>1</var>);</td></tr>
<tr><th id="419">419</th><td></td></tr>
<tr><th id="420">420</th><td>	<a class="local col3 ref" href="#383word" title='word' data-ref="383word">word</a> = <a class="local col0 ref" href="#380bitmap" title='bitmap' data-ref="380bitmap">bitmap</a>[<a class="local col2 ref" href="#382word_bitidx" title='word_bitidx' data-ref="382word_bitidx">word_bitidx</a>];</td></tr>
<tr><th id="421">421</th><td>	<a class="local col1 ref" href="#381bitidx" title='bitidx' data-ref="381bitidx">bitidx</a> += <a class="local col8 ref" href="#378end_bitidx" title='end_bitidx' data-ref="378end_bitidx">end_bitidx</a>;</td></tr>
<tr><th id="422">422</th><td>	<b>return</b> (<a class="local col3 ref" href="#383word" title='word' data-ref="383word">word</a> &gt;&gt; (<a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a> - <a class="local col1 ref" href="#381bitidx" title='bitidx' data-ref="381bitidx">bitidx</a> - <var>1</var>)) &amp; <a class="local col9 ref" href="#379mask" title='mask' data-ref="379mask">mask</a>;</td></tr>
<tr><th id="423">423</th><td>}</td></tr>
<tr><th id="424">424</th><td></td></tr>
<tr><th id="425">425</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def fn" id="get_pfnblock_flags_mask" title='get_pfnblock_flags_mask' data-ref="get_pfnblock_flags_mask">get_pfnblock_flags_mask</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="384page" title='page' data-type='struct page *' data-ref="384page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="385pfn" title='pfn' data-type='unsigned long' data-ref="385pfn">pfn</dfn>,</td></tr>
<tr><th id="426">426</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="386end_bitidx" title='end_bitidx' data-type='unsigned long' data-ref="386end_bitidx">end_bitidx</dfn>,</td></tr>
<tr><th id="427">427</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="387mask" title='mask' data-type='unsigned long' data-ref="387mask">mask</dfn>)</td></tr>
<tr><th id="428">428</th><td>{</td></tr>
<tr><th id="429">429</th><td>	<b>return</b> <a class="tu ref fn" href="#__get_pfnblock_flags_mask" title='__get_pfnblock_flags_mask' data-use='c' data-ref="__get_pfnblock_flags_mask">__get_pfnblock_flags_mask</a>(<a class="local col4 ref" href="#384page" title='page' data-ref="384page">page</a>, <a class="local col5 ref" href="#385pfn" title='pfn' data-ref="385pfn">pfn</a>, <a class="local col6 ref" href="#386end_bitidx" title='end_bitidx' data-ref="386end_bitidx">end_bitidx</a>, <a class="local col7 ref" href="#387mask" title='mask' data-ref="387mask">mask</a>);</td></tr>
<tr><th id="430">430</th><td>}</td></tr>
<tr><th id="431">431</th><td></td></tr>
<tr><th id="432">432</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#103" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function)) __attribute__((always_inline))" data-ref="_M/__always_inline">__always_inline</a> <em>int</em> <dfn class="tu decl def fn" id="get_pfnblock_migratetype" title='get_pfnblock_migratetype' data-type='int get_pfnblock_migratetype(struct page * page, unsigned long pfn)' data-ref="get_pfnblock_migratetype">get_pfnblock_migratetype</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="388page" title='page' data-type='struct page *' data-ref="388page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="389pfn" title='pfn' data-type='unsigned long' data-ref="389pfn">pfn</dfn>)</td></tr>
<tr><th id="433">433</th><td>{</td></tr>
<tr><th id="434">434</th><td>	<b>return</b> <a class="tu ref fn" href="#__get_pfnblock_flags_mask" title='__get_pfnblock_flags_mask' data-use='c' data-ref="__get_pfnblock_flags_mask">__get_pfnblock_flags_mask</a>(<a class="local col8 ref" href="#388page" title='page' data-ref="388page">page</a>, <a class="local col9 ref" href="#389pfn" title='pfn' data-ref="389pfn">pfn</a>, <a class="enum" href="../include/linux/pageblock-flags.h.html#PB_migrate_end" title='PB_migrate_end' data-ref="PB_migrate_end">PB_migrate_end</a>, <a class="macro" href="../include/linux/mmzone.h.html#90" title="((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1)" data-ref="_M/MIGRATETYPE_MASK">MIGRATETYPE_MASK</a>);</td></tr>
<tr><th id="435">435</th><td>}</td></tr>
<tr><th id="436">436</th><td></td></tr>
<tr><th id="437">437</th><td><i class="doc">/**</i></td></tr>
<tr><th id="438">438</th><td><i class="doc"> * set_pfnblock_flags_mask - Set the requested group of flags for a pageblock_nr_pages block of pages</i></td></tr>
<tr><th id="439">439</th><td><i class="doc"> *<span class="command"> @page</span>: The page within the block of interest</i></td></tr>
<tr><th id="440">440</th><td><i class="doc"> *<span class="command"> @flags</span>: The flags to set</i></td></tr>
<tr><th id="441">441</th><td><i class="doc"> * <span class="command">@pf</span>n:<span class="verb"> The target page frame number</span></i></td></tr>
<tr><th id="442">442</th><td><i class="doc"> *<span class="command"> @end</span>_bitidx: The last bit of interest</i></td></tr>
<tr><th id="443">443</th><td><i class="doc"> *<span class="command"> @mask</span>: mask of bits that the caller is interested in</i></td></tr>
<tr><th id="444">444</th><td><i class="doc"> */</i></td></tr>
<tr><th id="445">445</th><td><em>void</em> <dfn class="decl def fn" id="set_pfnblock_flags_mask" title='set_pfnblock_flags_mask' data-ref="set_pfnblock_flags_mask">set_pfnblock_flags_mask</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="390page" title='page' data-type='struct page *' data-ref="390page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="391flags" title='flags' data-type='unsigned long' data-ref="391flags">flags</dfn>,</td></tr>
<tr><th id="446">446</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="392pfn" title='pfn' data-type='unsigned long' data-ref="392pfn">pfn</dfn>,</td></tr>
<tr><th id="447">447</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="393end_bitidx" title='end_bitidx' data-type='unsigned long' data-ref="393end_bitidx">end_bitidx</dfn>,</td></tr>
<tr><th id="448">448</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="394mask" title='mask' data-type='unsigned long' data-ref="394mask">mask</dfn>)</td></tr>
<tr><th id="449">449</th><td>{</td></tr>
<tr><th id="450">450</th><td>	<em>unsigned</em> <em>long</em> *<dfn class="local col5 decl" id="395bitmap" title='bitmap' data-type='unsigned long *' data-ref="395bitmap">bitmap</dfn>;</td></tr>
<tr><th id="451">451</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="396bitidx" title='bitidx' data-type='unsigned long' data-ref="396bitidx">bitidx</dfn>, <dfn class="local col7 decl" id="397word_bitidx" title='word_bitidx' data-type='unsigned long' data-ref="397word_bitidx">word_bitidx</dfn>;</td></tr>
<tr><th id="452">452</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="398old_word" title='old_word' data-type='unsigned long' data-ref="398old_word">old_word</dfn>, <dfn class="local col9 decl" id="399word" title='word' data-type='unsigned long' data-ref="399word">word</dfn>;</td></tr>
<tr><th id="453">453</th><td></td></tr>
<tr><th id="454">454</th><td>	<a class="macro" href="../include/linux/build_bug.h.html#70" title="do { bool __cond = !(!(NR_PAGEBLOCK_BITS != 4)); extern void __compiletime_assert_454(void) ; if (__cond) __compiletime_assert_454(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0)" data-ref="_M/BUILD_BUG_ON">BUILD_BUG_ON</a>(<a class="enum" href="../include/linux/pageblock-flags.h.html#NR_PAGEBLOCK_BITS" title='NR_PAGEBLOCK_BITS' data-ref="NR_PAGEBLOCK_BITS">NR_PAGEBLOCK_BITS</a> != <var>4</var>);</td></tr>
<tr><th id="455">455</th><td></td></tr>
<tr><th id="456">456</th><td>	<a class="local col5 ref" href="#395bitmap" title='bitmap' data-ref="395bitmap">bitmap</a> = <a class="tu ref fn" href="#get_pageblock_bitmap" title='get_pageblock_bitmap' data-use='c' data-ref="get_pageblock_bitmap">get_pageblock_bitmap</a>(<a class="local col0 ref" href="#390page" title='page' data-ref="390page">page</a>, <a class="local col2 ref" href="#392pfn" title='pfn' data-ref="392pfn">pfn</a>);</td></tr>
<tr><th id="457">457</th><td>	<a class="local col6 ref" href="#396bitidx" title='bitidx' data-ref="396bitidx">bitidx</a> = <a class="tu ref fn" href="#pfn_to_bitidx" title='pfn_to_bitidx' data-use='c' data-ref="pfn_to_bitidx">pfn_to_bitidx</a>(<a class="local col0 ref" href="#390page" title='page' data-ref="390page">page</a>, <a class="local col2 ref" href="#392pfn" title='pfn' data-ref="392pfn">pfn</a>);</td></tr>
<tr><th id="458">458</th><td>	<a class="local col7 ref" href="#397word_bitidx" title='word_bitidx' data-ref="397word_bitidx">word_bitidx</a> = <a class="local col6 ref" href="#396bitidx" title='bitidx' data-ref="396bitidx">bitidx</a> / <a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a>;</td></tr>
<tr><th id="459">459</th><td>	<a class="local col6 ref" href="#396bitidx" title='bitidx' data-ref="396bitidx">bitidx</a> &amp;= (<a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a>-<var>1</var>);</td></tr>
<tr><th id="460">460</th><td></td></tr>
<tr><th id="461">461</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(!zone_spans_pfn(page_zone(page), pfn)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(!<a class="ref fn" href="../include/linux/mmzone.h.html#zone_spans_pfn" title='zone_spans_pfn' data-ref="zone_spans_pfn">zone_spans_pfn</a>(<a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col0 ref" href="#390page" title='page' data-ref="390page">page</a>), <a class="local col2 ref" href="#392pfn" title='pfn' data-ref="392pfn">pfn</a>), page);</td></tr>
<tr><th id="462">462</th><td></td></tr>
<tr><th id="463">463</th><td>	<a class="local col6 ref" href="#396bitidx" title='bitidx' data-ref="396bitidx">bitidx</a> += <a class="local col3 ref" href="#393end_bitidx" title='end_bitidx' data-ref="393end_bitidx">end_bitidx</a>;</td></tr>
<tr><th id="464">464</th><td>	<a class="local col4 ref" href="#394mask" title='mask' data-ref="394mask">mask</a> &lt;&lt;= (<a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a> - <a class="local col6 ref" href="#396bitidx" title='bitidx' data-ref="396bitidx">bitidx</a> - <var>1</var>);</td></tr>
<tr><th id="465">465</th><td>	<a class="local col1 ref" href="#391flags" title='flags' data-ref="391flags">flags</a> &lt;&lt;= (<a class="macro" href="../include/asm-generic/bitsperlong.h.html#9" title="64" data-ref="_M/BITS_PER_LONG">BITS_PER_LONG</a> - <a class="local col6 ref" href="#396bitidx" title='bitidx' data-ref="396bitidx">bitidx</a> - <var>1</var>);</td></tr>
<tr><th id="466">466</th><td></td></tr>
<tr><th id="467">467</th><td>	<a class="local col9 ref" href="#399word" title='word' data-ref="399word">word</a> = <a class="macro" href="../include/linux/compiler.h.html#254" title="({ union { typeof(bitmap[word_bitidx]) __val; char __c[1]; } __u; if (1) __read_once_size(&amp;(bitmap[word_bitidx]), __u.__c, sizeof(bitmap[word_bitidx])); else __read_once_size_nocheck(&amp;(bitmap[word_bitidx]), __u.__c, sizeof(bitmap[word_bitidx])); do { } while (0); __u.__val; })" data-ref="_M/READ_ONCE">READ_ONCE</a>(<a class="local col5 ref" href="#395bitmap" title='bitmap' data-ref="395bitmap">bitmap</a>[<a class="local col7 ref" href="#397word_bitidx" title='word_bitidx' data-ref="397word_bitidx">word_bitidx</a>]);</td></tr>
<tr><th id="468">468</th><td>	<b>for</b> (;;) {</td></tr>
<tr><th id="469">469</th><td>		<a class="local col8 ref" href="#398old_word" title='old_word' data-ref="398old_word">old_word</a> = <a class="macro" href="../arch/x86/include/asm/cmpxchg.h.html#148" title="({ __typeof__(*((&amp;bitmap[word_bitidx]))) __ret; __typeof__(*((&amp;bitmap[word_bitidx]))) __old = ((word)); __typeof__(*((&amp;bitmap[word_bitidx]))) __new = (((word &amp; ~mask) | flags)); switch ((sizeof(*(&amp;bitmap[word_bitidx])))) { case 1: { volatile u8 *__ptr = (volatile u8 *)((&amp;bitmap[word_bitidx])); asm volatile(&quot;.pushsection .smp_locks,\&quot;a\&quot;\n&quot; &quot;.balign 4\n&quot; &quot;.long 671f - .\n&quot; &quot;.popsection\n&quot; &quot;671:&quot; &quot;\n\tlock; &quot; &quot;cmpxchgb %2,%1&quot; : &quot;=a&quot; (__ret), &quot;+m&quot; (*__ptr) : &quot;q&quot; (__new), &quot;0&quot; (__old) : &quot;memory&quot;); break; } case 2: { volatile u16 *__ptr = (volatile u16 *)((&amp;bitmap[word_bitidx])); asm volatile(&quot;.pushsection .smp_locks,\&quot;a\&quot;\n&quot; &quot;.balign 4\n&quot; &quot;.long 671f - .\n&quot; &quot;.popsection\n&quot; &quot;671:&quot; &quot;\n\tlock; &quot; &quot;cmpxchgw %2,%1&quot; : &quot;=a&quot; (__ret), &quot;+m&quot; (*__ptr) : &quot;r&quot; (__new), &quot;0&quot; (__old) : &quot;memory&quot;); break; } case 4: { volatile u32 *__ptr = (volatile u32 *)((&amp;bitmap[word_bitidx])); asm volatile(&quot;.pushsection .smp_locks,\&quot;a\&quot;\n&quot; &quot;.balign 4\n&quot; &quot;.long 671f - .\n&quot; &quot;.popsection\n&quot; &quot;671:&quot; &quot;\n\tlock; &quot; &quot;cmpxchgl %2,%1&quot; : &quot;=a&quot; (__ret), &quot;+m&quot; (*__ptr) : &quot;r&quot; (__new), &quot;0&quot; (__old) : &quot;memory&quot;); break; } case 8: { volatile u64 *__ptr = (volatile u64 *)((&amp;bitmap[word_bitidx])); asm volatile(&quot;.pushsection .smp_locks,\&quot;a\&quot;\n&quot; &quot;.balign 4\n&quot; &quot;.long 671f - .\n&quot; &quot;.popsection\n&quot; &quot;671:&quot; &quot;\n\tlock; &quot; &quot;cmpxchgq %2,%1&quot; : &quot;=a&quot; (__ret), &quot;+m&quot; (*__ptr) : &quot;r&quot; (__new), &quot;0&quot; (__old) : &quot;memory&quot;); break; } default: __cmpxchg_wrong_size(); } __ret; })" data-ref="_M/cmpxchg">cmpxchg</a>(&amp;<a class="local col5 ref" href="#395bitmap" title='bitmap' data-ref="395bitmap">bitmap</a>[<a class="local col7 ref" href="#397word_bitidx" title='word_bitidx' data-ref="397word_bitidx">word_bitidx</a>], <a class="local col9 ref" href="#399word" title='word' data-ref="399word">word</a>, (<a class="local col9 ref" href="#399word" title='word' data-ref="399word">word</a> &amp; ~<a class="local col4 ref" href="#394mask" title='mask' data-ref="394mask">mask</a>) | <a class="local col1 ref" href="#391flags" title='flags' data-ref="391flags">flags</a>);</td></tr>
<tr><th id="470">470</th><td>		<b>if</b> (<a class="local col9 ref" href="#399word" title='word' data-ref="399word">word</a> == <a class="local col8 ref" href="#398old_word" title='old_word' data-ref="398old_word">old_word</a>)</td></tr>
<tr><th id="471">471</th><td>			<b>break</b>;</td></tr>
<tr><th id="472">472</th><td>		<a class="local col9 ref" href="#399word" title='word' data-ref="399word">word</a> = <a class="local col8 ref" href="#398old_word" title='old_word' data-ref="398old_word">old_word</a>;</td></tr>
<tr><th id="473">473</th><td>	}</td></tr>
<tr><th id="474">474</th><td>}</td></tr>
<tr><th id="475">475</th><td></td></tr>
<tr><th id="476">476</th><td><em>void</em> <dfn class="decl def fn" id="set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="400page" title='page' data-type='struct page *' data-ref="400page">page</dfn>, <em>int</em> <dfn class="local col1 decl" id="401migratetype" title='migratetype' data-type='int' data-ref="401migratetype">migratetype</dfn>)</td></tr>
<tr><th id="477">477</th><td>{</td></tr>
<tr><th id="478">478</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page_group_by_mobility_disabled &amp;&amp; migratetype &lt; MIGRATE_PCPTYPES), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref" href="../include/linux/mmzone.h.html#page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</a> &amp;&amp;</td></tr>
<tr><th id="479">479</th><td>		     <a class="local col1 ref" href="#401migratetype" title='migratetype' data-ref="401migratetype">migratetype</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_PCPTYPES" title='MIGRATE_PCPTYPES' data-ref="MIGRATE_PCPTYPES">MIGRATE_PCPTYPES</a>))</td></tr>
<tr><th id="480">480</th><td>		<a class="local col1 ref" href="#401migratetype" title='migratetype' data-ref="401migratetype">migratetype</a> = <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_UNMOVABLE" title='MIGRATE_UNMOVABLE' data-ref="MIGRATE_UNMOVABLE">MIGRATE_UNMOVABLE</a>;</td></tr>
<tr><th id="481">481</th><td></td></tr>
<tr><th id="482">482</th><td>	<a class="macro" href="../include/linux/pageblock-flags.h.html#84" title="set_pfnblock_flags_mask(page, (unsigned long)migratetype, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, (1 &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1)" data-ref="_M/set_pageblock_flags_group">set_pageblock_flags_group</a>(<a class="local col0 ref" href="#400page" title='page' data-ref="400page">page</a>, (<em>unsigned</em> <em>long</em>)<a class="local col1 ref" href="#401migratetype" title='migratetype' data-ref="401migratetype">migratetype</a>,</td></tr>
<tr><th id="483">483</th><td>					<a class="enum" href="../include/linux/pageblock-flags.h.html#PB_migrate" title='PB_migrate' data-ref="PB_migrate">PB_migrate</a>, <a class="enum" href="../include/linux/pageblock-flags.h.html#PB_migrate_end" title='PB_migrate_end' data-ref="PB_migrate_end">PB_migrate_end</a>);</td></tr>
<tr><th id="484">484</th><td>}</td></tr>
<tr><th id="485">485</th><td></td></tr>
<tr><th id="486">486</th><td><u>#<span data-ppcond="486">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEBUG_VM">CONFIG_DEBUG_VM</span></u></td></tr>
<tr><th id="487">487</th><td><em>static</em> <em>int</em> page_outside_zone_boundaries(<b>struct</b> zone *zone, <b>struct</b> page *page)</td></tr>
<tr><th id="488">488</th><td>{</td></tr>
<tr><th id="489">489</th><td>	<em>int</em> ret = <var>0</var>;</td></tr>
<tr><th id="490">490</th><td>	<em>unsigned</em> seq;</td></tr>
<tr><th id="491">491</th><td>	<em>unsigned</em> <em>long</em> pfn = page_to_pfn(page);</td></tr>
<tr><th id="492">492</th><td>	<em>unsigned</em> <em>long</em> sp, start_pfn;</td></tr>
<tr><th id="493">493</th><td></td></tr>
<tr><th id="494">494</th><td>	<b>do</b> {</td></tr>
<tr><th id="495">495</th><td>		seq = zone_span_seqbegin(zone);</td></tr>
<tr><th id="496">496</th><td>		start_pfn = zone-&gt;zone_start_pfn;</td></tr>
<tr><th id="497">497</th><td>		sp = zone-&gt;spanned_pages;</td></tr>
<tr><th id="498">498</th><td>		<b>if</b> (!zone_spans_pfn(zone, pfn))</td></tr>
<tr><th id="499">499</th><td>			ret = <var>1</var>;</td></tr>
<tr><th id="500">500</th><td>	} <b>while</b> (zone_span_seqretry(zone, seq));</td></tr>
<tr><th id="501">501</th><td></td></tr>
<tr><th id="502">502</th><td>	<b>if</b> (ret)</td></tr>
<tr><th id="503">503</th><td>		pr_err(<q>"page 0x%lx outside node %d zone %s [ 0x%lx - 0x%lx ]\n"</q>,</td></tr>
<tr><th id="504">504</th><td>			pfn, zone_to_nid(zone), zone-&gt;name,</td></tr>
<tr><th id="505">505</th><td>			start_pfn, start_pfn + sp);</td></tr>
<tr><th id="506">506</th><td></td></tr>
<tr><th id="507">507</th><td>	<b>return</b> ret;</td></tr>
<tr><th id="508">508</th><td>}</td></tr>
<tr><th id="509">509</th><td></td></tr>
<tr><th id="510">510</th><td><em>static</em> <em>int</em> page_is_consistent(<b>struct</b> zone *zone, <b>struct</b> page *page)</td></tr>
<tr><th id="511">511</th><td>{</td></tr>
<tr><th id="512">512</th><td>	<b>if</b> (!pfn_valid_within(page_to_pfn(page)))</td></tr>
<tr><th id="513">513</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="514">514</th><td>	<b>if</b> (zone != page_zone(page))</td></tr>
<tr><th id="515">515</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="516">516</th><td></td></tr>
<tr><th id="517">517</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="518">518</th><td>}</td></tr>
<tr><th id="519">519</th><td><i>/*</i></td></tr>
<tr><th id="520">520</th><td><i> * Temporary debugging check for pages not lying within a given zone.</i></td></tr>
<tr><th id="521">521</th><td><i> */</i></td></tr>
<tr><th id="522">522</th><td><em>static</em> <em>int</em> __maybe_unused bad_range(<b>struct</b> zone *zone, <b>struct</b> page *page)</td></tr>
<tr><th id="523">523</th><td>{</td></tr>
<tr><th id="524">524</th><td>	<b>if</b> (page_outside_zone_boundaries(zone, page))</td></tr>
<tr><th id="525">525</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="526">526</th><td>	<b>if</b> (!page_is_consistent(zone, page))</td></tr>
<tr><th id="527">527</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="528">528</th><td></td></tr>
<tr><th id="529">529</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="530">530</th><td>}</td></tr>
<tr><th id="531">531</th><td><u>#<span data-ppcond="486">else</span></u></td></tr>
<tr><th id="532">532</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#147" title="__attribute__((unused))" data-ref="_M/__maybe_unused">__maybe_unused</a> <dfn class="tu decl def fn" id="bad_range" title='bad_range' data-type='int bad_range(struct zone * zone, struct page * page)' data-ref="bad_range">bad_range</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="402zone" title='zone' data-type='struct zone *' data-ref="402zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="403page" title='page' data-type='struct page *' data-ref="403page">page</dfn>)</td></tr>
<tr><th id="533">533</th><td>{</td></tr>
<tr><th id="534">534</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="535">535</th><td>}</td></tr>
<tr><th id="536">536</th><td><u>#<span data-ppcond="486">endif</span></u></td></tr>
<tr><th id="537">537</th><td></td></tr>
<tr><th id="538">538</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="bad_page" title='bad_page' data-type='void bad_page(struct page * page, const char * reason, unsigned long bad_flags)' data-ref="bad_page">bad_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="404page" title='page' data-type='struct page *' data-ref="404page">page</dfn>, <em>const</em> <em>char</em> *<dfn class="local col5 decl" id="405reason" title='reason' data-type='const char *' data-ref="405reason">reason</dfn>,</td></tr>
<tr><th id="539">539</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="406bad_flags" title='bad_flags' data-type='unsigned long' data-ref="406bad_flags">bad_flags</dfn>)</td></tr>
<tr><th id="540">540</th><td>{</td></tr>
<tr><th id="541">541</th><td>	<em>static</em> <em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="407resume" title='resume' data-type='unsigned long' data-ref="407resume">resume</dfn>;</td></tr>
<tr><th id="542">542</th><td>	<em>static</em> <em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="408nr_shown" title='nr_shown' data-type='unsigned long' data-ref="408nr_shown">nr_shown</dfn>;</td></tr>
<tr><th id="543">543</th><td>	<em>static</em> <em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="409nr_unshown" title='nr_unshown' data-type='unsigned long' data-ref="409nr_unshown">nr_unshown</dfn>;</td></tr>
<tr><th id="544">544</th><td></td></tr>
<tr><th id="545">545</th><td>	<i>/*</i></td></tr>
<tr><th id="546">546</th><td><i>	 * Allow a burst of 60 reports, then keep quiet for that minute;</i></td></tr>
<tr><th id="547">547</th><td><i>	 * or allow a steady drip of one report per second.</i></td></tr>
<tr><th id="548">548</th><td><i>	 */</i></td></tr>
<tr><th id="549">549</th><td>	<b>if</b> (<a class="local col8 ref" href="#408nr_shown" title='nr_shown' data-ref="408nr_shown">nr_shown</a> == <var>60</var>) {</td></tr>
<tr><th id="550">550</th><td>		<b>if</b> (<a class="macro" href="../include/linux/jiffies.h.html#106" title="(({ unsigned long __dummy; typeof(resume) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }) &amp;&amp; ({ unsigned long __dummy; typeof(jiffies) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }) &amp;&amp; ((long)((jiffies) - (resume)) &lt; 0))" data-ref="_M/time_before">time_before</a>(<a class="ref" href="../include/linux/jiffies.h.html#jiffies" title='jiffies' data-ref="jiffies">jiffies</a>, <a class="local col7 ref" href="#407resume" title='resume' data-ref="407resume">resume</a>)) {</td></tr>
<tr><th id="551">551</th><td>			<a class="local col9 ref" href="#409nr_unshown" title='nr_unshown' data-ref="409nr_unshown">nr_unshown</a>++;</td></tr>
<tr><th id="552">552</th><td>			<b>goto</b> <a class="lbl" href="#410out" data-ref="410out">out</a>;</td></tr>
<tr><th id="553">553</th><td>		}</td></tr>
<tr><th id="554">554</th><td>		<b>if</b> (<a class="local col9 ref" href="#409nr_unshown" title='nr_unshown' data-ref="409nr_unshown">nr_unshown</a>) {</td></tr>
<tr><th id="555">555</th><td>			<a class="macro" href="../include/linux/printk.h.html#297" title="printk(&quot;\001&quot; &quot;1&quot; &quot;BUG: Bad page state: %lu messages suppressed\n&quot;, nr_unshown)" data-ref="_M/pr_alert">pr_alert</a>(</td></tr>
<tr><th id="556">556</th><td>			      <q>"BUG: Bad page state: %lu messages suppressed\n"</q>,</td></tr>
<tr><th id="557">557</th><td>				<a class="local col9 ref" href="#409nr_unshown" title='nr_unshown' data-ref="409nr_unshown">nr_unshown</a>);</td></tr>
<tr><th id="558">558</th><td>			<a class="local col9 ref" href="#409nr_unshown" title='nr_unshown' data-ref="409nr_unshown">nr_unshown</a> = <var>0</var>;</td></tr>
<tr><th id="559">559</th><td>		}</td></tr>
<tr><th id="560">560</th><td>		<a class="local col8 ref" href="#408nr_shown" title='nr_shown' data-ref="408nr_shown">nr_shown</a> = <var>0</var>;</td></tr>
<tr><th id="561">561</th><td>	}</td></tr>
<tr><th id="562">562</th><td>	<b>if</b> (<a class="local col8 ref" href="#408nr_shown" title='nr_shown' data-ref="408nr_shown">nr_shown</a>++ == <var>0</var>)</td></tr>
<tr><th id="563">563</th><td>		<a class="local col7 ref" href="#407resume" title='resume' data-ref="407resume">resume</a> = <a class="ref" href="../include/linux/jiffies.h.html#jiffies" title='jiffies' data-ref="jiffies">jiffies</a> + <var>60</var> * <a class="macro" href="../include/asm-generic/param.h.html#8" title="100" data-ref="_M/HZ">HZ</a>;</td></tr>
<tr><th id="564">564</th><td></td></tr>
<tr><th id="565">565</th><td>	<a class="macro" href="../include/linux/printk.h.html#297" title="printk(&quot;\001&quot; &quot;1&quot; &quot;BUG: Bad page state in process %s  pfn:%05lx\n&quot;, get_current()-&gt;comm, (unsigned long)((page) - ((struct page *)vmemmap_base)))" data-ref="_M/pr_alert">pr_alert</a>(<q>"BUG: Bad page state in process %s  pfn:%05lx\n"</q>,</td></tr>
<tr><th id="566">566</th><td>		current-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::comm" title='task_struct::comm' data-ref="task_struct::comm">comm</a>, page_to_pfn(<a class="local col4 ref" href="#404page" title='page' data-ref="404page">page</a>));</td></tr>
<tr><th id="567">567</th><td>	<a class="ref fn" href="../include/linux/mmdebug.h.html#__dump_page" title='__dump_page' data-ref="__dump_page">__dump_page</a>(<a class="local col4 ref" href="#404page" title='page' data-ref="404page">page</a>, <a class="local col5 ref" href="#405reason" title='reason' data-ref="405reason">reason</a>);</td></tr>
<tr><th id="568">568</th><td>	<a class="local col6 ref" href="#406bad_flags" title='bad_flags' data-ref="406bad_flags">bad_flags</a> &amp;= <a class="local col4 ref" href="#404page" title='page' data-ref="404page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a>;</td></tr>
<tr><th id="569">569</th><td>	<b>if</b> (<a class="local col6 ref" href="#406bad_flags" title='bad_flags' data-ref="406bad_flags">bad_flags</a>)</td></tr>
<tr><th id="570">570</th><td>		<a class="macro" href="../include/linux/printk.h.html#297" title="printk(&quot;\001&quot; &quot;1&quot; &quot;bad because of flags: %#lx(%pGp)\n&quot;, bad_flags, &amp;bad_flags)" data-ref="_M/pr_alert">pr_alert</a>(<q>"bad because of flags: %#lx(%pGp)\n"</q>,</td></tr>
<tr><th id="571">571</th><td>						<a class="local col6 ref" href="#406bad_flags" title='bad_flags' data-ref="406bad_flags">bad_flags</a>, &amp;<a class="local col6 ref" href="#406bad_flags" title='bad_flags' data-ref="406bad_flags">bad_flags</a>);</td></tr>
<tr><th id="572">572</th><td>	<a class="ref fn" href="../include/linux/page_owner.h.html#dump_page_owner" title='dump_page_owner' data-ref="dump_page_owner">dump_page_owner</a>(<a class="local col4 ref" href="#404page" title='page' data-ref="404page">page</a>);</td></tr>
<tr><th id="573">573</th><td></td></tr>
<tr><th id="574">574</th><td>	<a class="ref fn" href="../include/linux/module.h.html#print_modules" title='print_modules' data-ref="print_modules">print_modules</a>();</td></tr>
<tr><th id="575">575</th><td>	<a class="ref fn" href="../include/linux/printk.h.html#dump_stack" title='dump_stack' data-ref="dump_stack">dump_stack</a>();</td></tr>
<tr><th id="576">576</th><td><dfn class="lbl" id="410out" data-ref="410out">out</dfn>:</td></tr>
<tr><th id="577">577</th><td>	<i>/* Leave bad fields for debug, except PageBuddy could make trouble */</i></td></tr>
<tr><th id="578">578</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#page_mapcount_reset" title='page_mapcount_reset' data-ref="page_mapcount_reset">page_mapcount_reset</a>(<a class="local col4 ref" href="#404page" title='page' data-ref="404page">page</a>); <i>/* remove PageBuddy */</i></td></tr>
<tr><th id="579">579</th><td>	<a class="ref fn" href="../include/linux/kernel.h.html#add_taint" title='add_taint' data-ref="add_taint">add_taint</a>(<a class="macro" href="../include/linux/kernel.h.html#541" title="5" data-ref="_M/TAINT_BAD_PAGE">TAINT_BAD_PAGE</a>, <a class="enum" href="../include/linux/kernel.h.html#LOCKDEP_NOW_UNRELIABLE" title='LOCKDEP_NOW_UNRELIABLE' data-ref="LOCKDEP_NOW_UNRELIABLE">LOCKDEP_NOW_UNRELIABLE</a>);</td></tr>
<tr><th id="580">580</th><td>}</td></tr>
<tr><th id="581">581</th><td></td></tr>
<tr><th id="582">582</th><td><i>/*</i></td></tr>
<tr><th id="583">583</th><td><i> * Higher-order pages are called "compound pages".  They are structured thusly:</i></td></tr>
<tr><th id="584">584</th><td><i> *</i></td></tr>
<tr><th id="585">585</th><td><i> * The first PAGE_SIZE page is called the "head page" and have PG_head set.</i></td></tr>
<tr><th id="586">586</th><td><i> *</i></td></tr>
<tr><th id="587">587</th><td><i> * The remaining PAGE_SIZE pages are called "tail pages". PageTail() is encoded</i></td></tr>
<tr><th id="588">588</th><td><i> * in bit 0 of page-&gt;compound_head. The rest of bits is pointer to head page.</i></td></tr>
<tr><th id="589">589</th><td><i> *</i></td></tr>
<tr><th id="590">590</th><td><i> * The first tail page's -&gt;compound_dtor holds the offset in array of compound</i></td></tr>
<tr><th id="591">591</th><td><i> * page destructors. See compound_page_dtors.</i></td></tr>
<tr><th id="592">592</th><td><i> *</i></td></tr>
<tr><th id="593">593</th><td><i> * The first tail page's -&gt;compound_order holds the order of allocation.</i></td></tr>
<tr><th id="594">594</th><td><i> * This usage means that zero-order pages may not be compound.</i></td></tr>
<tr><th id="595">595</th><td><i> */</i></td></tr>
<tr><th id="596">596</th><td></td></tr>
<tr><th id="597">597</th><td><em>void</em> <dfn class="decl def fn" id="free_compound_page" title='free_compound_page' data-ref="free_compound_page">free_compound_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="411page" title='page' data-type='struct page *' data-ref="411page">page</dfn>)</td></tr>
<tr><th id="598">598</th><td>{</td></tr>
<tr><th id="599">599</th><td>	<a class="tu ref fn" href="#__free_pages_ok" title='__free_pages_ok' data-use='c' data-ref="__free_pages_ok">__free_pages_ok</a>(<a class="local col1 ref" href="#411page" title='page' data-ref="411page">page</a>, <a class="ref fn" href="../include/linux/mm.h.html#compound_order" title='compound_order' data-ref="compound_order">compound_order</a>(<a class="local col1 ref" href="#411page" title='page' data-ref="411page">page</a>));</td></tr>
<tr><th id="600">600</th><td>}</td></tr>
<tr><th id="601">601</th><td></td></tr>
<tr><th id="602">602</th><td><em>void</em> <dfn class="decl def fn" id="prep_compound_page" title='prep_compound_page' data-ref="prep_compound_page">prep_compound_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="412page" title='page' data-type='struct page *' data-ref="412page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="413order" title='order' data-type='unsigned int' data-ref="413order">order</dfn>)</td></tr>
<tr><th id="603">603</th><td>{</td></tr>
<tr><th id="604">604</th><td>	<em>int</em> <dfn class="local col4 decl" id="414i" title='i' data-type='int' data-ref="414i">i</dfn>;</td></tr>
<tr><th id="605">605</th><td>	<em>int</em> <dfn class="local col5 decl" id="415nr_pages" title='nr_pages' data-type='int' data-ref="415nr_pages">nr_pages</dfn> = <var>1</var> &lt;&lt; <a class="local col3 ref" href="#413order" title='order' data-ref="413order">order</a>;</td></tr>
<tr><th id="606">606</th><td></td></tr>
<tr><th id="607">607</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#set_compound_page_dtor" title='set_compound_page_dtor' data-ref="set_compound_page_dtor">set_compound_page_dtor</a>(<a class="local col2 ref" href="#412page" title='page' data-ref="412page">page</a>, <a class="enum" href="../include/linux/mm.h.html#COMPOUND_PAGE_DTOR" title='COMPOUND_PAGE_DTOR' data-ref="COMPOUND_PAGE_DTOR">COMPOUND_PAGE_DTOR</a>);</td></tr>
<tr><th id="608">608</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#set_compound_order" title='set_compound_order' data-ref="set_compound_order">set_compound_order</a>(<a class="local col2 ref" href="#412page" title='page' data-ref="412page">page</a>, <a class="local col3 ref" href="#413order" title='order' data-ref="413order">order</a>);</td></tr>
<tr><th id="609">609</th><td>	<a class="ref fn" href="../include/linux/page-flags.h.html#493" title='__SetPageHead' data-ref="__SetPageHead">__SetPageHead</a>(<a class="local col2 ref" href="#412page" title='page' data-ref="412page">page</a>);</td></tr>
<tr><th id="610">610</th><td>	<b>for</b> (<a class="local col4 ref" href="#414i" title='i' data-ref="414i">i</a> = <var>1</var>; <a class="local col4 ref" href="#414i" title='i' data-ref="414i">i</a> &lt; <a class="local col5 ref" href="#415nr_pages" title='nr_pages' data-ref="415nr_pages">nr_pages</a>; <a class="local col4 ref" href="#414i" title='i' data-ref="414i">i</a>++) {</td></tr>
<tr><th id="611">611</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="416p" title='p' data-type='struct page *' data-ref="416p">p</dfn> = <a class="local col2 ref" href="#412page" title='page' data-ref="412page">page</a> + <a class="local col4 ref" href="#414i" title='i' data-ref="414i">i</a>;</td></tr>
<tr><th id="612">612</th><td>		<a class="ref fn" href="../include/linux/page_ref.h.html#set_page_count" title='set_page_count' data-ref="set_page_count">set_page_count</a>(<a class="local col6 ref" href="#416p" title='p' data-ref="416p">p</a>, <var>0</var>);</td></tr>
<tr><th id="613">613</th><td>		<a class="local col6 ref" href="#416p" title='p' data-ref="416p">p</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> = <a class="macro" href="../include/linux/poison.h.html#42" title="((void *) 0x400 + (0xdead000000000000UL))" data-ref="_M/TAIL_MAPPING">TAIL_MAPPING</a>;</td></tr>
<tr><th id="614">614</th><td>		<a class="ref fn" href="../include/linux/page-flags.h.html#set_compound_head" title='set_compound_head' data-ref="set_compound_head">set_compound_head</a>(<a class="local col6 ref" href="#416p" title='p' data-ref="416p">p</a>, <a class="local col2 ref" href="#412page" title='page' data-ref="412page">page</a>);</td></tr>
<tr><th id="615">615</th><td>	}</td></tr>
<tr><th id="616">616</th><td>	<a class="ref fn" href="../arch/x86/include/asm/atomic.h.html#atomic_set" title='atomic_set' data-ref="atomic_set">atomic_set</a>(<a class="ref fn" href="../include/linux/mm.h.html#compound_mapcount_ptr" title='compound_mapcount_ptr' data-ref="compound_mapcount_ptr">compound_mapcount_ptr</a>(<a class="local col2 ref" href="#412page" title='page' data-ref="412page">page</a>), -<var>1</var>);</td></tr>
<tr><th id="617">617</th><td>}</td></tr>
<tr><th id="618">618</th><td></td></tr>
<tr><th id="619">619</th><td><u>#<span data-ppcond="619">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEBUG_PAGEALLOC">CONFIG_DEBUG_PAGEALLOC</span></u></td></tr>
<tr><th id="620">620</th><td><em>unsigned</em> <em>int</em> _debug_guardpage_minorder;</td></tr>
<tr><th id="621">621</th><td>bool _debug_pagealloc_enabled __read_mostly</td></tr>
<tr><th id="622">622</th><td>			= IS_ENABLED(CONFIG_DEBUG_PAGEALLOC_ENABLE_DEFAULT);</td></tr>
<tr><th id="623">623</th><td>EXPORT_SYMBOL(_debug_pagealloc_enabled);</td></tr>
<tr><th id="624">624</th><td>bool _debug_guardpage_enabled __read_mostly;</td></tr>
<tr><th id="625">625</th><td></td></tr>
<tr><th id="626">626</th><td><em>static</em> <em>int</em> __init early_debug_pagealloc(<em>char</em> *buf)</td></tr>
<tr><th id="627">627</th><td>{</td></tr>
<tr><th id="628">628</th><td>	<b>if</b> (!buf)</td></tr>
<tr><th id="629">629</th><td>		<b>return</b> -EINVAL;</td></tr>
<tr><th id="630">630</th><td>	<b>return</b> kstrtobool(buf, &amp;_debug_pagealloc_enabled);</td></tr>
<tr><th id="631">631</th><td>}</td></tr>
<tr><th id="632">632</th><td>early_param(<q>"debug_pagealloc"</q>, early_debug_pagealloc);</td></tr>
<tr><th id="633">633</th><td></td></tr>
<tr><th id="634">634</th><td><em>static</em> bool need_debug_guardpage(<em>void</em>)</td></tr>
<tr><th id="635">635</th><td>{</td></tr>
<tr><th id="636">636</th><td>	<i>/* If we don't use debug_pagealloc, we don't need guard page */</i></td></tr>
<tr><th id="637">637</th><td>	<b>if</b> (!debug_pagealloc_enabled())</td></tr>
<tr><th id="638">638</th><td>		<b>return</b> false;</td></tr>
<tr><th id="639">639</th><td></td></tr>
<tr><th id="640">640</th><td>	<b>if</b> (!debug_guardpage_minorder())</td></tr>
<tr><th id="641">641</th><td>		<b>return</b> false;</td></tr>
<tr><th id="642">642</th><td></td></tr>
<tr><th id="643">643</th><td>	<b>return</b> true;</td></tr>
<tr><th id="644">644</th><td>}</td></tr>
<tr><th id="645">645</th><td></td></tr>
<tr><th id="646">646</th><td><em>static</em> <em>void</em> init_debug_guardpage(<em>void</em>)</td></tr>
<tr><th id="647">647</th><td>{</td></tr>
<tr><th id="648">648</th><td>	<b>if</b> (!debug_pagealloc_enabled())</td></tr>
<tr><th id="649">649</th><td>		<b>return</b>;</td></tr>
<tr><th id="650">650</th><td></td></tr>
<tr><th id="651">651</th><td>	<b>if</b> (!debug_guardpage_minorder())</td></tr>
<tr><th id="652">652</th><td>		<b>return</b>;</td></tr>
<tr><th id="653">653</th><td></td></tr>
<tr><th id="654">654</th><td>	_debug_guardpage_enabled = true;</td></tr>
<tr><th id="655">655</th><td>}</td></tr>
<tr><th id="656">656</th><td></td></tr>
<tr><th id="657">657</th><td><b>struct</b> page_ext_operations debug_guardpage_ops = {</td></tr>
<tr><th id="658">658</th><td>	.need = need_debug_guardpage,</td></tr>
<tr><th id="659">659</th><td>	.init = init_debug_guardpage,</td></tr>
<tr><th id="660">660</th><td>};</td></tr>
<tr><th id="661">661</th><td></td></tr>
<tr><th id="662">662</th><td><em>static</em> <em>int</em> __init debug_guardpage_minorder_setup(<em>char</em> *buf)</td></tr>
<tr><th id="663">663</th><td>{</td></tr>
<tr><th id="664">664</th><td>	<em>unsigned</em> <em>long</em> res;</td></tr>
<tr><th id="665">665</th><td></td></tr>
<tr><th id="666">666</th><td>	<b>if</b> (kstrtoul(buf, <var>10</var>, &amp;res) &lt; <var>0</var> ||  res &gt; MAX_ORDER / <var>2</var>) {</td></tr>
<tr><th id="667">667</th><td>		pr_err(<q>"Bad debug_guardpage_minorder value\n"</q>);</td></tr>
<tr><th id="668">668</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="669">669</th><td>	}</td></tr>
<tr><th id="670">670</th><td>	_debug_guardpage_minorder = res;</td></tr>
<tr><th id="671">671</th><td>	pr_info(<q>"Setting debug_guardpage_minorder to %lu\n"</q>, res);</td></tr>
<tr><th id="672">672</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="673">673</th><td>}</td></tr>
<tr><th id="674">674</th><td>early_param(<q>"debug_guardpage_minorder"</q>, debug_guardpage_minorder_setup);</td></tr>
<tr><th id="675">675</th><td></td></tr>
<tr><th id="676">676</th><td><em>static</em> <b>inline</b> bool set_page_guard(<b>struct</b> zone *zone, <b>struct</b> page *page,</td></tr>
<tr><th id="677">677</th><td>				<em>unsigned</em> <em>int</em> order, <em>int</em> migratetype)</td></tr>
<tr><th id="678">678</th><td>{</td></tr>
<tr><th id="679">679</th><td>	<b>struct</b> page_ext *page_ext;</td></tr>
<tr><th id="680">680</th><td></td></tr>
<tr><th id="681">681</th><td>	<b>if</b> (!debug_guardpage_enabled())</td></tr>
<tr><th id="682">682</th><td>		<b>return</b> false;</td></tr>
<tr><th id="683">683</th><td></td></tr>
<tr><th id="684">684</th><td>	<b>if</b> (order &gt;= debug_guardpage_minorder())</td></tr>
<tr><th id="685">685</th><td>		<b>return</b> false;</td></tr>
<tr><th id="686">686</th><td></td></tr>
<tr><th id="687">687</th><td>	page_ext = lookup_page_ext(page);</td></tr>
<tr><th id="688">688</th><td>	<b>if</b> (unlikely(!page_ext))</td></tr>
<tr><th id="689">689</th><td>		<b>return</b> false;</td></tr>
<tr><th id="690">690</th><td></td></tr>
<tr><th id="691">691</th><td>	__set_bit(PAGE_EXT_DEBUG_GUARD, &amp;page_ext-&gt;flags);</td></tr>
<tr><th id="692">692</th><td></td></tr>
<tr><th id="693">693</th><td>	INIT_LIST_HEAD(&amp;page-&gt;lru);</td></tr>
<tr><th id="694">694</th><td>	set_page_private(page, order);</td></tr>
<tr><th id="695">695</th><td>	<i>/* Guard pages are not available for any usage */</i></td></tr>
<tr><th id="696">696</th><td>	__mod_zone_freepage_state(zone, -(<var>1</var> &lt;&lt; order), migratetype);</td></tr>
<tr><th id="697">697</th><td></td></tr>
<tr><th id="698">698</th><td>	<b>return</b> true;</td></tr>
<tr><th id="699">699</th><td>}</td></tr>
<tr><th id="700">700</th><td></td></tr>
<tr><th id="701">701</th><td><em>static</em> <b>inline</b> <em>void</em> clear_page_guard(<b>struct</b> zone *zone, <b>struct</b> page *page,</td></tr>
<tr><th id="702">702</th><td>				<em>unsigned</em> <em>int</em> order, <em>int</em> migratetype)</td></tr>
<tr><th id="703">703</th><td>{</td></tr>
<tr><th id="704">704</th><td>	<b>struct</b> page_ext *page_ext;</td></tr>
<tr><th id="705">705</th><td></td></tr>
<tr><th id="706">706</th><td>	<b>if</b> (!debug_guardpage_enabled())</td></tr>
<tr><th id="707">707</th><td>		<b>return</b>;</td></tr>
<tr><th id="708">708</th><td></td></tr>
<tr><th id="709">709</th><td>	page_ext = lookup_page_ext(page);</td></tr>
<tr><th id="710">710</th><td>	<b>if</b> (unlikely(!page_ext))</td></tr>
<tr><th id="711">711</th><td>		<b>return</b>;</td></tr>
<tr><th id="712">712</th><td></td></tr>
<tr><th id="713">713</th><td>	__clear_bit(PAGE_EXT_DEBUG_GUARD, &amp;page_ext-&gt;flags);</td></tr>
<tr><th id="714">714</th><td></td></tr>
<tr><th id="715">715</th><td>	set_page_private(page, <var>0</var>);</td></tr>
<tr><th id="716">716</th><td>	<b>if</b> (!is_migrate_isolate(migratetype))</td></tr>
<tr><th id="717">717</th><td>		__mod_zone_freepage_state(zone, (<var>1</var> &lt;&lt; order), migratetype);</td></tr>
<tr><th id="718">718</th><td>}</td></tr>
<tr><th id="719">719</th><td><u>#<span data-ppcond="619">else</span></u></td></tr>
<tr><th id="720">720</th><td><b>struct</b> <a class="type" href="../include/linux/page_ext.h.html#page_ext_operations" title='page_ext_operations' data-ref="page_ext_operations">page_ext_operations</a> <dfn class="decl def" id="debug_guardpage_ops" title='debug_guardpage_ops' data-ref="debug_guardpage_ops">debug_guardpage_ops</dfn>;</td></tr>
<tr><th id="721">721</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="set_page_guard" title='set_page_guard' data-type='bool set_page_guard(struct zone * zone, struct page * page, unsigned int order, int migratetype)' data-ref="set_page_guard">set_page_guard</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="417zone" title='zone' data-type='struct zone *' data-ref="417zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="418page" title='page' data-type='struct page *' data-ref="418page">page</dfn>,</td></tr>
<tr><th id="722">722</th><td>			<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="419order" title='order' data-type='unsigned int' data-ref="419order">order</dfn>, <em>int</em> <dfn class="local col0 decl" id="420migratetype" title='migratetype' data-type='int' data-ref="420migratetype">migratetype</dfn>) { <b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>; }</td></tr>
<tr><th id="723">723</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="clear_page_guard" title='clear_page_guard' data-type='void clear_page_guard(struct zone * zone, struct page * page, unsigned int order, int migratetype)' data-ref="clear_page_guard">clear_page_guard</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="421zone" title='zone' data-type='struct zone *' data-ref="421zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="422page" title='page' data-type='struct page *' data-ref="422page">page</dfn>,</td></tr>
<tr><th id="724">724</th><td>				<em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="423order" title='order' data-type='unsigned int' data-ref="423order">order</dfn>, <em>int</em> <dfn class="local col4 decl" id="424migratetype" title='migratetype' data-type='int' data-ref="424migratetype">migratetype</dfn>) {}</td></tr>
<tr><th id="725">725</th><td><u>#<span data-ppcond="619">endif</span></u></td></tr>
<tr><th id="726">726</th><td></td></tr>
<tr><th id="727">727</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="set_page_order" title='set_page_order' data-type='void set_page_order(struct page * page, unsigned int order)' data-ref="set_page_order">set_page_order</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="425page" title='page' data-type='struct page *' data-ref="425page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="426order" title='order' data-type='unsigned int' data-ref="426order">order</dfn>)</td></tr>
<tr><th id="728">728</th><td>{</td></tr>
<tr><th id="729">729</th><td>	<a class="macro" href="../include/linux/mm.h.html#431" title="((page)-&gt;private = (order))" data-ref="_M/set_page_private">set_page_private</a>(<a class="local col5 ref" href="#425page" title='page' data-ref="425page">page</a>, <a class="local col6 ref" href="#426order" title='order' data-ref="426order">order</a>);</td></tr>
<tr><th id="730">730</th><td>	<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='__SetPageBuddy' data-ref="__SetPageBuddy">__SetPageBuddy</a>(<a class="local col5 ref" href="#425page" title='page' data-ref="425page">page</a>);</td></tr>
<tr><th id="731">731</th><td>}</td></tr>
<tr><th id="732">732</th><td></td></tr>
<tr><th id="733">733</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="rmv_page_order" title='rmv_page_order' data-type='void rmv_page_order(struct page * page)' data-ref="rmv_page_order">rmv_page_order</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col7 decl" id="427page" title='page' data-type='struct page *' data-ref="427page">page</dfn>)</td></tr>
<tr><th id="734">734</th><td>{</td></tr>
<tr><th id="735">735</th><td>	<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='__ClearPageBuddy' data-ref="__ClearPageBuddy">__ClearPageBuddy</a>(<a class="local col7 ref" href="#427page" title='page' data-ref="427page">page</a>);</td></tr>
<tr><th id="736">736</th><td>	<a class="macro" href="../include/linux/mm.h.html#431" title="((page)-&gt;private = (0))" data-ref="_M/set_page_private">set_page_private</a>(<a class="local col7 ref" href="#427page" title='page' data-ref="427page">page</a>, <var>0</var>);</td></tr>
<tr><th id="737">737</th><td>}</td></tr>
<tr><th id="738">738</th><td></td></tr>
<tr><th id="739">739</th><td><i  data-doc="page_is_buddy">/*</i></td></tr>
<tr><th id="740">740</th><td><i  data-doc="page_is_buddy"> * This function checks whether a page is free &amp;&amp; is the buddy</i></td></tr>
<tr><th id="741">741</th><td><i  data-doc="page_is_buddy"> * we can do coalesce a page and its buddy if</i></td></tr>
<tr><th id="742">742</th><td><i  data-doc="page_is_buddy"> * (a) the buddy is not in a hole (check before calling!) &amp;&amp;</i></td></tr>
<tr><th id="743">743</th><td><i  data-doc="page_is_buddy"> * (b) the buddy is in the buddy system &amp;&amp;</i></td></tr>
<tr><th id="744">744</th><td><i  data-doc="page_is_buddy"> * (c) a page and its buddy have the same order &amp;&amp;</i></td></tr>
<tr><th id="745">745</th><td><i  data-doc="page_is_buddy"> * (d) a page and its buddy are in the same zone.</i></td></tr>
<tr><th id="746">746</th><td><i  data-doc="page_is_buddy"> *</i></td></tr>
<tr><th id="747">747</th><td><i  data-doc="page_is_buddy"> * For recording whether a page is in the buddy system, we set -&gt;_mapcount</i></td></tr>
<tr><th id="748">748</th><td><i  data-doc="page_is_buddy"> * PAGE_BUDDY_MAPCOUNT_VALUE.</i></td></tr>
<tr><th id="749">749</th><td><i  data-doc="page_is_buddy"> * Setting, clearing, and testing _mapcount PAGE_BUDDY_MAPCOUNT_VALUE is</i></td></tr>
<tr><th id="750">750</th><td><i  data-doc="page_is_buddy"> * serialized by zone-&gt;lock.</i></td></tr>
<tr><th id="751">751</th><td><i  data-doc="page_is_buddy"> *</i></td></tr>
<tr><th id="752">752</th><td><i  data-doc="page_is_buddy"> * For recording page's order, we use page_private(page).</i></td></tr>
<tr><th id="753">753</th><td><i  data-doc="page_is_buddy"> */</i></td></tr>
<tr><th id="754">754</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="page_is_buddy" title='page_is_buddy' data-type='int page_is_buddy(struct page * page, struct page * buddy, unsigned int order)' data-ref="page_is_buddy">page_is_buddy</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="428page" title='page' data-type='struct page *' data-ref="428page">page</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="429buddy" title='buddy' data-type='struct page *' data-ref="429buddy">buddy</dfn>,</td></tr>
<tr><th id="755">755</th><td>							<em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="430order" title='order' data-type='unsigned int' data-ref="430order">order</dfn>)</td></tr>
<tr><th id="756">756</th><td>{</td></tr>
<tr><th id="757">757</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#page_is_guard" title='page_is_guard' data-ref="page_is_guard">page_is_guard</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>) &amp;&amp; <a class="ref fn" href="internal.h.html#page_order" title='page_order' data-ref="page_order">page_order</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>) == <a class="local col0 ref" href="#430order" title='order' data-ref="430order">order</a>) {</td></tr>
<tr><th id="758">758</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#page_zone_id" title='page_zone_id' data-ref="page_zone_id">page_zone_id</a>(<a class="local col8 ref" href="#428page" title='page' data-ref="428page">page</a>) != <a class="ref fn" href="../include/linux/mm.h.html#page_zone_id" title='page_zone_id' data-ref="page_zone_id">page_zone_id</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>))</td></tr>
<tr><th id="759">759</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="760">760</th><td></td></tr>
<tr><th id="761">761</th><td>		<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(page_count(buddy) != 0))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/page_ref.h.html#page_count" title='page_count' data-ref="page_count">page_count</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>) != <var>0</var>, buddy);</td></tr>
<tr><th id="762">762</th><td></td></tr>
<tr><th id="763">763</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="764">764</th><td>	}</td></tr>
<tr><th id="765">765</th><td></td></tr>
<tr><th id="766">766</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='PageBuddy' data-ref="PageBuddy">PageBuddy</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>) &amp;&amp; <a class="ref fn" href="internal.h.html#page_order" title='page_order' data-ref="page_order">page_order</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>) == <a class="local col0 ref" href="#430order" title='order' data-ref="430order">order</a>) {</td></tr>
<tr><th id="767">767</th><td>		<i>/*</i></td></tr>
<tr><th id="768">768</th><td><i>		 * zone check is done late to avoid uselessly</i></td></tr>
<tr><th id="769">769</th><td><i>		 * calculating zone/node ids for pages that could</i></td></tr>
<tr><th id="770">770</th><td><i>		 * never merge.</i></td></tr>
<tr><th id="771">771</th><td><i>		 */</i></td></tr>
<tr><th id="772">772</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#page_zone_id" title='page_zone_id' data-ref="page_zone_id">page_zone_id</a>(<a class="local col8 ref" href="#428page" title='page' data-ref="428page">page</a>) != <a class="ref fn" href="../include/linux/mm.h.html#page_zone_id" title='page_zone_id' data-ref="page_zone_id">page_zone_id</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>))</td></tr>
<tr><th id="773">773</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="774">774</th><td></td></tr>
<tr><th id="775">775</th><td>		<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(page_count(buddy) != 0))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/page_ref.h.html#page_count" title='page_count' data-ref="page_count">page_count</a>(<a class="local col9 ref" href="#429buddy" title='buddy' data-ref="429buddy">buddy</a>) != <var>0</var>, buddy);</td></tr>
<tr><th id="776">776</th><td></td></tr>
<tr><th id="777">777</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="778">778</th><td>	}</td></tr>
<tr><th id="779">779</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="780">780</th><td>}</td></tr>
<tr><th id="781">781</th><td></td></tr>
<tr><th id="782">782</th><td><i  data-doc="__free_one_page">/*</i></td></tr>
<tr><th id="783">783</th><td><i  data-doc="__free_one_page"> * Freeing function for a buddy system allocator.</i></td></tr>
<tr><th id="784">784</th><td><i  data-doc="__free_one_page"> *</i></td></tr>
<tr><th id="785">785</th><td><i  data-doc="__free_one_page"> * The concept of a buddy system is to maintain direct-mapped table</i></td></tr>
<tr><th id="786">786</th><td><i  data-doc="__free_one_page"> * (containing bit values) for memory blocks of various "orders".</i></td></tr>
<tr><th id="787">787</th><td><i  data-doc="__free_one_page"> * The bottom level table contains the map for the smallest allocatable</i></td></tr>
<tr><th id="788">788</th><td><i  data-doc="__free_one_page"> * units of memory (here, pages), and each level above it describes</i></td></tr>
<tr><th id="789">789</th><td><i  data-doc="__free_one_page"> * pairs of units from the levels below, hence, "buddies".</i></td></tr>
<tr><th id="790">790</th><td><i  data-doc="__free_one_page"> * At a high level, all that happens here is marking the table entry</i></td></tr>
<tr><th id="791">791</th><td><i  data-doc="__free_one_page"> * at the bottom level available, and propagating the changes upward</i></td></tr>
<tr><th id="792">792</th><td><i  data-doc="__free_one_page"> * as necessary, plus some accounting needed to play nicely with other</i></td></tr>
<tr><th id="793">793</th><td><i  data-doc="__free_one_page"> * parts of the VM system.</i></td></tr>
<tr><th id="794">794</th><td><i  data-doc="__free_one_page"> * At each level, we keep a list of pages, which are heads of continuous</i></td></tr>
<tr><th id="795">795</th><td><i  data-doc="__free_one_page"> * free pages of length of (1 &lt;&lt; order) and marked with _mapcount</i></td></tr>
<tr><th id="796">796</th><td><i  data-doc="__free_one_page"> * PAGE_BUDDY_MAPCOUNT_VALUE. Page's order is recorded in page_private(page)</i></td></tr>
<tr><th id="797">797</th><td><i  data-doc="__free_one_page"> * field.</i></td></tr>
<tr><th id="798">798</th><td><i  data-doc="__free_one_page"> * So when we are allocating or freeing one, we can derive the state of the</i></td></tr>
<tr><th id="799">799</th><td><i  data-doc="__free_one_page"> * other.  That is, if we allocate a small block, and both were</i></td></tr>
<tr><th id="800">800</th><td><i  data-doc="__free_one_page"> * free, the remainder of the region must be split into blocks.</i></td></tr>
<tr><th id="801">801</th><td><i  data-doc="__free_one_page"> * If a block is freed, and its buddy is also free, then this</i></td></tr>
<tr><th id="802">802</th><td><i  data-doc="__free_one_page"> * triggers coalescing into a block of larger size.</i></td></tr>
<tr><th id="803">803</th><td><i  data-doc="__free_one_page"> *</i></td></tr>
<tr><th id="804">804</th><td><i  data-doc="__free_one_page"> * -- nyc</i></td></tr>
<tr><th id="805">805</th><td><i  data-doc="__free_one_page"> */</i></td></tr>
<tr><th id="806">806</th><td></td></tr>
<tr><th id="807">807</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="__free_one_page" title='__free_one_page' data-type='void __free_one_page(struct page * page, unsigned long pfn, struct zone * zone, unsigned int order, int migratetype)' data-ref="__free_one_page">__free_one_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="431page" title='page' data-type='struct page *' data-ref="431page">page</dfn>,</td></tr>
<tr><th id="808">808</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="432pfn" title='pfn' data-type='unsigned long' data-ref="432pfn">pfn</dfn>,</td></tr>
<tr><th id="809">809</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col3 decl" id="433zone" title='zone' data-type='struct zone *' data-ref="433zone">zone</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="434order" title='order' data-type='unsigned int' data-ref="434order">order</dfn>,</td></tr>
<tr><th id="810">810</th><td>		<em>int</em> <dfn class="local col5 decl" id="435migratetype" title='migratetype' data-type='int' data-ref="435migratetype">migratetype</dfn>)</td></tr>
<tr><th id="811">811</th><td>{</td></tr>
<tr><th id="812">812</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="436combined_pfn" title='combined_pfn' data-type='unsigned long' data-ref="436combined_pfn">combined_pfn</dfn>;</td></tr>
<tr><th id="813">813</th><td>	<em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/compiler-clang.h.html#12" title="buddy_pfn = *(&amp;(buddy_pfn))" data-ref="_M/uninitialized_var">uninitialized_var</a>(<dfn class="local col7 decl" id="437buddy_pfn" title='buddy_pfn' data-type='unsigned long' data-ref="437buddy_pfn"><a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a></dfn>);</td></tr>
<tr><th id="814">814</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="438buddy" title='buddy' data-type='struct page *' data-ref="438buddy">buddy</dfn>;</td></tr>
<tr><th id="815">815</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="439max_order" title='max_order' data-type='unsigned int' data-ref="439max_order">max_order</dfn>;</td></tr>
<tr><th id="816">816</th><td></td></tr>
<tr><th id="817">817</th><td>	<a class="local col9 ref" href="#439max_order" title='max_order' data-ref="439max_order">max_order</a> = <a class="macro" href="../include/linux/kernel.h.html#870" title="({ unsigned int __UNIQUE_ID_min1_149 = (11); unsigned int __UNIQUE_ID_min2_150 = ((21 - 12) + 1); (void) (&amp;__UNIQUE_ID_min1_149 == &amp;__UNIQUE_ID_min2_150); __UNIQUE_ID_min1_149 &lt; __UNIQUE_ID_min2_150 ? __UNIQUE_ID_min1_149 : __UNIQUE_ID_min2_150; })" data-ref="_M/min_t">min_t</a>(<em>unsigned</em> <em>int</em>, <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>, <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a> + <var>1</var>);</td></tr>
<tr><th id="818">818</th><td></td></tr>
<tr><th id="819">819</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)(!zone_is_initialized(zone)))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>(!<a class="ref fn" href="../include/linux/mmzone.h.html#zone_is_initialized" title='zone_is_initialized' data-ref="zone_is_initialized">zone_is_initialized</a>(<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>));</td></tr>
<tr><th id="820">820</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(page-&gt;flags &amp; (((1UL &lt;&lt; 22) - 1) &amp; ~0)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp; <a class="macro" href="../include/linux/page-flags.h.html#739" title="(((1UL &lt;&lt; 22) - 1) &amp; ~0)" data-ref="_M/PAGE_FLAGS_CHECK_AT_PREP">PAGE_FLAGS_CHECK_AT_PREP</a>, page);</td></tr>
<tr><th id="821">821</th><td></td></tr>
<tr><th id="822">822</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)(migratetype == -1))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>(<a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a> == -<var>1</var>);</td></tr>
<tr><th id="823">823</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(!is_migrate_isolate(migratetype)), 1)" data-ref="_M/likely">likely</a>(!<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a>)))</td></tr>
<tr><th id="824">824</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#__mod_zone_freepage_state" title='__mod_zone_freepage_state' data-ref="__mod_zone_freepage_state">__mod_zone_freepage_state</a>(<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>, <var>1</var> &lt;&lt; <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>, <a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a>);</td></tr>
<tr><th id="825">825</th><td></td></tr>
<tr><th id="826">826</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(pfn &amp; ((1 &lt;&lt; order) - 1)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a> &amp; ((<var>1</var> &lt;&lt; <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>) - <var>1</var>), page);</td></tr>
<tr><th id="827">827</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(bad_range(zone, page)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="tu ref fn" href="#bad_range" title='bad_range' data-use='c' data-ref="bad_range">bad_range</a>(<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>, <a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a>), page);</td></tr>
<tr><th id="828">828</th><td></td></tr>
<tr><th id="829">829</th><td><dfn class="lbl" id="440continue_merging" data-ref="440continue_merging">continue_merging</dfn>:</td></tr>
<tr><th id="830">830</th><td>	<b>while</b> (<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a> &lt; <a class="local col9 ref" href="#439max_order" title='max_order' data-ref="439max_order">max_order</a> - <var>1</var>) {</td></tr>
<tr><th id="831">831</th><td>		<a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> = <a class="ref fn" href="internal.h.html#__find_buddy_pfn" title='__find_buddy_pfn' data-ref="__find_buddy_pfn">__find_buddy_pfn</a>(<a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>);</td></tr>
<tr><th id="832">832</th><td>		<a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a> = <a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a> + (<a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> - <a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>);</td></tr>
<tr><th id="833">833</th><td></td></tr>
<tr><th id="834">834</th><td>		<b>if</b> (!<a class="macro" href="../include/linux/mmzone.h.html#1301" title="(1)" data-ref="_M/pfn_valid_within">pfn_valid_within</a>(buddy_pfn))</td></tr>
<tr><th id="835">835</th><td>			<b>goto</b> <a class="lbl" href="#441done_merging" data-ref="441done_merging">done_merging</a>;</td></tr>
<tr><th id="836">836</th><td>		<b>if</b> (!<a class="tu ref fn" href="#page_is_buddy" title='page_is_buddy' data-use='c' data-ref="page_is_buddy">page_is_buddy</a>(<a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a>, <a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>))</td></tr>
<tr><th id="837">837</th><td>			<b>goto</b> <a class="lbl" href="#441done_merging" data-ref="441done_merging">done_merging</a>;</td></tr>
<tr><th id="838">838</th><td>		<i>/*</i></td></tr>
<tr><th id="839">839</th><td><i>		 * Our buddy is free or it is CONFIG_DEBUG_PAGEALLOC guard page,</i></td></tr>
<tr><th id="840">840</th><td><i>		 * merge with it and move up one order.</i></td></tr>
<tr><th id="841">841</th><td><i>		 */</i></td></tr>
<tr><th id="842">842</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#page_is_guard" title='page_is_guard' data-ref="page_is_guard">page_is_guard</a>(<a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a>)) {</td></tr>
<tr><th id="843">843</th><td>			<a class="tu ref fn" href="#clear_page_guard" title='clear_page_guard' data-use='c' data-ref="clear_page_guard">clear_page_guard</a>(<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>, <a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>, <a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a>);</td></tr>
<tr><th id="844">844</th><td>		} <b>else</b> {</td></tr>
<tr><th id="845">845</th><td>			<a class="ref fn" href="../include/linux/list.h.html#list_del" title='list_del' data-ref="list_del">list_del</a>(&amp;<a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="846">846</th><td>			<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>--;</td></tr>
<tr><th id="847">847</th><td>			<a class="tu ref fn" href="#rmv_page_order" title='rmv_page_order' data-use='c' data-ref="rmv_page_order">rmv_page_order</a>(<a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a>);</td></tr>
<tr><th id="848">848</th><td>		}</td></tr>
<tr><th id="849">849</th><td>		<a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a> = <a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> &amp; <a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>;</td></tr>
<tr><th id="850">850</th><td>		<a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a> = <a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a> + (<a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a> - <a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>);</td></tr>
<tr><th id="851">851</th><td>		<a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a> = <a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a>;</td></tr>
<tr><th id="852">852</th><td>		<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>++;</td></tr>
<tr><th id="853">853</th><td>	}</td></tr>
<tr><th id="854">854</th><td>	<b>if</b> (<a class="local col9 ref" href="#439max_order" title='max_order' data-ref="439max_order">max_order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>) {</td></tr>
<tr><th id="855">855</th><td>		<i>/* If we are here, it means order is &gt;= pageblock_order.</i></td></tr>
<tr><th id="856">856</th><td><i>		 * We want to prevent merge between freepages on isolate</i></td></tr>
<tr><th id="857">857</th><td><i>		 * pageblock and normal pageblock. Without this, pageblock</i></td></tr>
<tr><th id="858">858</th><td><i>		 * isolation could cause incorrect freepage or CMA accounting.</i></td></tr>
<tr><th id="859">859</th><td><i>		 *</i></td></tr>
<tr><th id="860">860</th><td><i>		 * We don't want to hit this code for the more frequent</i></td></tr>
<tr><th id="861">861</th><td><i>		 * low-order merging.</i></td></tr>
<tr><th id="862">862</th><td><i>		 */</i></td></tr>
<tr><th id="863">863</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(has_isolate_pageblock(zone)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/page-isolation.h.html#has_isolate_pageblock" title='has_isolate_pageblock' data-ref="has_isolate_pageblock">has_isolate_pageblock</a>(<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>))) {</td></tr>
<tr><th id="864">864</th><td>			<em>int</em> <dfn class="local col2 decl" id="442buddy_mt" title='buddy_mt' data-type='int' data-ref="442buddy_mt">buddy_mt</dfn>;</td></tr>
<tr><th id="865">865</th><td></td></tr>
<tr><th id="866">866</th><td>			<a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> = <a class="ref fn" href="internal.h.html#__find_buddy_pfn" title='__find_buddy_pfn' data-ref="__find_buddy_pfn">__find_buddy_pfn</a>(<a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>);</td></tr>
<tr><th id="867">867</th><td>			<a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a> = <a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a> + (<a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> - <a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>);</td></tr>
<tr><th id="868">868</th><td>			<a class="local col2 ref" href="#442buddy_mt" title='buddy_mt' data-ref="442buddy_mt">buddy_mt</a> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(buddy, (unsigned long)((buddy) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col8 ref" href="#438buddy" title='buddy' data-ref="438buddy">buddy</a>);</td></tr>
<tr><th id="869">869</th><td></td></tr>
<tr><th id="870">870</th><td>			<b>if</b> (<a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a> != <a class="local col2 ref" href="#442buddy_mt" title='buddy_mt' data-ref="442buddy_mt">buddy_mt</a></td></tr>
<tr><th id="871">871</th><td>					&amp;&amp; (<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a>) ||</td></tr>
<tr><th id="872">872</th><td>						<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col2 ref" href="#442buddy_mt" title='buddy_mt' data-ref="442buddy_mt">buddy_mt</a>)))</td></tr>
<tr><th id="873">873</th><td>				<b>goto</b> <a class="lbl" href="#441done_merging" data-ref="441done_merging">done_merging</a>;</td></tr>
<tr><th id="874">874</th><td>		}</td></tr>
<tr><th id="875">875</th><td>		<a class="local col9 ref" href="#439max_order" title='max_order' data-ref="439max_order">max_order</a>++;</td></tr>
<tr><th id="876">876</th><td>		<b>goto</b> <a class="lbl" href="#440continue_merging" data-ref="440continue_merging">continue_merging</a>;</td></tr>
<tr><th id="877">877</th><td>	}</td></tr>
<tr><th id="878">878</th><td></td></tr>
<tr><th id="879">879</th><td><dfn class="lbl" id="441done_merging" data-ref="441done_merging">done_merging</dfn>:</td></tr>
<tr><th id="880">880</th><td>	<a class="tu ref fn" href="#set_page_order" title='set_page_order' data-use='c' data-ref="set_page_order">set_page_order</a>(<a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>);</td></tr>
<tr><th id="881">881</th><td></td></tr>
<tr><th id="882">882</th><td>	<i>/*</i></td></tr>
<tr><th id="883">883</th><td><i>	 * If this is not the largest possible page, check if the buddy</i></td></tr>
<tr><th id="884">884</th><td><i>	 * of the next-highest order is free. If it is, it's possible</i></td></tr>
<tr><th id="885">885</th><td><i>	 * that pages are being freed that will coalesce soon. In case,</i></td></tr>
<tr><th id="886">886</th><td><i>	 * that is happening, add the free page to the tail of the list</i></td></tr>
<tr><th id="887">887</th><td><i>	 * so it's less likely to be used soon and more likely to be merged</i></td></tr>
<tr><th id="888">888</th><td><i>	 * as a higher order page</i></td></tr>
<tr><th id="889">889</th><td><i>	 */</i></td></tr>
<tr><th id="890">890</th><td>	<b>if</b> ((<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>-<var>2</var>) &amp;&amp; <a class="macro" href="../include/linux/mmzone.h.html#1301" title="(1)" data-ref="_M/pfn_valid_within">pfn_valid_within</a>(buddy_pfn)) {</td></tr>
<tr><th id="891">891</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="443higher_page" title='higher_page' data-type='struct page *' data-ref="443higher_page">higher_page</dfn>, *<dfn class="local col4 decl" id="444higher_buddy" title='higher_buddy' data-type='struct page *' data-ref="444higher_buddy">higher_buddy</dfn>;</td></tr>
<tr><th id="892">892</th><td>		<a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a> = <a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> &amp; <a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>;</td></tr>
<tr><th id="893">893</th><td>		<a class="local col3 ref" href="#443higher_page" title='higher_page' data-ref="443higher_page">higher_page</a> = <a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a> + (<a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a> - <a class="local col2 ref" href="#432pfn" title='pfn' data-ref="432pfn">pfn</a>);</td></tr>
<tr><th id="894">894</th><td>		<a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> = <a class="ref fn" href="internal.h.html#__find_buddy_pfn" title='__find_buddy_pfn' data-ref="__find_buddy_pfn">__find_buddy_pfn</a>(<a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a> + <var>1</var>);</td></tr>
<tr><th id="895">895</th><td>		<a class="local col4 ref" href="#444higher_buddy" title='higher_buddy' data-ref="444higher_buddy">higher_buddy</a> = <a class="local col3 ref" href="#443higher_page" title='higher_page' data-ref="443higher_page">higher_page</a> + (<a class="local col7 ref" href="#813" title='buddy_pfn' data-ref="437buddy_pfn">buddy_pfn</a> - <a class="local col6 ref" href="#436combined_pfn" title='combined_pfn' data-ref="436combined_pfn">combined_pfn</a>);</td></tr>
<tr><th id="896">896</th><td>		<b>if</b> (<a class="macro" href="../include/linux/mmzone.h.html#1301" title="(1)" data-ref="_M/pfn_valid_within">pfn_valid_within</a>(buddy_pfn) &amp;&amp;</td></tr>
<tr><th id="897">897</th><td>		    <a class="tu ref fn" href="#page_is_buddy" title='page_is_buddy' data-use='c' data-ref="page_is_buddy">page_is_buddy</a>(<a class="local col3 ref" href="#443higher_page" title='higher_page' data-ref="443higher_page">higher_page</a>, <a class="local col4 ref" href="#444higher_buddy" title='higher_buddy' data-ref="444higher_buddy">higher_buddy</a>, <a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a> + <var>1</var>)) {</td></tr>
<tr><th id="898">898</th><td>			<a class="ref fn" href="../include/linux/list.h.html#list_add_tail" title='list_add_tail' data-ref="list_add_tail">list_add_tail</a>(&amp;<a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>,</td></tr>
<tr><th id="899">899</th><td>				&amp;<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a>]);</td></tr>
<tr><th id="900">900</th><td>			<b>goto</b> <a class="lbl" href="#445out" data-ref="445out">out</a>;</td></tr>
<tr><th id="901">901</th><td>		}</td></tr>
<tr><th id="902">902</th><td>	}</td></tr>
<tr><th id="903">903</th><td></td></tr>
<tr><th id="904">904</th><td>	<a class="ref fn" href="../include/linux/list.h.html#list_add" title='list_add' data-ref="list_add">list_add</a>(&amp;<a class="local col1 ref" href="#431page" title='page' data-ref="431page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, &amp;<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col5 ref" href="#435migratetype" title='migratetype' data-ref="435migratetype">migratetype</a>]);</td></tr>
<tr><th id="905">905</th><td><dfn class="lbl" id="445out" data-ref="445out">out</dfn>:</td></tr>
<tr><th id="906">906</th><td>	<a class="local col3 ref" href="#433zone" title='zone' data-ref="433zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col4 ref" href="#434order" title='order' data-ref="434order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>++;</td></tr>
<tr><th id="907">907</th><td>}</td></tr>
<tr><th id="908">908</th><td></td></tr>
<tr><th id="909">909</th><td><i  data-doc="page_expected_state">/*</i></td></tr>
<tr><th id="910">910</th><td><i  data-doc="page_expected_state"> * A bad page could be due to a number of fields. Instead of multiple branches,</i></td></tr>
<tr><th id="911">911</th><td><i  data-doc="page_expected_state"> * try and check multiple fields with one check. The caller must do a detailed</i></td></tr>
<tr><th id="912">912</th><td><i  data-doc="page_expected_state"> * check if necessary.</i></td></tr>
<tr><th id="913">913</th><td><i  data-doc="page_expected_state"> */</i></td></tr>
<tr><th id="914">914</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="page_expected_state" title='page_expected_state' data-type='bool page_expected_state(struct page * page, unsigned long check_flags)' data-ref="page_expected_state">page_expected_state</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="446page" title='page' data-type='struct page *' data-ref="446page">page</dfn>,</td></tr>
<tr><th id="915">915</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="447check_flags" title='check_flags' data-type='unsigned long' data-ref="447check_flags">check_flags</dfn>)</td></tr>
<tr><th id="916">916</th><td>{</td></tr>
<tr><th id="917">917</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(atomic_read(&amp;page-&gt;_mapcount) != -1), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../arch/x86/include/asm/atomic.h.html#atomic_read" title='atomic_read' data-ref="atomic_read">atomic_read</a>(&amp;<a class="local col6 ref" href="#446page" title='page' data-ref="446page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymousunion)::(anonymousstruct)::(anonymous)::_mapcount" title='page::(anonymous union)::(anonymous struct)::(anonymous union)::_mapcount' data-ref="page::(anonymousunion)::(anonymousstruct)::(anonymous)::_mapcount">_mapcount</a>) != -<var>1</var>))</td></tr>
<tr><th id="918">918</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="919">919</th><td></td></tr>
<tr><th id="920">920</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!((unsigned long)page-&gt;mapping | page_ref_count(page) |ifdef CONFIG_MEMCG (unsigned long)page-&gt;mem_cgroup |endif (page-&gt;flags &amp; check_flags)), 0)" data-ref="_M/unlikely">unlikely</a>((<em>unsigned</em> <em>long</em>)<a class="local col6 ref" href="#446page" title='page' data-ref="446page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> |</td></tr>
<tr><th id="921">921</th><td>			<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_count" title='page_ref_count' data-ref="page_ref_count">page_ref_count</a>(<a class="local col6 ref" href="#446page" title='page' data-ref="446page">page</a>) |</td></tr>
<tr><th id="922">922</th><td><u>#<span data-ppcond="922">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMCG">CONFIG_MEMCG</span></u></td></tr>
<tr><th id="923">923</th><td>			(<em>unsigned</em> <em>long</em>)page-&gt;mem_cgroup |</td></tr>
<tr><th id="924">924</th><td><u>#<span data-ppcond="922">endif</span></u></td></tr>
<tr><th id="925">925</th><td>			(<a class="local col6 ref" href="#446page" title='page' data-ref="446page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp; <a class="local col7 ref" href="#447check_flags" title='check_flags' data-ref="447check_flags">check_flags</a>)))</td></tr>
<tr><th id="926">926</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="927">927</th><td></td></tr>
<tr><th id="928">928</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="929">929</th><td>}</td></tr>
<tr><th id="930">930</th><td></td></tr>
<tr><th id="931">931</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="free_pages_check_bad" title='free_pages_check_bad' data-type='void free_pages_check_bad(struct page * page)' data-ref="free_pages_check_bad">free_pages_check_bad</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="448page" title='page' data-type='struct page *' data-ref="448page">page</dfn>)</td></tr>
<tr><th id="932">932</th><td>{</td></tr>
<tr><th id="933">933</th><td>	<em>const</em> <em>char</em> *<dfn class="local col9 decl" id="449bad_reason" title='bad_reason' data-type='const char *' data-ref="449bad_reason">bad_reason</dfn>;</td></tr>
<tr><th id="934">934</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="450bad_flags" title='bad_flags' data-type='unsigned long' data-ref="450bad_flags">bad_flags</dfn>;</td></tr>
<tr><th id="935">935</th><td></td></tr>
<tr><th id="936">936</th><td>	<a class="local col9 ref" href="#449bad_reason" title='bad_reason' data-ref="449bad_reason">bad_reason</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="937">937</th><td>	<a class="local col0 ref" href="#450bad_flags" title='bad_flags' data-ref="450bad_flags">bad_flags</a> = <var>0</var>;</td></tr>
<tr><th id="938">938</th><td></td></tr>
<tr><th id="939">939</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(atomic_read(&amp;page-&gt;_mapcount) != -1), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../arch/x86/include/asm/atomic.h.html#atomic_read" title='atomic_read' data-ref="atomic_read">atomic_read</a>(&amp;<a class="local col8 ref" href="#448page" title='page' data-ref="448page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymousunion)::(anonymousstruct)::(anonymous)::_mapcount" title='page::(anonymous union)::(anonymous struct)::(anonymous union)::_mapcount' data-ref="page::(anonymousunion)::(anonymousstruct)::(anonymous)::_mapcount">_mapcount</a>) != -<var>1</var>))</td></tr>
<tr><th id="940">940</th><td>		<a class="local col9 ref" href="#449bad_reason" title='bad_reason' data-ref="449bad_reason">bad_reason</a> = <q>"nonzero mapcount"</q>;</td></tr>
<tr><th id="941">941</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page-&gt;mapping != ((void *)0)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col8 ref" href="#448page" title='page' data-ref="448page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> != <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>))</td></tr>
<tr><th id="942">942</th><td>		<a class="local col9 ref" href="#449bad_reason" title='bad_reason' data-ref="449bad_reason">bad_reason</a> = <q>"non-NULL mapping"</q>;</td></tr>
<tr><th id="943">943</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page_ref_count(page) != 0), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_count" title='page_ref_count' data-ref="page_ref_count">page_ref_count</a>(<a class="local col8 ref" href="#448page" title='page' data-ref="448page">page</a>) != <var>0</var>))</td></tr>
<tr><th id="944">944</th><td>		<a class="local col9 ref" href="#449bad_reason" title='bad_reason' data-ref="449bad_reason">bad_reason</a> = <q>"nonzero _refcount"</q>;</td></tr>
<tr><th id="945">945</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page-&gt;flags &amp; (1UL &lt;&lt; PG_lru | 1UL &lt;&lt; PG_locked | 1UL &lt;&lt; PG_private | 1UL &lt;&lt; PG_private_2 | 1UL &lt;&lt; PG_writeback | 1UL &lt;&lt; PG_reserved | 1UL &lt;&lt; PG_slab | 1UL &lt;&lt; PG_active | 1UL &lt;&lt; PG_unevictable | (1UL &lt;&lt; PG_mlocked))), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col8 ref" href="#448page" title='page' data-ref="448page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp; <a class="macro" href="../include/linux/page-flags.h.html#724" title="(1UL &lt;&lt; PG_lru | 1UL &lt;&lt; PG_locked | 1UL &lt;&lt; PG_private | 1UL &lt;&lt; PG_private_2 | 1UL &lt;&lt; PG_writeback | 1UL &lt;&lt; PG_reserved | 1UL &lt;&lt; PG_slab | 1UL &lt;&lt; PG_active | 1UL &lt;&lt; PG_unevictable | (1UL &lt;&lt; PG_mlocked))" data-ref="_M/PAGE_FLAGS_CHECK_AT_FREE">PAGE_FLAGS_CHECK_AT_FREE</a>)) {</td></tr>
<tr><th id="946">946</th><td>		<a class="local col9 ref" href="#449bad_reason" title='bad_reason' data-ref="449bad_reason">bad_reason</a> = <q>"PAGE_FLAGS_CHECK_AT_FREE flag(s) set"</q>;</td></tr>
<tr><th id="947">947</th><td>		<a class="local col0 ref" href="#450bad_flags" title='bad_flags' data-ref="450bad_flags">bad_flags</a> = <a class="macro" href="../include/linux/page-flags.h.html#724" title="(1UL &lt;&lt; PG_lru | 1UL &lt;&lt; PG_locked | 1UL &lt;&lt; PG_private | 1UL &lt;&lt; PG_private_2 | 1UL &lt;&lt; PG_writeback | 1UL &lt;&lt; PG_reserved | 1UL &lt;&lt; PG_slab | 1UL &lt;&lt; PG_active | 1UL &lt;&lt; PG_unevictable | (1UL &lt;&lt; PG_mlocked))" data-ref="_M/PAGE_FLAGS_CHECK_AT_FREE">PAGE_FLAGS_CHECK_AT_FREE</a>;</td></tr>
<tr><th id="948">948</th><td>	}</td></tr>
<tr><th id="949">949</th><td><u>#<span data-ppcond="949">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMCG">CONFIG_MEMCG</span></u></td></tr>
<tr><th id="950">950</th><td>	<b>if</b> (unlikely(page-&gt;mem_cgroup))</td></tr>
<tr><th id="951">951</th><td>		bad_reason = <q>"page still charged to cgroup"</q>;</td></tr>
<tr><th id="952">952</th><td><u>#<span data-ppcond="949">endif</span></u></td></tr>
<tr><th id="953">953</th><td>	<a class="tu ref fn" href="#bad_page" title='bad_page' data-use='c' data-ref="bad_page">bad_page</a>(<a class="local col8 ref" href="#448page" title='page' data-ref="448page">page</a>, <a class="local col9 ref" href="#449bad_reason" title='bad_reason' data-ref="449bad_reason">bad_reason</a>, <a class="local col0 ref" href="#450bad_flags" title='bad_flags' data-ref="450bad_flags">bad_flags</a>);</td></tr>
<tr><th id="954">954</th><td>}</td></tr>
<tr><th id="955">955</th><td></td></tr>
<tr><th id="956">956</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="free_pages_check" title='free_pages_check' data-type='int free_pages_check(struct page * page)' data-ref="free_pages_check">free_pages_check</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="451page" title='page' data-type='struct page *' data-ref="451page">page</dfn>)</td></tr>
<tr><th id="957">957</th><td>{</td></tr>
<tr><th id="958">958</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(page_expected_state(page, (1UL &lt;&lt; PG_lru | 1UL &lt;&lt; PG_locked | 1UL &lt;&lt; PG_private | 1UL &lt;&lt; PG_private_2 | 1UL &lt;&lt; PG_writeback | 1UL &lt;&lt; PG_reserved | 1UL &lt;&lt; PG_slab | 1UL &lt;&lt; PG_active | 1UL &lt;&lt; PG_unevictable | (1UL &lt;&lt; PG_mlocked)))), 1)" data-ref="_M/likely">likely</a>(<a class="tu ref fn" href="#page_expected_state" title='page_expected_state' data-use='c' data-ref="page_expected_state">page_expected_state</a>(<a class="local col1 ref" href="#451page" title='page' data-ref="451page">page</a>, <a class="macro" href="../include/linux/page-flags.h.html#724" title="(1UL &lt;&lt; PG_lru | 1UL &lt;&lt; PG_locked | 1UL &lt;&lt; PG_private | 1UL &lt;&lt; PG_private_2 | 1UL &lt;&lt; PG_writeback | 1UL &lt;&lt; PG_reserved | 1UL &lt;&lt; PG_slab | 1UL &lt;&lt; PG_active | 1UL &lt;&lt; PG_unevictable | (1UL &lt;&lt; PG_mlocked))" data-ref="_M/PAGE_FLAGS_CHECK_AT_FREE">PAGE_FLAGS_CHECK_AT_FREE</a>)))</td></tr>
<tr><th id="959">959</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="960">960</th><td></td></tr>
<tr><th id="961">961</th><td>	<i>/* Something has gone sideways, find it */</i></td></tr>
<tr><th id="962">962</th><td>	<a class="tu ref fn" href="#free_pages_check_bad" title='free_pages_check_bad' data-use='c' data-ref="free_pages_check_bad">free_pages_check_bad</a>(<a class="local col1 ref" href="#451page" title='page' data-ref="451page">page</a>);</td></tr>
<tr><th id="963">963</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="964">964</th><td>}</td></tr>
<tr><th id="965">965</th><td></td></tr>
<tr><th id="966">966</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="free_tail_pages_check" title='free_tail_pages_check' data-type='int free_tail_pages_check(struct page * head_page, struct page * page)' data-ref="free_tail_pages_check">free_tail_pages_check</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="452head_page" title='head_page' data-type='struct page *' data-ref="452head_page">head_page</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="453page" title='page' data-type='struct page *' data-ref="453page">page</dfn>)</td></tr>
<tr><th id="967">967</th><td>{</td></tr>
<tr><th id="968">968</th><td>	<em>int</em> <dfn class="local col4 decl" id="454ret" title='ret' data-type='int' data-ref="454ret">ret</dfn> = <var>1</var>;</td></tr>
<tr><th id="969">969</th><td></td></tr>
<tr><th id="970">970</th><td>	<i>/*</i></td></tr>
<tr><th id="971">971</th><td><i>	 * We rely page-&gt;lru.next never has bit 0 set, unless the page</i></td></tr>
<tr><th id="972">972</th><td><i>	 * is PageTail(). Let's make sure that's true even for poisoned -&gt;lru.</i></td></tr>
<tr><th id="973">973</th><td><i>	 */</i></td></tr>
<tr><th id="974">974</th><td>	<a class="macro" href="../include/linux/build_bug.h.html#70" title="do { bool __cond = !(!((unsigned long)((void *) 0x100 + (0xdead000000000000UL)) &amp; 1)); extern void __compiletime_assert_974(void) ; if (__cond) __compiletime_assert_974(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0)" data-ref="_M/BUILD_BUG_ON">BUILD_BUG_ON</a>((<em>unsigned</em> <em>long</em>)<a class="macro" href="../include/linux/poison.h.html#23" title="((void *) 0x100 + (0xdead000000000000UL))" data-ref="_M/LIST_POISON1">LIST_POISON1</a> &amp; <var>1</var>);</td></tr>
<tr><th id="975">975</th><td></td></tr>
<tr><th id="976">976</th><td>	<b>if</b> (!<a class="macro" href="../include/linux/kconfig.h.html#71" title="0" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(CONFIG_DEBUG_VM)) {</td></tr>
<tr><th id="977">977</th><td>		<a class="local col4 ref" href="#454ret" title='ret' data-ref="454ret">ret</a> = <var>0</var>;</td></tr>
<tr><th id="978">978</th><td>		<b>goto</b> <a class="lbl" href="#455out" data-ref="455out">out</a>;</td></tr>
<tr><th id="979">979</th><td>	}</td></tr>
<tr><th id="980">980</th><td>	<b>switch</b> (<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a> - <a class="local col2 ref" href="#452head_page" title='head_page' data-ref="452head_page">head_page</a>) {</td></tr>
<tr><th id="981">981</th><td>	<b>case</b> <var>1</var>:</td></tr>
<tr><th id="982">982</th><td>		<i>/* the first tail page: -&gt;mapping is compound_mapcount() */</i></td></tr>
<tr><th id="983">983</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(compound_mapcount(page)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/mm.h.html#compound_mapcount" title='compound_mapcount' data-ref="compound_mapcount">compound_mapcount</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>))) {</td></tr>
<tr><th id="984">984</th><td>			<a class="tu ref fn" href="#bad_page" title='bad_page' data-use='c' data-ref="bad_page">bad_page</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>, <q>"nonzero compound_mapcount"</q>, <var>0</var>);</td></tr>
<tr><th id="985">985</th><td>			<b>goto</b> <a class="lbl" href="#455out" data-ref="455out">out</a>;</td></tr>
<tr><th id="986">986</th><td>		}</td></tr>
<tr><th id="987">987</th><td>		<b>break</b>;</td></tr>
<tr><th id="988">988</th><td>	<b>case</b> <var>2</var>:</td></tr>
<tr><th id="989">989</th><td>		<i>/*</i></td></tr>
<tr><th id="990">990</th><td><i>		 * the second tail page: -&gt;mapping is</i></td></tr>
<tr><th id="991">991</th><td><i>		 * page_deferred_list().next -- ignore value.</i></td></tr>
<tr><th id="992">992</th><td><i>		 */</i></td></tr>
<tr><th id="993">993</th><td>		<b>break</b>;</td></tr>
<tr><th id="994">994</th><td>	<b>default</b>:</td></tr>
<tr><th id="995">995</th><td>		<b>if</b> (<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> != <a class="macro" href="../include/linux/poison.h.html#42" title="((void *) 0x400 + (0xdead000000000000UL))" data-ref="_M/TAIL_MAPPING">TAIL_MAPPING</a>) {</td></tr>
<tr><th id="996">996</th><td>			<a class="tu ref fn" href="#bad_page" title='bad_page' data-use='c' data-ref="bad_page">bad_page</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>, <q>"corrupted mapping in tail page"</q>, <var>0</var>);</td></tr>
<tr><th id="997">997</th><td>			<b>goto</b> <a class="lbl" href="#455out" data-ref="455out">out</a>;</td></tr>
<tr><th id="998">998</th><td>		}</td></tr>
<tr><th id="999">999</th><td>		<b>break</b>;</td></tr>
<tr><th id="1000">1000</th><td>	}</td></tr>
<tr><th id="1001">1001</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(!PageTail(page)), 0)" data-ref="_M/unlikely">unlikely</a>(!<a class="ref fn" href="../include/linux/page-flags.h.html#PageTail" title='PageTail' data-ref="PageTail">PageTail</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>))) {</td></tr>
<tr><th id="1002">1002</th><td>		<a class="tu ref fn" href="#bad_page" title='bad_page' data-use='c' data-ref="bad_page">bad_page</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>, <q>"PageTail not set"</q>, <var>0</var>);</td></tr>
<tr><th id="1003">1003</th><td>		<b>goto</b> <a class="lbl" href="#455out" data-ref="455out">out</a>;</td></tr>
<tr><th id="1004">1004</th><td>	}</td></tr>
<tr><th id="1005">1005</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(compound_head(page) != head_page), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/page-flags.h.html#compound_head" title='compound_head' data-ref="compound_head">compound_head</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>) != <a class="local col2 ref" href="#452head_page" title='head_page' data-ref="452head_page">head_page</a>)) {</td></tr>
<tr><th id="1006">1006</th><td>		<a class="tu ref fn" href="#bad_page" title='bad_page' data-use='c' data-ref="bad_page">bad_page</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>, <q>"compound_head not consistent"</q>, <var>0</var>);</td></tr>
<tr><th id="1007">1007</th><td>		<b>goto</b> <a class="lbl" href="#455out" data-ref="455out">out</a>;</td></tr>
<tr><th id="1008">1008</th><td>	}</td></tr>
<tr><th id="1009">1009</th><td>	<a class="local col4 ref" href="#454ret" title='ret' data-ref="454ret">ret</a> = <var>0</var>;</td></tr>
<tr><th id="1010">1010</th><td><dfn class="lbl" id="455out" data-ref="455out">out</dfn>:</td></tr>
<tr><th id="1011">1011</th><td>	<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1012">1012</th><td>	<a class="ref fn" href="../include/linux/page-flags.h.html#clear_compound_head" title='clear_compound_head' data-ref="clear_compound_head">clear_compound_head</a>(<a class="local col3 ref" href="#453page" title='page' data-ref="453page">page</a>);</td></tr>
<tr><th id="1013">1013</th><td>	<b>return</b> <a class="local col4 ref" href="#454ret" title='ret' data-ref="454ret">ret</a>;</td></tr>
<tr><th id="1014">1014</th><td>}</td></tr>
<tr><th id="1015">1015</th><td></td></tr>
<tr><th id="1016">1016</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#103" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function)) __attribute__((always_inline))" data-ref="_M/__always_inline">__always_inline</a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="free_pages_prepare" title='free_pages_prepare' data-type='bool free_pages_prepare(struct page * page, unsigned int order, bool check_free)' data-ref="free_pages_prepare">free_pages_prepare</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="456page" title='page' data-type='struct page *' data-ref="456page">page</dfn>,</td></tr>
<tr><th id="1017">1017</th><td>					<em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="457order" title='order' data-type='unsigned int' data-ref="457order">order</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col8 decl" id="458check_free" title='check_free' data-type='bool' data-ref="458check_free">check_free</dfn>)</td></tr>
<tr><th id="1018">1018</th><td>{</td></tr>
<tr><th id="1019">1019</th><td>	<em>int</em> <dfn class="local col9 decl" id="459bad" title='bad' data-type='int' data-ref="459bad">bad</dfn> = <var>0</var>;</td></tr>
<tr><th id="1020">1020</th><td></td></tr>
<tr><th id="1021">1021</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(PageTail(page)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/page-flags.h.html#PageTail" title='PageTail' data-ref="PageTail">PageTail</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>), page);</td></tr>
<tr><th id="1022">1022</th><td></td></tr>
<tr><th id="1023">1023</th><td>	<a class="ref fn" href="../include/trace/events/kmem.h.html#151" title='trace_mm_page_free' data-ref="trace_mm_page_free">trace_mm_page_free</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1024">1024</th><td></td></tr>
<tr><th id="1025">1025</th><td>	<i>/*</i></td></tr>
<tr><th id="1026">1026</th><td><i>	 * Check tail pages before head page information is cleared to</i></td></tr>
<tr><th id="1027">1027</th><td><i>	 * avoid checking PageCompound for order-0 pages.</i></td></tr>
<tr><th id="1028">1028</th><td><i>	 */</i></td></tr>
<tr><th id="1029">1029</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(order), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>)) {</td></tr>
<tr><th id="1030">1030</th><td>		<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col0 decl" id="460compound" title='compound' data-type='bool' data-ref="460compound">compound</dfn> = <a class="ref fn" href="../include/linux/page-flags.h.html#PageCompound" title='PageCompound' data-ref="PageCompound">PageCompound</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>);</td></tr>
<tr><th id="1031">1031</th><td>		<em>int</em> <dfn class="local col1 decl" id="461i" title='i' data-type='int' data-ref="461i">i</dfn>;</td></tr>
<tr><th id="1032">1032</th><td></td></tr>
<tr><th id="1033">1033</th><td>		<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(compound &amp;&amp; compound_order(page) != order))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="local col0 ref" href="#460compound" title='compound' data-ref="460compound">compound</a> &amp;&amp; <a class="ref fn" href="../include/linux/mm.h.html#compound_order" title='compound_order' data-ref="compound_order">compound_order</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>) != <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>, page);</td></tr>
<tr><th id="1034">1034</th><td></td></tr>
<tr><th id="1035">1035</th><td>		<b>if</b> (<a class="local col0 ref" href="#460compound" title='compound' data-ref="460compound">compound</a>)</td></tr>
<tr><th id="1036">1036</th><td>			<a class="ref fn" href="../include/linux/page-flags.h.html#632" title='ClearPageDoubleMap' data-ref="ClearPageDoubleMap">ClearPageDoubleMap</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>);</td></tr>
<tr><th id="1037">1037</th><td>		<b>for</b> (<a class="local col1 ref" href="#461i" title='i' data-ref="461i">i</a> = <var>1</var>; <a class="local col1 ref" href="#461i" title='i' data-ref="461i">i</a> &lt; (<var>1</var> &lt;&lt; <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>); <a class="local col1 ref" href="#461i" title='i' data-ref="461i">i</a>++) {</td></tr>
<tr><th id="1038">1038</th><td>			<b>if</b> (<a class="local col0 ref" href="#460compound" title='compound' data-ref="460compound">compound</a>)</td></tr>
<tr><th id="1039">1039</th><td>				<a class="local col9 ref" href="#459bad" title='bad' data-ref="459bad">bad</a> += <a class="tu ref fn" href="#free_tail_pages_check" title='free_tail_pages_check' data-use='c' data-ref="free_tail_pages_check">free_tail_pages_check</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a> + <a class="local col1 ref" href="#461i" title='i' data-ref="461i">i</a>);</td></tr>
<tr><th id="1040">1040</th><td>			<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(free_pages_check(page + i)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="tu ref fn" href="#free_pages_check" title='free_pages_check' data-use='c' data-ref="free_pages_check">free_pages_check</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a> + <a class="local col1 ref" href="#461i" title='i' data-ref="461i">i</a>))) {</td></tr>
<tr><th id="1041">1041</th><td>				<a class="local col9 ref" href="#459bad" title='bad' data-ref="459bad">bad</a>++;</td></tr>
<tr><th id="1042">1042</th><td>				<b>continue</b>;</td></tr>
<tr><th id="1043">1043</th><td>			}</td></tr>
<tr><th id="1044">1044</th><td>			(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a> + <a class="local col1 ref" href="#461i" title='i' data-ref="461i">i</a>)-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp;= ~<a class="macro" href="../include/linux/page-flags.h.html#739" title="(((1UL &lt;&lt; 22) - 1) &amp; ~0)" data-ref="_M/PAGE_FLAGS_CHECK_AT_PREP">PAGE_FLAGS_CHECK_AT_PREP</a>;</td></tr>
<tr><th id="1045">1045</th><td>		}</td></tr>
<tr><th id="1046">1046</th><td>	}</td></tr>
<tr><th id="1047">1047</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/page-flags.h.html#PageMappingFlags" title='PageMappingFlags' data-ref="PageMappingFlags">PageMappingFlags</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>))</td></tr>
<tr><th id="1048">1048</th><td>		<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1049">1049</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/memcontrol.h.html#memcg_kmem_enabled" title='memcg_kmem_enabled' data-ref="memcg_kmem_enabled">memcg_kmem_enabled</a>() &amp;&amp; <a class="ref fn" href="../include/linux/page-flags.h.html#680" title='PageKmemcg' data-ref="PageKmemcg">PageKmemcg</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>))</td></tr>
<tr><th id="1050">1050</th><td>		<a class="ref fn" href="../include/linux/memcontrol.h.html#memcg_kmem_uncharge" title='memcg_kmem_uncharge' data-ref="memcg_kmem_uncharge">memcg_kmem_uncharge</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1051">1051</th><td>	<b>if</b> (<a class="local col8 ref" href="#458check_free" title='check_free' data-ref="458check_free">check_free</a>)</td></tr>
<tr><th id="1052">1052</th><td>		<a class="local col9 ref" href="#459bad" title='bad' data-ref="459bad">bad</a> += <a class="tu ref fn" href="#free_pages_check" title='free_pages_check' data-use='c' data-ref="free_pages_check">free_pages_check</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>);</td></tr>
<tr><th id="1053">1053</th><td>	<b>if</b> (<a class="local col9 ref" href="#459bad" title='bad' data-ref="459bad">bad</a>)</td></tr>
<tr><th id="1054">1054</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="1055">1055</th><td></td></tr>
<tr><th id="1056">1056</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#page_cpupid_reset_last" title='page_cpupid_reset_last' data-ref="page_cpupid_reset_last">page_cpupid_reset_last</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>);</td></tr>
<tr><th id="1057">1057</th><td>	<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp;= ~<a class="macro" href="../include/linux/page-flags.h.html#739" title="(((1UL &lt;&lt; 22) - 1) &amp; ~0)" data-ref="_M/PAGE_FLAGS_CHECK_AT_PREP">PAGE_FLAGS_CHECK_AT_PREP</a>;</td></tr>
<tr><th id="1058">1058</th><td>	<a class="ref fn" href="../include/linux/page_owner.h.html#reset_page_owner" title='reset_page_owner' data-ref="reset_page_owner">reset_page_owner</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1059">1059</th><td></td></tr>
<tr><th id="1060">1060</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/page-flags.h.html#324" title='PageHighMem' data-ref="PageHighMem">PageHighMem</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>)) {</td></tr>
<tr><th id="1061">1061</th><td>		<a class="ref fn" href="../include/linux/debug_locks.h.html#debug_check_no_locks_freed" title='debug_check_no_locks_freed' data-ref="debug_check_no_locks_freed">debug_check_no_locks_freed</a>(<a class="macro" href="../include/linux/mm.h.html#1103" title="lowmem_page_address(page)" data-ref="_M/page_address">page_address</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>),</td></tr>
<tr><th id="1062">1062</th><td>					   <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &lt;&lt; <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1063">1063</th><td>		<a class="ref fn" href="../include/linux/debugobjects.h.html#debug_check_no_obj_freed" title='debug_check_no_obj_freed' data-ref="debug_check_no_obj_freed">debug_check_no_obj_freed</a>(<a class="macro" href="../include/linux/mm.h.html#1103" title="lowmem_page_address(page)" data-ref="_M/page_address">page_address</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>),</td></tr>
<tr><th id="1064">1064</th><td>					   <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &lt;&lt; <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1065">1065</th><td>	}</td></tr>
<tr><th id="1066">1066</th><td>	<a class="ref fn" href="../include/linux/gfp.h.html#arch_free_page" title='arch_free_page' data-ref="arch_free_page">arch_free_page</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1067">1067</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#kernel_poison_pages" title='kernel_poison_pages' data-ref="kernel_poison_pages">kernel_poison_pages</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <var>1</var> &lt;&lt; <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>, <var>0</var>);</td></tr>
<tr><th id="1068">1068</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#kernel_map_pages" title='kernel_map_pages' data-ref="kernel_map_pages">kernel_map_pages</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <var>1</var> &lt;&lt; <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>, <var>0</var>);</td></tr>
<tr><th id="1069">1069</th><td>	<a class="ref fn" href="../include/linux/kasan.h.html#kasan_free_pages" title='kasan_free_pages' data-ref="kasan_free_pages">kasan_free_pages</a>(<a class="local col6 ref" href="#456page" title='page' data-ref="456page">page</a>, <a class="local col7 ref" href="#457order" title='order' data-ref="457order">order</a>);</td></tr>
<tr><th id="1070">1070</th><td></td></tr>
<tr><th id="1071">1071</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1072">1072</th><td>}</td></tr>
<tr><th id="1073">1073</th><td></td></tr>
<tr><th id="1074">1074</th><td><u>#<span data-ppcond="1074">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEBUG_VM">CONFIG_DEBUG_VM</span></u></td></tr>
<tr><th id="1075">1075</th><td><em>static</em> <b>inline</b> bool free_pcp_prepare(<b>struct</b> page *page)</td></tr>
<tr><th id="1076">1076</th><td>{</td></tr>
<tr><th id="1077">1077</th><td>	<b>return</b> free_pages_prepare(page, <var>0</var>, true);</td></tr>
<tr><th id="1078">1078</th><td>}</td></tr>
<tr><th id="1079">1079</th><td></td></tr>
<tr><th id="1080">1080</th><td><em>static</em> <b>inline</b> bool bulkfree_pcp_prepare(<b>struct</b> page *page)</td></tr>
<tr><th id="1081">1081</th><td>{</td></tr>
<tr><th id="1082">1082</th><td>	<b>return</b> false;</td></tr>
<tr><th id="1083">1083</th><td>}</td></tr>
<tr><th id="1084">1084</th><td><u>#<span data-ppcond="1074">else</span></u></td></tr>
<tr><th id="1085">1085</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="free_pcp_prepare" title='free_pcp_prepare' data-type='bool free_pcp_prepare(struct page * page)' data-ref="free_pcp_prepare">free_pcp_prepare</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="462page" title='page' data-type='struct page *' data-ref="462page">page</dfn>)</td></tr>
<tr><th id="1086">1086</th><td>{</td></tr>
<tr><th id="1087">1087</th><td>	<b>return</b> <a class="tu ref fn" href="#free_pages_prepare" title='free_pages_prepare' data-use='c' data-ref="free_pages_prepare">free_pages_prepare</a>(<a class="local col2 ref" href="#462page" title='page' data-ref="462page">page</a>, <var>0</var>, <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>);</td></tr>
<tr><th id="1088">1088</th><td>}</td></tr>
<tr><th id="1089">1089</th><td></td></tr>
<tr><th id="1090">1090</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="bulkfree_pcp_prepare" title='bulkfree_pcp_prepare' data-type='bool bulkfree_pcp_prepare(struct page * page)' data-ref="bulkfree_pcp_prepare">bulkfree_pcp_prepare</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="463page" title='page' data-type='struct page *' data-ref="463page">page</dfn>)</td></tr>
<tr><th id="1091">1091</th><td>{</td></tr>
<tr><th id="1092">1092</th><td>	<b>return</b> <a class="tu ref fn" href="#free_pages_check" title='free_pages_check' data-use='c' data-ref="free_pages_check">free_pages_check</a>(<a class="local col3 ref" href="#463page" title='page' data-ref="463page">page</a>);</td></tr>
<tr><th id="1093">1093</th><td>}</td></tr>
<tr><th id="1094">1094</th><td><u>#<span data-ppcond="1074">endif</span> /* CONFIG_DEBUG_VM */</u></td></tr>
<tr><th id="1095">1095</th><td></td></tr>
<tr><th id="1096">1096</th><td><i  data-doc="free_pcppages_bulk">/*</i></td></tr>
<tr><th id="1097">1097</th><td><i  data-doc="free_pcppages_bulk"> * Frees a number of pages from the PCP lists</i></td></tr>
<tr><th id="1098">1098</th><td><i  data-doc="free_pcppages_bulk"> * Assumes all pages on list are in same zone, and of same order.</i></td></tr>
<tr><th id="1099">1099</th><td><i  data-doc="free_pcppages_bulk"> * count is the number of pages to free.</i></td></tr>
<tr><th id="1100">1100</th><td><i  data-doc="free_pcppages_bulk"> *</i></td></tr>
<tr><th id="1101">1101</th><td><i  data-doc="free_pcppages_bulk"> * If the zone was previously in an "all pages pinned" state then look to</i></td></tr>
<tr><th id="1102">1102</th><td><i  data-doc="free_pcppages_bulk"> * see if this freeing clears that state.</i></td></tr>
<tr><th id="1103">1103</th><td><i  data-doc="free_pcppages_bulk"> *</i></td></tr>
<tr><th id="1104">1104</th><td><i  data-doc="free_pcppages_bulk"> * And clear the zone's pages_scanned counter, to hold off the "all pages are</i></td></tr>
<tr><th id="1105">1105</th><td><i  data-doc="free_pcppages_bulk"> * pinned" detection logic.</i></td></tr>
<tr><th id="1106">1106</th><td><i  data-doc="free_pcppages_bulk"> */</i></td></tr>
<tr><th id="1107">1107</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="free_pcppages_bulk" title='free_pcppages_bulk' data-type='void free_pcppages_bulk(struct zone * zone, int count, struct per_cpu_pages * pcp)' data-ref="free_pcppages_bulk">free_pcppages_bulk</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="464zone" title='zone' data-type='struct zone *' data-ref="464zone">zone</dfn>, <em>int</em> <dfn class="local col5 decl" id="465count" title='count' data-type='int' data-ref="465count">count</dfn>,</td></tr>
<tr><th id="1108">1108</th><td>					<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col6 decl" id="466pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="466pcp">pcp</dfn>)</td></tr>
<tr><th id="1109">1109</th><td>{</td></tr>
<tr><th id="1110">1110</th><td>	<em>int</em> <dfn class="local col7 decl" id="467migratetype" title='migratetype' data-type='int' data-ref="467migratetype">migratetype</dfn> = <var>0</var>;</td></tr>
<tr><th id="1111">1111</th><td>	<em>int</em> <dfn class="local col8 decl" id="468batch_free" title='batch_free' data-type='int' data-ref="468batch_free">batch_free</dfn> = <var>0</var>;</td></tr>
<tr><th id="1112">1112</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col9 decl" id="469isolated_pageblocks" title='isolated_pageblocks' data-type='bool' data-ref="469isolated_pageblocks">isolated_pageblocks</dfn>;</td></tr>
<tr><th id="1113">1113</th><td></td></tr>
<tr><th id="1114">1114</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="local col4 ref" href="#464zone" title='zone' data-ref="464zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="1115">1115</th><td>	<a class="local col9 ref" href="#469isolated_pageblocks" title='isolated_pageblocks' data-ref="469isolated_pageblocks">isolated_pageblocks</a> = <a class="ref fn" href="../include/linux/page-isolation.h.html#has_isolate_pageblock" title='has_isolate_pageblock' data-ref="has_isolate_pageblock">has_isolate_pageblock</a>(<a class="local col4 ref" href="#464zone" title='zone' data-ref="464zone">zone</a>);</td></tr>
<tr><th id="1116">1116</th><td></td></tr>
<tr><th id="1117">1117</th><td>	<b>while</b> (<a class="local col5 ref" href="#465count" title='count' data-ref="465count">count</a>) {</td></tr>
<tr><th id="1118">1118</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="470page" title='page' data-type='struct page *' data-ref="470page">page</dfn>;</td></tr>
<tr><th id="1119">1119</th><td>		<b>struct</b> <a class="type" href="../include/linux/types.h.html#list_head" title='list_head' data-ref="list_head">list_head</a> *<dfn class="local col1 decl" id="471list" title='list' data-type='struct list_head *' data-ref="471list">list</dfn>;</td></tr>
<tr><th id="1120">1120</th><td></td></tr>
<tr><th id="1121">1121</th><td>		<i>/*</i></td></tr>
<tr><th id="1122">1122</th><td><i>		 * Remove pages from lists in a round-robin fashion. A</i></td></tr>
<tr><th id="1123">1123</th><td><i>		 * batch_free count is maintained that is incremented when an</i></td></tr>
<tr><th id="1124">1124</th><td><i>		 * empty list is encountered.  This is so more pages are freed</i></td></tr>
<tr><th id="1125">1125</th><td><i>		 * off fuller lists instead of spinning excessively around empty</i></td></tr>
<tr><th id="1126">1126</th><td><i>		 * lists</i></td></tr>
<tr><th id="1127">1127</th><td><i>		 */</i></td></tr>
<tr><th id="1128">1128</th><td>		<b>do</b> {</td></tr>
<tr><th id="1129">1129</th><td>			<a class="local col8 ref" href="#468batch_free" title='batch_free' data-ref="468batch_free">batch_free</a>++;</td></tr>
<tr><th id="1130">1130</th><td>			<b>if</b> (++<a class="local col7 ref" href="#467migratetype" title='migratetype' data-ref="467migratetype">migratetype</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_PCPTYPES" title='MIGRATE_PCPTYPES' data-ref="MIGRATE_PCPTYPES">MIGRATE_PCPTYPES</a>)</td></tr>
<tr><th id="1131">1131</th><td>				<a class="local col7 ref" href="#467migratetype" title='migratetype' data-ref="467migratetype">migratetype</a> = <var>0</var>;</td></tr>
<tr><th id="1132">1132</th><td>			<a class="local col1 ref" href="#471list" title='list' data-ref="471list">list</a> = &amp;<a class="local col6 ref" href="#466pcp" title='pcp' data-ref="466pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::lists" title='per_cpu_pages::lists' data-ref="per_cpu_pages::lists">lists</a>[<a class="local col7 ref" href="#467migratetype" title='migratetype' data-ref="467migratetype">migratetype</a>];</td></tr>
<tr><th id="1133">1133</th><td>		} <b>while</b> (<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(<a class="local col1 ref" href="#471list" title='list' data-ref="471list">list</a>));</td></tr>
<tr><th id="1134">1134</th><td></td></tr>
<tr><th id="1135">1135</th><td>		<i>/* This is the only non-empty list. Free them all. */</i></td></tr>
<tr><th id="1136">1136</th><td>		<b>if</b> (<a class="local col8 ref" href="#468batch_free" title='batch_free' data-ref="468batch_free">batch_free</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_PCPTYPES" title='MIGRATE_PCPTYPES' data-ref="MIGRATE_PCPTYPES">MIGRATE_PCPTYPES</a>)</td></tr>
<tr><th id="1137">1137</th><td>			<a class="local col8 ref" href="#468batch_free" title='batch_free' data-ref="468batch_free">batch_free</a> = <a class="local col5 ref" href="#465count" title='count' data-ref="465count">count</a>;</td></tr>
<tr><th id="1138">1138</th><td></td></tr>
<tr><th id="1139">1139</th><td>		<b>do</b> {</td></tr>
<tr><th id="1140">1140</th><td>			<em>int</em> <dfn class="local col2 decl" id="472mt" title='mt' data-type='int' data-ref="472mt">mt</dfn>;	<i>/* migratetype of the to-be-freed page */</i></td></tr>
<tr><th id="1141">1141</th><td></td></tr>
<tr><th id="1142">1142</th><td>			<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a> = <a class="macro" href="../include/linux/list.h.html#387" title="({ void *__mptr = (void *)((list)-&gt;prev); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((list)-&gt;prev)), typeof(((struct page *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((list)-&gt;prev)), typeof(void)))); extern void __compiletime_assert_1142(void) ; if (__cond) __compiletime_assert_1142(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((struct page *)(__mptr - __builtin_offsetof(struct page, lru))); })" data-ref="_M/list_last_entry">list_last_entry</a>(<a class="local col1 ref" href="#471list" title='list' data-ref="471list">list</a>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="1143">1143</th><td>			<i>/* must delete as __free_one_page list manipulates */</i></td></tr>
<tr><th id="1144">1144</th><td>			<a class="ref fn" href="../include/linux/list.h.html#list_del" title='list_del' data-ref="list_del">list_del</a>(&amp;<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="1145">1145</th><td></td></tr>
<tr><th id="1146">1146</th><td>			<a class="local col2 ref" href="#472mt" title='mt' data-ref="472mt">mt</a> = <a class="tu ref fn" href="#get_pcppage_migratetype" title='get_pcppage_migratetype' data-use='c' data-ref="get_pcppage_migratetype">get_pcppage_migratetype</a>(<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>);</td></tr>
<tr><th id="1147">1147</th><td>			<i>/* MIGRATE_ISOLATE page should not go to pcplists */</i></td></tr>
<tr><th id="1148">1148</th><td>			<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(is_migrate_isolate(mt)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col2 ref" href="#472mt" title='mt' data-ref="472mt">mt</a>), page);</td></tr>
<tr><th id="1149">1149</th><td>			<i>/* Pageblock could have been isolated meanwhile */</i></td></tr>
<tr><th id="1150">1150</th><td>			<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(isolated_pageblocks), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col9 ref" href="#469isolated_pageblocks" title='isolated_pageblocks' data-ref="469isolated_pageblocks">isolated_pageblocks</a>))</td></tr>
<tr><th id="1151">1151</th><td>				<a class="local col2 ref" href="#472mt" title='mt' data-ref="472mt">mt</a> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(page, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>);</td></tr>
<tr><th id="1152">1152</th><td></td></tr>
<tr><th id="1153">1153</th><td>			<b>if</b> (<a class="tu ref fn" href="#bulkfree_pcp_prepare" title='bulkfree_pcp_prepare' data-use='c' data-ref="bulkfree_pcp_prepare">bulkfree_pcp_prepare</a>(<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>))</td></tr>
<tr><th id="1154">1154</th><td>				<b>continue</b>;</td></tr>
<tr><th id="1155">1155</th><td></td></tr>
<tr><th id="1156">1156</th><td>			<a class="tu ref fn" href="#__free_one_page" title='__free_one_page' data-use='c' data-ref="__free_one_page">__free_one_page</a>(<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>, <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>), <a class="local col4 ref" href="#464zone" title='zone' data-ref="464zone">zone</a>, <var>0</var>, <a class="local col2 ref" href="#472mt" title='mt' data-ref="472mt">mt</a>);</td></tr>
<tr><th id="1157">1157</th><td>			<a class="ref fn" href="../include/trace/events/kmem.h.html#257" title='trace_mm_page_pcpu_drain' data-ref="trace_mm_page_pcpu_drain">trace_mm_page_pcpu_drain</a>(<a class="local col0 ref" href="#470page" title='page' data-ref="470page">page</a>, <var>0</var>, <a class="local col2 ref" href="#472mt" title='mt' data-ref="472mt">mt</a>);</td></tr>
<tr><th id="1158">1158</th><td>		} <b>while</b> (--<a class="local col5 ref" href="#465count" title='count' data-ref="465count">count</a> &amp;&amp; --<a class="local col8 ref" href="#468batch_free" title='batch_free' data-ref="468batch_free">batch_free</a> &amp;&amp; !<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(<a class="local col1 ref" href="#471list" title='list' data-ref="471list">list</a>));</td></tr>
<tr><th id="1159">1159</th><td>	}</td></tr>
<tr><th id="1160">1160</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col4 ref" href="#464zone" title='zone' data-ref="464zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="1161">1161</th><td>}</td></tr>
<tr><th id="1162">1162</th><td></td></tr>
<tr><th id="1163">1163</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="free_one_page" title='free_one_page' data-type='void free_one_page(struct zone * zone, struct page * page, unsigned long pfn, unsigned int order, int migratetype)' data-ref="free_one_page">free_one_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col3 decl" id="473zone" title='zone' data-type='struct zone *' data-ref="473zone">zone</dfn>,</td></tr>
<tr><th id="1164">1164</th><td>				<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="474page" title='page' data-type='struct page *' data-ref="474page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="475pfn" title='pfn' data-type='unsigned long' data-ref="475pfn">pfn</dfn>,</td></tr>
<tr><th id="1165">1165</th><td>				<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="476order" title='order' data-type='unsigned int' data-ref="476order">order</dfn>,</td></tr>
<tr><th id="1166">1166</th><td>				<em>int</em> <dfn class="local col7 decl" id="477migratetype" title='migratetype' data-type='int' data-ref="477migratetype">migratetype</dfn>)</td></tr>
<tr><th id="1167">1167</th><td>{</td></tr>
<tr><th id="1168">1168</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="local col3 ref" href="#473zone" title='zone' data-ref="473zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="1169">1169</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(has_isolate_pageblock(zone) || is_migrate_isolate(migratetype)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/page-isolation.h.html#has_isolate_pageblock" title='has_isolate_pageblock' data-ref="has_isolate_pageblock">has_isolate_pageblock</a>(<a class="local col3 ref" href="#473zone" title='zone' data-ref="473zone">zone</a>) ||</td></tr>
<tr><th id="1170">1170</th><td>		<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col7 ref" href="#477migratetype" title='migratetype' data-ref="477migratetype">migratetype</a>))) {</td></tr>
<tr><th id="1171">1171</th><td>		<a class="local col7 ref" href="#477migratetype" title='migratetype' data-ref="477migratetype">migratetype</a> = <a class="tu ref fn" href="#get_pfnblock_migratetype" title='get_pfnblock_migratetype' data-use='c' data-ref="get_pfnblock_migratetype">get_pfnblock_migratetype</a>(<a class="local col4 ref" href="#474page" title='page' data-ref="474page">page</a>, <a class="local col5 ref" href="#475pfn" title='pfn' data-ref="475pfn">pfn</a>);</td></tr>
<tr><th id="1172">1172</th><td>	}</td></tr>
<tr><th id="1173">1173</th><td>	<a class="tu ref fn" href="#__free_one_page" title='__free_one_page' data-use='c' data-ref="__free_one_page">__free_one_page</a>(<a class="local col4 ref" href="#474page" title='page' data-ref="474page">page</a>, <a class="local col5 ref" href="#475pfn" title='pfn' data-ref="475pfn">pfn</a>, <a class="local col3 ref" href="#473zone" title='zone' data-ref="473zone">zone</a>, <a class="local col6 ref" href="#476order" title='order' data-ref="476order">order</a>, <a class="local col7 ref" href="#477migratetype" title='migratetype' data-ref="477migratetype">migratetype</a>);</td></tr>
<tr><th id="1174">1174</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col3 ref" href="#473zone" title='zone' data-ref="473zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="1175">1175</th><td>}</td></tr>
<tr><th id="1176">1176</th><td></td></tr>
<tr><th id="1177">1177</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="__init_single_page" title='__init_single_page' data-type='void __init_single_page(struct page * page, unsigned long pfn, unsigned long zone, int nid)' data-ref="__init_single_page">__init_single_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="478page" title='page' data-type='struct page *' data-ref="478page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="479pfn" title='pfn' data-type='unsigned long' data-ref="479pfn">pfn</dfn>,</td></tr>
<tr><th id="1178">1178</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="480zone" title='zone' data-type='unsigned long' data-ref="480zone">zone</dfn>, <em>int</em> <dfn class="local col1 decl" id="481nid" title='nid' data-type='int' data-ref="481nid">nid</dfn>)</td></tr>
<tr><th id="1179">1179</th><td>{</td></tr>
<tr><th id="1180">1180</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#set_page_links" title='set_page_links' data-ref="set_page_links">set_page_links</a>(<a class="local col8 ref" href="#478page" title='page' data-ref="478page">page</a>, <a class="local col0 ref" href="#480zone" title='zone' data-ref="480zone">zone</a>, <a class="local col1 ref" href="#481nid" title='nid' data-ref="481nid">nid</a>, <a class="local col9 ref" href="#479pfn" title='pfn' data-ref="479pfn">pfn</a>);</td></tr>
<tr><th id="1181">1181</th><td>	<a class="ref fn" href="../include/linux/page_ref.h.html#init_page_count" title='init_page_count' data-ref="init_page_count">init_page_count</a>(<a class="local col8 ref" href="#478page" title='page' data-ref="478page">page</a>);</td></tr>
<tr><th id="1182">1182</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#page_mapcount_reset" title='page_mapcount_reset' data-ref="page_mapcount_reset">page_mapcount_reset</a>(<a class="local col8 ref" href="#478page" title='page' data-ref="478page">page</a>);</td></tr>
<tr><th id="1183">1183</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#page_cpupid_reset_last" title='page_cpupid_reset_last' data-ref="page_cpupid_reset_last">page_cpupid_reset_last</a>(<a class="local col8 ref" href="#478page" title='page' data-ref="478page">page</a>);</td></tr>
<tr><th id="1184">1184</th><td></td></tr>
<tr><th id="1185">1185</th><td>	<a class="ref fn" href="../include/linux/list.h.html#INIT_LIST_HEAD" title='INIT_LIST_HEAD' data-ref="INIT_LIST_HEAD">INIT_LIST_HEAD</a>(&amp;<a class="local col8 ref" href="#478page" title='page' data-ref="478page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="1186">1186</th><td><u>#<span data-ppcond="1186">ifdef</span> <span class="macro" data-ref="_M/WANT_PAGE_VIRTUAL">WANT_PAGE_VIRTUAL</span></u></td></tr>
<tr><th id="1187">1187</th><td>	<i>/* The shift won't overflow because ZONE_NORMAL is below 4G. */</i></td></tr>
<tr><th id="1188">1188</th><td>	<b>if</b> (!is_highmem_idx(zone))</td></tr>
<tr><th id="1189">1189</th><td>		set_page_address(page, __va(pfn &lt;&lt; PAGE_SHIFT));</td></tr>
<tr><th id="1190">1190</th><td><u>#<span data-ppcond="1186">endif</span></u></td></tr>
<tr><th id="1191">1191</th><td>}</td></tr>
<tr><th id="1192">1192</th><td></td></tr>
<tr><th id="1193">1193</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="__init_single_pfn" title='__init_single_pfn' data-type='void __init_single_pfn(unsigned long pfn, unsigned long zone, int nid)' data-ref="__init_single_pfn">__init_single_pfn</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="482pfn" title='pfn' data-type='unsigned long' data-ref="482pfn">pfn</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="483zone" title='zone' data-type='unsigned long' data-ref="483zone">zone</dfn>,</td></tr>
<tr><th id="1194">1194</th><td>					<em>int</em> <dfn class="local col4 decl" id="484nid" title='nid' data-type='int' data-ref="484nid">nid</dfn>)</td></tr>
<tr><th id="1195">1195</th><td>{</td></tr>
<tr><th id="1196">1196</th><td>	<b>return</b> <a class="tu ref fn" href="#__init_single_page" title='__init_single_page' data-use='c' data-ref="__init_single_page">__init_single_page</a>(<a class="macro" href="../include/asm-generic/memory_model.h.html#82" title="__pfn_to_page" data-ref="_M/pfn_to_page">pfn_to_page</a>(<a class="local col2 ref" href="#482pfn" title='pfn' data-ref="482pfn">pfn</a>), <a class="local col2 ref" href="#482pfn" title='pfn' data-ref="482pfn">pfn</a>, <a class="local col3 ref" href="#483zone" title='zone' data-ref="483zone">zone</a>, <a class="local col4 ref" href="#484nid" title='nid' data-ref="484nid">nid</a>);</td></tr>
<tr><th id="1197">1197</th><td>}</td></tr>
<tr><th id="1198">1198</th><td></td></tr>
<tr><th id="1199">1199</th><td><u>#<span data-ppcond="1199">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEFERRED_STRUCT_PAGE_INIT">CONFIG_DEFERRED_STRUCT_PAGE_INIT</span></u></td></tr>
<tr><th id="1200">1200</th><td><em>static</em> <em>void</em> __meminit init_reserved_page(<em>unsigned</em> <em>long</em> pfn)</td></tr>
<tr><th id="1201">1201</th><td>{</td></tr>
<tr><th id="1202">1202</th><td>	pg_data_t *pgdat;</td></tr>
<tr><th id="1203">1203</th><td>	<em>int</em> nid, zid;</td></tr>
<tr><th id="1204">1204</th><td></td></tr>
<tr><th id="1205">1205</th><td>	<b>if</b> (!early_page_uninitialised(pfn))</td></tr>
<tr><th id="1206">1206</th><td>		<b>return</b>;</td></tr>
<tr><th id="1207">1207</th><td></td></tr>
<tr><th id="1208">1208</th><td>	nid = early_pfn_to_nid(pfn);</td></tr>
<tr><th id="1209">1209</th><td>	pgdat = NODE_DATA(nid);</td></tr>
<tr><th id="1210">1210</th><td></td></tr>
<tr><th id="1211">1211</th><td>	<b>for</b> (zid = <var>0</var>; zid &lt; MAX_NR_ZONES; zid++) {</td></tr>
<tr><th id="1212">1212</th><td>		<b>struct</b> zone *zone = &amp;pgdat-&gt;node_zones[zid];</td></tr>
<tr><th id="1213">1213</th><td></td></tr>
<tr><th id="1214">1214</th><td>		<b>if</b> (pfn &gt;= zone-&gt;zone_start_pfn &amp;&amp; pfn &lt; zone_end_pfn(zone))</td></tr>
<tr><th id="1215">1215</th><td>			<b>break</b>;</td></tr>
<tr><th id="1216">1216</th><td>	}</td></tr>
<tr><th id="1217">1217</th><td>	__init_single_pfn(pfn, zid, nid);</td></tr>
<tr><th id="1218">1218</th><td>}</td></tr>
<tr><th id="1219">1219</th><td><u>#<span data-ppcond="1199">else</span></u></td></tr>
<tr><th id="1220">1220</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="init_reserved_page" title='init_reserved_page' data-type='void init_reserved_page(unsigned long pfn)' data-ref="init_reserved_page">init_reserved_page</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="485pfn" title='pfn' data-type='unsigned long' data-ref="485pfn">pfn</dfn>)</td></tr>
<tr><th id="1221">1221</th><td>{</td></tr>
<tr><th id="1222">1222</th><td>}</td></tr>
<tr><th id="1223">1223</th><td><u>#<span data-ppcond="1199">endif</span> /* CONFIG_DEFERRED_STRUCT_PAGE_INIT */</u></td></tr>
<tr><th id="1224">1224</th><td></td></tr>
<tr><th id="1225">1225</th><td><i>/*</i></td></tr>
<tr><th id="1226">1226</th><td><i> * Initialised pages do not have PageReserved set. This function is</i></td></tr>
<tr><th id="1227">1227</th><td><i> * called for each range allocated by the bootmem allocator and</i></td></tr>
<tr><th id="1228">1228</th><td><i> * marks the pages PageReserved. The remaining valid pages are later</i></td></tr>
<tr><th id="1229">1229</th><td><i> * sent to the buddy page allocator.</i></td></tr>
<tr><th id="1230">1230</th><td><i> */</i></td></tr>
<tr><th id="1231">1231</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="reserve_bootmem_region" title='reserve_bootmem_region' data-ref="reserve_bootmem_region">reserve_bootmem_region</dfn>(<a class="typedef" href="../include/linux/types.h.html#phys_addr_t" title='phys_addr_t' data-type='u64' data-ref="phys_addr_t">phys_addr_t</a> <dfn class="local col6 decl" id="486start" title='start' data-type='phys_addr_t' data-ref="486start">start</dfn>, <a class="typedef" href="../include/linux/types.h.html#phys_addr_t" title='phys_addr_t' data-type='u64' data-ref="phys_addr_t">phys_addr_t</a> <dfn class="local col7 decl" id="487end" title='end' data-type='phys_addr_t' data-ref="487end">end</dfn>)</td></tr>
<tr><th id="1232">1232</th><td>{</td></tr>
<tr><th id="1233">1233</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="488start_pfn" title='start_pfn' data-type='unsigned long' data-ref="488start_pfn">start_pfn</dfn> = <a class="macro" href="../include/linux/pfn.h.html#20" title="((start) &gt;&gt; 12)" data-ref="_M/PFN_DOWN">PFN_DOWN</a>(<a class="local col6 ref" href="#486start" title='start' data-ref="486start">start</a>);</td></tr>
<tr><th id="1234">1234</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="489end_pfn" title='end_pfn' data-type='unsigned long' data-ref="489end_pfn">end_pfn</dfn> = <a class="macro" href="../include/linux/pfn.h.html#19" title="(((end) + ((1UL) &lt;&lt; 12)-1) &gt;&gt; 12)" data-ref="_M/PFN_UP">PFN_UP</a>(<a class="local col7 ref" href="#487end" title='end' data-ref="487end">end</a>);</td></tr>
<tr><th id="1235">1235</th><td></td></tr>
<tr><th id="1236">1236</th><td>	<b>for</b> (; <a class="local col8 ref" href="#488start_pfn" title='start_pfn' data-ref="488start_pfn">start_pfn</a> &lt; <a class="local col9 ref" href="#489end_pfn" title='end_pfn' data-ref="489end_pfn">end_pfn</a>; <a class="local col8 ref" href="#488start_pfn" title='start_pfn' data-ref="488start_pfn">start_pfn</a>++) {</td></tr>
<tr><th id="1237">1237</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mmzone.h.html#pfn_valid" title='pfn_valid' data-ref="pfn_valid">pfn_valid</a>(<a class="local col8 ref" href="#488start_pfn" title='start_pfn' data-ref="488start_pfn">start_pfn</a>)) {</td></tr>
<tr><th id="1238">1238</th><td>			<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="490page" title='page' data-type='struct page *' data-ref="490page">page</dfn> = <a class="macro" href="../include/asm-generic/memory_model.h.html#82" title="__pfn_to_page" data-ref="_M/pfn_to_page">pfn_to_page</a>(<a class="local col8 ref" href="#488start_pfn" title='start_pfn' data-ref="488start_pfn">start_pfn</a>);</td></tr>
<tr><th id="1239">1239</th><td></td></tr>
<tr><th id="1240">1240</th><td>			<a class="tu ref fn" href="#init_reserved_page" title='init_reserved_page' data-use='c' data-ref="init_reserved_page">init_reserved_page</a>(<a class="local col8 ref" href="#488start_pfn" title='start_pfn' data-ref="488start_pfn">start_pfn</a>);</td></tr>
<tr><th id="1241">1241</th><td></td></tr>
<tr><th id="1242">1242</th><td>			<i>/* Avoid false-positive PageTail() */</i></td></tr>
<tr><th id="1243">1243</th><td>			<a class="ref fn" href="../include/linux/list.h.html#INIT_LIST_HEAD" title='INIT_LIST_HEAD' data-ref="INIT_LIST_HEAD">INIT_LIST_HEAD</a>(&amp;<a class="local col0 ref" href="#490page" title='page' data-ref="490page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="1244">1244</th><td></td></tr>
<tr><th id="1245">1245</th><td>			<a class="ref fn" href="../include/linux/page-flags.h.html#286" title='SetPageReserved' data-ref="SetPageReserved">SetPageReserved</a>(<a class="local col0 ref" href="#490page" title='page' data-ref="490page">page</a>);</td></tr>
<tr><th id="1246">1246</th><td>		}</td></tr>
<tr><th id="1247">1247</th><td>	}</td></tr>
<tr><th id="1248">1248</th><td>}</td></tr>
<tr><th id="1249">1249</th><td></td></tr>
<tr><th id="1250">1250</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="__free_pages_ok" title='__free_pages_ok' data-type='void __free_pages_ok(struct page * page, unsigned int order)' data-ref="__free_pages_ok">__free_pages_ok</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="491page" title='page' data-type='struct page *' data-ref="491page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col2 decl" id="492order" title='order' data-type='unsigned int' data-ref="492order">order</dfn>)</td></tr>
<tr><th id="1251">1251</th><td>{</td></tr>
<tr><th id="1252">1252</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="493flags" title='flags' data-type='unsigned long' data-ref="493flags">flags</dfn>;</td></tr>
<tr><th id="1253">1253</th><td>	<em>int</em> <dfn class="local col4 decl" id="494migratetype" title='migratetype' data-type='int' data-ref="494migratetype">migratetype</dfn>;</td></tr>
<tr><th id="1254">1254</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="495pfn" title='pfn' data-type='unsigned long' data-ref="495pfn">pfn</dfn> = <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col1 ref" href="#491page" title='page' data-ref="491page">page</a>);</td></tr>
<tr><th id="1255">1255</th><td></td></tr>
<tr><th id="1256">1256</th><td>	<b>if</b> (!<a class="tu ref fn" href="#free_pages_prepare" title='free_pages_prepare' data-use='c' data-ref="free_pages_prepare">free_pages_prepare</a>(<a class="local col1 ref" href="#491page" title='page' data-ref="491page">page</a>, <a class="local col2 ref" href="#492order" title='order' data-ref="492order">order</a>, <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>))</td></tr>
<tr><th id="1257">1257</th><td>		<b>return</b>;</td></tr>
<tr><th id="1258">1258</th><td></td></tr>
<tr><th id="1259">1259</th><td>	<a class="local col4 ref" href="#494migratetype" title='migratetype' data-ref="494migratetype">migratetype</a> = <a class="tu ref fn" href="#get_pfnblock_migratetype" title='get_pfnblock_migratetype' data-use='c' data-ref="get_pfnblock_migratetype">get_pfnblock_migratetype</a>(<a class="local col1 ref" href="#491page" title='page' data-ref="491page">page</a>, <a class="local col5 ref" href="#495pfn" title='pfn' data-ref="495pfn">pfn</a>);</td></tr>
<tr><th id="1260">1260</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#139" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = arch_local_irq_save(); } while (0); } while (0)" data-ref="_M/local_irq_save">local_irq_save</a>(<a class="local col3 ref" href="#493flags" title='flags' data-ref="493flags">flags</a>);</td></tr>
<tr><th id="1261">1261</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#__count_vm_events" title='__count_vm_events' data-ref="__count_vm_events">__count_vm_events</a>(<a class="enum" href="../include/linux/vm_event_item.h.html#PGFREE" title='PGFREE' data-ref="PGFREE">PGFREE</a>, <var>1</var> &lt;&lt; <a class="local col2 ref" href="#492order" title='order' data-ref="492order">order</a>);</td></tr>
<tr><th id="1262">1262</th><td>	<a class="tu ref fn" href="#free_one_page" title='free_one_page' data-use='c' data-ref="free_one_page">free_one_page</a>(<a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col1 ref" href="#491page" title='page' data-ref="491page">page</a>), <a class="local col1 ref" href="#491page" title='page' data-ref="491page">page</a>, <a class="local col5 ref" href="#495pfn" title='pfn' data-ref="495pfn">pfn</a>, <a class="local col2 ref" href="#492order" title='order' data-ref="492order">order</a>, <a class="local col4 ref" href="#494migratetype" title='migratetype' data-ref="494migratetype">migratetype</a>);</td></tr>
<tr><th id="1263">1263</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col3 ref" href="#493flags" title='flags' data-ref="493flags">flags</a>);</td></tr>
<tr><th id="1264">1264</th><td>}</td></tr>
<tr><th id="1265">1265</th><td></td></tr>
<tr><th id="1266">1266</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="__free_pages_boot_core" title='__free_pages_boot_core' data-type='void __free_pages_boot_core(struct page * page, unsigned int order)' data-ref="__free_pages_boot_core">__free_pages_boot_core</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="496page" title='page' data-type='struct page *' data-ref="496page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="497order" title='order' data-type='unsigned int' data-ref="497order">order</dfn>)</td></tr>
<tr><th id="1267">1267</th><td>{</td></tr>
<tr><th id="1268">1268</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="498nr_pages" title='nr_pages' data-type='unsigned int' data-ref="498nr_pages">nr_pages</dfn> = <var>1</var> &lt;&lt; <a class="local col7 ref" href="#497order" title='order' data-ref="497order">order</a>;</td></tr>
<tr><th id="1269">1269</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="499p" title='p' data-type='struct page *' data-ref="499p">p</dfn> = <a class="local col6 ref" href="#496page" title='page' data-ref="496page">page</a>;</td></tr>
<tr><th id="1270">1270</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="500loop" title='loop' data-type='unsigned int' data-ref="500loop">loop</dfn>;</td></tr>
<tr><th id="1271">1271</th><td></td></tr>
<tr><th id="1272">1272</th><td>	<a class="ref fn" href="../arch/x86/include/asm/processor.h.html#prefetchw" title='prefetchw' data-ref="prefetchw">prefetchw</a>(<a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a>);</td></tr>
<tr><th id="1273">1273</th><td>	<b>for</b> (<a class="local col0 ref" href="#500loop" title='loop' data-ref="500loop">loop</a> = <var>0</var>; <a class="local col0 ref" href="#500loop" title='loop' data-ref="500loop">loop</a> &lt; (<a class="local col8 ref" href="#498nr_pages" title='nr_pages' data-ref="498nr_pages">nr_pages</a> - <var>1</var>); <a class="local col0 ref" href="#500loop" title='loop' data-ref="500loop">loop</a>++, <a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a>++) {</td></tr>
<tr><th id="1274">1274</th><td>		<a class="ref fn" href="../arch/x86/include/asm/processor.h.html#prefetchw" title='prefetchw' data-ref="prefetchw">prefetchw</a>(<a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a> + <var>1</var>);</td></tr>
<tr><th id="1275">1275</th><td>		<a class="ref fn" href="../include/linux/page-flags.h.html#287" title='__ClearPageReserved' data-ref="__ClearPageReserved">__ClearPageReserved</a>(<a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a>);</td></tr>
<tr><th id="1276">1276</th><td>		<a class="ref fn" href="../include/linux/page_ref.h.html#set_page_count" title='set_page_count' data-ref="set_page_count">set_page_count</a>(<a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a>, <var>0</var>);</td></tr>
<tr><th id="1277">1277</th><td>	}</td></tr>
<tr><th id="1278">1278</th><td>	<a class="ref fn" href="../include/linux/page-flags.h.html#287" title='__ClearPageReserved' data-ref="__ClearPageReserved">__ClearPageReserved</a>(<a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a>);</td></tr>
<tr><th id="1279">1279</th><td>	<a class="ref fn" href="../include/linux/page_ref.h.html#set_page_count" title='set_page_count' data-ref="set_page_count">set_page_count</a>(<a class="local col9 ref" href="#499p" title='p' data-ref="499p">p</a>, <var>0</var>);</td></tr>
<tr><th id="1280">1280</th><td></td></tr>
<tr><th id="1281">1281</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col6 ref" href="#496page" title='page' data-ref="496page">page</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> += <a class="local col8 ref" href="#498nr_pages" title='nr_pages' data-ref="498nr_pages">nr_pages</a>;</td></tr>
<tr><th id="1282">1282</th><td>	<a class="ref fn" href="internal.h.html#set_page_refcounted" title='set_page_refcounted' data-ref="set_page_refcounted">set_page_refcounted</a>(<a class="local col6 ref" href="#496page" title='page' data-ref="496page">page</a>);</td></tr>
<tr><th id="1283">1283</th><td>	<a class="ref fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages">__free_pages</a>(<a class="local col6 ref" href="#496page" title='page' data-ref="496page">page</a>, <a class="local col7 ref" href="#497order" title='order' data-ref="497order">order</a>);</td></tr>
<tr><th id="1284">1284</th><td>}</td></tr>
<tr><th id="1285">1285</th><td></td></tr>
<tr><th id="1286">1286</th><td><u>#<span data-ppcond="1286">if</span> defined(<span class="macro" data-ref="_M/CONFIG_HAVE_ARCH_EARLY_PFN_TO_NID">CONFIG_HAVE_ARCH_EARLY_PFN_TO_NID</span>) || \</u></td></tr>
<tr><th id="1287">1287</th><td><u>	defined(<a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a>)</u></td></tr>
<tr><th id="1288">1288</th><td></td></tr>
<tr><th id="1289">1289</th><td><em>static</em> <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache" title='mminit_pfnnid_cache' data-ref="mminit_pfnnid_cache">mminit_pfnnid_cache</a> <dfn class="tu decl def" id="early_pfnnid_cache" title='early_pfnnid_cache' data-type='struct mminit_pfnnid_cache' data-ref="early_pfnnid_cache">early_pfnnid_cache</dfn> <a class="macro" href="../include/linux/init.h.html#90" title="__attribute__ ((__section__(&quot;.meminit.data&quot;)))" data-ref="_M/__meminitdata">__meminitdata</a>;</td></tr>
<tr><th id="1290">1290</th><td></td></tr>
<tr><th id="1291">1291</th><td><em>int</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="early_pfn_to_nid" title='early_pfn_to_nid' data-ref="early_pfn_to_nid">early_pfn_to_nid</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="501pfn" title='pfn' data-type='unsigned long' data-ref="501pfn">pfn</dfn>)</td></tr>
<tr><th id="1292">1292</th><td>{</td></tr>
<tr><th id="1293">1293</th><td>	<em>static</em> <a class="macro" href="../include/linux/spinlock_types.h.html#84" title="spinlock_t early_pfn_lock = (spinlock_t ) { { .rlock = { .raw_lock = { { (0) } }, } } }" data-ref="_M/DEFINE_SPINLOCK">DEFINE_SPINLOCK</a>(<dfn class="local col2 decl" id="502early_pfn_lock" title='early_pfn_lock' data-type='spinlock_t' data-ref="502early_pfn_lock">early_pfn_lock</dfn>);</td></tr>
<tr><th id="1294">1294</th><td>	<em>int</em> <dfn class="local col3 decl" id="503nid" title='nid' data-type='int' data-ref="503nid">nid</dfn>;</td></tr>
<tr><th id="1295">1295</th><td></td></tr>
<tr><th id="1296">1296</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="local col2 ref" href="#1293" title='early_pfn_lock' data-ref="502early_pfn_lock">early_pfn_lock</a>);</td></tr>
<tr><th id="1297">1297</th><td>	<a class="local col3 ref" href="#503nid" title='nid' data-ref="503nid">nid</a> = <a class="ref fn" href="#__early_pfn_to_nid" title='__early_pfn_to_nid' data-ref="__early_pfn_to_nid">__early_pfn_to_nid</a>(<a class="local col1 ref" href="#501pfn" title='pfn' data-ref="501pfn">pfn</a>, &amp;<a class="tu ref" href="#early_pfnnid_cache" title='early_pfnnid_cache' data-use='a' data-ref="early_pfnnid_cache">early_pfnnid_cache</a>);</td></tr>
<tr><th id="1298">1298</th><td>	<b>if</b> (<a class="local col3 ref" href="#503nid" title='nid' data-ref="503nid">nid</a> &lt; <var>0</var>)</td></tr>
<tr><th id="1299">1299</th><td>		<a class="local col3 ref" href="#503nid" title='nid' data-ref="503nid">nid</a> = <a class="macro" href="../include/linux/nodemask.h.html#476" title="0" data-ref="_M/first_online_node">first_online_node</a>;</td></tr>
<tr><th id="1300">1300</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col2 ref" href="#1293" title='early_pfn_lock' data-ref="502early_pfn_lock">early_pfn_lock</a>);</td></tr>
<tr><th id="1301">1301</th><td></td></tr>
<tr><th id="1302">1302</th><td>	<b>return</b> <a class="local col3 ref" href="#503nid" title='nid' data-ref="503nid">nid</a>;</td></tr>
<tr><th id="1303">1303</th><td>}</td></tr>
<tr><th id="1304">1304</th><td><u>#<span data-ppcond="1286">endif</span></u></td></tr>
<tr><th id="1305">1305</th><td></td></tr>
<tr><th id="1306">1306</th><td><u>#<span data-ppcond="1306">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NODES_SPAN_OTHER_NODES">CONFIG_NODES_SPAN_OTHER_NODES</span></u></td></tr>
<tr><th id="1307">1307</th><td><em>static</em> <b>inline</b> bool __meminit __maybe_unused</td></tr>
<tr><th id="1308">1308</th><td>meminit_pfn_in_nid(<em>unsigned</em> <em>long</em> pfn, <em>int</em> node,</td></tr>
<tr><th id="1309">1309</th><td>		   <b>struct</b> mminit_pfnnid_cache *state)</td></tr>
<tr><th id="1310">1310</th><td>{</td></tr>
<tr><th id="1311">1311</th><td>	<em>int</em> nid;</td></tr>
<tr><th id="1312">1312</th><td></td></tr>
<tr><th id="1313">1313</th><td>	nid = __early_pfn_to_nid(pfn, state);</td></tr>
<tr><th id="1314">1314</th><td>	<b>if</b> (nid &gt;= <var>0</var> &amp;&amp; nid != node)</td></tr>
<tr><th id="1315">1315</th><td>		<b>return</b> false;</td></tr>
<tr><th id="1316">1316</th><td>	<b>return</b> true;</td></tr>
<tr><th id="1317">1317</th><td>}</td></tr>
<tr><th id="1318">1318</th><td></td></tr>
<tr><th id="1319">1319</th><td><i>/* Only safe to use early in boot when initialisation is single-threaded */</i></td></tr>
<tr><th id="1320">1320</th><td><em>static</em> <b>inline</b> bool __meminit early_pfn_in_nid(<em>unsigned</em> <em>long</em> pfn, <em>int</em> node)</td></tr>
<tr><th id="1321">1321</th><td>{</td></tr>
<tr><th id="1322">1322</th><td>	<b>return</b> meminit_pfn_in_nid(pfn, node, &amp;early_pfnnid_cache);</td></tr>
<tr><th id="1323">1323</th><td>}</td></tr>
<tr><th id="1324">1324</th><td></td></tr>
<tr><th id="1325">1325</th><td><u>#<span data-ppcond="1306">else</span></u></td></tr>
<tr><th id="1326">1326</th><td></td></tr>
<tr><th id="1327">1327</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="early_pfn_in_nid" title='early_pfn_in_nid' data-type='bool early_pfn_in_nid(unsigned long pfn, int node)' data-ref="early_pfn_in_nid">early_pfn_in_nid</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="504pfn" title='pfn' data-type='unsigned long' data-ref="504pfn">pfn</dfn>, <em>int</em> <dfn class="local col5 decl" id="505node" title='node' data-type='int' data-ref="505node">node</dfn>)</td></tr>
<tr><th id="1328">1328</th><td>{</td></tr>
<tr><th id="1329">1329</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1330">1330</th><td>}</td></tr>
<tr><th id="1331">1331</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a>  <a class="macro" href="../include/linux/compiler-gcc.h.html#147" title="__attribute__((unused))" data-ref="_M/__maybe_unused">__maybe_unused</a></td></tr>
<tr><th id="1332">1332</th><td><dfn class="tu decl def fn" id="meminit_pfn_in_nid" title='meminit_pfn_in_nid' data-type='bool meminit_pfn_in_nid(unsigned long pfn, int node, struct mminit_pfnnid_cache * state)' data-ref="meminit_pfn_in_nid">meminit_pfn_in_nid</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="506pfn" title='pfn' data-type='unsigned long' data-ref="506pfn">pfn</dfn>, <em>int</em> <dfn class="local col7 decl" id="507node" title='node' data-type='int' data-ref="507node">node</dfn>,</td></tr>
<tr><th id="1333">1333</th><td>		   <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache" title='mminit_pfnnid_cache' data-ref="mminit_pfnnid_cache">mminit_pfnnid_cache</a> *<dfn class="local col8 decl" id="508state" title='state' data-type='struct mminit_pfnnid_cache *' data-ref="508state">state</dfn>)</td></tr>
<tr><th id="1334">1334</th><td>{</td></tr>
<tr><th id="1335">1335</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1336">1336</th><td>}</td></tr>
<tr><th id="1337">1337</th><td><u>#<span data-ppcond="1306">endif</span></u></td></tr>
<tr><th id="1338">1338</th><td></td></tr>
<tr><th id="1339">1339</th><td></td></tr>
<tr><th id="1340">1340</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="__free_pages_bootmem" title='__free_pages_bootmem' data-ref="__free_pages_bootmem">__free_pages_bootmem</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="509page" title='page' data-type='struct page *' data-ref="509page">page</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="510pfn" title='pfn' data-type='unsigned long' data-ref="510pfn">pfn</dfn>,</td></tr>
<tr><th id="1341">1341</th><td>							<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="511order" title='order' data-type='unsigned int' data-ref="511order">order</dfn>)</td></tr>
<tr><th id="1342">1342</th><td>{</td></tr>
<tr><th id="1343">1343</th><td>	<b>if</b> (<a class="tu ref fn" href="#early_page_uninitialised" title='early_page_uninitialised' data-use='c' data-ref="early_page_uninitialised">early_page_uninitialised</a>(<a class="local col0 ref" href="#510pfn" title='pfn' data-ref="510pfn">pfn</a>))</td></tr>
<tr><th id="1344">1344</th><td>		<b>return</b>;</td></tr>
<tr><th id="1345">1345</th><td>	<b>return</b> <a class="tu ref fn" href="#__free_pages_boot_core" title='__free_pages_boot_core' data-use='c' data-ref="__free_pages_boot_core">__free_pages_boot_core</a>(<a class="local col9 ref" href="#509page" title='page' data-ref="509page">page</a>, <a class="local col1 ref" href="#511order" title='order' data-ref="511order">order</a>);</td></tr>
<tr><th id="1346">1346</th><td>}</td></tr>
<tr><th id="1347">1347</th><td></td></tr>
<tr><th id="1348">1348</th><td><i>/*</i></td></tr>
<tr><th id="1349">1349</th><td><i> * Check that the whole (or subset of) a pageblock given by the interval of</i></td></tr>
<tr><th id="1350">1350</th><td><i> * [start_pfn, end_pfn) is valid and within the same zone, before scanning it</i></td></tr>
<tr><th id="1351">1351</th><td><i> * with the migration of free compaction scanner. The scanners then need to</i></td></tr>
<tr><th id="1352">1352</th><td><i> * use only pfn_valid_within() check for arches that allow holes within</i></td></tr>
<tr><th id="1353">1353</th><td><i> * pageblocks.</i></td></tr>
<tr><th id="1354">1354</th><td><i> *</i></td></tr>
<tr><th id="1355">1355</th><td><i> * Return struct page pointer of start_pfn, or NULL if checks were not passed.</i></td></tr>
<tr><th id="1356">1356</th><td><i> *</i></td></tr>
<tr><th id="1357">1357</th><td><i> * It's possible on some configurations to have a setup like node0 node1 node0</i></td></tr>
<tr><th id="1358">1358</th><td><i> * i.e. it's possible that all pages within a zones range of pages do not</i></td></tr>
<tr><th id="1359">1359</th><td><i> * belong to a single zone. We assume that a border between node0 and node1</i></td></tr>
<tr><th id="1360">1360</th><td><i> * can occur within a single pageblock, but not a node0 node1 node0</i></td></tr>
<tr><th id="1361">1361</th><td><i> * interleaving within a single pageblock. It is therefore sufficient to check</i></td></tr>
<tr><th id="1362">1362</th><td><i> * the first and last page of a pageblock and avoid checking each individual</i></td></tr>
<tr><th id="1363">1363</th><td><i> * page in a pageblock.</i></td></tr>
<tr><th id="1364">1364</th><td><i> */</i></td></tr>
<tr><th id="1365">1365</th><td><b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="decl def fn" id="__pageblock_pfn_to_page" title='__pageblock_pfn_to_page' data-ref="__pageblock_pfn_to_page">__pageblock_pfn_to_page</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="512start_pfn" title='start_pfn' data-type='unsigned long' data-ref="512start_pfn">start_pfn</dfn>,</td></tr>
<tr><th id="1366">1366</th><td>				     <em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="513end_pfn" title='end_pfn' data-type='unsigned long' data-ref="513end_pfn">end_pfn</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="514zone" title='zone' data-type='struct zone *' data-ref="514zone">zone</dfn>)</td></tr>
<tr><th id="1367">1367</th><td>{</td></tr>
<tr><th id="1368">1368</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="515start_page" title='start_page' data-type='struct page *' data-ref="515start_page">start_page</dfn>;</td></tr>
<tr><th id="1369">1369</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="516end_page" title='end_page' data-type='struct page *' data-ref="516end_page">end_page</dfn>;</td></tr>
<tr><th id="1370">1370</th><td></td></tr>
<tr><th id="1371">1371</th><td>	<i>/* end_pfn is one past the range we are checking */</i></td></tr>
<tr><th id="1372">1372</th><td>	<a class="local col3 ref" href="#513end_pfn" title='end_pfn' data-ref="513end_pfn">end_pfn</a>--;</td></tr>
<tr><th id="1373">1373</th><td></td></tr>
<tr><th id="1374">1374</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#pfn_valid" title='pfn_valid' data-ref="pfn_valid">pfn_valid</a>(<a class="local col2 ref" href="#512start_pfn" title='start_pfn' data-ref="512start_pfn">start_pfn</a>) || !<a class="ref fn" href="../include/linux/mmzone.h.html#pfn_valid" title='pfn_valid' data-ref="pfn_valid">pfn_valid</a>(<a class="local col3 ref" href="#513end_pfn" title='end_pfn' data-ref="513end_pfn">end_pfn</a>))</td></tr>
<tr><th id="1375">1375</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1376">1376</th><td></td></tr>
<tr><th id="1377">1377</th><td>	<a class="local col5 ref" href="#515start_page" title='start_page' data-ref="515start_page">start_page</a> = <a class="macro" href="../include/linux/memory_hotplug.h.html#238" title="({ struct page *___page = ((void *)0); if (pfn_valid(start_pfn)) ___page = (((struct page *)vmemmap_base) + (start_pfn)); ___page; })" data-ref="_M/pfn_to_online_page">pfn_to_online_page</a>(<a class="local col2 ref" href="#512start_pfn" title='start_pfn' data-ref="512start_pfn">start_pfn</a>);</td></tr>
<tr><th id="1378">1378</th><td>	<b>if</b> (!<a class="local col5 ref" href="#515start_page" title='start_page' data-ref="515start_page">start_page</a>)</td></tr>
<tr><th id="1379">1379</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1380">1380</th><td></td></tr>
<tr><th id="1381">1381</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col5 ref" href="#515start_page" title='start_page' data-ref="515start_page">start_page</a>) != <a class="local col4 ref" href="#514zone" title='zone' data-ref="514zone">zone</a>)</td></tr>
<tr><th id="1382">1382</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1383">1383</th><td></td></tr>
<tr><th id="1384">1384</th><td>	<a class="local col6 ref" href="#516end_page" title='end_page' data-ref="516end_page">end_page</a> = <a class="macro" href="../include/asm-generic/memory_model.h.html#82" title="__pfn_to_page" data-ref="_M/pfn_to_page">pfn_to_page</a>(<a class="local col3 ref" href="#513end_pfn" title='end_pfn' data-ref="513end_pfn">end_pfn</a>);</td></tr>
<tr><th id="1385">1385</th><td></td></tr>
<tr><th id="1386">1386</th><td>	<i>/* This gives a shorter code than deriving page_zone(end_page) */</i></td></tr>
<tr><th id="1387">1387</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#page_zone_id" title='page_zone_id' data-ref="page_zone_id">page_zone_id</a>(<a class="local col5 ref" href="#515start_page" title='start_page' data-ref="515start_page">start_page</a>) != <a class="ref fn" href="../include/linux/mm.h.html#page_zone_id" title='page_zone_id' data-ref="page_zone_id">page_zone_id</a>(<a class="local col6 ref" href="#516end_page" title='end_page' data-ref="516end_page">end_page</a>))</td></tr>
<tr><th id="1388">1388</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1389">1389</th><td></td></tr>
<tr><th id="1390">1390</th><td>	<b>return</b> <a class="local col5 ref" href="#515start_page" title='start_page' data-ref="515start_page">start_page</a>;</td></tr>
<tr><th id="1391">1391</th><td>}</td></tr>
<tr><th id="1392">1392</th><td></td></tr>
<tr><th id="1393">1393</th><td><em>void</em> <dfn class="decl def fn" id="set_zone_contiguous" title='set_zone_contiguous' data-ref="set_zone_contiguous">set_zone_contiguous</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="517zone" title='zone' data-type='struct zone *' data-ref="517zone">zone</dfn>)</td></tr>
<tr><th id="1394">1394</th><td>{</td></tr>
<tr><th id="1395">1395</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="518block_start_pfn" title='block_start_pfn' data-type='unsigned long' data-ref="518block_start_pfn">block_start_pfn</dfn> = <a class="local col7 ref" href="#517zone" title='zone' data-ref="517zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_start_pfn" title='zone::zone_start_pfn' data-ref="zone::zone_start_pfn">zone_start_pfn</a>;</td></tr>
<tr><th id="1396">1396</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="519block_end_pfn" title='block_end_pfn' data-type='unsigned long' data-ref="519block_end_pfn">block_end_pfn</dfn>;</td></tr>
<tr><th id="1397">1397</th><td></td></tr>
<tr><th id="1398">1398</th><td>	<a class="local col9 ref" href="#519block_end_pfn" title='block_end_pfn' data-ref="519block_end_pfn">block_end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#57" title="((((block_start_pfn + 1)) + ((typeof((block_start_pfn + 1)))(((1UL &lt;&lt; (21 - 12)))) - 1)) &amp; ~((typeof((block_start_pfn + 1)))(((1UL &lt;&lt; (21 - 12)))) - 1))" data-ref="_M/ALIGN">ALIGN</a>(<a class="local col8 ref" href="#518block_start_pfn" title='block_start_pfn' data-ref="518block_start_pfn">block_start_pfn</a> + <var>1</var>, <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>);</td></tr>
<tr><th id="1399">1399</th><td>	<b>for</b> (; <a class="local col8 ref" href="#518block_start_pfn" title='block_start_pfn' data-ref="518block_start_pfn">block_start_pfn</a> &lt; <a class="ref fn" href="../include/linux/mmzone.h.html#zone_end_pfn" title='zone_end_pfn' data-ref="zone_end_pfn">zone_end_pfn</a>(<a class="local col7 ref" href="#517zone" title='zone' data-ref="517zone">zone</a>);</td></tr>
<tr><th id="1400">1400</th><td>			<a class="local col8 ref" href="#518block_start_pfn" title='block_start_pfn' data-ref="518block_start_pfn">block_start_pfn</a> = <a class="local col9 ref" href="#519block_end_pfn" title='block_end_pfn' data-ref="519block_end_pfn">block_end_pfn</a>,</td></tr>
<tr><th id="1401">1401</th><td>			 <a class="local col9 ref" href="#519block_end_pfn" title='block_end_pfn' data-ref="519block_end_pfn">block_end_pfn</a> += <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>) {</td></tr>
<tr><th id="1402">1402</th><td></td></tr>
<tr><th id="1403">1403</th><td>		<a class="local col9 ref" href="#519block_end_pfn" title='block_end_pfn' data-ref="519block_end_pfn">block_end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(block_end_pfn) __UNIQUE_ID_min1_153 = (block_end_pfn); typeof(zone_end_pfn(zone)) __UNIQUE_ID_min2_154 = (zone_end_pfn(zone)); (void) (&amp;__UNIQUE_ID_min1_153 == &amp;__UNIQUE_ID_min2_154); __UNIQUE_ID_min1_153 &lt; __UNIQUE_ID_min2_154 ? __UNIQUE_ID_min1_153 : __UNIQUE_ID_min2_154; })" data-ref="_M/min">min</a>(<a class="local col9 ref" href="#519block_end_pfn" title='block_end_pfn' data-ref="519block_end_pfn">block_end_pfn</a>, <a class="ref fn" href="../include/linux/mmzone.h.html#zone_end_pfn" title='zone_end_pfn' data-ref="zone_end_pfn">zone_end_pfn</a>(<a class="local col7 ref" href="#517zone" title='zone' data-ref="517zone">zone</a>));</td></tr>
<tr><th id="1404">1404</th><td></td></tr>
<tr><th id="1405">1405</th><td>		<b>if</b> (!<a class="ref fn" href="#__pageblock_pfn_to_page" title='__pageblock_pfn_to_page' data-ref="__pageblock_pfn_to_page">__pageblock_pfn_to_page</a>(<a class="local col8 ref" href="#518block_start_pfn" title='block_start_pfn' data-ref="518block_start_pfn">block_start_pfn</a>,</td></tr>
<tr><th id="1406">1406</th><td>					     <a class="local col9 ref" href="#519block_end_pfn" title='block_end_pfn' data-ref="519block_end_pfn">block_end_pfn</a>, <a class="local col7 ref" href="#517zone" title='zone' data-ref="517zone">zone</a>))</td></tr>
<tr><th id="1407">1407</th><td>			<b>return</b>;</td></tr>
<tr><th id="1408">1408</th><td>	}</td></tr>
<tr><th id="1409">1409</th><td></td></tr>
<tr><th id="1410">1410</th><td>	<i>/* We confirm that there is no hole */</i></td></tr>
<tr><th id="1411">1411</th><td>	<a class="local col7 ref" href="#517zone" title='zone' data-ref="517zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::contiguous" title='zone::contiguous' data-ref="zone::contiguous">contiguous</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1412">1412</th><td>}</td></tr>
<tr><th id="1413">1413</th><td></td></tr>
<tr><th id="1414">1414</th><td><em>void</em> <dfn class="decl def fn" id="clear_zone_contiguous" title='clear_zone_contiguous' data-ref="clear_zone_contiguous">clear_zone_contiguous</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col0 decl" id="520zone" title='zone' data-type='struct zone *' data-ref="520zone">zone</dfn>)</td></tr>
<tr><th id="1415">1415</th><td>{</td></tr>
<tr><th id="1416">1416</th><td>	<a class="local col0 ref" href="#520zone" title='zone' data-ref="520zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::contiguous" title='zone::contiguous' data-ref="zone::contiguous">contiguous</a> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="1417">1417</th><td>}</td></tr>
<tr><th id="1418">1418</th><td></td></tr>
<tr><th id="1419">1419</th><td><u>#<span data-ppcond="1419">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEFERRED_STRUCT_PAGE_INIT">CONFIG_DEFERRED_STRUCT_PAGE_INIT</span></u></td></tr>
<tr><th id="1420">1420</th><td><em>static</em> <em>void</em> __init deferred_free_range(<b>struct</b> page *page,</td></tr>
<tr><th id="1421">1421</th><td>					<em>unsigned</em> <em>long</em> pfn, <em>int</em> nr_pages)</td></tr>
<tr><th id="1422">1422</th><td>{</td></tr>
<tr><th id="1423">1423</th><td>	<em>int</em> i;</td></tr>
<tr><th id="1424">1424</th><td></td></tr>
<tr><th id="1425">1425</th><td>	<b>if</b> (!page)</td></tr>
<tr><th id="1426">1426</th><td>		<b>return</b>;</td></tr>
<tr><th id="1427">1427</th><td></td></tr>
<tr><th id="1428">1428</th><td>	<i>/* Free a large naturally-aligned chunk if possible */</i></td></tr>
<tr><th id="1429">1429</th><td>	<b>if</b> (nr_pages == pageblock_nr_pages &amp;&amp;</td></tr>
<tr><th id="1430">1430</th><td>	    (pfn &amp; (pageblock_nr_pages - <var>1</var>)) == <var>0</var>) {</td></tr>
<tr><th id="1431">1431</th><td>		set_pageblock_migratetype(page, MIGRATE_MOVABLE);</td></tr>
<tr><th id="1432">1432</th><td>		__free_pages_boot_core(page, pageblock_order);</td></tr>
<tr><th id="1433">1433</th><td>		<b>return</b>;</td></tr>
<tr><th id="1434">1434</th><td>	}</td></tr>
<tr><th id="1435">1435</th><td></td></tr>
<tr><th id="1436">1436</th><td>	<b>for</b> (i = <var>0</var>; i &lt; nr_pages; i++, page++, pfn++) {</td></tr>
<tr><th id="1437">1437</th><td>		<b>if</b> ((pfn &amp; (pageblock_nr_pages - <var>1</var>)) == <var>0</var>)</td></tr>
<tr><th id="1438">1438</th><td>			set_pageblock_migratetype(page, MIGRATE_MOVABLE);</td></tr>
<tr><th id="1439">1439</th><td>		__free_pages_boot_core(page, <var>0</var>);</td></tr>
<tr><th id="1440">1440</th><td>	}</td></tr>
<tr><th id="1441">1441</th><td>}</td></tr>
<tr><th id="1442">1442</th><td></td></tr>
<tr><th id="1443">1443</th><td><i>/* Completion tracking for deferred_init_memmap() threads */</i></td></tr>
<tr><th id="1444">1444</th><td><em>static</em> atomic_t pgdat_init_n_undone __initdata;</td></tr>
<tr><th id="1445">1445</th><td><em>static</em> __initdata DECLARE_COMPLETION(pgdat_init_all_done_comp);</td></tr>
<tr><th id="1446">1446</th><td></td></tr>
<tr><th id="1447">1447</th><td><em>static</em> <b>inline</b> <em>void</em> __init pgdat_init_report_one_done(<em>void</em>)</td></tr>
<tr><th id="1448">1448</th><td>{</td></tr>
<tr><th id="1449">1449</th><td>	<b>if</b> (atomic_dec_and_test(&amp;pgdat_init_n_undone))</td></tr>
<tr><th id="1450">1450</th><td>		complete(&amp;pgdat_init_all_done_comp);</td></tr>
<tr><th id="1451">1451</th><td>}</td></tr>
<tr><th id="1452">1452</th><td></td></tr>
<tr><th id="1453">1453</th><td><i>/* Initialise remaining memory on a node */</i></td></tr>
<tr><th id="1454">1454</th><td><em>static</em> <em>int</em> __init deferred_init_memmap(<em>void</em> *data)</td></tr>
<tr><th id="1455">1455</th><td>{</td></tr>
<tr><th id="1456">1456</th><td>	pg_data_t *pgdat = data;</td></tr>
<tr><th id="1457">1457</th><td>	<em>int</em> nid = pgdat-&gt;node_id;</td></tr>
<tr><th id="1458">1458</th><td>	<b>struct</b> mminit_pfnnid_cache nid_init_state = { };</td></tr>
<tr><th id="1459">1459</th><td>	<em>unsigned</em> <em>long</em> start = jiffies;</td></tr>
<tr><th id="1460">1460</th><td>	<em>unsigned</em> <em>long</em> nr_pages = <var>0</var>;</td></tr>
<tr><th id="1461">1461</th><td>	<em>unsigned</em> <em>long</em> walk_start, walk_end;</td></tr>
<tr><th id="1462">1462</th><td>	<em>int</em> i, zid;</td></tr>
<tr><th id="1463">1463</th><td>	<b>struct</b> zone *zone;</td></tr>
<tr><th id="1464">1464</th><td>	<em>unsigned</em> <em>long</em> first_init_pfn = pgdat-&gt;first_deferred_pfn;</td></tr>
<tr><th id="1465">1465</th><td>	<em>const</em> <b>struct</b> cpumask *cpumask = cpumask_of_node(pgdat-&gt;node_id);</td></tr>
<tr><th id="1466">1466</th><td></td></tr>
<tr><th id="1467">1467</th><td>	<b>if</b> (first_init_pfn == ULONG_MAX) {</td></tr>
<tr><th id="1468">1468</th><td>		pgdat_init_report_one_done();</td></tr>
<tr><th id="1469">1469</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1470">1470</th><td>	}</td></tr>
<tr><th id="1471">1471</th><td></td></tr>
<tr><th id="1472">1472</th><td>	<i>/* Bind memory initialisation thread to a local node if possible */</i></td></tr>
<tr><th id="1473">1473</th><td>	<b>if</b> (!cpumask_empty(cpumask))</td></tr>
<tr><th id="1474">1474</th><td>		set_cpus_allowed_ptr(current, cpumask);</td></tr>
<tr><th id="1475">1475</th><td></td></tr>
<tr><th id="1476">1476</th><td>	<i>/* Sanity check boundaries */</i></td></tr>
<tr><th id="1477">1477</th><td>	BUG_ON(pgdat-&gt;first_deferred_pfn &lt; pgdat-&gt;node_start_pfn);</td></tr>
<tr><th id="1478">1478</th><td>	BUG_ON(pgdat-&gt;first_deferred_pfn &gt; pgdat_end_pfn(pgdat));</td></tr>
<tr><th id="1479">1479</th><td>	pgdat-&gt;first_deferred_pfn = ULONG_MAX;</td></tr>
<tr><th id="1480">1480</th><td></td></tr>
<tr><th id="1481">1481</th><td>	<i>/* Only the highest zone is deferred so find it */</i></td></tr>
<tr><th id="1482">1482</th><td>	<b>for</b> (zid = <var>0</var>; zid &lt; MAX_NR_ZONES; zid++) {</td></tr>
<tr><th id="1483">1483</th><td>		zone = pgdat-&gt;node_zones + zid;</td></tr>
<tr><th id="1484">1484</th><td>		<b>if</b> (first_init_pfn &lt; zone_end_pfn(zone))</td></tr>
<tr><th id="1485">1485</th><td>			<b>break</b>;</td></tr>
<tr><th id="1486">1486</th><td>	}</td></tr>
<tr><th id="1487">1487</th><td></td></tr>
<tr><th id="1488">1488</th><td>	for_each_mem_pfn_range(i, nid, &amp;walk_start, &amp;walk_end, NULL) {</td></tr>
<tr><th id="1489">1489</th><td>		<em>unsigned</em> <em>long</em> pfn, end_pfn;</td></tr>
<tr><th id="1490">1490</th><td>		<b>struct</b> page *page = NULL;</td></tr>
<tr><th id="1491">1491</th><td>		<b>struct</b> page *free_base_page = NULL;</td></tr>
<tr><th id="1492">1492</th><td>		<em>unsigned</em> <em>long</em> free_base_pfn = <var>0</var>;</td></tr>
<tr><th id="1493">1493</th><td>		<em>int</em> nr_to_free = <var>0</var>;</td></tr>
<tr><th id="1494">1494</th><td></td></tr>
<tr><th id="1495">1495</th><td>		end_pfn = min(walk_end, zone_end_pfn(zone));</td></tr>
<tr><th id="1496">1496</th><td>		pfn = first_init_pfn;</td></tr>
<tr><th id="1497">1497</th><td>		<b>if</b> (pfn &lt; walk_start)</td></tr>
<tr><th id="1498">1498</th><td>			pfn = walk_start;</td></tr>
<tr><th id="1499">1499</th><td>		<b>if</b> (pfn &lt; zone-&gt;zone_start_pfn)</td></tr>
<tr><th id="1500">1500</th><td>			pfn = zone-&gt;zone_start_pfn;</td></tr>
<tr><th id="1501">1501</th><td></td></tr>
<tr><th id="1502">1502</th><td>		<b>for</b> (; pfn &lt; end_pfn; pfn++) {</td></tr>
<tr><th id="1503">1503</th><td>			<b>if</b> (!pfn_valid_within(pfn))</td></tr>
<tr><th id="1504">1504</th><td>				<b>goto</b> free_range;</td></tr>
<tr><th id="1505">1505</th><td></td></tr>
<tr><th id="1506">1506</th><td>			<i>/*</i></td></tr>
<tr><th id="1507">1507</th><td><i>			 * Ensure pfn_valid is checked every</i></td></tr>
<tr><th id="1508">1508</th><td><i>			 * pageblock_nr_pages for memory holes</i></td></tr>
<tr><th id="1509">1509</th><td><i>			 */</i></td></tr>
<tr><th id="1510">1510</th><td>			<b>if</b> ((pfn &amp; (pageblock_nr_pages - <var>1</var>)) == <var>0</var>) {</td></tr>
<tr><th id="1511">1511</th><td>				<b>if</b> (!pfn_valid(pfn)) {</td></tr>
<tr><th id="1512">1512</th><td>					page = NULL;</td></tr>
<tr><th id="1513">1513</th><td>					<b>goto</b> free_range;</td></tr>
<tr><th id="1514">1514</th><td>				}</td></tr>
<tr><th id="1515">1515</th><td>			}</td></tr>
<tr><th id="1516">1516</th><td></td></tr>
<tr><th id="1517">1517</th><td>			<b>if</b> (!meminit_pfn_in_nid(pfn, nid, &amp;nid_init_state)) {</td></tr>
<tr><th id="1518">1518</th><td>				page = NULL;</td></tr>
<tr><th id="1519">1519</th><td>				<b>goto</b> free_range;</td></tr>
<tr><th id="1520">1520</th><td>			}</td></tr>
<tr><th id="1521">1521</th><td></td></tr>
<tr><th id="1522">1522</th><td>			<i>/* Minimise pfn page lookups and scheduler checks */</i></td></tr>
<tr><th id="1523">1523</th><td>			<b>if</b> (page &amp;&amp; (pfn &amp; (pageblock_nr_pages - <var>1</var>)) != <var>0</var>) {</td></tr>
<tr><th id="1524">1524</th><td>				page++;</td></tr>
<tr><th id="1525">1525</th><td>			} <b>else</b> {</td></tr>
<tr><th id="1526">1526</th><td>				nr_pages += nr_to_free;</td></tr>
<tr><th id="1527">1527</th><td>				deferred_free_range(free_base_page,</td></tr>
<tr><th id="1528">1528</th><td>						free_base_pfn, nr_to_free);</td></tr>
<tr><th id="1529">1529</th><td>				free_base_page = NULL;</td></tr>
<tr><th id="1530">1530</th><td>				free_base_pfn = nr_to_free = <var>0</var>;</td></tr>
<tr><th id="1531">1531</th><td></td></tr>
<tr><th id="1532">1532</th><td>				page = pfn_to_page(pfn);</td></tr>
<tr><th id="1533">1533</th><td>				cond_resched();</td></tr>
<tr><th id="1534">1534</th><td>			}</td></tr>
<tr><th id="1535">1535</th><td></td></tr>
<tr><th id="1536">1536</th><td>			<b>if</b> (page-&gt;flags) {</td></tr>
<tr><th id="1537">1537</th><td>				VM_BUG_ON(page_zone(page) != zone);</td></tr>
<tr><th id="1538">1538</th><td>				<b>goto</b> free_range;</td></tr>
<tr><th id="1539">1539</th><td>			}</td></tr>
<tr><th id="1540">1540</th><td></td></tr>
<tr><th id="1541">1541</th><td>			__init_single_page(page, pfn, zid, nid);</td></tr>
<tr><th id="1542">1542</th><td>			<b>if</b> (!free_base_page) {</td></tr>
<tr><th id="1543">1543</th><td>				free_base_page = page;</td></tr>
<tr><th id="1544">1544</th><td>				free_base_pfn = pfn;</td></tr>
<tr><th id="1545">1545</th><td>				nr_to_free = <var>0</var>;</td></tr>
<tr><th id="1546">1546</th><td>			}</td></tr>
<tr><th id="1547">1547</th><td>			nr_to_free++;</td></tr>
<tr><th id="1548">1548</th><td></td></tr>
<tr><th id="1549">1549</th><td>			<i>/* Where possible, batch up pages for a single free */</i></td></tr>
<tr><th id="1550">1550</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1551">1551</th><td>free_range:</td></tr>
<tr><th id="1552">1552</th><td>			<i>/* Free the current block of pages to allocator */</i></td></tr>
<tr><th id="1553">1553</th><td>			nr_pages += nr_to_free;</td></tr>
<tr><th id="1554">1554</th><td>			deferred_free_range(free_base_page, free_base_pfn,</td></tr>
<tr><th id="1555">1555</th><td>								nr_to_free);</td></tr>
<tr><th id="1556">1556</th><td>			free_base_page = NULL;</td></tr>
<tr><th id="1557">1557</th><td>			free_base_pfn = nr_to_free = <var>0</var>;</td></tr>
<tr><th id="1558">1558</th><td>		}</td></tr>
<tr><th id="1559">1559</th><td>		<i>/* Free the last block of pages to allocator */</i></td></tr>
<tr><th id="1560">1560</th><td>		nr_pages += nr_to_free;</td></tr>
<tr><th id="1561">1561</th><td>		deferred_free_range(free_base_page, free_base_pfn, nr_to_free);</td></tr>
<tr><th id="1562">1562</th><td></td></tr>
<tr><th id="1563">1563</th><td>		first_init_pfn = max(end_pfn, first_init_pfn);</td></tr>
<tr><th id="1564">1564</th><td>	}</td></tr>
<tr><th id="1565">1565</th><td></td></tr>
<tr><th id="1566">1566</th><td>	<i>/* Sanity check that the next zone really is unpopulated */</i></td></tr>
<tr><th id="1567">1567</th><td>	WARN_ON(++zid &lt; MAX_NR_ZONES &amp;&amp; populated_zone(++zone));</td></tr>
<tr><th id="1568">1568</th><td></td></tr>
<tr><th id="1569">1569</th><td>	pr_info(<q>"node %d initialised, %lu pages in %ums\n"</q>, nid, nr_pages,</td></tr>
<tr><th id="1570">1570</th><td>					jiffies_to_msecs(jiffies - start));</td></tr>
<tr><th id="1571">1571</th><td></td></tr>
<tr><th id="1572">1572</th><td>	pgdat_init_report_one_done();</td></tr>
<tr><th id="1573">1573</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1574">1574</th><td>}</td></tr>
<tr><th id="1575">1575</th><td><u>#<span data-ppcond="1419">endif</span> /* CONFIG_DEFERRED_STRUCT_PAGE_INIT */</u></td></tr>
<tr><th id="1576">1576</th><td></td></tr>
<tr><th id="1577">1577</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="page_alloc_init_late" title='page_alloc_init_late' data-ref="page_alloc_init_late">page_alloc_init_late</dfn>(<em>void</em>)</td></tr>
<tr><th id="1578">1578</th><td>{</td></tr>
<tr><th id="1579">1579</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="521zone" title='zone' data-type='struct zone *' data-ref="521zone">zone</dfn>;</td></tr>
<tr><th id="1580">1580</th><td></td></tr>
<tr><th id="1581">1581</th><td><u>#<span data-ppcond="1581">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEFERRED_STRUCT_PAGE_INIT">CONFIG_DEFERRED_STRUCT_PAGE_INIT</span></u></td></tr>
<tr><th id="1582">1582</th><td>	<em>int</em> nid;</td></tr>
<tr><th id="1583">1583</th><td></td></tr>
<tr><th id="1584">1584</th><td>	<i>/* There will be num_node_state(N_MEMORY) threads */</i></td></tr>
<tr><th id="1585">1585</th><td>	atomic_set(&amp;pgdat_init_n_undone, num_node_state(N_MEMORY));</td></tr>
<tr><th id="1586">1586</th><td>	for_each_node_state(nid, N_MEMORY) {</td></tr>
<tr><th id="1587">1587</th><td>		kthread_run(deferred_init_memmap, NODE_DATA(nid), <q>"pgdatinit%d"</q>, nid);</td></tr>
<tr><th id="1588">1588</th><td>	}</td></tr>
<tr><th id="1589">1589</th><td></td></tr>
<tr><th id="1590">1590</th><td>	<i>/* Block until all are initialised */</i></td></tr>
<tr><th id="1591">1591</th><td>	wait_for_completion(&amp;pgdat_init_all_done_comp);</td></tr>
<tr><th id="1592">1592</th><td></td></tr>
<tr><th id="1593">1593</th><td>	<i>/* Reinit limits that are based on free pages after the kernel is up */</i></td></tr>
<tr><th id="1594">1594</th><td>	files_maxfiles_init();</td></tr>
<tr><th id="1595">1595</th><td><u>#<span data-ppcond="1581">endif</span></u></td></tr>
<tr><th id="1596">1596</th><td><u>#<span data-ppcond="1596">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#626" data-ref="_M/CONFIG_ARCH_DISCARD_MEMBLOCK">CONFIG_ARCH_DISCARD_MEMBLOCK</a></u></td></tr>
<tr><th id="1597">1597</th><td>	<i>/* Discard memblock private memory */</i></td></tr>
<tr><th id="1598">1598</th><td>	<a class="ref fn" href="../include/linux/memblock.h.html#memblock_discard" title='memblock_discard' data-ref="memblock_discard">memblock_discard</a>();</td></tr>
<tr><th id="1599">1599</th><td><u>#<span data-ppcond="1596">endif</span></u></td></tr>
<tr><th id="1600">1600</th><td></td></tr>
<tr><th id="1601">1601</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col1 ref" href="#521zone" title='zone' data-ref="521zone">zone</a>)</td></tr>
<tr><th id="1602">1602</th><td>		<a class="ref fn" href="#set_zone_contiguous" title='set_zone_contiguous' data-ref="set_zone_contiguous">set_zone_contiguous</a>(<a class="local col1 ref" href="#521zone" title='zone' data-ref="521zone">zone</a>);</td></tr>
<tr><th id="1603">1603</th><td>}</td></tr>
<tr><th id="1604">1604</th><td></td></tr>
<tr><th id="1605">1605</th><td><u>#<span data-ppcond="1605">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="1606">1606</th><td><i>/* Free whole pageblock and set its migration type to MIGRATE_CMA. */</i></td></tr>
<tr><th id="1607">1607</th><td><em>void</em> __init init_cma_reserved_pageblock(<b>struct</b> page *page)</td></tr>
<tr><th id="1608">1608</th><td>{</td></tr>
<tr><th id="1609">1609</th><td>	<em>unsigned</em> i = pageblock_nr_pages;</td></tr>
<tr><th id="1610">1610</th><td>	<b>struct</b> page *p = page;</td></tr>
<tr><th id="1611">1611</th><td></td></tr>
<tr><th id="1612">1612</th><td>	<b>do</b> {</td></tr>
<tr><th id="1613">1613</th><td>		__ClearPageReserved(p);</td></tr>
<tr><th id="1614">1614</th><td>		set_page_count(p, <var>0</var>);</td></tr>
<tr><th id="1615">1615</th><td>	} <b>while</b> (++p, --i);</td></tr>
<tr><th id="1616">1616</th><td></td></tr>
<tr><th id="1617">1617</th><td>	set_pageblock_migratetype(page, MIGRATE_CMA);</td></tr>
<tr><th id="1618">1618</th><td></td></tr>
<tr><th id="1619">1619</th><td>	<b>if</b> (pageblock_order &gt;= MAX_ORDER) {</td></tr>
<tr><th id="1620">1620</th><td>		i = pageblock_nr_pages;</td></tr>
<tr><th id="1621">1621</th><td>		p = page;</td></tr>
<tr><th id="1622">1622</th><td>		<b>do</b> {</td></tr>
<tr><th id="1623">1623</th><td>			set_page_refcounted(p);</td></tr>
<tr><th id="1624">1624</th><td>			__free_pages(p, MAX_ORDER - <var>1</var>);</td></tr>
<tr><th id="1625">1625</th><td>			p += MAX_ORDER_NR_PAGES;</td></tr>
<tr><th id="1626">1626</th><td>		} <b>while</b> (i -= MAX_ORDER_NR_PAGES);</td></tr>
<tr><th id="1627">1627</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1628">1628</th><td>		set_page_refcounted(page);</td></tr>
<tr><th id="1629">1629</th><td>		__free_pages(page, pageblock_order);</td></tr>
<tr><th id="1630">1630</th><td>	}</td></tr>
<tr><th id="1631">1631</th><td></td></tr>
<tr><th id="1632">1632</th><td>	adjust_managed_page_count(page, pageblock_nr_pages);</td></tr>
<tr><th id="1633">1633</th><td>}</td></tr>
<tr><th id="1634">1634</th><td><u>#<span data-ppcond="1605">endif</span></u></td></tr>
<tr><th id="1635">1635</th><td></td></tr>
<tr><th id="1636">1636</th><td><i  data-doc="expand">/*</i></td></tr>
<tr><th id="1637">1637</th><td><i  data-doc="expand"> * The order of subdivision here is critical for the IO subsystem.</i></td></tr>
<tr><th id="1638">1638</th><td><i  data-doc="expand"> * Please do not alter this order without good reasons and regression</i></td></tr>
<tr><th id="1639">1639</th><td><i  data-doc="expand"> * testing. Specifically, as large blocks of memory are subdivided,</i></td></tr>
<tr><th id="1640">1640</th><td><i  data-doc="expand"> * the order in which smaller blocks are delivered depends on the order</i></td></tr>
<tr><th id="1641">1641</th><td><i  data-doc="expand"> * they're subdivided in this function. This is the primary factor</i></td></tr>
<tr><th id="1642">1642</th><td><i  data-doc="expand"> * influencing the order in which pages are delivered to the IO</i></td></tr>
<tr><th id="1643">1643</th><td><i  data-doc="expand"> * subsystem according to empirical testing, and this is also justified</i></td></tr>
<tr><th id="1644">1644</th><td><i  data-doc="expand"> * by considering the behavior of a buddy system containing a single</i></td></tr>
<tr><th id="1645">1645</th><td><i  data-doc="expand"> * large block of memory acted on by a series of small allocations.</i></td></tr>
<tr><th id="1646">1646</th><td><i  data-doc="expand"> * This behavior is a critical factor in sglist merging's success.</i></td></tr>
<tr><th id="1647">1647</th><td><i  data-doc="expand"> *</i></td></tr>
<tr><th id="1648">1648</th><td><i  data-doc="expand"> * -- nyc</i></td></tr>
<tr><th id="1649">1649</th><td><i  data-doc="expand"> */</i></td></tr>
<tr><th id="1650">1650</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="expand" title='expand' data-type='void expand(struct zone * zone, struct page * page, int low, int high, struct free_area * area, int migratetype)' data-ref="expand">expand</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="522zone" title='zone' data-type='struct zone *' data-ref="522zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="523page" title='page' data-type='struct page *' data-ref="523page">page</dfn>,</td></tr>
<tr><th id="1651">1651</th><td>	<em>int</em> <dfn class="local col4 decl" id="524low" title='low' data-type='int' data-ref="524low">low</dfn>, <em>int</em> <dfn class="local col5 decl" id="525high" title='high' data-type='int' data-ref="525high">high</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col6 decl" id="526area" title='area' data-type='struct free_area *' data-ref="526area">area</dfn>,</td></tr>
<tr><th id="1652">1652</th><td>	<em>int</em> <dfn class="local col7 decl" id="527migratetype" title='migratetype' data-type='int' data-ref="527migratetype">migratetype</dfn>)</td></tr>
<tr><th id="1653">1653</th><td>{</td></tr>
<tr><th id="1654">1654</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="528size" title='size' data-type='unsigned long' data-ref="528size">size</dfn> = <var>1</var> &lt;&lt; <a class="local col5 ref" href="#525high" title='high' data-ref="525high">high</a>;</td></tr>
<tr><th id="1655">1655</th><td></td></tr>
<tr><th id="1656">1656</th><td>	<b>while</b> (<a class="local col5 ref" href="#525high" title='high' data-ref="525high">high</a> &gt; <a class="local col4 ref" href="#524low" title='low' data-ref="524low">low</a>) {</td></tr>
<tr><th id="1657">1657</th><td>		<a class="local col6 ref" href="#526area" title='area' data-ref="526area">area</a>--;</td></tr>
<tr><th id="1658">1658</th><td>		<a class="local col5 ref" href="#525high" title='high' data-ref="525high">high</a>--;</td></tr>
<tr><th id="1659">1659</th><td>		<a class="local col8 ref" href="#528size" title='size' data-ref="528size">size</a> &gt;&gt;= <var>1</var>;</td></tr>
<tr><th id="1660">1660</th><td>		<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(bad_range(zone, &amp;page[size])))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="tu ref fn" href="#bad_range" title='bad_range' data-use='c' data-ref="bad_range">bad_range</a>(<a class="local col2 ref" href="#522zone" title='zone' data-ref="522zone">zone</a>, &amp;<a class="local col3 ref" href="#523page" title='page' data-ref="523page">page</a>[<a class="local col8 ref" href="#528size" title='size' data-ref="528size">size</a>]), &amp;page[size]);</td></tr>
<tr><th id="1661">1661</th><td></td></tr>
<tr><th id="1662">1662</th><td>		<i>/*</i></td></tr>
<tr><th id="1663">1663</th><td><i>		 * Mark as guard pages (or page), that will allow to</i></td></tr>
<tr><th id="1664">1664</th><td><i>		 * merge back to allocator when buddy will be freed.</i></td></tr>
<tr><th id="1665">1665</th><td><i>		 * Corresponding page table entries will not be touched,</i></td></tr>
<tr><th id="1666">1666</th><td><i>		 * pages will stay not present in virtual address space</i></td></tr>
<tr><th id="1667">1667</th><td><i>		 */</i></td></tr>
<tr><th id="1668">1668</th><td>		<b>if</b> (<a class="tu ref fn" href="#set_page_guard" title='set_page_guard' data-use='c' data-ref="set_page_guard">set_page_guard</a>(<a class="local col2 ref" href="#522zone" title='zone' data-ref="522zone">zone</a>, &amp;<a class="local col3 ref" href="#523page" title='page' data-ref="523page">page</a>[<a class="local col8 ref" href="#528size" title='size' data-ref="528size">size</a>], <a class="local col5 ref" href="#525high" title='high' data-ref="525high">high</a>, <a class="local col7 ref" href="#527migratetype" title='migratetype' data-ref="527migratetype">migratetype</a>))</td></tr>
<tr><th id="1669">1669</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1670">1670</th><td></td></tr>
<tr><th id="1671">1671</th><td>		<a class="ref fn" href="../include/linux/list.h.html#list_add" title='list_add' data-ref="list_add">list_add</a>(&amp;<a class="local col3 ref" href="#523page" title='page' data-ref="523page">page</a>[<a class="local col8 ref" href="#528size" title='size' data-ref="528size">size</a>].<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, &amp;<a class="local col6 ref" href="#526area" title='area' data-ref="526area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col7 ref" href="#527migratetype" title='migratetype' data-ref="527migratetype">migratetype</a>]);</td></tr>
<tr><th id="1672">1672</th><td>		<a class="local col6 ref" href="#526area" title='area' data-ref="526area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>++;</td></tr>
<tr><th id="1673">1673</th><td>		<a class="tu ref fn" href="#set_page_order" title='set_page_order' data-use='c' data-ref="set_page_order">set_page_order</a>(&amp;<a class="local col3 ref" href="#523page" title='page' data-ref="523page">page</a>[<a class="local col8 ref" href="#528size" title='size' data-ref="528size">size</a>], <a class="local col5 ref" href="#525high" title='high' data-ref="525high">high</a>);</td></tr>
<tr><th id="1674">1674</th><td>	}</td></tr>
<tr><th id="1675">1675</th><td>}</td></tr>
<tr><th id="1676">1676</th><td></td></tr>
<tr><th id="1677">1677</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="check_new_page_bad" title='check_new_page_bad' data-type='void check_new_page_bad(struct page * page)' data-ref="check_new_page_bad">check_new_page_bad</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="529page" title='page' data-type='struct page *' data-ref="529page">page</dfn>)</td></tr>
<tr><th id="1678">1678</th><td>{</td></tr>
<tr><th id="1679">1679</th><td>	<em>const</em> <em>char</em> *<dfn class="local col0 decl" id="530bad_reason" title='bad_reason' data-type='const char *' data-ref="530bad_reason">bad_reason</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1680">1680</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="531bad_flags" title='bad_flags' data-type='unsigned long' data-ref="531bad_flags">bad_flags</dfn> = <var>0</var>;</td></tr>
<tr><th id="1681">1681</th><td></td></tr>
<tr><th id="1682">1682</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(atomic_read(&amp;page-&gt;_mapcount) != -1), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../arch/x86/include/asm/atomic.h.html#atomic_read" title='atomic_read' data-ref="atomic_read">atomic_read</a>(&amp;<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymousunion)::(anonymousstruct)::(anonymous)::_mapcount" title='page::(anonymous union)::(anonymous struct)::(anonymous union)::_mapcount' data-ref="page::(anonymousunion)::(anonymousstruct)::(anonymous)::_mapcount">_mapcount</a>) != -<var>1</var>))</td></tr>
<tr><th id="1683">1683</th><td>		<a class="local col0 ref" href="#530bad_reason" title='bad_reason' data-ref="530bad_reason">bad_reason</a> = <q>"nonzero mapcount"</q>;</td></tr>
<tr><th id="1684">1684</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page-&gt;mapping != ((void *)0)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::mapping" title='page::(anonymous union)::mapping' data-ref="page::(anonymous)::mapping">mapping</a> != <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>))</td></tr>
<tr><th id="1685">1685</th><td>		<a class="local col0 ref" href="#530bad_reason" title='bad_reason' data-ref="530bad_reason">bad_reason</a> = <q>"non-NULL mapping"</q>;</td></tr>
<tr><th id="1686">1686</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page_ref_count(page) != 0), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_count" title='page_ref_count' data-ref="page_ref_count">page_ref_count</a>(<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>) != <var>0</var>))</td></tr>
<tr><th id="1687">1687</th><td>		<a class="local col0 ref" href="#530bad_reason" title='bad_reason' data-ref="530bad_reason">bad_reason</a> = <q>"nonzero _count"</q>;</td></tr>
<tr><th id="1688">1688</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page-&gt;flags &amp; 0), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp; <a class="macro" href="../include/linux/page-flags.h.html#367" title="0" data-ref="_M/__PG_HWPOISON">__PG_HWPOISON</a>)) {</td></tr>
<tr><th id="1689">1689</th><td>		<a class="local col0 ref" href="#530bad_reason" title='bad_reason' data-ref="530bad_reason">bad_reason</a> = <q>"HWPoisoned (hardware-corrupted)"</q>;</td></tr>
<tr><th id="1690">1690</th><td>		<a class="local col1 ref" href="#531bad_flags" title='bad_flags' data-ref="531bad_flags">bad_flags</a> = <a class="macro" href="../include/linux/page-flags.h.html#367" title="0" data-ref="_M/__PG_HWPOISON">__PG_HWPOISON</a>;</td></tr>
<tr><th id="1691">1691</th><td>		<i>/* Don't complain about hwpoisoned pages */</i></td></tr>
<tr><th id="1692">1692</th><td>		<a class="ref fn" href="../include/linux/mm.h.html#page_mapcount_reset" title='page_mapcount_reset' data-ref="page_mapcount_reset">page_mapcount_reset</a>(<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>); <i>/* remove PageBuddy */</i></td></tr>
<tr><th id="1693">1693</th><td>		<b>return</b>;</td></tr>
<tr><th id="1694">1694</th><td>	}</td></tr>
<tr><th id="1695">1695</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page-&gt;flags &amp; (((1UL &lt;&lt; 22) - 1) &amp; ~0)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::flags" title='page::flags' data-ref="page::flags">flags</a> &amp; <a class="macro" href="../include/linux/page-flags.h.html#739" title="(((1UL &lt;&lt; 22) - 1) &amp; ~0)" data-ref="_M/PAGE_FLAGS_CHECK_AT_PREP">PAGE_FLAGS_CHECK_AT_PREP</a>)) {</td></tr>
<tr><th id="1696">1696</th><td>		<a class="local col0 ref" href="#530bad_reason" title='bad_reason' data-ref="530bad_reason">bad_reason</a> = <q>"PAGE_FLAGS_CHECK_AT_PREP flag set"</q>;</td></tr>
<tr><th id="1697">1697</th><td>		<a class="local col1 ref" href="#531bad_flags" title='bad_flags' data-ref="531bad_flags">bad_flags</a> = <a class="macro" href="../include/linux/page-flags.h.html#739" title="(((1UL &lt;&lt; 22) - 1) &amp; ~0)" data-ref="_M/PAGE_FLAGS_CHECK_AT_PREP">PAGE_FLAGS_CHECK_AT_PREP</a>;</td></tr>
<tr><th id="1698">1698</th><td>	}</td></tr>
<tr><th id="1699">1699</th><td><u>#<span data-ppcond="1699">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMCG">CONFIG_MEMCG</span></u></td></tr>
<tr><th id="1700">1700</th><td>	<b>if</b> (unlikely(page-&gt;mem_cgroup))</td></tr>
<tr><th id="1701">1701</th><td>		bad_reason = <q>"page still charged to cgroup"</q>;</td></tr>
<tr><th id="1702">1702</th><td><u>#<span data-ppcond="1699">endif</span></u></td></tr>
<tr><th id="1703">1703</th><td>	<a class="tu ref fn" href="#bad_page" title='bad_page' data-use='c' data-ref="bad_page">bad_page</a>(<a class="local col9 ref" href="#529page" title='page' data-ref="529page">page</a>, <a class="local col0 ref" href="#530bad_reason" title='bad_reason' data-ref="530bad_reason">bad_reason</a>, <a class="local col1 ref" href="#531bad_flags" title='bad_flags' data-ref="531bad_flags">bad_flags</a>);</td></tr>
<tr><th id="1704">1704</th><td>}</td></tr>
<tr><th id="1705">1705</th><td></td></tr>
<tr><th id="1706">1706</th><td><i  data-doc="check_new_page">/*</i></td></tr>
<tr><th id="1707">1707</th><td><i  data-doc="check_new_page"> * This page is about to be returned from the page allocator</i></td></tr>
<tr><th id="1708">1708</th><td><i  data-doc="check_new_page"> */</i></td></tr>
<tr><th id="1709">1709</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="check_new_page" title='check_new_page' data-type='int check_new_page(struct page * page)' data-ref="check_new_page">check_new_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="532page" title='page' data-type='struct page *' data-ref="532page">page</dfn>)</td></tr>
<tr><th id="1710">1710</th><td>{</td></tr>
<tr><th id="1711">1711</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(page_expected_state(page, (((1UL &lt;&lt; 22) - 1) &amp; ~0)|0)), 1)" data-ref="_M/likely">likely</a>(<a class="tu ref fn" href="#page_expected_state" title='page_expected_state' data-use='c' data-ref="page_expected_state">page_expected_state</a>(<a class="local col2 ref" href="#532page" title='page' data-ref="532page">page</a>,</td></tr>
<tr><th id="1712">1712</th><td>				<a class="macro" href="../include/linux/page-flags.h.html#739" title="(((1UL &lt;&lt; 22) - 1) &amp; ~0)" data-ref="_M/PAGE_FLAGS_CHECK_AT_PREP">PAGE_FLAGS_CHECK_AT_PREP</a>|<a class="macro" href="../include/linux/page-flags.h.html#367" title="0" data-ref="_M/__PG_HWPOISON">__PG_HWPOISON</a>)))</td></tr>
<tr><th id="1713">1713</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1714">1714</th><td></td></tr>
<tr><th id="1715">1715</th><td>	<a class="tu ref fn" href="#check_new_page_bad" title='check_new_page_bad' data-use='c' data-ref="check_new_page_bad">check_new_page_bad</a>(<a class="local col2 ref" href="#532page" title='page' data-ref="532page">page</a>);</td></tr>
<tr><th id="1716">1716</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1717">1717</th><td>}</td></tr>
<tr><th id="1718">1718</th><td></td></tr>
<tr><th id="1719">1719</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="free_pages_prezeroed" title='free_pages_prezeroed' data-type='bool free_pages_prezeroed()' data-ref="free_pages_prezeroed">free_pages_prezeroed</dfn>(<em>void</em>)</td></tr>
<tr><th id="1720">1720</th><td>{</td></tr>
<tr><th id="1721">1721</th><td>	<b>return</b> <a class="macro" href="../include/linux/kconfig.h.html#71" title="0" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(CONFIG_PAGE_POISONING_ZERO) &amp;&amp;</td></tr>
<tr><th id="1722">1722</th><td>		<a class="ref fn" href="../include/linux/mm.h.html#page_poisoning_enabled" title='page_poisoning_enabled' data-ref="page_poisoning_enabled">page_poisoning_enabled</a>();</td></tr>
<tr><th id="1723">1723</th><td>}</td></tr>
<tr><th id="1724">1724</th><td></td></tr>
<tr><th id="1725">1725</th><td><u>#<span data-ppcond="1725">ifdef</span> <span class="macro" data-ref="_M/CONFIG_DEBUG_VM">CONFIG_DEBUG_VM</span></u></td></tr>
<tr><th id="1726">1726</th><td><em>static</em> bool check_pcp_refill(<b>struct</b> page *page)</td></tr>
<tr><th id="1727">1727</th><td>{</td></tr>
<tr><th id="1728">1728</th><td>	<b>return</b> false;</td></tr>
<tr><th id="1729">1729</th><td>}</td></tr>
<tr><th id="1730">1730</th><td></td></tr>
<tr><th id="1731">1731</th><td><em>static</em> bool check_new_pcp(<b>struct</b> page *page)</td></tr>
<tr><th id="1732">1732</th><td>{</td></tr>
<tr><th id="1733">1733</th><td>	<b>return</b> check_new_page(page);</td></tr>
<tr><th id="1734">1734</th><td>}</td></tr>
<tr><th id="1735">1735</th><td><u>#<span data-ppcond="1725">else</span></u></td></tr>
<tr><th id="1736">1736</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="check_pcp_refill" title='check_pcp_refill' data-type='bool check_pcp_refill(struct page * page)' data-ref="check_pcp_refill">check_pcp_refill</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="533page" title='page' data-type='struct page *' data-ref="533page">page</dfn>)</td></tr>
<tr><th id="1737">1737</th><td>{</td></tr>
<tr><th id="1738">1738</th><td>	<b>return</b> <a class="tu ref fn" href="#check_new_page" title='check_new_page' data-use='c' data-ref="check_new_page">check_new_page</a>(<a class="local col3 ref" href="#533page" title='page' data-ref="533page">page</a>);</td></tr>
<tr><th id="1739">1739</th><td>}</td></tr>
<tr><th id="1740">1740</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="check_new_pcp" title='check_new_pcp' data-type='bool check_new_pcp(struct page * page)' data-ref="check_new_pcp">check_new_pcp</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="534page" title='page' data-type='struct page *' data-ref="534page">page</dfn>)</td></tr>
<tr><th id="1741">1741</th><td>{</td></tr>
<tr><th id="1742">1742</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="1743">1743</th><td>}</td></tr>
<tr><th id="1744">1744</th><td><u>#<span data-ppcond="1725">endif</span> /* CONFIG_DEBUG_VM */</u></td></tr>
<tr><th id="1745">1745</th><td></td></tr>
<tr><th id="1746">1746</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="check_new_pages" title='check_new_pages' data-type='bool check_new_pages(struct page * page, unsigned int order)' data-ref="check_new_pages">check_new_pages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="535page" title='page' data-type='struct page *' data-ref="535page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="536order" title='order' data-type='unsigned int' data-ref="536order">order</dfn>)</td></tr>
<tr><th id="1747">1747</th><td>{</td></tr>
<tr><th id="1748">1748</th><td>	<em>int</em> <dfn class="local col7 decl" id="537i" title='i' data-type='int' data-ref="537i">i</dfn>;</td></tr>
<tr><th id="1749">1749</th><td>	<b>for</b> (<a class="local col7 ref" href="#537i" title='i' data-ref="537i">i</a> = <var>0</var>; <a class="local col7 ref" href="#537i" title='i' data-ref="537i">i</a> &lt; (<var>1</var> &lt;&lt; <a class="local col6 ref" href="#536order" title='order' data-ref="536order">order</a>); <a class="local col7 ref" href="#537i" title='i' data-ref="537i">i</a>++) {</td></tr>
<tr><th id="1750">1750</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="538p" title='p' data-type='struct page *' data-ref="538p">p</dfn> = <a class="local col5 ref" href="#535page" title='page' data-ref="535page">page</a> + <a class="local col7 ref" href="#537i" title='i' data-ref="537i">i</a>;</td></tr>
<tr><th id="1751">1751</th><td></td></tr>
<tr><th id="1752">1752</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(check_new_page(p)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="tu ref fn" href="#check_new_page" title='check_new_page' data-use='c' data-ref="check_new_page">check_new_page</a>(<a class="local col8 ref" href="#538p" title='p' data-ref="538p">p</a>)))</td></tr>
<tr><th id="1753">1753</th><td>			<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1754">1754</th><td>	}</td></tr>
<tr><th id="1755">1755</th><td></td></tr>
<tr><th id="1756">1756</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="1757">1757</th><td>}</td></tr>
<tr><th id="1758">1758</th><td></td></tr>
<tr><th id="1759">1759</th><td><a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="decl def fn" id="post_alloc_hook" title='post_alloc_hook' data-ref="post_alloc_hook">post_alloc_hook</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="539page" title='page' data-type='struct page *' data-ref="539page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="540order" title='order' data-type='unsigned int' data-ref="540order">order</dfn>,</td></tr>
<tr><th id="1760">1760</th><td>				<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col1 decl" id="541gfp_flags" title='gfp_flags' data-type='gfp_t' data-ref="541gfp_flags">gfp_flags</dfn>)</td></tr>
<tr><th id="1761">1761</th><td>{</td></tr>
<tr><th id="1762">1762</th><td>	<a class="macro" href="../include/linux/mm.h.html#431" title="((page)-&gt;private = (0))" data-ref="_M/set_page_private">set_page_private</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>, <var>0</var>);</td></tr>
<tr><th id="1763">1763</th><td>	<a class="ref fn" href="internal.h.html#set_page_refcounted" title='set_page_refcounted' data-ref="set_page_refcounted">set_page_refcounted</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>);</td></tr>
<tr><th id="1764">1764</th><td></td></tr>
<tr><th id="1765">1765</th><td>	<a class="ref fn" href="../include/linux/gfp.h.html#arch_alloc_page" title='arch_alloc_page' data-ref="arch_alloc_page">arch_alloc_page</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>, <a class="local col0 ref" href="#540order" title='order' data-ref="540order">order</a>);</td></tr>
<tr><th id="1766">1766</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#kernel_map_pages" title='kernel_map_pages' data-ref="kernel_map_pages">kernel_map_pages</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>, <var>1</var> &lt;&lt; <a class="local col0 ref" href="#540order" title='order' data-ref="540order">order</a>, <var>1</var>);</td></tr>
<tr><th id="1767">1767</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#kernel_poison_pages" title='kernel_poison_pages' data-ref="kernel_poison_pages">kernel_poison_pages</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>, <var>1</var> &lt;&lt; <a class="local col0 ref" href="#540order" title='order' data-ref="540order">order</a>, <var>1</var>);</td></tr>
<tr><th id="1768">1768</th><td>	<a class="ref fn" href="../include/linux/kasan.h.html#kasan_alloc_pages" title='kasan_alloc_pages' data-ref="kasan_alloc_pages">kasan_alloc_pages</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>, <a class="local col0 ref" href="#540order" title='order' data-ref="540order">order</a>);</td></tr>
<tr><th id="1769">1769</th><td>	<a class="ref fn" href="../include/linux/page_owner.h.html#set_page_owner" title='set_page_owner' data-ref="set_page_owner">set_page_owner</a>(<a class="local col9 ref" href="#539page" title='page' data-ref="539page">page</a>, <a class="local col0 ref" href="#540order" title='order' data-ref="540order">order</a>, <a class="local col1 ref" href="#541gfp_flags" title='gfp_flags' data-ref="541gfp_flags">gfp_flags</a>);</td></tr>
<tr><th id="1770">1770</th><td>}</td></tr>
<tr><th id="1771">1771</th><td></td></tr>
<tr><th id="1772">1772</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="prep_new_page" title='prep_new_page' data-type='void prep_new_page(struct page * page, unsigned int order, gfp_t gfp_flags, unsigned int alloc_flags)' data-ref="prep_new_page">prep_new_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="542page" title='page' data-type='struct page *' data-ref="542page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="543order" title='order' data-type='unsigned int' data-ref="543order">order</dfn>, <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col4 decl" id="544gfp_flags" title='gfp_flags' data-type='gfp_t' data-ref="544gfp_flags">gfp_flags</dfn>,</td></tr>
<tr><th id="1773">1773</th><td>							<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="545alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="545alloc_flags">alloc_flags</dfn>)</td></tr>
<tr><th id="1774">1774</th><td>{</td></tr>
<tr><th id="1775">1775</th><td>	<em>int</em> <dfn class="local col6 decl" id="546i" title='i' data-type='int' data-ref="546i">i</dfn>;</td></tr>
<tr><th id="1776">1776</th><td></td></tr>
<tr><th id="1777">1777</th><td>	<a class="ref fn" href="#post_alloc_hook" title='post_alloc_hook' data-ref="post_alloc_hook">post_alloc_hook</a>(<a class="local col2 ref" href="#542page" title='page' data-ref="542page">page</a>, <a class="local col3 ref" href="#543order" title='order' data-ref="543order">order</a>, <a class="local col4 ref" href="#544gfp_flags" title='gfp_flags' data-ref="544gfp_flags">gfp_flags</a>);</td></tr>
<tr><th id="1778">1778</th><td></td></tr>
<tr><th id="1779">1779</th><td>	<b>if</b> (!<a class="tu ref fn" href="#free_pages_prezeroed" title='free_pages_prezeroed' data-use='c' data-ref="free_pages_prezeroed">free_pages_prezeroed</a>() &amp;&amp; (<a class="local col4 ref" href="#544gfp_flags" title='gfp_flags' data-ref="544gfp_flags">gfp_flags</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#207" title="(( gfp_t)0x8000u)" data-ref="_M/__GFP_ZERO">__GFP_ZERO</a>))</td></tr>
<tr><th id="1780">1780</th><td>		<b>for</b> (<a class="local col6 ref" href="#546i" title='i' data-ref="546i">i</a> = <var>0</var>; <a class="local col6 ref" href="#546i" title='i' data-ref="546i">i</a> &lt; (<var>1</var> &lt;&lt; <a class="local col3 ref" href="#543order" title='order' data-ref="543order">order</a>); <a class="local col6 ref" href="#546i" title='i' data-ref="546i">i</a>++)</td></tr>
<tr><th id="1781">1781</th><td>			<a class="ref fn" href="../include/linux/highmem.h.html#clear_highpage" title='clear_highpage' data-ref="clear_highpage">clear_highpage</a>(<a class="local col2 ref" href="#542page" title='page' data-ref="542page">page</a> + <a class="local col6 ref" href="#546i" title='i' data-ref="546i">i</a>);</td></tr>
<tr><th id="1782">1782</th><td></td></tr>
<tr><th id="1783">1783</th><td>	<b>if</b> (<a class="local col3 ref" href="#543order" title='order' data-ref="543order">order</a> &amp;&amp; (<a class="local col4 ref" href="#544gfp_flags" title='gfp_flags' data-ref="544gfp_flags">gfp_flags</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#206" title="(( gfp_t)0x4000u)" data-ref="_M/__GFP_COMP">__GFP_COMP</a>))</td></tr>
<tr><th id="1784">1784</th><td>		<a class="ref fn" href="#prep_compound_page" title='prep_compound_page' data-ref="prep_compound_page">prep_compound_page</a>(<a class="local col2 ref" href="#542page" title='page' data-ref="542page">page</a>, <a class="local col3 ref" href="#543order" title='order' data-ref="543order">order</a>);</td></tr>
<tr><th id="1785">1785</th><td></td></tr>
<tr><th id="1786">1786</th><td>	<i>/*</i></td></tr>
<tr><th id="1787">1787</th><td><i>	 * page is set pfmemalloc when ALLOC_NO_WATERMARKS was necessary to</i></td></tr>
<tr><th id="1788">1788</th><td><i>	 * allocate the page. The expectation is that the caller is taking</i></td></tr>
<tr><th id="1789">1789</th><td><i>	 * steps that will free more memory. The caller should avoid the page</i></td></tr>
<tr><th id="1790">1790</th><td><i>	 * being used for !PFMEMALLOC purposes.</i></td></tr>
<tr><th id="1791">1791</th><td><i>	 */</i></td></tr>
<tr><th id="1792">1792</th><td>	<b>if</b> (<a class="local col5 ref" href="#545alloc_flags" title='alloc_flags' data-ref="545alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a>)</td></tr>
<tr><th id="1793">1793</th><td>		<a class="ref fn" href="../include/linux/mm.h.html#set_page_pfmemalloc" title='set_page_pfmemalloc' data-ref="set_page_pfmemalloc">set_page_pfmemalloc</a>(<a class="local col2 ref" href="#542page" title='page' data-ref="542page">page</a>);</td></tr>
<tr><th id="1794">1794</th><td>	<b>else</b></td></tr>
<tr><th id="1795">1795</th><td>		<a class="ref fn" href="../include/linux/mm.h.html#clear_page_pfmemalloc" title='clear_page_pfmemalloc' data-ref="clear_page_pfmemalloc">clear_page_pfmemalloc</a>(<a class="local col2 ref" href="#542page" title='page' data-ref="542page">page</a>);</td></tr>
<tr><th id="1796">1796</th><td>}</td></tr>
<tr><th id="1797">1797</th><td></td></tr>
<tr><th id="1798">1798</th><td><i  data-doc="__rmqueue_smallest">/*</i></td></tr>
<tr><th id="1799">1799</th><td><i  data-doc="__rmqueue_smallest"> * Go through the free lists for the given migratetype and remove</i></td></tr>
<tr><th id="1800">1800</th><td><i  data-doc="__rmqueue_smallest"> * the smallest available page from the freelists</i></td></tr>
<tr><th id="1801">1801</th><td><i  data-doc="__rmqueue_smallest"> */</i></td></tr>
<tr><th id="1802">1802</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a></td></tr>
<tr><th id="1803">1803</th><td><b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="__rmqueue_smallest" title='__rmqueue_smallest' data-type='struct page * __rmqueue_smallest(struct zone * zone, unsigned int order, int migratetype)' data-ref="__rmqueue_smallest">__rmqueue_smallest</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="547zone" title='zone' data-type='struct zone *' data-ref="547zone">zone</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="548order" title='order' data-type='unsigned int' data-ref="548order">order</dfn>,</td></tr>
<tr><th id="1804">1804</th><td>						<em>int</em> <dfn class="local col9 decl" id="549migratetype" title='migratetype' data-type='int' data-ref="549migratetype">migratetype</dfn>)</td></tr>
<tr><th id="1805">1805</th><td>{</td></tr>
<tr><th id="1806">1806</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="550current_order" title='current_order' data-type='unsigned int' data-ref="550current_order">current_order</dfn>;</td></tr>
<tr><th id="1807">1807</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col1 decl" id="551area" title='area' data-type='struct free_area *' data-ref="551area">area</dfn>;</td></tr>
<tr><th id="1808">1808</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="552page" title='page' data-type='struct page *' data-ref="552page">page</dfn>;</td></tr>
<tr><th id="1809">1809</th><td></td></tr>
<tr><th id="1810">1810</th><td>	<i>/* Find a page of the appropriate size in the preferred list */</i></td></tr>
<tr><th id="1811">1811</th><td>	<b>for</b> (<a class="local col0 ref" href="#550current_order" title='current_order' data-ref="550current_order">current_order</a> = <a class="local col8 ref" href="#548order" title='order' data-ref="548order">order</a>; <a class="local col0 ref" href="#550current_order" title='current_order' data-ref="550current_order">current_order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>; ++<a class="local col0 ref" href="#550current_order" title='current_order' data-ref="550current_order">current_order</a>) {</td></tr>
<tr><th id="1812">1812</th><td>		<a class="local col1 ref" href="#551area" title='area' data-ref="551area">area</a> = &amp;(<a class="local col7 ref" href="#547zone" title='zone' data-ref="547zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col0 ref" href="#550current_order" title='current_order' data-ref="550current_order">current_order</a>]);</td></tr>
<tr><th id="1813">1813</th><td>		<a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a> = <a class="macro" href="../include/linux/list.h.html#398" title="({ struct list_head *head__ = (&amp;area-&gt;free_list[migratetype]); struct list_head *pos__ = ({ union { typeof(head__-&gt;next) __val; char __c[1]; } __u; if (1) __read_once_size(&amp;(head__-&gt;next), __u.__c, sizeof(head__-&gt;next)); else __read_once_size_nocheck(&amp;(head__-&gt;next), __u.__c, sizeof(head__-&gt;next)); do { } while (0); __u.__val; }); pos__ != head__ ? ({ void *__mptr = (void *)(pos__); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*(pos__)), typeof(((struct page *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*(pos__)), typeof(void)))); extern void __compiletime_assert_1814(void) ; if (__cond) __compiletime_assert_1814(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((struct page *)(__mptr - __builtin_offsetof(struct page, lru))); }) : ((void *)0); })" data-ref="_M/list_first_entry_or_null">list_first_entry_or_null</a>(&amp;<a class="local col1 ref" href="#551area" title='area' data-ref="551area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col9 ref" href="#549migratetype" title='migratetype' data-ref="549migratetype">migratetype</a>],</td></tr>
<tr><th id="1814">1814</th><td>							<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="1815">1815</th><td>		<b>if</b> (!<a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a>)</td></tr>
<tr><th id="1816">1816</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1817">1817</th><td>		<a class="ref fn" href="../include/linux/list.h.html#list_del" title='list_del' data-ref="list_del">list_del</a>(&amp;<a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="1818">1818</th><td>		<a class="tu ref fn" href="#rmv_page_order" title='rmv_page_order' data-use='c' data-ref="rmv_page_order">rmv_page_order</a>(<a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a>);</td></tr>
<tr><th id="1819">1819</th><td>		<a class="local col1 ref" href="#551area" title='area' data-ref="551area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>--;</td></tr>
<tr><th id="1820">1820</th><td>		<a class="tu ref fn" href="#expand" title='expand' data-use='c' data-ref="expand">expand</a>(<a class="local col7 ref" href="#547zone" title='zone' data-ref="547zone">zone</a>, <a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a>, <a class="local col8 ref" href="#548order" title='order' data-ref="548order">order</a>, <a class="local col0 ref" href="#550current_order" title='current_order' data-ref="550current_order">current_order</a>, <a class="local col1 ref" href="#551area" title='area' data-ref="551area">area</a>, <a class="local col9 ref" href="#549migratetype" title='migratetype' data-ref="549migratetype">migratetype</a>);</td></tr>
<tr><th id="1821">1821</th><td>		<a class="tu ref fn" href="#set_pcppage_migratetype" title='set_pcppage_migratetype' data-use='c' data-ref="set_pcppage_migratetype">set_pcppage_migratetype</a>(<a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a>, <a class="local col9 ref" href="#549migratetype" title='migratetype' data-ref="549migratetype">migratetype</a>);</td></tr>
<tr><th id="1822">1822</th><td>		<b>return</b> <a class="local col2 ref" href="#552page" title='page' data-ref="552page">page</a>;</td></tr>
<tr><th id="1823">1823</th><td>	}</td></tr>
<tr><th id="1824">1824</th><td></td></tr>
<tr><th id="1825">1825</th><td>	<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1826">1826</th><td>}</td></tr>
<tr><th id="1827">1827</th><td></td></tr>
<tr><th id="1828">1828</th><td></td></tr>
<tr><th id="1829">1829</th><td><i  data-doc="fallbacks">/*</i></td></tr>
<tr><th id="1830">1830</th><td><i  data-doc="fallbacks"> * This array describes the order lists are fallen back to when</i></td></tr>
<tr><th id="1831">1831</th><td><i  data-doc="fallbacks"> * the free lists for the desirable migrate type are depleted</i></td></tr>
<tr><th id="1832">1832</th><td><i  data-doc="fallbacks"> */</i></td></tr>
<tr><th id="1833">1833</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="fallbacks" title='fallbacks' data-type='int [4][4]' data-ref="fallbacks">fallbacks</dfn>[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>][<var>4</var>] = {</td></tr>
<tr><th id="1834">1834</th><td>	[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_UNMOVABLE" title='MIGRATE_UNMOVABLE' data-ref="MIGRATE_UNMOVABLE">MIGRATE_UNMOVABLE</a>]   = { <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_RECLAIMABLE" title='MIGRATE_RECLAIMABLE' data-ref="MIGRATE_RECLAIMABLE">MIGRATE_RECLAIMABLE</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>,   <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a> },</td></tr>
<tr><th id="1835">1835</th><td>	[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_RECLAIMABLE" title='MIGRATE_RECLAIMABLE' data-ref="MIGRATE_RECLAIMABLE">MIGRATE_RECLAIMABLE</a>] = { <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_UNMOVABLE" title='MIGRATE_UNMOVABLE' data-ref="MIGRATE_UNMOVABLE">MIGRATE_UNMOVABLE</a>,   <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>,   <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a> },</td></tr>
<tr><th id="1836">1836</th><td>	[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>]     = { <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_RECLAIMABLE" title='MIGRATE_RECLAIMABLE' data-ref="MIGRATE_RECLAIMABLE">MIGRATE_RECLAIMABLE</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_UNMOVABLE" title='MIGRATE_UNMOVABLE' data-ref="MIGRATE_UNMOVABLE">MIGRATE_UNMOVABLE</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a> },</td></tr>
<tr><th id="1837">1837</th><td><u>#<span data-ppcond="1837">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="1838">1838</th><td>	[MIGRATE_CMA]         = { MIGRATE_TYPES }, <i>/* Never used */</i></td></tr>
<tr><th id="1839">1839</th><td><u>#<span data-ppcond="1837">endif</span></u></td></tr>
<tr><th id="1840">1840</th><td><u>#<span data-ppcond="1840">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMORY_ISOLATION">CONFIG_MEMORY_ISOLATION</span></u></td></tr>
<tr><th id="1841">1841</th><td>	[MIGRATE_ISOLATE]     = { MIGRATE_TYPES }, <i>/* Never used */</i></td></tr>
<tr><th id="1842">1842</th><td><u>#<span data-ppcond="1840">endif</span></u></td></tr>
<tr><th id="1843">1843</th><td>};</td></tr>
<tr><th id="1844">1844</th><td></td></tr>
<tr><th id="1845">1845</th><td><u>#<span data-ppcond="1845">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="1846">1846</th><td><em>static</em> <b>struct</b> page *__rmqueue_cma_fallback(<b>struct</b> zone *zone,</td></tr>
<tr><th id="1847">1847</th><td>					<em>unsigned</em> <em>int</em> order)</td></tr>
<tr><th id="1848">1848</th><td>{</td></tr>
<tr><th id="1849">1849</th><td>	<b>return</b> __rmqueue_smallest(zone, order, MIGRATE_CMA);</td></tr>
<tr><th id="1850">1850</th><td>}</td></tr>
<tr><th id="1851">1851</th><td><u>#<span data-ppcond="1845">else</span></u></td></tr>
<tr><th id="1852">1852</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="__rmqueue_cma_fallback" title='__rmqueue_cma_fallback' data-type='struct page * __rmqueue_cma_fallback(struct zone * zone, unsigned int order)' data-ref="__rmqueue_cma_fallback">__rmqueue_cma_fallback</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col3 decl" id="553zone" title='zone' data-type='struct zone *' data-ref="553zone">zone</dfn>,</td></tr>
<tr><th id="1853">1853</th><td>					<em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="554order" title='order' data-type='unsigned int' data-ref="554order">order</dfn>) { <b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>; }</td></tr>
<tr><th id="1854">1854</th><td><u>#<span data-ppcond="1845">endif</span></u></td></tr>
<tr><th id="1855">1855</th><td></td></tr>
<tr><th id="1856">1856</th><td><i  data-doc="move_freepages">/*</i></td></tr>
<tr><th id="1857">1857</th><td><i  data-doc="move_freepages"> * Move the free pages in a range to the free lists of the requested type.</i></td></tr>
<tr><th id="1858">1858</th><td><i  data-doc="move_freepages"> * Note that start_page and end_pages are not aligned on a pageblock</i></td></tr>
<tr><th id="1859">1859</th><td><i  data-doc="move_freepages"> * boundary. If alignment is required, use move_freepages_block()</i></td></tr>
<tr><th id="1860">1860</th><td><i  data-doc="move_freepages"> */</i></td></tr>
<tr><th id="1861">1861</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="move_freepages" title='move_freepages' data-type='int move_freepages(struct zone * zone, struct page * start_page, struct page * end_page, int migratetype, int * num_movable)' data-ref="move_freepages">move_freepages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col5 decl" id="555zone" title='zone' data-type='struct zone *' data-ref="555zone">zone</dfn>,</td></tr>
<tr><th id="1862">1862</th><td>			  <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="556start_page" title='start_page' data-type='struct page *' data-ref="556start_page">start_page</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col7 decl" id="557end_page" title='end_page' data-type='struct page *' data-ref="557end_page">end_page</dfn>,</td></tr>
<tr><th id="1863">1863</th><td>			  <em>int</em> <dfn class="local col8 decl" id="558migratetype" title='migratetype' data-type='int' data-ref="558migratetype">migratetype</dfn>, <em>int</em> *<dfn class="local col9 decl" id="559num_movable" title='num_movable' data-type='int *' data-ref="559num_movable">num_movable</dfn>)</td></tr>
<tr><th id="1864">1864</th><td>{</td></tr>
<tr><th id="1865">1865</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="560page" title='page' data-type='struct page *' data-ref="560page">page</dfn>;</td></tr>
<tr><th id="1866">1866</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="561order" title='order' data-type='unsigned int' data-ref="561order">order</dfn>;</td></tr>
<tr><th id="1867">1867</th><td>	<em>int</em> <dfn class="local col2 decl" id="562pages_moved" title='pages_moved' data-type='int' data-ref="562pages_moved">pages_moved</dfn> = <var>0</var>;</td></tr>
<tr><th id="1868">1868</th><td></td></tr>
<tr><th id="1869">1869</th><td><u>#<span data-ppcond="1869">ifndef</span> <span class="macro" data-ref="_M/CONFIG_HOLES_IN_ZONE">CONFIG_HOLES_IN_ZONE</span></u></td></tr>
<tr><th id="1870">1870</th><td>	<i>/*</i></td></tr>
<tr><th id="1871">1871</th><td><i>	 * page_zone is not safe to call in this context when</i></td></tr>
<tr><th id="1872">1872</th><td><i>	 * CONFIG_HOLES_IN_ZONE is set. This bug check is probably redundant</i></td></tr>
<tr><th id="1873">1873</th><td><i>	 * anyway as we check zone boundaries in move_freepages_block().</i></td></tr>
<tr><th id="1874">1874</th><td><i>	 * Remove at a later date when no bug reports exist related to</i></td></tr>
<tr><th id="1875">1875</th><td><i>	 * grouping pages by mobility</i></td></tr>
<tr><th id="1876">1876</th><td><i>	 */</i></td></tr>
<tr><th id="1877">1877</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)(page_zone(start_page) != page_zone(end_page)))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>(<a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col6 ref" href="#556start_page" title='start_page' data-ref="556start_page">start_page</a>) != <a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col7 ref" href="#557end_page" title='end_page' data-ref="557end_page">end_page</a>));</td></tr>
<tr><th id="1878">1878</th><td><u>#<span data-ppcond="1869">endif</span></u></td></tr>
<tr><th id="1879">1879</th><td></td></tr>
<tr><th id="1880">1880</th><td>	<b>if</b> (<a class="local col9 ref" href="#559num_movable" title='num_movable' data-ref="559num_movable">num_movable</a>)</td></tr>
<tr><th id="1881">1881</th><td>		*<a class="local col9 ref" href="#559num_movable" title='num_movable' data-ref="559num_movable">num_movable</a> = <var>0</var>;</td></tr>
<tr><th id="1882">1882</th><td></td></tr>
<tr><th id="1883">1883</th><td>	<b>for</b> (<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a> = <a class="local col6 ref" href="#556start_page" title='start_page' data-ref="556start_page">start_page</a>; <a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a> &lt;= <a class="local col7 ref" href="#557end_page" title='end_page' data-ref="557end_page">end_page</a>;) {</td></tr>
<tr><th id="1884">1884</th><td>		<b>if</b> (!<a class="macro" href="../include/linux/mmzone.h.html#1301" title="(1)" data-ref="_M/pfn_valid_within">pfn_valid_within</a>(page_to_pfn(page))) {</td></tr>
<tr><th id="1885">1885</th><td>			<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>++;</td></tr>
<tr><th id="1886">1886</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1887">1887</th><td>		}</td></tr>
<tr><th id="1888">1888</th><td></td></tr>
<tr><th id="1889">1889</th><td>		<i>/* Make sure we are not inadvertently changing nodes */</i></td></tr>
<tr><th id="1890">1890</th><td>		<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(page_to_nid(page) != zone_to_nid(zone)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/mm.h.html#page_to_nid" title='page_to_nid' data-ref="page_to_nid">page_to_nid</a>(<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>) != <a class="ref fn" href="../include/linux/mm.h.html#zone_to_nid" title='zone_to_nid' data-ref="zone_to_nid">zone_to_nid</a>(<a class="local col5 ref" href="#555zone" title='zone' data-ref="555zone">zone</a>), page);</td></tr>
<tr><th id="1891">1891</th><td></td></tr>
<tr><th id="1892">1892</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='PageBuddy' data-ref="PageBuddy">PageBuddy</a>(<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>)) {</td></tr>
<tr><th id="1893">1893</th><td>			<i>/*</i></td></tr>
<tr><th id="1894">1894</th><td><i>			 * We assume that pages that could be isolated for</i></td></tr>
<tr><th id="1895">1895</th><td><i>			 * migration are movable. But we don't actually try</i></td></tr>
<tr><th id="1896">1896</th><td><i>			 * isolating, as that would be expensive.</i></td></tr>
<tr><th id="1897">1897</th><td><i>			 */</i></td></tr>
<tr><th id="1898">1898</th><td>			<b>if</b> (<a class="local col9 ref" href="#559num_movable" title='num_movable' data-ref="559num_movable">num_movable</a> &amp;&amp;</td></tr>
<tr><th id="1899">1899</th><td>					(<a class="ref fn" href="../include/linux/page-flags.h.html#273" title='PageLRU' data-ref="PageLRU">PageLRU</a>(<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>) || <a class="ref fn" href="../include/linux/page-flags.h.html#__PageMovable" title='__PageMovable' data-ref="__PageMovable">__PageMovable</a>(<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>)))</td></tr>
<tr><th id="1900">1900</th><td>				(*<a class="local col9 ref" href="#559num_movable" title='num_movable' data-ref="559num_movable">num_movable</a>)++;</td></tr>
<tr><th id="1901">1901</th><td></td></tr>
<tr><th id="1902">1902</th><td>			<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>++;</td></tr>
<tr><th id="1903">1903</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1904">1904</th><td>		}</td></tr>
<tr><th id="1905">1905</th><td></td></tr>
<tr><th id="1906">1906</th><td>		<a class="local col1 ref" href="#561order" title='order' data-ref="561order">order</a> = <a class="ref fn" href="internal.h.html#page_order" title='page_order' data-ref="page_order">page_order</a>(<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>);</td></tr>
<tr><th id="1907">1907</th><td>		<a class="ref fn" href="../include/linux/list.h.html#list_move" title='list_move' data-ref="list_move">list_move</a>(&amp;<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>,</td></tr>
<tr><th id="1908">1908</th><td>			  &amp;<a class="local col5 ref" href="#555zone" title='zone' data-ref="555zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col1 ref" href="#561order" title='order' data-ref="561order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col8 ref" href="#558migratetype" title='migratetype' data-ref="558migratetype">migratetype</a>]);</td></tr>
<tr><th id="1909">1909</th><td>		<a class="local col0 ref" href="#560page" title='page' data-ref="560page">page</a> += <var>1</var> &lt;&lt; <a class="local col1 ref" href="#561order" title='order' data-ref="561order">order</a>;</td></tr>
<tr><th id="1910">1910</th><td>		<a class="local col2 ref" href="#562pages_moved" title='pages_moved' data-ref="562pages_moved">pages_moved</a> += <var>1</var> &lt;&lt; <a class="local col1 ref" href="#561order" title='order' data-ref="561order">order</a>;</td></tr>
<tr><th id="1911">1911</th><td>	}</td></tr>
<tr><th id="1912">1912</th><td></td></tr>
<tr><th id="1913">1913</th><td>	<b>return</b> <a class="local col2 ref" href="#562pages_moved" title='pages_moved' data-ref="562pages_moved">pages_moved</a>;</td></tr>
<tr><th id="1914">1914</th><td>}</td></tr>
<tr><th id="1915">1915</th><td></td></tr>
<tr><th id="1916">1916</th><td><em>int</em> <dfn class="decl def fn" id="move_freepages_block" title='move_freepages_block' data-ref="move_freepages_block">move_freepages_block</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col3 decl" id="563zone" title='zone' data-type='struct zone *' data-ref="563zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="564page" title='page' data-type='struct page *' data-ref="564page">page</dfn>,</td></tr>
<tr><th id="1917">1917</th><td>				<em>int</em> <dfn class="local col5 decl" id="565migratetype" title='migratetype' data-type='int' data-ref="565migratetype">migratetype</dfn>, <em>int</em> *<dfn class="local col6 decl" id="566num_movable" title='num_movable' data-type='int *' data-ref="566num_movable">num_movable</dfn>)</td></tr>
<tr><th id="1918">1918</th><td>{</td></tr>
<tr><th id="1919">1919</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="567start_pfn" title='start_pfn' data-type='unsigned long' data-ref="567start_pfn">start_pfn</dfn>, <dfn class="local col8 decl" id="568end_pfn" title='end_pfn' data-type='unsigned long' data-ref="568end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="1920">1920</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="569start_page" title='start_page' data-type='struct page *' data-ref="569start_page">start_page</dfn>, *<dfn class="local col0 decl" id="570end_page" title='end_page' data-type='struct page *' data-ref="570end_page">end_page</dfn>;</td></tr>
<tr><th id="1921">1921</th><td></td></tr>
<tr><th id="1922">1922</th><td>	<a class="local col7 ref" href="#567start_pfn" title='start_pfn' data-ref="567start_pfn">start_pfn</a> = <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col4 ref" href="#564page" title='page' data-ref="564page">page</a>);</td></tr>
<tr><th id="1923">1923</th><td>	<a class="local col7 ref" href="#567start_pfn" title='start_pfn' data-ref="567start_pfn">start_pfn</a> = <a class="local col7 ref" href="#567start_pfn" title='start_pfn' data-ref="567start_pfn">start_pfn</a> &amp; ~(<a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>-<var>1</var>);</td></tr>
<tr><th id="1924">1924</th><td>	<a class="local col9 ref" href="#569start_page" title='start_page' data-ref="569start_page">start_page</a> = <a class="macro" href="../include/asm-generic/memory_model.h.html#82" title="__pfn_to_page" data-ref="_M/pfn_to_page">pfn_to_page</a>(<a class="local col7 ref" href="#567start_pfn" title='start_pfn' data-ref="567start_pfn">start_pfn</a>);</td></tr>
<tr><th id="1925">1925</th><td>	<a class="local col0 ref" href="#570end_page" title='end_page' data-ref="570end_page">end_page</a> = <a class="local col9 ref" href="#569start_page" title='start_page' data-ref="569start_page">start_page</a> + <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a> - <var>1</var>;</td></tr>
<tr><th id="1926">1926</th><td>	<a class="local col8 ref" href="#568end_pfn" title='end_pfn' data-ref="568end_pfn">end_pfn</a> = <a class="local col7 ref" href="#567start_pfn" title='start_pfn' data-ref="567start_pfn">start_pfn</a> + <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a> - <var>1</var>;</td></tr>
<tr><th id="1927">1927</th><td></td></tr>
<tr><th id="1928">1928</th><td>	<i>/* Do not cross zone boundaries */</i></td></tr>
<tr><th id="1929">1929</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#zone_spans_pfn" title='zone_spans_pfn' data-ref="zone_spans_pfn">zone_spans_pfn</a>(<a class="local col3 ref" href="#563zone" title='zone' data-ref="563zone">zone</a>, <a class="local col7 ref" href="#567start_pfn" title='start_pfn' data-ref="567start_pfn">start_pfn</a>))</td></tr>
<tr><th id="1930">1930</th><td>		<a class="local col9 ref" href="#569start_page" title='start_page' data-ref="569start_page">start_page</a> = <a class="local col4 ref" href="#564page" title='page' data-ref="564page">page</a>;</td></tr>
<tr><th id="1931">1931</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#zone_spans_pfn" title='zone_spans_pfn' data-ref="zone_spans_pfn">zone_spans_pfn</a>(<a class="local col3 ref" href="#563zone" title='zone' data-ref="563zone">zone</a>, <a class="local col8 ref" href="#568end_pfn" title='end_pfn' data-ref="568end_pfn">end_pfn</a>))</td></tr>
<tr><th id="1932">1932</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1933">1933</th><td></td></tr>
<tr><th id="1934">1934</th><td>	<b>return</b> <a class="tu ref fn" href="#move_freepages" title='move_freepages' data-use='c' data-ref="move_freepages">move_freepages</a>(<a class="local col3 ref" href="#563zone" title='zone' data-ref="563zone">zone</a>, <a class="local col9 ref" href="#569start_page" title='start_page' data-ref="569start_page">start_page</a>, <a class="local col0 ref" href="#570end_page" title='end_page' data-ref="570end_page">end_page</a>, <a class="local col5 ref" href="#565migratetype" title='migratetype' data-ref="565migratetype">migratetype</a>,</td></tr>
<tr><th id="1935">1935</th><td>								<a class="local col6 ref" href="#566num_movable" title='num_movable' data-ref="566num_movable">num_movable</a>);</td></tr>
<tr><th id="1936">1936</th><td>}</td></tr>
<tr><th id="1937">1937</th><td></td></tr>
<tr><th id="1938">1938</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="change_pageblock_range" title='change_pageblock_range' data-type='void change_pageblock_range(struct page * pageblock_page, int start_order, int migratetype)' data-ref="change_pageblock_range">change_pageblock_range</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="571pageblock_page" title='pageblock_page' data-type='struct page *' data-ref="571pageblock_page">pageblock_page</dfn>,</td></tr>
<tr><th id="1939">1939</th><td>					<em>int</em> <dfn class="local col2 decl" id="572start_order" title='start_order' data-type='int' data-ref="572start_order">start_order</dfn>, <em>int</em> <dfn class="local col3 decl" id="573migratetype" title='migratetype' data-type='int' data-ref="573migratetype">migratetype</dfn>)</td></tr>
<tr><th id="1940">1940</th><td>{</td></tr>
<tr><th id="1941">1941</th><td>	<em>int</em> <dfn class="local col4 decl" id="574nr_pageblocks" title='nr_pageblocks' data-type='int' data-ref="574nr_pageblocks">nr_pageblocks</dfn> = <var>1</var> &lt;&lt; (<a class="local col2 ref" href="#572start_order" title='start_order' data-ref="572start_order">start_order</a> - <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a>);</td></tr>
<tr><th id="1942">1942</th><td></td></tr>
<tr><th id="1943">1943</th><td>	<b>while</b> (<a class="local col4 ref" href="#574nr_pageblocks" title='nr_pageblocks' data-ref="574nr_pageblocks">nr_pageblocks</a>--) {</td></tr>
<tr><th id="1944">1944</th><td>		<a class="ref fn" href="#set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</a>(<a class="local col1 ref" href="#571pageblock_page" title='pageblock_page' data-ref="571pageblock_page">pageblock_page</a>, <a class="local col3 ref" href="#573migratetype" title='migratetype' data-ref="573migratetype">migratetype</a>);</td></tr>
<tr><th id="1945">1945</th><td>		<a class="local col1 ref" href="#571pageblock_page" title='pageblock_page' data-ref="571pageblock_page">pageblock_page</a> += <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>;</td></tr>
<tr><th id="1946">1946</th><td>	}</td></tr>
<tr><th id="1947">1947</th><td>}</td></tr>
<tr><th id="1948">1948</th><td></td></tr>
<tr><th id="1949">1949</th><td><i  data-doc="can_steal_fallback">/*</i></td></tr>
<tr><th id="1950">1950</th><td><i  data-doc="can_steal_fallback"> * When we are falling back to another migratetype during allocation, try to</i></td></tr>
<tr><th id="1951">1951</th><td><i  data-doc="can_steal_fallback"> * steal extra free pages from the same pageblocks to satisfy further</i></td></tr>
<tr><th id="1952">1952</th><td><i  data-doc="can_steal_fallback"> * allocations, instead of polluting multiple pageblocks.</i></td></tr>
<tr><th id="1953">1953</th><td><i  data-doc="can_steal_fallback"> *</i></td></tr>
<tr><th id="1954">1954</th><td><i  data-doc="can_steal_fallback"> * If we are stealing a relatively large buddy page, it is likely there will</i></td></tr>
<tr><th id="1955">1955</th><td><i  data-doc="can_steal_fallback"> * be more free pages in the pageblock, so try to steal them all. For</i></td></tr>
<tr><th id="1956">1956</th><td><i  data-doc="can_steal_fallback"> * reclaimable and unmovable allocations, we steal regardless of page size,</i></td></tr>
<tr><th id="1957">1957</th><td><i  data-doc="can_steal_fallback"> * as fragmentation caused by those allocations polluting movable pageblocks</i></td></tr>
<tr><th id="1958">1958</th><td><i  data-doc="can_steal_fallback"> * is worse than movable allocations stealing from unmovable and reclaimable</i></td></tr>
<tr><th id="1959">1959</th><td><i  data-doc="can_steal_fallback"> * pageblocks.</i></td></tr>
<tr><th id="1960">1960</th><td><i  data-doc="can_steal_fallback"> */</i></td></tr>
<tr><th id="1961">1961</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="can_steal_fallback" title='can_steal_fallback' data-type='bool can_steal_fallback(unsigned int order, int start_mt)' data-ref="can_steal_fallback">can_steal_fallback</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="575order" title='order' data-type='unsigned int' data-ref="575order">order</dfn>, <em>int</em> <dfn class="local col6 decl" id="576start_mt" title='start_mt' data-type='int' data-ref="576start_mt">start_mt</dfn>)</td></tr>
<tr><th id="1962">1962</th><td>{</td></tr>
<tr><th id="1963">1963</th><td>	<i>/*</i></td></tr>
<tr><th id="1964">1964</th><td><i>	 * Leaving this order check is intended, although there is</i></td></tr>
<tr><th id="1965">1965</th><td><i>	 * relaxed order check in next check. The reason is that</i></td></tr>
<tr><th id="1966">1966</th><td><i>	 * we can actually steal whole pageblock if this condition met,</i></td></tr>
<tr><th id="1967">1967</th><td><i>	 * but, below check doesn't guarantee it and that is just heuristic</i></td></tr>
<tr><th id="1968">1968</th><td><i>	 * so could be changed anytime.</i></td></tr>
<tr><th id="1969">1969</th><td><i>	 */</i></td></tr>
<tr><th id="1970">1970</th><td>	<b>if</b> (<a class="local col5 ref" href="#575order" title='order' data-ref="575order">order</a> &gt;= <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a>)</td></tr>
<tr><th id="1971">1971</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1972">1972</th><td></td></tr>
<tr><th id="1973">1973</th><td>	<b>if</b> (<a class="local col5 ref" href="#575order" title='order' data-ref="575order">order</a> &gt;= <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a> / <var>2</var> ||</td></tr>
<tr><th id="1974">1974</th><td>		<a class="local col6 ref" href="#576start_mt" title='start_mt' data-ref="576start_mt">start_mt</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_RECLAIMABLE" title='MIGRATE_RECLAIMABLE' data-ref="MIGRATE_RECLAIMABLE">MIGRATE_RECLAIMABLE</a> ||</td></tr>
<tr><th id="1975">1975</th><td>		<a class="local col6 ref" href="#576start_mt" title='start_mt' data-ref="576start_mt">start_mt</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_UNMOVABLE" title='MIGRATE_UNMOVABLE' data-ref="MIGRATE_UNMOVABLE">MIGRATE_UNMOVABLE</a> ||</td></tr>
<tr><th id="1976">1976</th><td>		<a class="ref" href="../include/linux/mmzone.h.html#page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</a>)</td></tr>
<tr><th id="1977">1977</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="1978">1978</th><td></td></tr>
<tr><th id="1979">1979</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="1980">1980</th><td>}</td></tr>
<tr><th id="1981">1981</th><td></td></tr>
<tr><th id="1982">1982</th><td><i  data-doc="steal_suitable_fallback">/*</i></td></tr>
<tr><th id="1983">1983</th><td><i  data-doc="steal_suitable_fallback"> * This function implements actual steal behaviour. If order is large enough,</i></td></tr>
<tr><th id="1984">1984</th><td><i  data-doc="steal_suitable_fallback"> * we can steal whole pageblock. If not, we first move freepages in this</i></td></tr>
<tr><th id="1985">1985</th><td><i  data-doc="steal_suitable_fallback"> * pageblock to our migratetype and determine how many already-allocated pages</i></td></tr>
<tr><th id="1986">1986</th><td><i  data-doc="steal_suitable_fallback"> * are there in the pageblock with a compatible migratetype. If at least half</i></td></tr>
<tr><th id="1987">1987</th><td><i  data-doc="steal_suitable_fallback"> * of pages are free or compatible, we can change migratetype of the pageblock</i></td></tr>
<tr><th id="1988">1988</th><td><i  data-doc="steal_suitable_fallback"> * itself, so pages freed in the future will be put on the correct free list.</i></td></tr>
<tr><th id="1989">1989</th><td><i  data-doc="steal_suitable_fallback"> */</i></td></tr>
<tr><th id="1990">1990</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="steal_suitable_fallback" title='steal_suitable_fallback' data-type='void steal_suitable_fallback(struct zone * zone, struct page * page, int start_type, bool whole_block)' data-ref="steal_suitable_fallback">steal_suitable_fallback</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="577zone" title='zone' data-type='struct zone *' data-ref="577zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="578page" title='page' data-type='struct page *' data-ref="578page">page</dfn>,</td></tr>
<tr><th id="1991">1991</th><td>					<em>int</em> <dfn class="local col9 decl" id="579start_type" title='start_type' data-type='int' data-ref="579start_type">start_type</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col0 decl" id="580whole_block" title='whole_block' data-type='bool' data-ref="580whole_block">whole_block</dfn>)</td></tr>
<tr><th id="1992">1992</th><td>{</td></tr>
<tr><th id="1993">1993</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="581current_order" title='current_order' data-type='unsigned int' data-ref="581current_order">current_order</dfn> = <a class="ref fn" href="internal.h.html#page_order" title='page_order' data-ref="page_order">page_order</a>(<a class="local col8 ref" href="#578page" title='page' data-ref="578page">page</a>);</td></tr>
<tr><th id="1994">1994</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col2 decl" id="582area" title='area' data-type='struct free_area *' data-ref="582area">area</dfn>;</td></tr>
<tr><th id="1995">1995</th><td>	<em>int</em> <dfn class="local col3 decl" id="583free_pages" title='free_pages' data-type='int' data-ref="583free_pages">free_pages</dfn>, <dfn class="local col4 decl" id="584movable_pages" title='movable_pages' data-type='int' data-ref="584movable_pages">movable_pages</dfn>, <dfn class="local col5 decl" id="585alike_pages" title='alike_pages' data-type='int' data-ref="585alike_pages">alike_pages</dfn>;</td></tr>
<tr><th id="1996">1996</th><td>	<em>int</em> <dfn class="local col6 decl" id="586old_block_type" title='old_block_type' data-type='int' data-ref="586old_block_type">old_block_type</dfn>;</td></tr>
<tr><th id="1997">1997</th><td></td></tr>
<tr><th id="1998">1998</th><td>	<a class="local col6 ref" href="#586old_block_type" title='old_block_type' data-ref="586old_block_type">old_block_type</a> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(page, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col8 ref" href="#578page" title='page' data-ref="578page">page</a>);</td></tr>
<tr><th id="1999">1999</th><td></td></tr>
<tr><th id="2000">2000</th><td>	<i>/*</i></td></tr>
<tr><th id="2001">2001</th><td><i>	 * This can happen due to races and we want to prevent broken</i></td></tr>
<tr><th id="2002">2002</th><td><i>	 * highatomic accounting.</i></td></tr>
<tr><th id="2003">2003</th><td><i>	 */</i></td></tr>
<tr><th id="2004">2004</th><td>	<b>if</b> (<a class="ref fn" href="internal.h.html#is_migrate_highatomic" title='is_migrate_highatomic' data-ref="is_migrate_highatomic">is_migrate_highatomic</a>(<a class="local col6 ref" href="#586old_block_type" title='old_block_type' data-ref="586old_block_type">old_block_type</a>))</td></tr>
<tr><th id="2005">2005</th><td>		<b>goto</b> <a class="lbl" href="#587single_page" data-ref="587single_page">single_page</a>;</td></tr>
<tr><th id="2006">2006</th><td></td></tr>
<tr><th id="2007">2007</th><td>	<i>/* Take ownership for orders &gt;= pageblock_order */</i></td></tr>
<tr><th id="2008">2008</th><td>	<b>if</b> (<a class="local col1 ref" href="#581current_order" title='current_order' data-ref="581current_order">current_order</a> &gt;= <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a>) {</td></tr>
<tr><th id="2009">2009</th><td>		<a class="tu ref fn" href="#change_pageblock_range" title='change_pageblock_range' data-use='c' data-ref="change_pageblock_range">change_pageblock_range</a>(<a class="local col8 ref" href="#578page" title='page' data-ref="578page">page</a>, <a class="local col1 ref" href="#581current_order" title='current_order' data-ref="581current_order">current_order</a>, <a class="local col9 ref" href="#579start_type" title='start_type' data-ref="579start_type">start_type</a>);</td></tr>
<tr><th id="2010">2010</th><td>		<b>goto</b> <a class="lbl" href="#587single_page" data-ref="587single_page">single_page</a>;</td></tr>
<tr><th id="2011">2011</th><td>	}</td></tr>
<tr><th id="2012">2012</th><td></td></tr>
<tr><th id="2013">2013</th><td>	<i>/* We are not allowed to try stealing from the whole block */</i></td></tr>
<tr><th id="2014">2014</th><td>	<b>if</b> (!<a class="local col0 ref" href="#580whole_block" title='whole_block' data-ref="580whole_block">whole_block</a>)</td></tr>
<tr><th id="2015">2015</th><td>		<b>goto</b> <a class="lbl" href="#587single_page" data-ref="587single_page">single_page</a>;</td></tr>
<tr><th id="2016">2016</th><td></td></tr>
<tr><th id="2017">2017</th><td>	<a class="local col3 ref" href="#583free_pages" title='free_pages' data-ref="583free_pages">free_pages</a> = <a class="ref fn" href="#move_freepages_block" title='move_freepages_block' data-ref="move_freepages_block">move_freepages_block</a>(<a class="local col7 ref" href="#577zone" title='zone' data-ref="577zone">zone</a>, <a class="local col8 ref" href="#578page" title='page' data-ref="578page">page</a>, <a class="local col9 ref" href="#579start_type" title='start_type' data-ref="579start_type">start_type</a>,</td></tr>
<tr><th id="2018">2018</th><td>						&amp;<a class="local col4 ref" href="#584movable_pages" title='movable_pages' data-ref="584movable_pages">movable_pages</a>);</td></tr>
<tr><th id="2019">2019</th><td>	<i>/*</i></td></tr>
<tr><th id="2020">2020</th><td><i>	 * Determine how many pages are compatible with our allocation.</i></td></tr>
<tr><th id="2021">2021</th><td><i>	 * For movable allocation, it's the number of movable pages which</i></td></tr>
<tr><th id="2022">2022</th><td><i>	 * we just obtained. For other types it's a bit more tricky.</i></td></tr>
<tr><th id="2023">2023</th><td><i>	 */</i></td></tr>
<tr><th id="2024">2024</th><td>	<b>if</b> (<a class="local col9 ref" href="#579start_type" title='start_type' data-ref="579start_type">start_type</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>) {</td></tr>
<tr><th id="2025">2025</th><td>		<a class="local col5 ref" href="#585alike_pages" title='alike_pages' data-ref="585alike_pages">alike_pages</a> = <a class="local col4 ref" href="#584movable_pages" title='movable_pages' data-ref="584movable_pages">movable_pages</a>;</td></tr>
<tr><th id="2026">2026</th><td>	} <b>else</b> {</td></tr>
<tr><th id="2027">2027</th><td>		<i>/*</i></td></tr>
<tr><th id="2028">2028</th><td><i>		 * If we are falling back a RECLAIMABLE or UNMOVABLE allocation</i></td></tr>
<tr><th id="2029">2029</th><td><i>		 * to MOVABLE pageblock, consider all non-movable pages as</i></td></tr>
<tr><th id="2030">2030</th><td><i>		 * compatible. If it's UNMOVABLE falling back to RECLAIMABLE or</i></td></tr>
<tr><th id="2031">2031</th><td><i>		 * vice versa, be conservative since we can't distinguish the</i></td></tr>
<tr><th id="2032">2032</th><td><i>		 * exact migratetype of non-movable pages.</i></td></tr>
<tr><th id="2033">2033</th><td><i>		 */</i></td></tr>
<tr><th id="2034">2034</th><td>		<b>if</b> (<a class="local col6 ref" href="#586old_block_type" title='old_block_type' data-ref="586old_block_type">old_block_type</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>)</td></tr>
<tr><th id="2035">2035</th><td>			<a class="local col5 ref" href="#585alike_pages" title='alike_pages' data-ref="585alike_pages">alike_pages</a> = <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a></td></tr>
<tr><th id="2036">2036</th><td>						- (<a class="local col3 ref" href="#583free_pages" title='free_pages' data-ref="583free_pages">free_pages</a> + <a class="local col4 ref" href="#584movable_pages" title='movable_pages' data-ref="584movable_pages">movable_pages</a>);</td></tr>
<tr><th id="2037">2037</th><td>		<b>else</b></td></tr>
<tr><th id="2038">2038</th><td>			<a class="local col5 ref" href="#585alike_pages" title='alike_pages' data-ref="585alike_pages">alike_pages</a> = <var>0</var>;</td></tr>
<tr><th id="2039">2039</th><td>	}</td></tr>
<tr><th id="2040">2040</th><td></td></tr>
<tr><th id="2041">2041</th><td>	<i>/* moving whole block can fail due to zone boundary conditions */</i></td></tr>
<tr><th id="2042">2042</th><td>	<b>if</b> (!<a class="local col3 ref" href="#583free_pages" title='free_pages' data-ref="583free_pages">free_pages</a>)</td></tr>
<tr><th id="2043">2043</th><td>		<b>goto</b> <a class="lbl" href="#587single_page" data-ref="587single_page">single_page</a>;</td></tr>
<tr><th id="2044">2044</th><td></td></tr>
<tr><th id="2045">2045</th><td>	<i>/*</i></td></tr>
<tr><th id="2046">2046</th><td><i>	 * If a sufficient number of pages in the block are either free or of</i></td></tr>
<tr><th id="2047">2047</th><td><i>	 * comparable migratability as our allocation, claim the whole block.</i></td></tr>
<tr><th id="2048">2048</th><td><i>	 */</i></td></tr>
<tr><th id="2049">2049</th><td>	<b>if</b> (<a class="local col3 ref" href="#583free_pages" title='free_pages' data-ref="583free_pages">free_pages</a> + <a class="local col5 ref" href="#585alike_pages" title='alike_pages' data-ref="585alike_pages">alike_pages</a> &gt;= (<var>1</var> &lt;&lt; (<a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a>-<var>1</var>)) ||</td></tr>
<tr><th id="2050">2050</th><td>			<a class="ref" href="../include/linux/mmzone.h.html#page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</a>)</td></tr>
<tr><th id="2051">2051</th><td>		<a class="ref fn" href="#set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</a>(<a class="local col8 ref" href="#578page" title='page' data-ref="578page">page</a>, <a class="local col9 ref" href="#579start_type" title='start_type' data-ref="579start_type">start_type</a>);</td></tr>
<tr><th id="2052">2052</th><td></td></tr>
<tr><th id="2053">2053</th><td>	<b>return</b>;</td></tr>
<tr><th id="2054">2054</th><td></td></tr>
<tr><th id="2055">2055</th><td><dfn class="lbl" id="587single_page" data-ref="587single_page">single_page</dfn>:</td></tr>
<tr><th id="2056">2056</th><td>	<a class="local col2 ref" href="#582area" title='area' data-ref="582area">area</a> = &amp;<a class="local col7 ref" href="#577zone" title='zone' data-ref="577zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col1 ref" href="#581current_order" title='current_order' data-ref="581current_order">current_order</a>];</td></tr>
<tr><th id="2057">2057</th><td>	<a class="ref fn" href="../include/linux/list.h.html#list_move" title='list_move' data-ref="list_move">list_move</a>(&amp;<a class="local col8 ref" href="#578page" title='page' data-ref="578page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, &amp;<a class="local col2 ref" href="#582area" title='area' data-ref="582area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col9 ref" href="#579start_type" title='start_type' data-ref="579start_type">start_type</a>]);</td></tr>
<tr><th id="2058">2058</th><td>}</td></tr>
<tr><th id="2059">2059</th><td></td></tr>
<tr><th id="2060">2060</th><td><i>/*</i></td></tr>
<tr><th id="2061">2061</th><td><i> * Check whether there is a suitable fallback freepage with requested order.</i></td></tr>
<tr><th id="2062">2062</th><td><i> * If only_stealable is true, this function returns fallback_mt only if</i></td></tr>
<tr><th id="2063">2063</th><td><i> * we can steal other freepages all together. This would help to reduce</i></td></tr>
<tr><th id="2064">2064</th><td><i> * fragmentation due to mixed migratetype pages in one pageblock.</i></td></tr>
<tr><th id="2065">2065</th><td><i> */</i></td></tr>
<tr><th id="2066">2066</th><td><em>int</em> <dfn class="decl def fn" id="find_suitable_fallback" title='find_suitable_fallback' data-ref="find_suitable_fallback">find_suitable_fallback</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col8 decl" id="588area" title='area' data-type='struct free_area *' data-ref="588area">area</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="589order" title='order' data-type='unsigned int' data-ref="589order">order</dfn>,</td></tr>
<tr><th id="2067">2067</th><td>			<em>int</em> <dfn class="local col0 decl" id="590migratetype" title='migratetype' data-type='int' data-ref="590migratetype">migratetype</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col1 decl" id="591only_stealable" title='only_stealable' data-type='bool' data-ref="591only_stealable">only_stealable</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> *<dfn class="local col2 decl" id="592can_steal" title='can_steal' data-type='bool *' data-ref="592can_steal">can_steal</dfn>)</td></tr>
<tr><th id="2068">2068</th><td>{</td></tr>
<tr><th id="2069">2069</th><td>	<em>int</em> <dfn class="local col3 decl" id="593i" title='i' data-type='int' data-ref="593i">i</dfn>;</td></tr>
<tr><th id="2070">2070</th><td>	<em>int</em> <dfn class="local col4 decl" id="594fallback_mt" title='fallback_mt' data-type='int' data-ref="594fallback_mt">fallback_mt</dfn>;</td></tr>
<tr><th id="2071">2071</th><td></td></tr>
<tr><th id="2072">2072</th><td>	<b>if</b> (<a class="local col8 ref" href="#588area" title='area' data-ref="588area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a> == <var>0</var>)</td></tr>
<tr><th id="2073">2073</th><td>		<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2074">2074</th><td></td></tr>
<tr><th id="2075">2075</th><td>	*<a class="local col2 ref" href="#592can_steal" title='can_steal' data-ref="592can_steal">can_steal</a> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="2076">2076</th><td>	<b>for</b> (<a class="local col3 ref" href="#593i" title='i' data-ref="593i">i</a> = <var>0</var>;; <a class="local col3 ref" href="#593i" title='i' data-ref="593i">i</a>++) {</td></tr>
<tr><th id="2077">2077</th><td>		<a class="local col4 ref" href="#594fallback_mt" title='fallback_mt' data-ref="594fallback_mt">fallback_mt</a> = <a class="tu ref" href="#fallbacks" title='fallbacks' data-use='r' data-ref="fallbacks">fallbacks</a>[<a class="local col0 ref" href="#590migratetype" title='migratetype' data-ref="590migratetype">migratetype</a>][<a class="local col3 ref" href="#593i" title='i' data-ref="593i">i</a>];</td></tr>
<tr><th id="2078">2078</th><td>		<b>if</b> (<a class="local col4 ref" href="#594fallback_mt" title='fallback_mt' data-ref="594fallback_mt">fallback_mt</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>)</td></tr>
<tr><th id="2079">2079</th><td>			<b>break</b>;</td></tr>
<tr><th id="2080">2080</th><td></td></tr>
<tr><th id="2081">2081</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(&amp;<a class="local col8 ref" href="#588area" title='area' data-ref="588area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col4 ref" href="#594fallback_mt" title='fallback_mt' data-ref="594fallback_mt">fallback_mt</a>]))</td></tr>
<tr><th id="2082">2082</th><td>			<b>continue</b>;</td></tr>
<tr><th id="2083">2083</th><td></td></tr>
<tr><th id="2084">2084</th><td>		<b>if</b> (<a class="tu ref fn" href="#can_steal_fallback" title='can_steal_fallback' data-use='c' data-ref="can_steal_fallback">can_steal_fallback</a>(<a class="local col9 ref" href="#589order" title='order' data-ref="589order">order</a>, <a class="local col0 ref" href="#590migratetype" title='migratetype' data-ref="590migratetype">migratetype</a>))</td></tr>
<tr><th id="2085">2085</th><td>			*<a class="local col2 ref" href="#592can_steal" title='can_steal' data-ref="592can_steal">can_steal</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="2086">2086</th><td></td></tr>
<tr><th id="2087">2087</th><td>		<b>if</b> (!<a class="local col1 ref" href="#591only_stealable" title='only_stealable' data-ref="591only_stealable">only_stealable</a>)</td></tr>
<tr><th id="2088">2088</th><td>			<b>return</b> <a class="local col4 ref" href="#594fallback_mt" title='fallback_mt' data-ref="594fallback_mt">fallback_mt</a>;</td></tr>
<tr><th id="2089">2089</th><td></td></tr>
<tr><th id="2090">2090</th><td>		<b>if</b> (*<a class="local col2 ref" href="#592can_steal" title='can_steal' data-ref="592can_steal">can_steal</a>)</td></tr>
<tr><th id="2091">2091</th><td>			<b>return</b> <a class="local col4 ref" href="#594fallback_mt" title='fallback_mt' data-ref="594fallback_mt">fallback_mt</a>;</td></tr>
<tr><th id="2092">2092</th><td>	}</td></tr>
<tr><th id="2093">2093</th><td></td></tr>
<tr><th id="2094">2094</th><td>	<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2095">2095</th><td>}</td></tr>
<tr><th id="2096">2096</th><td></td></tr>
<tr><th id="2097">2097</th><td><i  data-doc="reserve_highatomic_pageblock">/*</i></td></tr>
<tr><th id="2098">2098</th><td><i  data-doc="reserve_highatomic_pageblock"> * Reserve a pageblock for exclusive use of high-order atomic allocations if</i></td></tr>
<tr><th id="2099">2099</th><td><i  data-doc="reserve_highatomic_pageblock"> * there are no empty page blocks that contain a page with a suitable order</i></td></tr>
<tr><th id="2100">2100</th><td><i  data-doc="reserve_highatomic_pageblock"> */</i></td></tr>
<tr><th id="2101">2101</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="reserve_highatomic_pageblock" title='reserve_highatomic_pageblock' data-type='void reserve_highatomic_pageblock(struct page * page, struct zone * zone, unsigned int alloc_order)' data-ref="reserve_highatomic_pageblock">reserve_highatomic_pageblock</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="595page" title='page' data-type='struct page *' data-ref="595page">page</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="596zone" title='zone' data-type='struct zone *' data-ref="596zone">zone</dfn>,</td></tr>
<tr><th id="2102">2102</th><td>				<em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="597alloc_order" title='alloc_order' data-type='unsigned int' data-ref="597alloc_order">alloc_order</dfn>)</td></tr>
<tr><th id="2103">2103</th><td>{</td></tr>
<tr><th id="2104">2104</th><td>	<em>int</em> <dfn class="local col8 decl" id="598mt" title='mt' data-type='int' data-ref="598mt">mt</dfn>;</td></tr>
<tr><th id="2105">2105</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="599max_managed" title='max_managed' data-type='unsigned long' data-ref="599max_managed">max_managed</dfn>, <dfn class="local col0 decl" id="600flags" title='flags' data-type='unsigned long' data-ref="600flags">flags</dfn>;</td></tr>
<tr><th id="2106">2106</th><td></td></tr>
<tr><th id="2107">2107</th><td>	<i>/*</i></td></tr>
<tr><th id="2108">2108</th><td><i>	 * Limit the number reserved to 1 pageblock or roughly 1% of a zone.</i></td></tr>
<tr><th id="2109">2109</th><td><i>	 * Check is race-prone but harmless.</i></td></tr>
<tr><th id="2110">2110</th><td><i>	 */</i></td></tr>
<tr><th id="2111">2111</th><td>	<a class="local col9 ref" href="#599max_managed" title='max_managed' data-ref="599max_managed">max_managed</a> = (<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> / <var>100</var>) + <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>;</td></tr>
<tr><th id="2112">2112</th><td>	<b>if</b> (<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a> &gt;= <a class="local col9 ref" href="#599max_managed" title='max_managed' data-ref="599max_managed">max_managed</a>)</td></tr>
<tr><th id="2113">2113</th><td>		<b>return</b>;</td></tr>
<tr><th id="2114">2114</th><td></td></tr>
<tr><th id="2115">2115</th><td>	<a class="macro" href="../include/linux/spinlock.h.html#345" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = _raw_spin_lock_irqsave(spinlock_check(&amp;zone-&gt;lock)); } while (0); } while (0)" data-ref="_M/spin_lock_irqsave">spin_lock_irqsave</a>(&amp;<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col0 ref" href="#600flags" title='flags' data-ref="600flags">flags</a>);</td></tr>
<tr><th id="2116">2116</th><td></td></tr>
<tr><th id="2117">2117</th><td>	<i>/* Recheck the nr_reserved_highatomic limit under the lock */</i></td></tr>
<tr><th id="2118">2118</th><td>	<b>if</b> (<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a> &gt;= <a class="local col9 ref" href="#599max_managed" title='max_managed' data-ref="599max_managed">max_managed</a>)</td></tr>
<tr><th id="2119">2119</th><td>		<b>goto</b> <a class="lbl" href="#601out_unlock" data-ref="601out_unlock">out_unlock</a>;</td></tr>
<tr><th id="2120">2120</th><td></td></tr>
<tr><th id="2121">2121</th><td>	<i>/* Yoink! */</i></td></tr>
<tr><th id="2122">2122</th><td>	<a class="local col8 ref" href="#598mt" title='mt' data-ref="598mt">mt</a> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(page, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col5 ref" href="#595page" title='page' data-ref="595page">page</a>);</td></tr>
<tr><th id="2123">2123</th><td>	<b>if</b> (!<a class="ref fn" href="internal.h.html#is_migrate_highatomic" title='is_migrate_highatomic' data-ref="is_migrate_highatomic">is_migrate_highatomic</a>(<a class="local col8 ref" href="#598mt" title='mt' data-ref="598mt">mt</a>) &amp;&amp; !<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col8 ref" href="#598mt" title='mt' data-ref="598mt">mt</a>)</td></tr>
<tr><th id="2124">2124</th><td>	    &amp;&amp; !<a class="macro" href="../include/linux/mmzone.h.html#74" title="false" data-ref="_M/is_migrate_cma">is_migrate_cma</a>(mt)) {</td></tr>
<tr><th id="2125">2125</th><td>		<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a> += <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>;</td></tr>
<tr><th id="2126">2126</th><td>		<a class="ref fn" href="#set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</a>(<a class="local col5 ref" href="#595page" title='page' data-ref="595page">page</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_HIGHATOMIC" title='MIGRATE_HIGHATOMIC' data-ref="MIGRATE_HIGHATOMIC">MIGRATE_HIGHATOMIC</a>);</td></tr>
<tr><th id="2127">2127</th><td>		<a class="ref fn" href="#move_freepages_block" title='move_freepages_block' data-ref="move_freepages_block">move_freepages_block</a>(<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>, <a class="local col5 ref" href="#595page" title='page' data-ref="595page">page</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_HIGHATOMIC" title='MIGRATE_HIGHATOMIC' data-ref="MIGRATE_HIGHATOMIC">MIGRATE_HIGHATOMIC</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="2128">2128</th><td>	}</td></tr>
<tr><th id="2129">2129</th><td></td></tr>
<tr><th id="2130">2130</th><td><dfn class="lbl" id="601out_unlock" data-ref="601out_unlock">out_unlock</dfn>:</td></tr>
<tr><th id="2131">2131</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock_irqrestore" title='spin_unlock_irqrestore' data-ref="spin_unlock_irqrestore">spin_unlock_irqrestore</a>(&amp;<a class="local col6 ref" href="#596zone" title='zone' data-ref="596zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col0 ref" href="#600flags" title='flags' data-ref="600flags">flags</a>);</td></tr>
<tr><th id="2132">2132</th><td>}</td></tr>
<tr><th id="2133">2133</th><td></td></tr>
<tr><th id="2134">2134</th><td><i  data-doc="unreserve_highatomic_pageblock">/*</i></td></tr>
<tr><th id="2135">2135</th><td><i  data-doc="unreserve_highatomic_pageblock"> * Used when an allocation is about to fail under memory pressure. This</i></td></tr>
<tr><th id="2136">2136</th><td><i  data-doc="unreserve_highatomic_pageblock"> * potentially hurts the reliability of high-order allocations when under</i></td></tr>
<tr><th id="2137">2137</th><td><i  data-doc="unreserve_highatomic_pageblock"> * intense memory pressure but failed atomic allocations should be easier</i></td></tr>
<tr><th id="2138">2138</th><td><i  data-doc="unreserve_highatomic_pageblock"> * to recover from than an OOM.</i></td></tr>
<tr><th id="2139">2139</th><td><i  data-doc="unreserve_highatomic_pageblock"> *</i></td></tr>
<tr><th id="2140">2140</th><td><i  data-doc="unreserve_highatomic_pageblock"> * If @force is true, try to unreserve a pageblock even though highatomic</i></td></tr>
<tr><th id="2141">2141</th><td><i  data-doc="unreserve_highatomic_pageblock"> * pageblock is exhausted.</i></td></tr>
<tr><th id="2142">2142</th><td><i  data-doc="unreserve_highatomic_pageblock"> */</i></td></tr>
<tr><th id="2143">2143</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="unreserve_highatomic_pageblock" title='unreserve_highatomic_pageblock' data-type='bool unreserve_highatomic_pageblock(const struct alloc_context * ac, bool force)' data-ref="unreserve_highatomic_pageblock">unreserve_highatomic_pageblock</dfn>(<em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col2 decl" id="602ac" title='ac' data-type='const struct alloc_context *' data-ref="602ac">ac</dfn>,</td></tr>
<tr><th id="2144">2144</th><td>						<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col3 decl" id="603force" title='force' data-type='bool' data-ref="603force">force</dfn>)</td></tr>
<tr><th id="2145">2145</th><td>{</td></tr>
<tr><th id="2146">2146</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zonelist" title='zonelist' data-ref="zonelist">zonelist</a> *<dfn class="local col4 decl" id="604zonelist" title='zonelist' data-type='struct zonelist *' data-ref="604zonelist">zonelist</dfn> = <a class="local col2 ref" href="#602ac" title='ac' data-ref="602ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>;</td></tr>
<tr><th id="2147">2147</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="605flags" title='flags' data-type='unsigned long' data-ref="605flags">flags</dfn>;</td></tr>
<tr><th id="2148">2148</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col6 decl" id="606z" title='z' data-type='struct zoneref *' data-ref="606z">z</dfn>;</td></tr>
<tr><th id="2149">2149</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="607zone" title='zone' data-type='struct zone *' data-ref="607zone">zone</dfn>;</td></tr>
<tr><th id="2150">2150</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="608page" title='page' data-type='struct page *' data-ref="608page">page</dfn>;</td></tr>
<tr><th id="2151">2151</th><td>	<em>int</em> <dfn class="local col9 decl" id="609order" title='order' data-type='int' data-ref="609order">order</dfn>;</td></tr>
<tr><th id="2152">2152</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col0 decl" id="610ret" title='ret' data-type='bool' data-ref="610ret">ret</dfn>;</td></tr>
<tr><th id="2153">2153</th><td></td></tr>
<tr><th id="2154">2154</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#1034" title="for (z = first_zones_zonelist(zonelist, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z); zone; z = next_zones_zonelist(++z, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z))" data-ref="_M/for_each_zone_zonelist_nodemask">for_each_zone_zonelist_nodemask</a>(<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>, <a class="local col6 ref" href="#606z" title='z' data-ref="606z">z</a>, <a class="local col4 ref" href="#604zonelist" title='zonelist' data-ref="604zonelist">zonelist</a>, <a class="local col2 ref" href="#602ac" title='ac' data-ref="602ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>,</td></tr>
<tr><th id="2155">2155</th><td>								<a class="local col2 ref" href="#602ac" title='ac' data-ref="602ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>) {</td></tr>
<tr><th id="2156">2156</th><td>		<i>/*</i></td></tr>
<tr><th id="2157">2157</th><td><i>		 * Preserve at least one pageblock unless memory pressure</i></td></tr>
<tr><th id="2158">2158</th><td><i>		 * is really high.</i></td></tr>
<tr><th id="2159">2159</th><td><i>		 */</i></td></tr>
<tr><th id="2160">2160</th><td>		<b>if</b> (!<a class="local col3 ref" href="#603force" title='force' data-ref="603force">force</a> &amp;&amp; <a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a> &lt;=</td></tr>
<tr><th id="2161">2161</th><td>					<a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>)</td></tr>
<tr><th id="2162">2162</th><td>			<b>continue</b>;</td></tr>
<tr><th id="2163">2163</th><td></td></tr>
<tr><th id="2164">2164</th><td>		<a class="macro" href="../include/linux/spinlock.h.html#345" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = _raw_spin_lock_irqsave(spinlock_check(&amp;zone-&gt;lock)); } while (0); } while (0)" data-ref="_M/spin_lock_irqsave">spin_lock_irqsave</a>(&amp;<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col5 ref" href="#605flags" title='flags' data-ref="605flags">flags</a>);</td></tr>
<tr><th id="2165">2165</th><td>		<b>for</b> (<a class="local col9 ref" href="#609order" title='order' data-ref="609order">order</a> = <var>0</var>; <a class="local col9 ref" href="#609order" title='order' data-ref="609order">order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>; <a class="local col9 ref" href="#609order" title='order' data-ref="609order">order</a>++) {</td></tr>
<tr><th id="2166">2166</th><td>			<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col1 decl" id="611area" title='area' data-type='struct free_area *' data-ref="611area">area</dfn> = &amp;(<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col9 ref" href="#609order" title='order' data-ref="609order">order</a>]);</td></tr>
<tr><th id="2167">2167</th><td></td></tr>
<tr><th id="2168">2168</th><td>			<a class="local col8 ref" href="#608page" title='page' data-ref="608page">page</a> = <a class="macro" href="../include/linux/list.h.html#398" title="({ struct list_head *head__ = (&amp;area-&gt;free_list[MIGRATE_HIGHATOMIC]); struct list_head *pos__ = ({ union { typeof(head__-&gt;next) __val; char __c[1]; } __u; if (1) __read_once_size(&amp;(head__-&gt;next), __u.__c, sizeof(head__-&gt;next)); else __read_once_size_nocheck(&amp;(head__-&gt;next), __u.__c, sizeof(head__-&gt;next)); do { } while (0); __u.__val; }); pos__ != head__ ? ({ void *__mptr = (void *)(pos__); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*(pos__)), typeof(((struct page *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*(pos__)), typeof(void)))); extern void __compiletime_assert_2170(void) ; if (__cond) __compiletime_assert_2170(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((struct page *)(__mptr - __builtin_offsetof(struct page, lru))); }) : ((void *)0); })" data-ref="_M/list_first_entry_or_null">list_first_entry_or_null</a>(</td></tr>
<tr><th id="2169">2169</th><td>					&amp;<a class="local col1 ref" href="#611area" title='area' data-ref="611area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_HIGHATOMIC" title='MIGRATE_HIGHATOMIC' data-ref="MIGRATE_HIGHATOMIC">MIGRATE_HIGHATOMIC</a>],</td></tr>
<tr><th id="2170">2170</th><td>					<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="2171">2171</th><td>			<b>if</b> (!<a class="local col8 ref" href="#608page" title='page' data-ref="608page">page</a>)</td></tr>
<tr><th id="2172">2172</th><td>				<b>continue</b>;</td></tr>
<tr><th id="2173">2173</th><td></td></tr>
<tr><th id="2174">2174</th><td>			<i>/*</i></td></tr>
<tr><th id="2175">2175</th><td><i>			 * In page freeing path, migratetype change is racy so</i></td></tr>
<tr><th id="2176">2176</th><td><i>			 * we can counter several free pages in a pageblock</i></td></tr>
<tr><th id="2177">2177</th><td><i>			 * in this loop althoug we changed the pageblock type</i></td></tr>
<tr><th id="2178">2178</th><td><i>			 * from highatomic to ac-&gt;migratetype. So we should</i></td></tr>
<tr><th id="2179">2179</th><td><i>			 * adjust the count once.</i></td></tr>
<tr><th id="2180">2180</th><td><i>			 */</i></td></tr>
<tr><th id="2181">2181</th><td>			<b>if</b> (<a class="ref fn" href="internal.h.html#is_migrate_highatomic_page" title='is_migrate_highatomic_page' data-ref="is_migrate_highatomic_page">is_migrate_highatomic_page</a>(<a class="local col8 ref" href="#608page" title='page' data-ref="608page">page</a>)) {</td></tr>
<tr><th id="2182">2182</th><td>				<i>/*</i></td></tr>
<tr><th id="2183">2183</th><td><i>				 * It should never happen but changes to</i></td></tr>
<tr><th id="2184">2184</th><td><i>				 * locking could inadvertently allow a per-cpu</i></td></tr>
<tr><th id="2185">2185</th><td><i>				 * drain to add pages to MIGRATE_HIGHATOMIC</i></td></tr>
<tr><th id="2186">2186</th><td><i>				 * while unreserving so be safe and watch for</i></td></tr>
<tr><th id="2187">2187</th><td><i>				 * underflows.</i></td></tr>
<tr><th id="2188">2188</th><td><i>				 */</i></td></tr>
<tr><th id="2189">2189</th><td>				<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a> -= <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof((1UL &lt;&lt; (21 - 12))) __UNIQUE_ID_min1_157 = ((1UL &lt;&lt; (21 - 12))); typeof(zone-&gt;nr_reserved_highatomic) __UNIQUE_ID_min2_158 = (zone-&gt;nr_reserved_highatomic); (void) (&amp;__UNIQUE_ID_min1_157 == &amp;__UNIQUE_ID_min2_158); __UNIQUE_ID_min1_157 &lt; __UNIQUE_ID_min2_158 ? __UNIQUE_ID_min1_157 : __UNIQUE_ID_min2_158; })" data-ref="_M/min">min</a>(</td></tr>
<tr><th id="2190">2190</th><td>						<a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>,</td></tr>
<tr><th id="2191">2191</th><td>						<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a>);</td></tr>
<tr><th id="2192">2192</th><td>			}</td></tr>
<tr><th id="2193">2193</th><td></td></tr>
<tr><th id="2194">2194</th><td>			<i>/*</i></td></tr>
<tr><th id="2195">2195</th><td><i>			 * Convert to ac-&gt;migratetype and avoid the normal</i></td></tr>
<tr><th id="2196">2196</th><td><i>			 * pageblock stealing heuristics. Minimally, the caller</i></td></tr>
<tr><th id="2197">2197</th><td><i>			 * is doing the work and needs the pages. More</i></td></tr>
<tr><th id="2198">2198</th><td><i>			 * importantly, if the block was always converted to</i></td></tr>
<tr><th id="2199">2199</th><td><i>			 * MIGRATE_UNMOVABLE or another type then the number</i></td></tr>
<tr><th id="2200">2200</th><td><i>			 * of pageblocks that cannot be completely freed</i></td></tr>
<tr><th id="2201">2201</th><td><i>			 * may increase.</i></td></tr>
<tr><th id="2202">2202</th><td><i>			 */</i></td></tr>
<tr><th id="2203">2203</th><td>			<a class="ref fn" href="#set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</a>(<a class="local col8 ref" href="#608page" title='page' data-ref="608page">page</a>, <a class="local col2 ref" href="#602ac" title='ac' data-ref="602ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a>);</td></tr>
<tr><th id="2204">2204</th><td>			<a class="local col0 ref" href="#610ret" title='ret' data-ref="610ret">ret</a> = <a class="ref fn" href="#move_freepages_block" title='move_freepages_block' data-ref="move_freepages_block">move_freepages_block</a>(<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>, <a class="local col8 ref" href="#608page" title='page' data-ref="608page">page</a>, <a class="local col2 ref" href="#602ac" title='ac' data-ref="602ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a>,</td></tr>
<tr><th id="2205">2205</th><td>									<a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="2206">2206</th><td>			<b>if</b> (<a class="local col0 ref" href="#610ret" title='ret' data-ref="610ret">ret</a>) {</td></tr>
<tr><th id="2207">2207</th><td>				<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock_irqrestore" title='spin_unlock_irqrestore' data-ref="spin_unlock_irqrestore">spin_unlock_irqrestore</a>(&amp;<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col5 ref" href="#605flags" title='flags' data-ref="605flags">flags</a>);</td></tr>
<tr><th id="2208">2208</th><td>				<b>return</b> <a class="local col0 ref" href="#610ret" title='ret' data-ref="610ret">ret</a>;</td></tr>
<tr><th id="2209">2209</th><td>			}</td></tr>
<tr><th id="2210">2210</th><td>		}</td></tr>
<tr><th id="2211">2211</th><td>		<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock_irqrestore" title='spin_unlock_irqrestore' data-ref="spin_unlock_irqrestore">spin_unlock_irqrestore</a>(&amp;<a class="local col7 ref" href="#607zone" title='zone' data-ref="607zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col5 ref" href="#605flags" title='flags' data-ref="605flags">flags</a>);</td></tr>
<tr><th id="2212">2212</th><td>	}</td></tr>
<tr><th id="2213">2213</th><td></td></tr>
<tr><th id="2214">2214</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="2215">2215</th><td>}</td></tr>
<tr><th id="2216">2216</th><td></td></tr>
<tr><th id="2217">2217</th><td><i  data-doc="__rmqueue_fallback">/*</i></td></tr>
<tr><th id="2218">2218</th><td><i  data-doc="__rmqueue_fallback"> * Try finding a free buddy page on the fallback list and put it on the free</i></td></tr>
<tr><th id="2219">2219</th><td><i  data-doc="__rmqueue_fallback"> * list of requested migratetype, possibly along with other pages from the same</i></td></tr>
<tr><th id="2220">2220</th><td><i  data-doc="__rmqueue_fallback"> * block, depending on fragmentation avoidance heuristics. Returns true if</i></td></tr>
<tr><th id="2221">2221</th><td><i  data-doc="__rmqueue_fallback"> * fallback was found so that __rmqueue_smallest() can grab it.</i></td></tr>
<tr><th id="2222">2222</th><td><i  data-doc="__rmqueue_fallback"> *</i></td></tr>
<tr><th id="2223">2223</th><td><i  data-doc="__rmqueue_fallback"> * The use of signed ints for order and current_order is a deliberate</i></td></tr>
<tr><th id="2224">2224</th><td><i  data-doc="__rmqueue_fallback"> * deviation from the rest of this file, to make the for loop</i></td></tr>
<tr><th id="2225">2225</th><td><i  data-doc="__rmqueue_fallback"> * condition simpler.</i></td></tr>
<tr><th id="2226">2226</th><td><i  data-doc="__rmqueue_fallback"> */</i></td></tr>
<tr><th id="2227">2227</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a></td></tr>
<tr><th id="2228">2228</th><td><dfn class="tu decl def fn" id="__rmqueue_fallback" title='__rmqueue_fallback' data-type='bool __rmqueue_fallback(struct zone * zone, int order, int start_migratetype)' data-ref="__rmqueue_fallback">__rmqueue_fallback</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="612zone" title='zone' data-type='struct zone *' data-ref="612zone">zone</dfn>, <em>int</em> <dfn class="local col3 decl" id="613order" title='order' data-type='int' data-ref="613order">order</dfn>, <em>int</em> <dfn class="local col4 decl" id="614start_migratetype" title='start_migratetype' data-type='int' data-ref="614start_migratetype">start_migratetype</dfn>)</td></tr>
<tr><th id="2229">2229</th><td>{</td></tr>
<tr><th id="2230">2230</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col5 decl" id="615area" title='area' data-type='struct free_area *' data-ref="615area">area</dfn>;</td></tr>
<tr><th id="2231">2231</th><td>	<em>int</em> <dfn class="local col6 decl" id="616current_order" title='current_order' data-type='int' data-ref="616current_order">current_order</dfn>;</td></tr>
<tr><th id="2232">2232</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col7 decl" id="617page" title='page' data-type='struct page *' data-ref="617page">page</dfn>;</td></tr>
<tr><th id="2233">2233</th><td>	<em>int</em> <dfn class="local col8 decl" id="618fallback_mt" title='fallback_mt' data-type='int' data-ref="618fallback_mt">fallback_mt</dfn>;</td></tr>
<tr><th id="2234">2234</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col9 decl" id="619can_steal" title='can_steal' data-type='bool' data-ref="619can_steal">can_steal</dfn>;</td></tr>
<tr><th id="2235">2235</th><td></td></tr>
<tr><th id="2236">2236</th><td>	<i>/*</i></td></tr>
<tr><th id="2237">2237</th><td><i>	 * Find the largest available free page in the other list. This roughly</i></td></tr>
<tr><th id="2238">2238</th><td><i>	 * approximates finding the pageblock with the most free pages, which</i></td></tr>
<tr><th id="2239">2239</th><td><i>	 * would be too costly to do exactly.</i></td></tr>
<tr><th id="2240">2240</th><td><i>	 */</i></td></tr>
<tr><th id="2241">2241</th><td>	<b>for</b> (<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a> = <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a> - <var>1</var>; <a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a> &gt;= <a class="local col3 ref" href="#613order" title='order' data-ref="613order">order</a>;</td></tr>
<tr><th id="2242">2242</th><td>				--<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>) {</td></tr>
<tr><th id="2243">2243</th><td>		<a class="local col5 ref" href="#615area" title='area' data-ref="615area">area</a> = &amp;(<a class="local col2 ref" href="#612zone" title='zone' data-ref="612zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>]);</td></tr>
<tr><th id="2244">2244</th><td>		<a class="local col8 ref" href="#618fallback_mt" title='fallback_mt' data-ref="618fallback_mt">fallback_mt</a> = <a class="ref fn" href="#find_suitable_fallback" title='find_suitable_fallback' data-ref="find_suitable_fallback">find_suitable_fallback</a>(<a class="local col5 ref" href="#615area" title='area' data-ref="615area">area</a>, <a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>,</td></tr>
<tr><th id="2245">2245</th><td>				<a class="local col4 ref" href="#614start_migratetype" title='start_migratetype' data-ref="614start_migratetype">start_migratetype</a>, <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>, &amp;<a class="local col9 ref" href="#619can_steal" title='can_steal' data-ref="619can_steal">can_steal</a>);</td></tr>
<tr><th id="2246">2246</th><td>		<b>if</b> (<a class="local col8 ref" href="#618fallback_mt" title='fallback_mt' data-ref="618fallback_mt">fallback_mt</a> == -<var>1</var>)</td></tr>
<tr><th id="2247">2247</th><td>			<b>continue</b>;</td></tr>
<tr><th id="2248">2248</th><td></td></tr>
<tr><th id="2249">2249</th><td>		<i>/*</i></td></tr>
<tr><th id="2250">2250</th><td><i>		 * We cannot steal all free pages from the pageblock and the</i></td></tr>
<tr><th id="2251">2251</th><td><i>		 * requested migratetype is movable. In that case it's better to</i></td></tr>
<tr><th id="2252">2252</th><td><i>		 * steal and split the smallest available page instead of the</i></td></tr>
<tr><th id="2253">2253</th><td><i>		 * largest available page, because even if the next movable</i></td></tr>
<tr><th id="2254">2254</th><td><i>		 * allocation falls back into a different pageblock than this</i></td></tr>
<tr><th id="2255">2255</th><td><i>		 * one, it won't cause permanent fragmentation.</i></td></tr>
<tr><th id="2256">2256</th><td><i>		 */</i></td></tr>
<tr><th id="2257">2257</th><td>		<b>if</b> (!<a class="local col9 ref" href="#619can_steal" title='can_steal' data-ref="619can_steal">can_steal</a> &amp;&amp; <a class="local col4 ref" href="#614start_migratetype" title='start_migratetype' data-ref="614start_migratetype">start_migratetype</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a></td></tr>
<tr><th id="2258">2258</th><td>					&amp;&amp; <a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a> &gt; <a class="local col3 ref" href="#613order" title='order' data-ref="613order">order</a>)</td></tr>
<tr><th id="2259">2259</th><td>			<b>goto</b> <a class="lbl" href="#620find_smallest" data-ref="620find_smallest">find_smallest</a>;</td></tr>
<tr><th id="2260">2260</th><td></td></tr>
<tr><th id="2261">2261</th><td>		<b>goto</b> <a class="lbl" href="#621do_steal" data-ref="621do_steal">do_steal</a>;</td></tr>
<tr><th id="2262">2262</th><td>	}</td></tr>
<tr><th id="2263">2263</th><td></td></tr>
<tr><th id="2264">2264</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="2265">2265</th><td></td></tr>
<tr><th id="2266">2266</th><td><dfn class="lbl" id="620find_smallest" data-ref="620find_smallest">find_smallest</dfn>:</td></tr>
<tr><th id="2267">2267</th><td>	<b>for</b> (<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a> = <a class="local col3 ref" href="#613order" title='order' data-ref="613order">order</a>; <a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>;</td></tr>
<tr><th id="2268">2268</th><td>							<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>++) {</td></tr>
<tr><th id="2269">2269</th><td>		<a class="local col5 ref" href="#615area" title='area' data-ref="615area">area</a> = &amp;(<a class="local col2 ref" href="#612zone" title='zone' data-ref="612zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>]);</td></tr>
<tr><th id="2270">2270</th><td>		<a class="local col8 ref" href="#618fallback_mt" title='fallback_mt' data-ref="618fallback_mt">fallback_mt</a> = <a class="ref fn" href="#find_suitable_fallback" title='find_suitable_fallback' data-ref="find_suitable_fallback">find_suitable_fallback</a>(<a class="local col5 ref" href="#615area" title='area' data-ref="615area">area</a>, <a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>,</td></tr>
<tr><th id="2271">2271</th><td>				<a class="local col4 ref" href="#614start_migratetype" title='start_migratetype' data-ref="614start_migratetype">start_migratetype</a>, <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>, &amp;<a class="local col9 ref" href="#619can_steal" title='can_steal' data-ref="619can_steal">can_steal</a>);</td></tr>
<tr><th id="2272">2272</th><td>		<b>if</b> (<a class="local col8 ref" href="#618fallback_mt" title='fallback_mt' data-ref="618fallback_mt">fallback_mt</a> != -<var>1</var>)</td></tr>
<tr><th id="2273">2273</th><td>			<b>break</b>;</td></tr>
<tr><th id="2274">2274</th><td>	}</td></tr>
<tr><th id="2275">2275</th><td></td></tr>
<tr><th id="2276">2276</th><td>	<i>/*</i></td></tr>
<tr><th id="2277">2277</th><td><i>	 * This should not happen - we already found a suitable fallback</i></td></tr>
<tr><th id="2278">2278</th><td><i>	 * when looking for the largest page.</i></td></tr>
<tr><th id="2279">2279</th><td><i>	 */</i></td></tr>
<tr><th id="2280">2280</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)(current_order == 11))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>(<a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a> == <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>);</td></tr>
<tr><th id="2281">2281</th><td></td></tr>
<tr><th id="2282">2282</th><td><dfn class="lbl" id="621do_steal" data-ref="621do_steal">do_steal</dfn>:</td></tr>
<tr><th id="2283">2283</th><td>	<a class="local col7 ref" href="#617page" title='page' data-ref="617page">page</a> = <a class="macro" href="../include/linux/list.h.html#376" title="({ void *__mptr = (void *)((&amp;area-&gt;free_list[fallback_mt])-&gt;next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((&amp;area-&gt;free_list[fallback_mt])-&gt;next)), typeof(((struct page *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((&amp;area-&gt;free_list[fallback_mt])-&gt;next)), typeof(void)))); extern void __compiletime_assert_2284(void) ; if (__cond) __compiletime_assert_2284(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((struct page *)(__mptr - __builtin_offsetof(struct page, lru))); })" data-ref="_M/list_first_entry">list_first_entry</a>(&amp;<a class="local col5 ref" href="#615area" title='area' data-ref="615area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col8 ref" href="#618fallback_mt" title='fallback_mt' data-ref="618fallback_mt">fallback_mt</a>],</td></tr>
<tr><th id="2284">2284</th><td>							<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="2285">2285</th><td></td></tr>
<tr><th id="2286">2286</th><td>	<a class="tu ref fn" href="#steal_suitable_fallback" title='steal_suitable_fallback' data-use='c' data-ref="steal_suitable_fallback">steal_suitable_fallback</a>(<a class="local col2 ref" href="#612zone" title='zone' data-ref="612zone">zone</a>, <a class="local col7 ref" href="#617page" title='page' data-ref="617page">page</a>, <a class="local col4 ref" href="#614start_migratetype" title='start_migratetype' data-ref="614start_migratetype">start_migratetype</a>, <a class="local col9 ref" href="#619can_steal" title='can_steal' data-ref="619can_steal">can_steal</a>);</td></tr>
<tr><th id="2287">2287</th><td></td></tr>
<tr><th id="2288">2288</th><td>	<a class="ref fn" href="../include/trace/events/kmem.h.html#280" title='trace_mm_page_alloc_extfrag' data-ref="trace_mm_page_alloc_extfrag">trace_mm_page_alloc_extfrag</a>(<a class="local col7 ref" href="#617page" title='page' data-ref="617page">page</a>, <a class="local col3 ref" href="#613order" title='order' data-ref="613order">order</a>, <a class="local col6 ref" href="#616current_order" title='current_order' data-ref="616current_order">current_order</a>,</td></tr>
<tr><th id="2289">2289</th><td>		<a class="local col4 ref" href="#614start_migratetype" title='start_migratetype' data-ref="614start_migratetype">start_migratetype</a>, <a class="local col8 ref" href="#618fallback_mt" title='fallback_mt' data-ref="618fallback_mt">fallback_mt</a>);</td></tr>
<tr><th id="2290">2290</th><td></td></tr>
<tr><th id="2291">2291</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="2292">2292</th><td></td></tr>
<tr><th id="2293">2293</th><td>}</td></tr>
<tr><th id="2294">2294</th><td></td></tr>
<tr><th id="2295">2295</th><td><i  data-doc="__rmqueue">/*</i></td></tr>
<tr><th id="2296">2296</th><td><i  data-doc="__rmqueue"> * Do the hard work of removing an element from the buddy allocator.</i></td></tr>
<tr><th id="2297">2297</th><td><i  data-doc="__rmqueue"> * Call me with the zone-&gt;lock already held.</i></td></tr>
<tr><th id="2298">2298</th><td><i  data-doc="__rmqueue"> */</i></td></tr>
<tr><th id="2299">2299</th><td><em>static</em> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="__rmqueue" title='__rmqueue' data-type='struct page * __rmqueue(struct zone * zone, unsigned int order, int migratetype)' data-ref="__rmqueue">__rmqueue</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="622zone" title='zone' data-type='struct zone *' data-ref="622zone">zone</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="623order" title='order' data-type='unsigned int' data-ref="623order">order</dfn>,</td></tr>
<tr><th id="2300">2300</th><td>				<em>int</em> <dfn class="local col4 decl" id="624migratetype" title='migratetype' data-type='int' data-ref="624migratetype">migratetype</dfn>)</td></tr>
<tr><th id="2301">2301</th><td>{</td></tr>
<tr><th id="2302">2302</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="625page" title='page' data-type='struct page *' data-ref="625page">page</dfn>;</td></tr>
<tr><th id="2303">2303</th><td></td></tr>
<tr><th id="2304">2304</th><td><dfn class="lbl" id="626retry" data-ref="626retry">retry</dfn>:</td></tr>
<tr><th id="2305">2305</th><td>	<a class="local col5 ref" href="#625page" title='page' data-ref="625page">page</a> = <a class="tu ref fn" href="#__rmqueue_smallest" title='__rmqueue_smallest' data-use='c' data-ref="__rmqueue_smallest">__rmqueue_smallest</a>(<a class="local col2 ref" href="#622zone" title='zone' data-ref="622zone">zone</a>, <a class="local col3 ref" href="#623order" title='order' data-ref="623order">order</a>, <a class="local col4 ref" href="#624migratetype" title='migratetype' data-ref="624migratetype">migratetype</a>);</td></tr>
<tr><th id="2306">2306</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(!page), 0)" data-ref="_M/unlikely">unlikely</a>(!<a class="local col5 ref" href="#625page" title='page' data-ref="625page">page</a>)) {</td></tr>
<tr><th id="2307">2307</th><td>		<b>if</b> (<a class="local col4 ref" href="#624migratetype" title='migratetype' data-ref="624migratetype">migratetype</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>)</td></tr>
<tr><th id="2308">2308</th><td>			<a class="local col5 ref" href="#625page" title='page' data-ref="625page">page</a> = <a class="tu ref fn" href="#__rmqueue_cma_fallback" title='__rmqueue_cma_fallback' data-use='c' data-ref="__rmqueue_cma_fallback">__rmqueue_cma_fallback</a>(<a class="local col2 ref" href="#622zone" title='zone' data-ref="622zone">zone</a>, <a class="local col3 ref" href="#623order" title='order' data-ref="623order">order</a>);</td></tr>
<tr><th id="2309">2309</th><td></td></tr>
<tr><th id="2310">2310</th><td>		<b>if</b> (!<a class="local col5 ref" href="#625page" title='page' data-ref="625page">page</a> &amp;&amp; <a class="tu ref fn" href="#__rmqueue_fallback" title='__rmqueue_fallback' data-use='c' data-ref="__rmqueue_fallback">__rmqueue_fallback</a>(<a class="local col2 ref" href="#622zone" title='zone' data-ref="622zone">zone</a>, <a class="local col3 ref" href="#623order" title='order' data-ref="623order">order</a>, <a class="local col4 ref" href="#624migratetype" title='migratetype' data-ref="624migratetype">migratetype</a>))</td></tr>
<tr><th id="2311">2311</th><td>			<b>goto</b> <a class="lbl" href="#626retry" data-ref="626retry">retry</a>;</td></tr>
<tr><th id="2312">2312</th><td>	}</td></tr>
<tr><th id="2313">2313</th><td></td></tr>
<tr><th id="2314">2314</th><td>	<a class="ref fn" href="../include/trace/events/kmem.h.html#250" title='trace_mm_page_alloc_zone_locked' data-ref="trace_mm_page_alloc_zone_locked">trace_mm_page_alloc_zone_locked</a>(<a class="local col5 ref" href="#625page" title='page' data-ref="625page">page</a>, <a class="local col3 ref" href="#623order" title='order' data-ref="623order">order</a>, <a class="local col4 ref" href="#624migratetype" title='migratetype' data-ref="624migratetype">migratetype</a>);</td></tr>
<tr><th id="2315">2315</th><td>	<b>return</b> <a class="local col5 ref" href="#625page" title='page' data-ref="625page">page</a>;</td></tr>
<tr><th id="2316">2316</th><td>}</td></tr>
<tr><th id="2317">2317</th><td></td></tr>
<tr><th id="2318">2318</th><td><i  data-doc="rmqueue_bulk">/*</i></td></tr>
<tr><th id="2319">2319</th><td><i  data-doc="rmqueue_bulk"> * Obtain a specified number of elements from the buddy allocator, all under</i></td></tr>
<tr><th id="2320">2320</th><td><i  data-doc="rmqueue_bulk"> * a single hold of the lock, for efficiency.  Add them to the supplied list.</i></td></tr>
<tr><th id="2321">2321</th><td><i  data-doc="rmqueue_bulk"> * Returns the number of new pages which were placed at *list.</i></td></tr>
<tr><th id="2322">2322</th><td><i  data-doc="rmqueue_bulk"> */</i></td></tr>
<tr><th id="2323">2323</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="rmqueue_bulk" title='rmqueue_bulk' data-type='int rmqueue_bulk(struct zone * zone, unsigned int order, unsigned long count, struct list_head * list, int migratetype, bool cold)' data-ref="rmqueue_bulk">rmqueue_bulk</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="627zone" title='zone' data-type='struct zone *' data-ref="627zone">zone</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="628order" title='order' data-type='unsigned int' data-ref="628order">order</dfn>,</td></tr>
<tr><th id="2324">2324</th><td>			<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="629count" title='count' data-type='unsigned long' data-ref="629count">count</dfn>, <b>struct</b> <a class="type" href="../include/linux/types.h.html#list_head" title='list_head' data-ref="list_head">list_head</a> *<dfn class="local col0 decl" id="630list" title='list' data-type='struct list_head *' data-ref="630list">list</dfn>,</td></tr>
<tr><th id="2325">2325</th><td>			<em>int</em> <dfn class="local col1 decl" id="631migratetype" title='migratetype' data-type='int' data-ref="631migratetype">migratetype</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col2 decl" id="632cold" title='cold' data-type='bool' data-ref="632cold">cold</dfn>)</td></tr>
<tr><th id="2326">2326</th><td>{</td></tr>
<tr><th id="2327">2327</th><td>	<em>int</em> <dfn class="local col3 decl" id="633i" title='i' data-type='int' data-ref="633i">i</dfn>, <dfn class="local col4 decl" id="634alloced" title='alloced' data-type='int' data-ref="634alloced">alloced</dfn> = <var>0</var>;</td></tr>
<tr><th id="2328">2328</th><td></td></tr>
<tr><th id="2329">2329</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="local col7 ref" href="#627zone" title='zone' data-ref="627zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="2330">2330</th><td>	<b>for</b> (<a class="local col3 ref" href="#633i" title='i' data-ref="633i">i</a> = <var>0</var>; <a class="local col3 ref" href="#633i" title='i' data-ref="633i">i</a> &lt; <a class="local col9 ref" href="#629count" title='count' data-ref="629count">count</a>; ++<a class="local col3 ref" href="#633i" title='i' data-ref="633i">i</a>) {</td></tr>
<tr><th id="2331">2331</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="635page" title='page' data-type='struct page *' data-ref="635page">page</dfn> = <a class="tu ref fn" href="#__rmqueue" title='__rmqueue' data-use='c' data-ref="__rmqueue">__rmqueue</a>(<a class="local col7 ref" href="#627zone" title='zone' data-ref="627zone">zone</a>, <a class="local col8 ref" href="#628order" title='order' data-ref="628order">order</a>, <a class="local col1 ref" href="#631migratetype" title='migratetype' data-ref="631migratetype">migratetype</a>);</td></tr>
<tr><th id="2332">2332</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(page == ((void *)0)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col5 ref" href="#635page" title='page' data-ref="635page">page</a> == <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>))</td></tr>
<tr><th id="2333">2333</th><td>			<b>break</b>;</td></tr>
<tr><th id="2334">2334</th><td></td></tr>
<tr><th id="2335">2335</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(check_pcp_refill(page)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="tu ref fn" href="#check_pcp_refill" title='check_pcp_refill' data-use='c' data-ref="check_pcp_refill">check_pcp_refill</a>(<a class="local col5 ref" href="#635page" title='page' data-ref="635page">page</a>)))</td></tr>
<tr><th id="2336">2336</th><td>			<b>continue</b>;</td></tr>
<tr><th id="2337">2337</th><td></td></tr>
<tr><th id="2338">2338</th><td>		<i>/*</i></td></tr>
<tr><th id="2339">2339</th><td><i>		 * Split buddy pages returned by expand() are received here</i></td></tr>
<tr><th id="2340">2340</th><td><i>		 * in physical page order. The page is added to the callers and</i></td></tr>
<tr><th id="2341">2341</th><td><i>		 * list and the list head then moves forward. From the callers</i></td></tr>
<tr><th id="2342">2342</th><td><i>		 * perspective, the linked list is ordered by page number in</i></td></tr>
<tr><th id="2343">2343</th><td><i>		 * some conditions. This is useful for IO devices that can</i></td></tr>
<tr><th id="2344">2344</th><td><i>		 * merge IO requests if the physical pages are ordered</i></td></tr>
<tr><th id="2345">2345</th><td><i>		 * properly.</i></td></tr>
<tr><th id="2346">2346</th><td><i>		 */</i></td></tr>
<tr><th id="2347">2347</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(!cold), 1)" data-ref="_M/likely">likely</a>(!<a class="local col2 ref" href="#632cold" title='cold' data-ref="632cold">cold</a>))</td></tr>
<tr><th id="2348">2348</th><td>			<a class="ref fn" href="../include/linux/list.h.html#list_add" title='list_add' data-ref="list_add">list_add</a>(&amp;<a class="local col5 ref" href="#635page" title='page' data-ref="635page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, <a class="local col0 ref" href="#630list" title='list' data-ref="630list">list</a>);</td></tr>
<tr><th id="2349">2349</th><td>		<b>else</b></td></tr>
<tr><th id="2350">2350</th><td>			<a class="ref fn" href="../include/linux/list.h.html#list_add_tail" title='list_add_tail' data-ref="list_add_tail">list_add_tail</a>(&amp;<a class="local col5 ref" href="#635page" title='page' data-ref="635page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, <a class="local col0 ref" href="#630list" title='list' data-ref="630list">list</a>);</td></tr>
<tr><th id="2351">2351</th><td>		<a class="local col0 ref" href="#630list" title='list' data-ref="630list">list</a> = &amp;<a class="local col5 ref" href="#635page" title='page' data-ref="635page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>;</td></tr>
<tr><th id="2352">2352</th><td>		<a class="local col4 ref" href="#634alloced" title='alloced' data-ref="634alloced">alloced</a>++;</td></tr>
<tr><th id="2353">2353</th><td>		<b>if</b> (<a class="macro" href="../include/linux/mmzone.h.html#74" title="false" data-ref="_M/is_migrate_cma">is_migrate_cma</a>(get_pcppage_migratetype(page)))</td></tr>
<tr><th id="2354">2354</th><td>			<a class="ref fn" href="../include/linux/vmstat.h.html#__mod_zone_page_state" title='__mod_zone_page_state' data-ref="__mod_zone_page_state">__mod_zone_page_state</a>(<a class="local col7 ref" href="#627zone" title='zone' data-ref="627zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_CMA_PAGES" title='NR_FREE_CMA_PAGES' data-ref="NR_FREE_CMA_PAGES">NR_FREE_CMA_PAGES</a>,</td></tr>
<tr><th id="2355">2355</th><td>					      -(<var>1</var> &lt;&lt; <a class="local col8 ref" href="#628order" title='order' data-ref="628order">order</a>));</td></tr>
<tr><th id="2356">2356</th><td>	}</td></tr>
<tr><th id="2357">2357</th><td></td></tr>
<tr><th id="2358">2358</th><td>	<i>/*</i></td></tr>
<tr><th id="2359">2359</th><td><i>	 * i pages were removed from the buddy list even if some leak due</i></td></tr>
<tr><th id="2360">2360</th><td><i>	 * to check_pcp_refill failing so adjust NR_FREE_PAGES based</i></td></tr>
<tr><th id="2361">2361</th><td><i>	 * on i. Do not confuse with 'alloced' which is the number of</i></td></tr>
<tr><th id="2362">2362</th><td><i>	 * pages added to the pcp list.</i></td></tr>
<tr><th id="2363">2363</th><td><i>	 */</i></td></tr>
<tr><th id="2364">2364</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#__mod_zone_page_state" title='__mod_zone_page_state' data-ref="__mod_zone_page_state">__mod_zone_page_state</a>(<a class="local col7 ref" href="#627zone" title='zone' data-ref="627zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>, -(<a class="local col3 ref" href="#633i" title='i' data-ref="633i">i</a> &lt;&lt; <a class="local col8 ref" href="#628order" title='order' data-ref="628order">order</a>));</td></tr>
<tr><th id="2365">2365</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col7 ref" href="#627zone" title='zone' data-ref="627zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="2366">2366</th><td>	<b>return</b> <a class="local col4 ref" href="#634alloced" title='alloced' data-ref="634alloced">alloced</a>;</td></tr>
<tr><th id="2367">2367</th><td>}</td></tr>
<tr><th id="2368">2368</th><td></td></tr>
<tr><th id="2369">2369</th><td><u>#<span data-ppcond="2369">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="2370">2370</th><td><i>/*</i></td></tr>
<tr><th id="2371">2371</th><td><i> * Called from the vmstat counter updater to drain pagesets of this</i></td></tr>
<tr><th id="2372">2372</th><td><i> * currently executing processor on remote nodes after they have</i></td></tr>
<tr><th id="2373">2373</th><td><i> * expired.</i></td></tr>
<tr><th id="2374">2374</th><td><i> *</i></td></tr>
<tr><th id="2375">2375</th><td><i> * Note that this function must be called with the thread pinned to</i></td></tr>
<tr><th id="2376">2376</th><td><i> * a single processor.</i></td></tr>
<tr><th id="2377">2377</th><td><i> */</i></td></tr>
<tr><th id="2378">2378</th><td><em>void</em> drain_zone_pages(<b>struct</b> zone *zone, <b>struct</b> per_cpu_pages *pcp)</td></tr>
<tr><th id="2379">2379</th><td>{</td></tr>
<tr><th id="2380">2380</th><td>	<em>unsigned</em> <em>long</em> flags;</td></tr>
<tr><th id="2381">2381</th><td>	<em>int</em> to_drain, batch;</td></tr>
<tr><th id="2382">2382</th><td></td></tr>
<tr><th id="2383">2383</th><td>	local_irq_save(flags);</td></tr>
<tr><th id="2384">2384</th><td>	batch = READ_ONCE(pcp-&gt;batch);</td></tr>
<tr><th id="2385">2385</th><td>	to_drain = min(pcp-&gt;count, batch);</td></tr>
<tr><th id="2386">2386</th><td>	<b>if</b> (to_drain &gt; <var>0</var>) {</td></tr>
<tr><th id="2387">2387</th><td>		free_pcppages_bulk(zone, to_drain, pcp);</td></tr>
<tr><th id="2388">2388</th><td>		pcp-&gt;count -= to_drain;</td></tr>
<tr><th id="2389">2389</th><td>	}</td></tr>
<tr><th id="2390">2390</th><td>	local_irq_restore(flags);</td></tr>
<tr><th id="2391">2391</th><td>}</td></tr>
<tr><th id="2392">2392</th><td><u>#<span data-ppcond="2369">endif</span></u></td></tr>
<tr><th id="2393">2393</th><td></td></tr>
<tr><th id="2394">2394</th><td><i  data-doc="drain_pages_zone">/*</i></td></tr>
<tr><th id="2395">2395</th><td><i  data-doc="drain_pages_zone"> * Drain pcplists of the indicated processor and zone.</i></td></tr>
<tr><th id="2396">2396</th><td><i  data-doc="drain_pages_zone"> *</i></td></tr>
<tr><th id="2397">2397</th><td><i  data-doc="drain_pages_zone"> * The processor must either be the current processor and the</i></td></tr>
<tr><th id="2398">2398</th><td><i  data-doc="drain_pages_zone"> * thread pinned to the current processor or a processor that</i></td></tr>
<tr><th id="2399">2399</th><td><i  data-doc="drain_pages_zone"> * is not online.</i></td></tr>
<tr><th id="2400">2400</th><td><i  data-doc="drain_pages_zone"> */</i></td></tr>
<tr><th id="2401">2401</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="drain_pages_zone" title='drain_pages_zone' data-type='void drain_pages_zone(unsigned int cpu, struct zone * zone)' data-ref="drain_pages_zone">drain_pages_zone</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="636cpu" title='cpu' data-type='unsigned int' data-ref="636cpu">cpu</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="637zone" title='zone' data-type='struct zone *' data-ref="637zone">zone</dfn>)</td></tr>
<tr><th id="2402">2402</th><td>{</td></tr>
<tr><th id="2403">2403</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="638flags" title='flags' data-type='unsigned long' data-ref="638flags">flags</dfn>;</td></tr>
<tr><th id="2404">2404</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col9 decl" id="639pset" title='pset' data-type='struct per_cpu_pageset *' data-ref="639pset">pset</dfn>;</td></tr>
<tr><th id="2405">2405</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col0 decl" id="640pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="640pcp">pcp</dfn>;</td></tr>
<tr><th id="2406">2406</th><td></td></tr>
<tr><th id="2407">2407</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#139" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = arch_local_irq_save(); } while (0); } while (0)" data-ref="_M/local_irq_save">local_irq_save</a>(<a class="local col8 ref" href="#638flags" title='flags' data-ref="638flags">flags</a>);</td></tr>
<tr><th id="2408">2408</th><td>	<a class="local col9 ref" href="#639pset" title='pset' data-ref="639pset">pset</a> = <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col7 ref" href="#637zone" title='zone' data-ref="637zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col6 ref" href="#636cpu" title='cpu' data-ref="636cpu">cpu</a>);</td></tr>
<tr><th id="2409">2409</th><td></td></tr>
<tr><th id="2410">2410</th><td>	<a class="local col0 ref" href="#640pcp" title='pcp' data-ref="640pcp">pcp</a> = &amp;<a class="local col9 ref" href="#639pset" title='pset' data-ref="639pset">pset</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>;</td></tr>
<tr><th id="2411">2411</th><td>	<b>if</b> (<a class="local col0 ref" href="#640pcp" title='pcp' data-ref="640pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>) {</td></tr>
<tr><th id="2412">2412</th><td>		<a class="tu ref fn" href="#free_pcppages_bulk" title='free_pcppages_bulk' data-use='c' data-ref="free_pcppages_bulk">free_pcppages_bulk</a>(<a class="local col7 ref" href="#637zone" title='zone' data-ref="637zone">zone</a>, <a class="local col0 ref" href="#640pcp" title='pcp' data-ref="640pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>, <a class="local col0 ref" href="#640pcp" title='pcp' data-ref="640pcp">pcp</a>);</td></tr>
<tr><th id="2413">2413</th><td>		<a class="local col0 ref" href="#640pcp" title='pcp' data-ref="640pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a> = <var>0</var>;</td></tr>
<tr><th id="2414">2414</th><td>	}</td></tr>
<tr><th id="2415">2415</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col8 ref" href="#638flags" title='flags' data-ref="638flags">flags</a>);</td></tr>
<tr><th id="2416">2416</th><td>}</td></tr>
<tr><th id="2417">2417</th><td></td></tr>
<tr><th id="2418">2418</th><td><i  data-doc="drain_pages">/*</i></td></tr>
<tr><th id="2419">2419</th><td><i  data-doc="drain_pages"> * Drain pcplists of all zones on the indicated processor.</i></td></tr>
<tr><th id="2420">2420</th><td><i  data-doc="drain_pages"> *</i></td></tr>
<tr><th id="2421">2421</th><td><i  data-doc="drain_pages"> * The processor must either be the current processor and the</i></td></tr>
<tr><th id="2422">2422</th><td><i  data-doc="drain_pages"> * thread pinned to the current processor or a processor that</i></td></tr>
<tr><th id="2423">2423</th><td><i  data-doc="drain_pages"> * is not online.</i></td></tr>
<tr><th id="2424">2424</th><td><i  data-doc="drain_pages"> */</i></td></tr>
<tr><th id="2425">2425</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="drain_pages" title='drain_pages' data-type='void drain_pages(unsigned int cpu)' data-ref="drain_pages">drain_pages</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="641cpu" title='cpu' data-type='unsigned int' data-ref="641cpu">cpu</dfn>)</td></tr>
<tr><th id="2426">2426</th><td>{</td></tr>
<tr><th id="2427">2427</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="642zone" title='zone' data-type='struct zone *' data-ref="642zone">zone</dfn>;</td></tr>
<tr><th id="2428">2428</th><td></td></tr>
<tr><th id="2429">2429</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col2 ref" href="#642zone" title='zone' data-ref="642zone">zone</a>) {</td></tr>
<tr><th id="2430">2430</th><td>		<a class="tu ref fn" href="#drain_pages_zone" title='drain_pages_zone' data-use='c' data-ref="drain_pages_zone">drain_pages_zone</a>(<a class="local col1 ref" href="#641cpu" title='cpu' data-ref="641cpu">cpu</a>, <a class="local col2 ref" href="#642zone" title='zone' data-ref="642zone">zone</a>);</td></tr>
<tr><th id="2431">2431</th><td>	}</td></tr>
<tr><th id="2432">2432</th><td>}</td></tr>
<tr><th id="2433">2433</th><td></td></tr>
<tr><th id="2434">2434</th><td><i>/*</i></td></tr>
<tr><th id="2435">2435</th><td><i> * Spill all of this CPU's per-cpu pages back into the buddy allocator.</i></td></tr>
<tr><th id="2436">2436</th><td><i> *</i></td></tr>
<tr><th id="2437">2437</th><td><i> * The CPU has to be pinned. When zone parameter is non-NULL, spill just</i></td></tr>
<tr><th id="2438">2438</th><td><i> * the single zone's pages.</i></td></tr>
<tr><th id="2439">2439</th><td><i> */</i></td></tr>
<tr><th id="2440">2440</th><td><em>void</em> <dfn class="decl def fn" id="drain_local_pages" title='drain_local_pages' data-ref="drain_local_pages">drain_local_pages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col3 decl" id="643zone" title='zone' data-type='struct zone *' data-ref="643zone">zone</dfn>)</td></tr>
<tr><th id="2441">2441</th><td>{</td></tr>
<tr><th id="2442">2442</th><td>	<em>int</em> <dfn class="local col4 decl" id="644cpu" title='cpu' data-type='int' data-ref="644cpu">cpu</dfn> = <a class="macro" href="../include/linux/smp.h.html#199" title="(({ typeof(cpu_number) pscr_ret__; do { const void *__vpp_verify = (typeof((&amp;(cpu_number)) + 0))((void *)0); (void)__vpp_verify; } while (0); switch(sizeof(cpu_number)) { case 1: pscr_ret__ = ({ typeof(cpu_number) pfo_ret__; switch (sizeof(cpu_number)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 2: pscr_ret__ = ({ typeof(cpu_number) pfo_ret__; switch (sizeof(cpu_number)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 4: pscr_ret__ = ({ typeof(cpu_number) pfo_ret__; switch (sizeof(cpu_number)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 8: pscr_ret__ = ({ typeof(cpu_number) pfo_ret__; switch (sizeof(cpu_number)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (cpu_number)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; default: __bad_size_call_parameter(); break; } pscr_ret__; }))" data-ref="_M/smp_processor_id">smp_processor_id</a>();</td></tr>
<tr><th id="2443">2443</th><td></td></tr>
<tr><th id="2444">2444</th><td>	<b>if</b> (<a class="local col3 ref" href="#643zone" title='zone' data-ref="643zone">zone</a>)</td></tr>
<tr><th id="2445">2445</th><td>		<a class="tu ref fn" href="#drain_pages_zone" title='drain_pages_zone' data-use='c' data-ref="drain_pages_zone">drain_pages_zone</a>(<a class="local col4 ref" href="#644cpu" title='cpu' data-ref="644cpu">cpu</a>, <a class="local col3 ref" href="#643zone" title='zone' data-ref="643zone">zone</a>);</td></tr>
<tr><th id="2446">2446</th><td>	<b>else</b></td></tr>
<tr><th id="2447">2447</th><td>		<a class="tu ref fn" href="#drain_pages" title='drain_pages' data-use='c' data-ref="drain_pages">drain_pages</a>(<a class="local col4 ref" href="#644cpu" title='cpu' data-ref="644cpu">cpu</a>);</td></tr>
<tr><th id="2448">2448</th><td>}</td></tr>
<tr><th id="2449">2449</th><td></td></tr>
<tr><th id="2450">2450</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="drain_local_pages_wq" title='drain_local_pages_wq' data-type='void drain_local_pages_wq(struct work_struct * work)' data-ref="drain_local_pages_wq">drain_local_pages_wq</dfn>(<b>struct</b> <a class="type" href="../include/linux/workqueue.h.html#work_struct" title='work_struct' data-ref="work_struct">work_struct</a> *<dfn class="local col5 decl" id="645work" title='work' data-type='struct work_struct *' data-ref="645work">work</dfn>)</td></tr>
<tr><th id="2451">2451</th><td>{</td></tr>
<tr><th id="2452">2452</th><td>	<i>/*</i></td></tr>
<tr><th id="2453">2453</th><td><i>	 * drain_all_pages doesn't use proper cpu hotplug protection so</i></td></tr>
<tr><th id="2454">2454</th><td><i>	 * we can race with cpu offline when the WQ can move this from</i></td></tr>
<tr><th id="2455">2455</th><td><i>	 * a cpu pinned worker to an unbound one. We can operate on a different</i></td></tr>
<tr><th id="2456">2456</th><td><i>	 * cpu which is allright but we also have to make sure to not move to</i></td></tr>
<tr><th id="2457">2457</th><td><i>	 * a different one.</i></td></tr>
<tr><th id="2458">2458</th><td><i>	 */</i></td></tr>
<tr><th id="2459">2459</th><td>	<a class="macro" href="../include/linux/preempt.h.html#245" title="__asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;)" data-ref="_M/preempt_disable">preempt_disable</a>();</td></tr>
<tr><th id="2460">2460</th><td>	<a class="ref fn" href="#drain_local_pages" title='drain_local_pages' data-ref="drain_local_pages">drain_local_pages</a>(<a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="2461">2461</th><td>	<a class="macro" href="../include/linux/preempt.h.html#248" title="__asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;)" data-ref="_M/preempt_enable">preempt_enable</a>();</td></tr>
<tr><th id="2462">2462</th><td>}</td></tr>
<tr><th id="2463">2463</th><td></td></tr>
<tr><th id="2464">2464</th><td><i>/*</i></td></tr>
<tr><th id="2465">2465</th><td><i> * Spill all the per-cpu pages from all CPUs back into the buddy allocator.</i></td></tr>
<tr><th id="2466">2466</th><td><i> *</i></td></tr>
<tr><th id="2467">2467</th><td><i> * When zone parameter is non-NULL, spill just the single zone's pages.</i></td></tr>
<tr><th id="2468">2468</th><td><i> *</i></td></tr>
<tr><th id="2469">2469</th><td><i> * Note that this can be extremely slow as the draining happens in a workqueue.</i></td></tr>
<tr><th id="2470">2470</th><td><i> */</i></td></tr>
<tr><th id="2471">2471</th><td><em>void</em> <dfn class="decl def fn" id="drain_all_pages" title='drain_all_pages' data-ref="drain_all_pages">drain_all_pages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="646zone" title='zone' data-type='struct zone *' data-ref="646zone">zone</dfn>)</td></tr>
<tr><th id="2472">2472</th><td>{</td></tr>
<tr><th id="2473">2473</th><td>	<em>int</em> <dfn class="local col7 decl" id="647cpu" title='cpu' data-type='int' data-ref="647cpu">cpu</dfn>;</td></tr>
<tr><th id="2474">2474</th><td></td></tr>
<tr><th id="2475">2475</th><td>	<i>/*</i></td></tr>
<tr><th id="2476">2476</th><td><i>	 * Allocate in the BSS so we wont require allocation in</i></td></tr>
<tr><th id="2477">2477</th><td><i>	 * direct reclaim path for CONFIG_CPUMASK_OFFSTACK=y</i></td></tr>
<tr><th id="2478">2478</th><td><i>	 */</i></td></tr>
<tr><th id="2479">2479</th><td>	<em>static</em> <a class="typedef" href="../include/linux/cpumask.h.html#cpumask_t" title='cpumask_t' data-type='struct cpumask' data-ref="cpumask_t">cpumask_t</a> <dfn class="local col8 decl" id="648cpus_with_pcps" title='cpus_with_pcps' data-type='cpumask_t' data-ref="648cpus_with_pcps">cpus_with_pcps</dfn>;</td></tr>
<tr><th id="2480">2480</th><td></td></tr>
<tr><th id="2481">2481</th><td>	<i>/*</i></td></tr>
<tr><th id="2482">2482</th><td><i>	 * Make sure nobody triggers this path before mm_percpu_wq is fully</i></td></tr>
<tr><th id="2483">2483</th><td><i>	 * initialized.</i></td></tr>
<tr><th id="2484">2484</th><td><i>	 */</i></td></tr>
<tr><th id="2485">2485</th><td>	<b>if</b> (<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!(!mm_percpu_wq); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (2485), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (161)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>(!<a class="ref" href="internal.h.html#mm_percpu_wq" title='mm_percpu_wq' data-ref="mm_percpu_wq">mm_percpu_wq</a>))</td></tr>
<tr><th id="2486">2486</th><td>		<b>return</b>;</td></tr>
<tr><th id="2487">2487</th><td></td></tr>
<tr><th id="2488">2488</th><td>	<i>/*</i></td></tr>
<tr><th id="2489">2489</th><td><i>	 * Do not drain if one is already in progress unless it's specific to</i></td></tr>
<tr><th id="2490">2490</th><td><i>	 * a zone. Such callers are primarily CMA and memory hotplug and need</i></td></tr>
<tr><th id="2491">2491</th><td><i>	 * the drain to be complete when the call returns.</i></td></tr>
<tr><th id="2492">2492</th><td><i>	 */</i></td></tr>
<tr><th id="2493">2493</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(!mutex_trylock(&amp;pcpu_drain_mutex)), 0)" data-ref="_M/unlikely">unlikely</a>(!<a class="ref fn" href="../include/linux/mutex.h.html#mutex_trylock" title='mutex_trylock' data-ref="mutex_trylock">mutex_trylock</a>(&amp;<a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex">pcpu_drain_mutex</a>))) {</td></tr>
<tr><th id="2494">2494</th><td>		<b>if</b> (!<a class="local col6 ref" href="#646zone" title='zone' data-ref="646zone">zone</a>)</td></tr>
<tr><th id="2495">2495</th><td>			<b>return</b>;</td></tr>
<tr><th id="2496">2496</th><td>		<a class="ref fn" href="../include/linux/mutex.h.html#mutex_lock" title='mutex_lock' data-ref="mutex_lock">mutex_lock</a>(&amp;<a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex">pcpu_drain_mutex</a>);</td></tr>
<tr><th id="2497">2497</th><td>	}</td></tr>
<tr><th id="2498">2498</th><td></td></tr>
<tr><th id="2499">2499</th><td>	<i>/*</i></td></tr>
<tr><th id="2500">2500</th><td><i>	 * We don't care about racing with CPU hotplug event</i></td></tr>
<tr><th id="2501">2501</th><td><i>	 * as offline notification will cause the notified</i></td></tr>
<tr><th id="2502">2502</th><td><i>	 * cpu to drain that CPU pcps and on_each_cpu_mask</i></td></tr>
<tr><th id="2503">2503</th><td><i>	 * disables preemption as part of its processing</i></td></tr>
<tr><th id="2504">2504</th><td><i>	 */</i></td></tr>
<tr><th id="2505">2505</th><td>	<a class="macro" href="../include/linux/cpumask.h.html#750" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_online_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_online_cpu">for_each_online_cpu</a>(<a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>) {</td></tr>
<tr><th id="2506">2506</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col9 decl" id="649pcp" title='pcp' data-type='struct per_cpu_pageset *' data-ref="649pcp">pcp</dfn>;</td></tr>
<tr><th id="2507">2507</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col0 decl" id="650z" title='z' data-type='struct zone *' data-ref="650z">z</dfn>;</td></tr>
<tr><th id="2508">2508</th><td>		<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col1 decl" id="651has_pcps" title='has_pcps' data-type='bool' data-ref="651has_pcps">has_pcps</dfn> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="2509">2509</th><td></td></tr>
<tr><th id="2510">2510</th><td>		<b>if</b> (<a class="local col6 ref" href="#646zone" title='zone' data-ref="646zone">zone</a>) {</td></tr>
<tr><th id="2511">2511</th><td>			<a class="local col9 ref" href="#649pcp" title='pcp' data-ref="649pcp">pcp</a> = <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col6 ref" href="#646zone" title='zone' data-ref="646zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>);</td></tr>
<tr><th id="2512">2512</th><td>			<b>if</b> (<a class="local col9 ref" href="#649pcp" title='pcp' data-ref="649pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>.<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>)</td></tr>
<tr><th id="2513">2513</th><td>				<a class="local col1 ref" href="#651has_pcps" title='has_pcps' data-ref="651has_pcps">has_pcps</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="2514">2514</th><td>		} <b>else</b> {</td></tr>
<tr><th id="2515">2515</th><td>			<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (z = (first_online_pgdat())-&gt;node_zones; z; z = next_zone(z)) if (!populated_zone(z)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col0 ref" href="#650z" title='z' data-ref="650z">z</a>) {</td></tr>
<tr><th id="2516">2516</th><td>				<a class="local col9 ref" href="#649pcp" title='pcp' data-ref="649pcp">pcp</a> = <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((z-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((z-&gt;pageset))) *)((z-&gt;pageset)))); (typeof((typeof(*((z-&gt;pageset))) *)((z-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col0 ref" href="#650z" title='z' data-ref="650z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>);</td></tr>
<tr><th id="2517">2517</th><td>				<b>if</b> (<a class="local col9 ref" href="#649pcp" title='pcp' data-ref="649pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>.<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>) {</td></tr>
<tr><th id="2518">2518</th><td>					<a class="local col1 ref" href="#651has_pcps" title='has_pcps' data-ref="651has_pcps">has_pcps</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="2519">2519</th><td>					<b>break</b>;</td></tr>
<tr><th id="2520">2520</th><td>				}</td></tr>
<tr><th id="2521">2521</th><td>			}</td></tr>
<tr><th id="2522">2522</th><td>		}</td></tr>
<tr><th id="2523">2523</th><td></td></tr>
<tr><th id="2524">2524</th><td>		<b>if</b> (<a class="local col1 ref" href="#651has_pcps" title='has_pcps' data-ref="651has_pcps">has_pcps</a>)</td></tr>
<tr><th id="2525">2525</th><td>			<a class="ref fn" href="../include/linux/cpumask.h.html#cpumask_set_cpu" title='cpumask_set_cpu' data-ref="cpumask_set_cpu">cpumask_set_cpu</a>(<a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>, &amp;<a class="local col8 ref" href="#648cpus_with_pcps" title='cpus_with_pcps' data-ref="648cpus_with_pcps">cpus_with_pcps</a>);</td></tr>
<tr><th id="2526">2526</th><td>		<b>else</b></td></tr>
<tr><th id="2527">2527</th><td>			<a class="ref fn" href="../include/linux/cpumask.h.html#cpumask_clear_cpu" title='cpumask_clear_cpu' data-ref="cpumask_clear_cpu">cpumask_clear_cpu</a>(<a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>, &amp;<a class="local col8 ref" href="#648cpus_with_pcps" title='cpus_with_pcps' data-ref="648cpus_with_pcps">cpus_with_pcps</a>);</td></tr>
<tr><th id="2528">2528</th><td>	}</td></tr>
<tr><th id="2529">2529</th><td></td></tr>
<tr><th id="2530">2530</th><td>	<a class="macro" href="../include/linux/cpumask.h.html#212" title="for ((cpu) = -1; (cpu) = cpumask_next((cpu), (&amp;cpus_with_pcps)), (cpu) &lt; nr_cpu_ids;)" data-ref="_M/for_each_cpu">for_each_cpu</a>(<a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>, &amp;<a class="local col8 ref" href="#648cpus_with_pcps" title='cpus_with_pcps' data-ref="648cpus_with_pcps">cpus_with_pcps</a>) {</td></tr>
<tr><th id="2531">2531</th><td>		<b>struct</b> <a class="type" href="../include/linux/workqueue.h.html#work_struct" title='work_struct' data-ref="work_struct">work_struct</a> *<dfn class="local col2 decl" id="652work" title='work' data-type='struct work_struct *' data-ref="652work">work</dfn> = <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((&amp;pcpu_drain) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((&amp;pcpu_drain))) *)((&amp;pcpu_drain)))); (typeof((typeof(*((&amp;pcpu_drain))) *)((&amp;pcpu_drain)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(&amp;<a class="ref" href="#99" title='pcpu_drain' data-ref="pcpu_drain">pcpu_drain</a>, <a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>);</td></tr>
<tr><th id="2532">2532</th><td>		<a class="macro" href="../include/linux/workqueue.h.html#236" title="do { __init_work(((work)), 0); ((work))-&gt;data = (atomic_long_t) { ((unsigned long)WORK_STRUCT_NO_POOL) }; INIT_LIST_HEAD(&amp;((work))-&gt;entry); ((work))-&gt;func = ((drain_local_pages_wq)); } while (0)" data-ref="_M/INIT_WORK">INIT_WORK</a>(<a class="local col2 ref" href="#652work" title='work' data-ref="652work">work</a>, <a class="tu ref fn" href="#drain_local_pages_wq" title='drain_local_pages_wq' data-use='r' data-ref="drain_local_pages_wq">drain_local_pages_wq</a>);</td></tr>
<tr><th id="2533">2533</th><td>		<a class="ref fn" href="../include/linux/workqueue.h.html#queue_work_on" title='queue_work_on' data-ref="queue_work_on">queue_work_on</a>(<a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>, <a class="ref" href="internal.h.html#mm_percpu_wq" title='mm_percpu_wq' data-ref="mm_percpu_wq">mm_percpu_wq</a>, <a class="local col2 ref" href="#652work" title='work' data-ref="652work">work</a>);</td></tr>
<tr><th id="2534">2534</th><td>	}</td></tr>
<tr><th id="2535">2535</th><td>	<a class="macro" href="../include/linux/cpumask.h.html#212" title="for ((cpu) = -1; (cpu) = cpumask_next((cpu), (&amp;cpus_with_pcps)), (cpu) &lt; nr_cpu_ids;)" data-ref="_M/for_each_cpu">for_each_cpu</a>(<a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>, &amp;<a class="local col8 ref" href="#648cpus_with_pcps" title='cpus_with_pcps' data-ref="648cpus_with_pcps">cpus_with_pcps</a>)</td></tr>
<tr><th id="2536">2536</th><td>		<a class="ref fn" href="../include/linux/workqueue.h.html#flush_work" title='flush_work' data-ref="flush_work">flush_work</a>(<a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((&amp;pcpu_drain) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((&amp;pcpu_drain))) *)((&amp;pcpu_drain)))); (typeof((typeof(*((&amp;pcpu_drain))) *)((&amp;pcpu_drain)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(&amp;<a class="ref" href="#99" title='pcpu_drain' data-ref="pcpu_drain">pcpu_drain</a>, <a class="local col7 ref" href="#647cpu" title='cpu' data-ref="647cpu">cpu</a>));</td></tr>
<tr><th id="2537">2537</th><td></td></tr>
<tr><th id="2538">2538</th><td>	<a class="ref fn" href="../include/linux/mutex.h.html#mutex_unlock" title='mutex_unlock' data-ref="mutex_unlock">mutex_unlock</a>(&amp;<a class="ref" href="#98" title='pcpu_drain_mutex' data-ref="pcpu_drain_mutex">pcpu_drain_mutex</a>);</td></tr>
<tr><th id="2539">2539</th><td>}</td></tr>
<tr><th id="2540">2540</th><td></td></tr>
<tr><th id="2541">2541</th><td><u>#<span data-ppcond="2541">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HIBERNATION">CONFIG_HIBERNATION</span></u></td></tr>
<tr><th id="2542">2542</th><td></td></tr>
<tr><th id="2543">2543</th><td><i>/*</i></td></tr>
<tr><th id="2544">2544</th><td><i> * Touch the watchdog for every WD_PAGE_COUNT pages.</i></td></tr>
<tr><th id="2545">2545</th><td><i> */</i></td></tr>
<tr><th id="2546">2546</th><td><u>#define WD_PAGE_COUNT	(128*1024)</u></td></tr>
<tr><th id="2547">2547</th><td></td></tr>
<tr><th id="2548">2548</th><td><em>void</em> mark_free_pages(<b>struct</b> zone *zone)</td></tr>
<tr><th id="2549">2549</th><td>{</td></tr>
<tr><th id="2550">2550</th><td>	<em>unsigned</em> <em>long</em> pfn, max_zone_pfn, page_count = WD_PAGE_COUNT;</td></tr>
<tr><th id="2551">2551</th><td>	<em>unsigned</em> <em>long</em> flags;</td></tr>
<tr><th id="2552">2552</th><td>	<em>unsigned</em> <em>int</em> order, t;</td></tr>
<tr><th id="2553">2553</th><td>	<b>struct</b> page *page;</td></tr>
<tr><th id="2554">2554</th><td></td></tr>
<tr><th id="2555">2555</th><td>	<b>if</b> (zone_is_empty(zone))</td></tr>
<tr><th id="2556">2556</th><td>		<b>return</b>;</td></tr>
<tr><th id="2557">2557</th><td></td></tr>
<tr><th id="2558">2558</th><td>	spin_lock_irqsave(&amp;zone-&gt;lock, flags);</td></tr>
<tr><th id="2559">2559</th><td></td></tr>
<tr><th id="2560">2560</th><td>	max_zone_pfn = zone_end_pfn(zone);</td></tr>
<tr><th id="2561">2561</th><td>	<b>for</b> (pfn = zone-&gt;zone_start_pfn; pfn &lt; max_zone_pfn; pfn++)</td></tr>
<tr><th id="2562">2562</th><td>		<b>if</b> (pfn_valid(pfn)) {</td></tr>
<tr><th id="2563">2563</th><td>			page = pfn_to_page(pfn);</td></tr>
<tr><th id="2564">2564</th><td></td></tr>
<tr><th id="2565">2565</th><td>			<b>if</b> (!--page_count) {</td></tr>
<tr><th id="2566">2566</th><td>				touch_nmi_watchdog();</td></tr>
<tr><th id="2567">2567</th><td>				page_count = WD_PAGE_COUNT;</td></tr>
<tr><th id="2568">2568</th><td>			}</td></tr>
<tr><th id="2569">2569</th><td></td></tr>
<tr><th id="2570">2570</th><td>			<b>if</b> (page_zone(page) != zone)</td></tr>
<tr><th id="2571">2571</th><td>				<b>continue</b>;</td></tr>
<tr><th id="2572">2572</th><td></td></tr>
<tr><th id="2573">2573</th><td>			<b>if</b> (!swsusp_page_is_forbidden(page))</td></tr>
<tr><th id="2574">2574</th><td>				swsusp_unset_page_free(page);</td></tr>
<tr><th id="2575">2575</th><td>		}</td></tr>
<tr><th id="2576">2576</th><td></td></tr>
<tr><th id="2577">2577</th><td>	for_each_migratetype_order(order, t) {</td></tr>
<tr><th id="2578">2578</th><td>		list_for_each_entry(page,</td></tr>
<tr><th id="2579">2579</th><td>				&amp;zone-&gt;free_area[order].free_list[t], lru) {</td></tr>
<tr><th id="2580">2580</th><td>			<em>unsigned</em> <em>long</em> i;</td></tr>
<tr><th id="2581">2581</th><td></td></tr>
<tr><th id="2582">2582</th><td>			pfn = page_to_pfn(page);</td></tr>
<tr><th id="2583">2583</th><td>			<b>for</b> (i = <var>0</var>; i &lt; (<var>1UL</var> &lt;&lt; order); i++) {</td></tr>
<tr><th id="2584">2584</th><td>				<b>if</b> (!--page_count) {</td></tr>
<tr><th id="2585">2585</th><td>					touch_nmi_watchdog();</td></tr>
<tr><th id="2586">2586</th><td>					page_count = WD_PAGE_COUNT;</td></tr>
<tr><th id="2587">2587</th><td>				}</td></tr>
<tr><th id="2588">2588</th><td>				swsusp_set_page_free(pfn_to_page(pfn + i));</td></tr>
<tr><th id="2589">2589</th><td>			}</td></tr>
<tr><th id="2590">2590</th><td>		}</td></tr>
<tr><th id="2591">2591</th><td>	}</td></tr>
<tr><th id="2592">2592</th><td>	spin_unlock_irqrestore(&amp;zone-&gt;lock, flags);</td></tr>
<tr><th id="2593">2593</th><td>}</td></tr>
<tr><th id="2594">2594</th><td><u>#<span data-ppcond="2541">endif</span> /* CONFIG_PM */</u></td></tr>
<tr><th id="2595">2595</th><td></td></tr>
<tr><th id="2596">2596</th><td><i>/*</i></td></tr>
<tr><th id="2597">2597</th><td><i> * Free a 0-order page</i></td></tr>
<tr><th id="2598">2598</th><td><i> * cold == true ? free a cold page : free a hot page</i></td></tr>
<tr><th id="2599">2599</th><td><i> */</i></td></tr>
<tr><th id="2600">2600</th><td><em>void</em> <dfn class="decl def fn" id="free_hot_cold_page" title='free_hot_cold_page' data-ref="free_hot_cold_page">free_hot_cold_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="653page" title='page' data-type='struct page *' data-ref="653page">page</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col4 decl" id="654cold" title='cold' data-type='bool' data-ref="654cold">cold</dfn>)</td></tr>
<tr><th id="2601">2601</th><td>{</td></tr>
<tr><th id="2602">2602</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col5 decl" id="655zone" title='zone' data-type='struct zone *' data-ref="655zone">zone</dfn> = <a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>);</td></tr>
<tr><th id="2603">2603</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col6 decl" id="656pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="656pcp">pcp</dfn>;</td></tr>
<tr><th id="2604">2604</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="657flags" title='flags' data-type='unsigned long' data-ref="657flags">flags</dfn>;</td></tr>
<tr><th id="2605">2605</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="658pfn" title='pfn' data-type='unsigned long' data-ref="658pfn">pfn</dfn> = <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>);</td></tr>
<tr><th id="2606">2606</th><td>	<em>int</em> <dfn class="local col9 decl" id="659migratetype" title='migratetype' data-type='int' data-ref="659migratetype">migratetype</dfn>;</td></tr>
<tr><th id="2607">2607</th><td></td></tr>
<tr><th id="2608">2608</th><td>	<b>if</b> (!<a class="tu ref fn" href="#free_pcp_prepare" title='free_pcp_prepare' data-use='c' data-ref="free_pcp_prepare">free_pcp_prepare</a>(<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>))</td></tr>
<tr><th id="2609">2609</th><td>		<b>return</b>;</td></tr>
<tr><th id="2610">2610</th><td></td></tr>
<tr><th id="2611">2611</th><td>	<a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a> = <a class="tu ref fn" href="#get_pfnblock_migratetype" title='get_pfnblock_migratetype' data-use='c' data-ref="get_pfnblock_migratetype">get_pfnblock_migratetype</a>(<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>, <a class="local col8 ref" href="#658pfn" title='pfn' data-ref="658pfn">pfn</a>);</td></tr>
<tr><th id="2612">2612</th><td>	<a class="tu ref fn" href="#set_pcppage_migratetype" title='set_pcppage_migratetype' data-use='c' data-ref="set_pcppage_migratetype">set_pcppage_migratetype</a>(<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>, <a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a>);</td></tr>
<tr><th id="2613">2613</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#139" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = arch_local_irq_save(); } while (0); } while (0)" data-ref="_M/local_irq_save">local_irq_save</a>(<a class="local col7 ref" href="#657flags" title='flags' data-ref="657flags">flags</a>);</td></tr>
<tr><th id="2614">2614</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#__count_vm_event" title='__count_vm_event' data-ref="__count_vm_event">__count_vm_event</a>(<a class="enum" href="../include/linux/vm_event_item.h.html#PGFREE" title='PGFREE' data-ref="PGFREE">PGFREE</a>);</td></tr>
<tr><th id="2615">2615</th><td></td></tr>
<tr><th id="2616">2616</th><td>	<i>/*</i></td></tr>
<tr><th id="2617">2617</th><td><i>	 * We only track unmovable, reclaimable and movable on pcp lists.</i></td></tr>
<tr><th id="2618">2618</th><td><i>	 * Free ISOLATE pages back to the allocator because they are being</i></td></tr>
<tr><th id="2619">2619</th><td><i>	 * offlined but treat HIGHATOMIC as movable pages so we can get those</i></td></tr>
<tr><th id="2620">2620</th><td><i>	 * areas back if necessary. Otherwise, we may have to free</i></td></tr>
<tr><th id="2621">2621</th><td><i>	 * excessively into the page allocator</i></td></tr>
<tr><th id="2622">2622</th><td><i>	 */</i></td></tr>
<tr><th id="2623">2623</th><td>	<b>if</b> (<a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a> &gt;= <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_PCPTYPES" title='MIGRATE_PCPTYPES' data-ref="MIGRATE_PCPTYPES">MIGRATE_PCPTYPES</a>) {</td></tr>
<tr><th id="2624">2624</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(is_migrate_isolate(migratetype)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a>))) {</td></tr>
<tr><th id="2625">2625</th><td>			<a class="tu ref fn" href="#free_one_page" title='free_one_page' data-use='c' data-ref="free_one_page">free_one_page</a>(<a class="local col5 ref" href="#655zone" title='zone' data-ref="655zone">zone</a>, <a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>, <a class="local col8 ref" href="#658pfn" title='pfn' data-ref="658pfn">pfn</a>, <var>0</var>, <a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a>);</td></tr>
<tr><th id="2626">2626</th><td>			<b>goto</b> <a class="lbl" href="#660out" data-ref="660out">out</a>;</td></tr>
<tr><th id="2627">2627</th><td>		}</td></tr>
<tr><th id="2628">2628</th><td>		<a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a> = <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>;</td></tr>
<tr><th id="2629">2629</th><td>	}</td></tr>
<tr><th id="2630">2630</th><td></td></tr>
<tr><th id="2631">2631</th><td>	<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a> = &amp;<a class="macro" href="../include/linux/percpu-defs.h.html#239" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long tcp_ptr__; asm volatile(&quot;add &quot; &quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot; &quot;, %0&quot; : &quot;=r&quot; (tcp_ptr__) : &quot;m&quot; (this_cpu_off), &quot;0&quot; (zone-&gt;pageset)); (typeof(*(zone-&gt;pageset)) *)tcp_ptr__; }); })" data-ref="_M/this_cpu_ptr">this_cpu_ptr</a>(<a class="local col5 ref" href="#655zone" title='zone' data-ref="655zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>;</td></tr>
<tr><th id="2632">2632</th><td>	<b>if</b> (!<a class="local col4 ref" href="#654cold" title='cold' data-ref="654cold">cold</a>)</td></tr>
<tr><th id="2633">2633</th><td>		<a class="ref fn" href="../include/linux/list.h.html#list_add" title='list_add' data-ref="list_add">list_add</a>(&amp;<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, &amp;<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::lists" title='per_cpu_pages::lists' data-ref="per_cpu_pages::lists">lists</a>[<a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a>]);</td></tr>
<tr><th id="2634">2634</th><td>	<b>else</b></td></tr>
<tr><th id="2635">2635</th><td>		<a class="ref fn" href="../include/linux/list.h.html#list_add_tail" title='list_add_tail' data-ref="list_add_tail">list_add_tail</a>(&amp;<a class="local col3 ref" href="#653page" title='page' data-ref="653page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>, &amp;<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::lists" title='per_cpu_pages::lists' data-ref="per_cpu_pages::lists">lists</a>[<a class="local col9 ref" href="#659migratetype" title='migratetype' data-ref="659migratetype">migratetype</a>]);</td></tr>
<tr><th id="2636">2636</th><td>	<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>++;</td></tr>
<tr><th id="2637">2637</th><td>	<b>if</b> (<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a> &gt;= <a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::high" title='per_cpu_pages::high' data-ref="per_cpu_pages::high">high</a>) {</td></tr>
<tr><th id="2638">2638</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="661batch" title='batch' data-type='unsigned long' data-ref="661batch">batch</dfn> = <a class="macro" href="../include/linux/compiler.h.html#254" title="({ union { typeof(pcp-&gt;batch) __val; char __c[1]; } __u; if (1) __read_once_size(&amp;(pcp-&gt;batch), __u.__c, sizeof(pcp-&gt;batch)); else __read_once_size_nocheck(&amp;(pcp-&gt;batch), __u.__c, sizeof(pcp-&gt;batch)); do { } while (0); __u.__val; })" data-ref="_M/READ_ONCE">READ_ONCE</a>(<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::batch" title='per_cpu_pages::batch' data-ref="per_cpu_pages::batch">batch</a>);</td></tr>
<tr><th id="2639">2639</th><td>		<a class="tu ref fn" href="#free_pcppages_bulk" title='free_pcppages_bulk' data-use='c' data-ref="free_pcppages_bulk">free_pcppages_bulk</a>(<a class="local col5 ref" href="#655zone" title='zone' data-ref="655zone">zone</a>, <a class="local col1 ref" href="#661batch" title='batch' data-ref="661batch">batch</a>, <a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>);</td></tr>
<tr><th id="2640">2640</th><td>		<a class="local col6 ref" href="#656pcp" title='pcp' data-ref="656pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a> -= <a class="local col1 ref" href="#661batch" title='batch' data-ref="661batch">batch</a>;</td></tr>
<tr><th id="2641">2641</th><td>	}</td></tr>
<tr><th id="2642">2642</th><td></td></tr>
<tr><th id="2643">2643</th><td><dfn class="lbl" id="660out" data-ref="660out">out</dfn>:</td></tr>
<tr><th id="2644">2644</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col7 ref" href="#657flags" title='flags' data-ref="657flags">flags</a>);</td></tr>
<tr><th id="2645">2645</th><td>}</td></tr>
<tr><th id="2646">2646</th><td></td></tr>
<tr><th id="2647">2647</th><td><i>/*</i></td></tr>
<tr><th id="2648">2648</th><td><i> * Free a list of 0-order pages</i></td></tr>
<tr><th id="2649">2649</th><td><i> */</i></td></tr>
<tr><th id="2650">2650</th><td><em>void</em> <dfn class="decl def fn" id="free_hot_cold_page_list" title='free_hot_cold_page_list' data-ref="free_hot_cold_page_list">free_hot_cold_page_list</dfn>(<b>struct</b> <a class="type" href="../include/linux/types.h.html#list_head" title='list_head' data-ref="list_head">list_head</a> *<dfn class="local col2 decl" id="662list" title='list' data-type='struct list_head *' data-ref="662list">list</dfn>, <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col3 decl" id="663cold" title='cold' data-type='bool' data-ref="663cold">cold</dfn>)</td></tr>
<tr><th id="2651">2651</th><td>{</td></tr>
<tr><th id="2652">2652</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="664page" title='page' data-type='struct page *' data-ref="664page">page</dfn>, *<dfn class="local col5 decl" id="665next" title='next' data-type='struct page *' data-ref="665next">next</dfn>;</td></tr>
<tr><th id="2653">2653</th><td></td></tr>
<tr><th id="2654">2654</th><td>	<a class="macro" href="../include/linux/list.h.html#550" title="for (page = ({ void *__mptr = (void *)((list)-&gt;next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((list)-&gt;next)), typeof(((typeof(*page) *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((list)-&gt;next)), typeof(void)))); extern void __compiletime_assert_2654(void) ; if (__cond) __compiletime_assert_2654(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*page) *)(__mptr - __builtin_offsetof(typeof(*page), lru))); }), next = ({ void *__mptr = (void *)((page)-&gt;lru.next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((page)-&gt;lru.next)), typeof(((typeof(*(page)) *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((page)-&gt;lru.next)), typeof(void)))); extern void __compiletime_assert_2654(void) ; if (__cond) __compiletime_assert_2654(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*(page)) *)(__mptr - __builtin_offsetof(typeof(*(page)), lru))); }); &amp;page-&gt;lru != (list); page = next, next = ({ void *__mptr = (void *)((next)-&gt;lru.next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((next)-&gt;lru.next)), typeof(((typeof(*(next)) *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((next)-&gt;lru.next)), typeof(void)))); extern void __compiletime_assert_2654(void) ; if (__cond) __compiletime_assert_2654(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*(next)) *)(__mptr - __builtin_offsetof(typeof(*(next)), lru))); }))" data-ref="_M/list_for_each_entry_safe">list_for_each_entry_safe</a>(<a class="local col4 ref" href="#664page" title='page' data-ref="664page">page</a>, <a class="local col5 ref" href="#665next" title='next' data-ref="665next">next</a>, <a class="local col2 ref" href="#662list" title='list' data-ref="662list">list</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>) {</td></tr>
<tr><th id="2655">2655</th><td>		<a class="ref fn" href="../include/trace/events/kmem.h.html#173" title='trace_mm_page_free_batched' data-ref="trace_mm_page_free_batched">trace_mm_page_free_batched</a>(<a class="local col4 ref" href="#664page" title='page' data-ref="664page">page</a>, <a class="local col3 ref" href="#663cold" title='cold' data-ref="663cold">cold</a>);</td></tr>
<tr><th id="2656">2656</th><td>		<a class="ref fn" href="#free_hot_cold_page" title='free_hot_cold_page' data-ref="free_hot_cold_page">free_hot_cold_page</a>(<a class="local col4 ref" href="#664page" title='page' data-ref="664page">page</a>, <a class="local col3 ref" href="#663cold" title='cold' data-ref="663cold">cold</a>);</td></tr>
<tr><th id="2657">2657</th><td>	}</td></tr>
<tr><th id="2658">2658</th><td>}</td></tr>
<tr><th id="2659">2659</th><td></td></tr>
<tr><th id="2660">2660</th><td><i>/*</i></td></tr>
<tr><th id="2661">2661</th><td><i> * split_page takes a non-compound higher-order page, and splits it into</i></td></tr>
<tr><th id="2662">2662</th><td><i> * n (1&lt;&lt;order) sub-pages: page[0..n]</i></td></tr>
<tr><th id="2663">2663</th><td><i> * Each sub-page must be freed individually.</i></td></tr>
<tr><th id="2664">2664</th><td><i> *</i></td></tr>
<tr><th id="2665">2665</th><td><i> * Note: this is probably too low level an operation for use in drivers.</i></td></tr>
<tr><th id="2666">2666</th><td><i> * Please consult with lkml before using this in your driver.</i></td></tr>
<tr><th id="2667">2667</th><td><i> */</i></td></tr>
<tr><th id="2668">2668</th><td><em>void</em> <dfn class="decl def fn" id="split_page" title='split_page' data-ref="split_page">split_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="666page" title='page' data-type='struct page *' data-ref="666page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="667order" title='order' data-type='unsigned int' data-ref="667order">order</dfn>)</td></tr>
<tr><th id="2669">2669</th><td>{</td></tr>
<tr><th id="2670">2670</th><td>	<em>int</em> <dfn class="local col8 decl" id="668i" title='i' data-type='int' data-ref="668i">i</dfn>;</td></tr>
<tr><th id="2671">2671</th><td></td></tr>
<tr><th id="2672">2672</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(PageCompound(page)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/page-flags.h.html#PageCompound" title='PageCompound' data-ref="PageCompound">PageCompound</a>(<a class="local col6 ref" href="#666page" title='page' data-ref="666page">page</a>), page);</td></tr>
<tr><th id="2673">2673</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(!page_count(page)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(!<a class="ref fn" href="../include/linux/page_ref.h.html#page_count" title='page_count' data-ref="page_count">page_count</a>(<a class="local col6 ref" href="#666page" title='page' data-ref="666page">page</a>), page);</td></tr>
<tr><th id="2674">2674</th><td></td></tr>
<tr><th id="2675">2675</th><td>	<b>for</b> (<a class="local col8 ref" href="#668i" title='i' data-ref="668i">i</a> = <var>1</var>; <a class="local col8 ref" href="#668i" title='i' data-ref="668i">i</a> &lt; (<var>1</var> &lt;&lt; <a class="local col7 ref" href="#667order" title='order' data-ref="667order">order</a>); <a class="local col8 ref" href="#668i" title='i' data-ref="668i">i</a>++)</td></tr>
<tr><th id="2676">2676</th><td>		<a class="ref fn" href="internal.h.html#set_page_refcounted" title='set_page_refcounted' data-ref="set_page_refcounted">set_page_refcounted</a>(<a class="local col6 ref" href="#666page" title='page' data-ref="666page">page</a> + <a class="local col8 ref" href="#668i" title='i' data-ref="668i">i</a>);</td></tr>
<tr><th id="2677">2677</th><td>	<a class="ref fn" href="../include/linux/page_owner.h.html#split_page_owner" title='split_page_owner' data-ref="split_page_owner">split_page_owner</a>(<a class="local col6 ref" href="#666page" title='page' data-ref="666page">page</a>, <a class="local col7 ref" href="#667order" title='order' data-ref="667order">order</a>);</td></tr>
<tr><th id="2678">2678</th><td>}</td></tr>
<tr><th id="2679">2679</th><td><a class="macro" href="../include/linux/export.h.html#106" title="extern typeof(split_page) split_page; static const char __kstrtab_split_page[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;split_page&quot;; static const struct kernel_symbol __ksymtab_split_page __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;_gpl&quot; &quot;+&quot; &quot;split_page&quot;), used)) = { (unsigned long)&amp;split_page, __kstrtab_split_page }" data-ref="_M/EXPORT_SYMBOL_GPL">EXPORT_SYMBOL_GPL</a>(<a class="decl fn" href="#split_page" title='split_page' data-ref="split_page"><a class="ref fn" href="#split_page" title='split_page' data-ref="split_page"><a class="ref fn" href="#split_page" title='split_page' data-ref="split_page"><a class="ref fn" href="#split_page" title='split_page' data-ref="split_page">split_page</a></a></a></a>);</td></tr>
<tr><th id="2680">2680</th><td></td></tr>
<tr><th id="2681">2681</th><td><em>int</em> <dfn class="decl def fn" id="__isolate_free_page" title='__isolate_free_page' data-ref="__isolate_free_page">__isolate_free_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col9 decl" id="669page" title='page' data-type='struct page *' data-ref="669page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="670order" title='order' data-type='unsigned int' data-ref="670order">order</dfn>)</td></tr>
<tr><th id="2682">2682</th><td>{</td></tr>
<tr><th id="2683">2683</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="671watermark" title='watermark' data-type='unsigned long' data-ref="671watermark">watermark</dfn>;</td></tr>
<tr><th id="2684">2684</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="672zone" title='zone' data-type='struct zone *' data-ref="672zone">zone</dfn>;</td></tr>
<tr><th id="2685">2685</th><td>	<em>int</em> <dfn class="local col3 decl" id="673mt" title='mt' data-type='int' data-ref="673mt">mt</dfn>;</td></tr>
<tr><th id="2686">2686</th><td></td></tr>
<tr><th id="2687">2687</th><td>	<a class="macro" href="../include/asm-generic/bug.h.html#59" title="do { if (__builtin_expect(!!(!PageBuddy(page)), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (2687), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (163)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(!<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='PageBuddy' data-ref="PageBuddy">PageBuddy</a>(<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>));</td></tr>
<tr><th id="2688">2688</th><td></td></tr>
<tr><th id="2689">2689</th><td>	<a class="local col2 ref" href="#672zone" title='zone' data-ref="672zone">zone</a> = <a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>);</td></tr>
<tr><th id="2690">2690</th><td>	<a class="local col3 ref" href="#673mt" title='mt' data-ref="673mt">mt</a> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(page, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>);</td></tr>
<tr><th id="2691">2691</th><td></td></tr>
<tr><th id="2692">2692</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col3 ref" href="#673mt" title='mt' data-ref="673mt">mt</a>)) {</td></tr>
<tr><th id="2693">2693</th><td>		<i>/*</i></td></tr>
<tr><th id="2694">2694</th><td><i>		 * Obey watermarks as if the page was being allocated. We can</i></td></tr>
<tr><th id="2695">2695</th><td><i>		 * emulate a high-order watermark check with a raised order-0</i></td></tr>
<tr><th id="2696">2696</th><td><i>		 * watermark, because we already know our high-order page</i></td></tr>
<tr><th id="2697">2697</th><td><i>		 * exists.</i></td></tr>
<tr><th id="2698">2698</th><td><i>		 */</i></td></tr>
<tr><th id="2699">2699</th><td>		<a class="local col1 ref" href="#671watermark" title='watermark' data-ref="671watermark">watermark</a> = <a class="macro" href="../include/linux/mmzone.h.html#269" title="(zone-&gt;watermark[WMARK_MIN])" data-ref="_M/min_wmark_pages">min_wmark_pages</a>(<a class="local col2 ref" href="#672zone" title='zone' data-ref="672zone">zone</a>) + (<var>1UL</var> &lt;&lt; <a class="local col0 ref" href="#670order" title='order' data-ref="670order">order</a>);</td></tr>
<tr><th id="2700">2700</th><td>		<b>if</b> (!<a class="ref fn" href="#zone_watermark_ok" title='zone_watermark_ok' data-ref="zone_watermark_ok">zone_watermark_ok</a>(<a class="local col2 ref" href="#672zone" title='zone' data-ref="672zone">zone</a>, <var>0</var>, <a class="local col1 ref" href="#671watermark" title='watermark' data-ref="671watermark">watermark</a>, <var>0</var>, <a class="macro" href="internal.h.html#497" title="0x80" data-ref="_M/ALLOC_CMA">ALLOC_CMA</a>))</td></tr>
<tr><th id="2701">2701</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2702">2702</th><td></td></tr>
<tr><th id="2703">2703</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#__mod_zone_freepage_state" title='__mod_zone_freepage_state' data-ref="__mod_zone_freepage_state">__mod_zone_freepage_state</a>(<a class="local col2 ref" href="#672zone" title='zone' data-ref="672zone">zone</a>, -(<var>1UL</var> &lt;&lt; <a class="local col0 ref" href="#670order" title='order' data-ref="670order">order</a>), <a class="local col3 ref" href="#673mt" title='mt' data-ref="673mt">mt</a>);</td></tr>
<tr><th id="2704">2704</th><td>	}</td></tr>
<tr><th id="2705">2705</th><td></td></tr>
<tr><th id="2706">2706</th><td>	<i>/* Remove page from free list */</i></td></tr>
<tr><th id="2707">2707</th><td>	<a class="ref fn" href="../include/linux/list.h.html#list_del" title='list_del' data-ref="list_del">list_del</a>(&amp;<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="2708">2708</th><td>	<a class="local col2 ref" href="#672zone" title='zone' data-ref="672zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col0 ref" href="#670order" title='order' data-ref="670order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>--;</td></tr>
<tr><th id="2709">2709</th><td>	<a class="tu ref fn" href="#rmv_page_order" title='rmv_page_order' data-use='c' data-ref="rmv_page_order">rmv_page_order</a>(<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>);</td></tr>
<tr><th id="2710">2710</th><td></td></tr>
<tr><th id="2711">2711</th><td>	<i>/*</i></td></tr>
<tr><th id="2712">2712</th><td><i>	 * Set the pageblock if the isolated page is at least half of a</i></td></tr>
<tr><th id="2713">2713</th><td><i>	 * pageblock</i></td></tr>
<tr><th id="2714">2714</th><td><i>	 */</i></td></tr>
<tr><th id="2715">2715</th><td>	<b>if</b> (<a class="local col0 ref" href="#670order" title='order' data-ref="670order">order</a> &gt;= <a class="macro" href="../include/linux/pageblock-flags.h.html#52" title="(21 - 12)" data-ref="_M/pageblock_order">pageblock_order</a> - <var>1</var>) {</td></tr>
<tr><th id="2716">2716</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col4 decl" id="674endpage" title='endpage' data-type='struct page *' data-ref="674endpage">endpage</dfn> = <a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a> + (<var>1</var> &lt;&lt; <a class="local col0 ref" href="#670order" title='order' data-ref="670order">order</a>) - <var>1</var>;</td></tr>
<tr><th id="2717">2717</th><td>		<b>for</b> (; <a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a> &lt; <a class="local col4 ref" href="#674endpage" title='endpage' data-ref="674endpage">endpage</a>; <a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a> += <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>) {</td></tr>
<tr><th id="2718">2718</th><td>			<em>int</em> <dfn class="local col5 decl" id="675mt" title='mt' data-type='int' data-ref="675mt">mt</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(page, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>);</td></tr>
<tr><th id="2719">2719</th><td>			<b>if</b> (!<a class="ref fn" href="../include/linux/page-isolation.h.html#is_migrate_isolate" title='is_migrate_isolate' data-ref="is_migrate_isolate">is_migrate_isolate</a>(<a class="local col5 ref" href="#675mt" title='mt' data-ref="675mt">mt</a>) &amp;&amp; !<a class="macro" href="../include/linux/mmzone.h.html#74" title="false" data-ref="_M/is_migrate_cma">is_migrate_cma</a>(mt)</td></tr>
<tr><th id="2720">2720</th><td>			    &amp;&amp; !<a class="ref fn" href="internal.h.html#is_migrate_highatomic" title='is_migrate_highatomic' data-ref="is_migrate_highatomic">is_migrate_highatomic</a>(<a class="local col5 ref" href="#675mt" title='mt' data-ref="675mt">mt</a>))</td></tr>
<tr><th id="2721">2721</th><td>				<a class="ref fn" href="#set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</a>(<a class="local col9 ref" href="#669page" title='page' data-ref="669page">page</a>,</td></tr>
<tr><th id="2722">2722</th><td>							  <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>);</td></tr>
<tr><th id="2723">2723</th><td>		}</td></tr>
<tr><th id="2724">2724</th><td>	}</td></tr>
<tr><th id="2725">2725</th><td></td></tr>
<tr><th id="2726">2726</th><td></td></tr>
<tr><th id="2727">2727</th><td>	<b>return</b> <var>1UL</var> &lt;&lt; <a class="local col0 ref" href="#670order" title='order' data-ref="670order">order</a>;</td></tr>
<tr><th id="2728">2728</th><td>}</td></tr>
<tr><th id="2729">2729</th><td></td></tr>
<tr><th id="2730">2730</th><td><i  data-doc="zone_statistics">/*</i></td></tr>
<tr><th id="2731">2731</th><td><i  data-doc="zone_statistics"> * Update NUMA hit/miss statistics</i></td></tr>
<tr><th id="2732">2732</th><td><i  data-doc="zone_statistics"> *</i></td></tr>
<tr><th id="2733">2733</th><td><i  data-doc="zone_statistics"> * Must be called with interrupts disabled.</i></td></tr>
<tr><th id="2734">2734</th><td><i  data-doc="zone_statistics"> */</i></td></tr>
<tr><th id="2735">2735</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="zone_statistics" title='zone_statistics' data-type='void zone_statistics(struct zone * preferred_zone, struct zone * z)' data-ref="zone_statistics">zone_statistics</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="676preferred_zone" title='preferred_zone' data-type='struct zone *' data-ref="676preferred_zone">preferred_zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="677z" title='z' data-type='struct zone *' data-ref="677z">z</dfn>)</td></tr>
<tr><th id="2736">2736</th><td>{</td></tr>
<tr><th id="2737">2737</th><td><u>#<span data-ppcond="2737">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="2738">2738</th><td>	<b>enum</b> numa_stat_item local_stat = NUMA_LOCAL;</td></tr>
<tr><th id="2739">2739</th><td></td></tr>
<tr><th id="2740">2740</th><td>	<b>if</b> (z-&gt;node != numa_node_id())</td></tr>
<tr><th id="2741">2741</th><td>		local_stat = NUMA_OTHER;</td></tr>
<tr><th id="2742">2742</th><td></td></tr>
<tr><th id="2743">2743</th><td>	<b>if</b> (z-&gt;node == preferred_zone-&gt;node)</td></tr>
<tr><th id="2744">2744</th><td>		__inc_numa_state(z, NUMA_HIT);</td></tr>
<tr><th id="2745">2745</th><td>	<b>else</b> {</td></tr>
<tr><th id="2746">2746</th><td>		__inc_numa_state(z, NUMA_MISS);</td></tr>
<tr><th id="2747">2747</th><td>		__inc_numa_state(preferred_zone, NUMA_FOREIGN);</td></tr>
<tr><th id="2748">2748</th><td>	}</td></tr>
<tr><th id="2749">2749</th><td>	__inc_numa_state(z, local_stat);</td></tr>
<tr><th id="2750">2750</th><td><u>#<span data-ppcond="2737">endif</span></u></td></tr>
<tr><th id="2751">2751</th><td>}</td></tr>
<tr><th id="2752">2752</th><td></td></tr>
<tr><th id="2753">2753</th><td><i  data-doc="__rmqueue_pcplist">/* Remove page from the per-cpu list, caller must protect the list */</i></td></tr>
<tr><th id="2754">2754</th><td><em>static</em> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="__rmqueue_pcplist" title='__rmqueue_pcplist' data-type='struct page * __rmqueue_pcplist(struct zone * zone, int migratetype, bool cold, struct per_cpu_pages * pcp, struct list_head * list)' data-ref="__rmqueue_pcplist">__rmqueue_pcplist</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col8 decl" id="678zone" title='zone' data-type='struct zone *' data-ref="678zone">zone</dfn>, <em>int</em> <dfn class="local col9 decl" id="679migratetype" title='migratetype' data-type='int' data-ref="679migratetype">migratetype</dfn>,</td></tr>
<tr><th id="2755">2755</th><td>			<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col0 decl" id="680cold" title='cold' data-type='bool' data-ref="680cold">cold</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col1 decl" id="681pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="681pcp">pcp</dfn>,</td></tr>
<tr><th id="2756">2756</th><td>			<b>struct</b> <a class="type" href="../include/linux/types.h.html#list_head" title='list_head' data-ref="list_head">list_head</a> *<dfn class="local col2 decl" id="682list" title='list' data-type='struct list_head *' data-ref="682list">list</dfn>)</td></tr>
<tr><th id="2757">2757</th><td>{</td></tr>
<tr><th id="2758">2758</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="683page" title='page' data-type='struct page *' data-ref="683page">page</dfn>;</td></tr>
<tr><th id="2759">2759</th><td></td></tr>
<tr><th id="2760">2760</th><td>	<b>do</b> {</td></tr>
<tr><th id="2761">2761</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(<a class="local col2 ref" href="#682list" title='list' data-ref="682list">list</a>)) {</td></tr>
<tr><th id="2762">2762</th><td>			<a class="local col1 ref" href="#681pcp" title='pcp' data-ref="681pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a> += <a class="tu ref fn" href="#rmqueue_bulk" title='rmqueue_bulk' data-use='c' data-ref="rmqueue_bulk">rmqueue_bulk</a>(<a class="local col8 ref" href="#678zone" title='zone' data-ref="678zone">zone</a>, <var>0</var>,</td></tr>
<tr><th id="2763">2763</th><td>					<a class="local col1 ref" href="#681pcp" title='pcp' data-ref="681pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::batch" title='per_cpu_pages::batch' data-ref="per_cpu_pages::batch">batch</a>, <a class="local col2 ref" href="#682list" title='list' data-ref="682list">list</a>,</td></tr>
<tr><th id="2764">2764</th><td>					<a class="local col9 ref" href="#679migratetype" title='migratetype' data-ref="679migratetype">migratetype</a>, <a class="local col0 ref" href="#680cold" title='cold' data-ref="680cold">cold</a>);</td></tr>
<tr><th id="2765">2765</th><td>			<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(list_empty(list)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(<a class="local col2 ref" href="#682list" title='list' data-ref="682list">list</a>)))</td></tr>
<tr><th id="2766">2766</th><td>				<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2767">2767</th><td>		}</td></tr>
<tr><th id="2768">2768</th><td></td></tr>
<tr><th id="2769">2769</th><td>		<b>if</b> (<a class="local col0 ref" href="#680cold" title='cold' data-ref="680cold">cold</a>)</td></tr>
<tr><th id="2770">2770</th><td>			<a class="local col3 ref" href="#683page" title='page' data-ref="683page">page</a> = <a class="macro" href="../include/linux/list.h.html#387" title="({ void *__mptr = (void *)((list)-&gt;prev); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((list)-&gt;prev)), typeof(((struct page *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((list)-&gt;prev)), typeof(void)))); extern void __compiletime_assert_2770(void) ; if (__cond) __compiletime_assert_2770(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((struct page *)(__mptr - __builtin_offsetof(struct page, lru))); })" data-ref="_M/list_last_entry">list_last_entry</a>(<a class="local col2 ref" href="#682list" title='list' data-ref="682list">list</a>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="2771">2771</th><td>		<b>else</b></td></tr>
<tr><th id="2772">2772</th><td>			<a class="local col3 ref" href="#683page" title='page' data-ref="683page">page</a> = <a class="macro" href="../include/linux/list.h.html#376" title="({ void *__mptr = (void *)((list)-&gt;next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((list)-&gt;next)), typeof(((struct page *)0)-&gt;lru)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((list)-&gt;next)), typeof(void)))); extern void __compiletime_assert_2772(void) ; if (__cond) __compiletime_assert_2772(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((struct page *)(__mptr - __builtin_offsetof(struct page, lru))); })" data-ref="_M/list_first_entry">list_first_entry</a>(<a class="local col2 ref" href="#682list" title='list' data-ref="682list">list</a>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>, <a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="2773">2773</th><td></td></tr>
<tr><th id="2774">2774</th><td>		<a class="ref fn" href="../include/linux/list.h.html#list_del" title='list_del' data-ref="list_del">list_del</a>(&amp;<a class="local col3 ref" href="#683page" title='page' data-ref="683page">page</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page::(anonymous)::lru" title='page::(anonymous union)::lru' data-ref="page::(anonymous)::lru">lru</a>);</td></tr>
<tr><th id="2775">2775</th><td>		<a class="local col1 ref" href="#681pcp" title='pcp' data-ref="681pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>--;</td></tr>
<tr><th id="2776">2776</th><td>	} <b>while</b> (<a class="tu ref fn" href="#check_new_pcp" title='check_new_pcp' data-use='c' data-ref="check_new_pcp">check_new_pcp</a>(<a class="local col3 ref" href="#683page" title='page' data-ref="683page">page</a>));</td></tr>
<tr><th id="2777">2777</th><td></td></tr>
<tr><th id="2778">2778</th><td>	<b>return</b> <a class="local col3 ref" href="#683page" title='page' data-ref="683page">page</a>;</td></tr>
<tr><th id="2779">2779</th><td>}</td></tr>
<tr><th id="2780">2780</th><td></td></tr>
<tr><th id="2781">2781</th><td><i  data-doc="rmqueue_pcplist">/* Lock and remove page from the per-cpu list */</i></td></tr>
<tr><th id="2782">2782</th><td><em>static</em> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="rmqueue_pcplist" title='rmqueue_pcplist' data-type='struct page * rmqueue_pcplist(struct zone * preferred_zone, struct zone * zone, unsigned int order, gfp_t gfp_flags, int migratetype)' data-ref="rmqueue_pcplist">rmqueue_pcplist</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="684preferred_zone" title='preferred_zone' data-type='struct zone *' data-ref="684preferred_zone">preferred_zone</dfn>,</td></tr>
<tr><th id="2783">2783</th><td>			<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col5 decl" id="685zone" title='zone' data-type='struct zone *' data-ref="685zone">zone</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="686order" title='order' data-type='unsigned int' data-ref="686order">order</dfn>,</td></tr>
<tr><th id="2784">2784</th><td>			<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col7 decl" id="687gfp_flags" title='gfp_flags' data-type='gfp_t' data-ref="687gfp_flags">gfp_flags</dfn>, <em>int</em> <dfn class="local col8 decl" id="688migratetype" title='migratetype' data-type='int' data-ref="688migratetype">migratetype</dfn>)</td></tr>
<tr><th id="2785">2785</th><td>{</td></tr>
<tr><th id="2786">2786</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col9 decl" id="689pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="689pcp">pcp</dfn>;</td></tr>
<tr><th id="2787">2787</th><td>	<b>struct</b> <a class="type" href="../include/linux/types.h.html#list_head" title='list_head' data-ref="list_head">list_head</a> *<dfn class="local col0 decl" id="690list" title='list' data-type='struct list_head *' data-ref="690list">list</dfn>;</td></tr>
<tr><th id="2788">2788</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col1 decl" id="691cold" title='cold' data-type='bool' data-ref="691cold">cold</dfn> = ((<a class="local col7 ref" href="#687gfp_flags" title='gfp_flags' data-ref="687gfp_flags">gfp_flags</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#204" title="(( gfp_t)0x100u)" data-ref="_M/__GFP_COLD">__GFP_COLD</a>) != <var>0</var>);</td></tr>
<tr><th id="2789">2789</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="692page" title='page' data-type='struct page *' data-ref="692page">page</dfn>;</td></tr>
<tr><th id="2790">2790</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="693flags" title='flags' data-type='unsigned long' data-ref="693flags">flags</dfn>;</td></tr>
<tr><th id="2791">2791</th><td></td></tr>
<tr><th id="2792">2792</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#139" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = arch_local_irq_save(); } while (0); } while (0)" data-ref="_M/local_irq_save">local_irq_save</a>(<a class="local col3 ref" href="#693flags" title='flags' data-ref="693flags">flags</a>);</td></tr>
<tr><th id="2793">2793</th><td>	<a class="local col9 ref" href="#689pcp" title='pcp' data-ref="689pcp">pcp</a> = &amp;<a class="macro" href="../include/linux/percpu-defs.h.html#239" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long tcp_ptr__; asm volatile(&quot;add &quot; &quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot; &quot;, %0&quot; : &quot;=r&quot; (tcp_ptr__) : &quot;m&quot; (this_cpu_off), &quot;0&quot; (zone-&gt;pageset)); (typeof(*(zone-&gt;pageset)) *)tcp_ptr__; }); })" data-ref="_M/this_cpu_ptr">this_cpu_ptr</a>(<a class="local col5 ref" href="#685zone" title='zone' data-ref="685zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>;</td></tr>
<tr><th id="2794">2794</th><td>	<a class="local col0 ref" href="#690list" title='list' data-ref="690list">list</a> = &amp;<a class="local col9 ref" href="#689pcp" title='pcp' data-ref="689pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::lists" title='per_cpu_pages::lists' data-ref="per_cpu_pages::lists">lists</a>[<a class="local col8 ref" href="#688migratetype" title='migratetype' data-ref="688migratetype">migratetype</a>];</td></tr>
<tr><th id="2795">2795</th><td>	<a class="local col2 ref" href="#692page" title='page' data-ref="692page">page</a> = <a class="tu ref fn" href="#__rmqueue_pcplist" title='__rmqueue_pcplist' data-use='c' data-ref="__rmqueue_pcplist">__rmqueue_pcplist</a>(<a class="local col5 ref" href="#685zone" title='zone' data-ref="685zone">zone</a>,  <a class="local col8 ref" href="#688migratetype" title='migratetype' data-ref="688migratetype">migratetype</a>, <a class="local col1 ref" href="#691cold" title='cold' data-ref="691cold">cold</a>, <a class="local col9 ref" href="#689pcp" title='pcp' data-ref="689pcp">pcp</a>, <a class="local col0 ref" href="#690list" title='list' data-ref="690list">list</a>);</td></tr>
<tr><th id="2796">2796</th><td>	<b>if</b> (<a class="local col2 ref" href="#692page" title='page' data-ref="692page">page</a>) {</td></tr>
<tr><th id="2797">2797</th><td>		<a class="macro" href="../include/linux/vmstat.h.html#104" title="__count_vm_events(PGALLOC_NORMAL - ZONE_NORMAL + page_zonenum(page), 1 &lt;&lt; order)" data-ref="_M/__count_zid_vm_events">__count_zid_vm_events</a>(PGALLOC, <a class="ref fn" href="../include/linux/mm.h.html#page_zonenum" title='page_zonenum' data-ref="page_zonenum">page_zonenum</a>(<a class="local col2 ref" href="#692page" title='page' data-ref="692page">page</a>), <var>1</var> &lt;&lt; <a class="local col6 ref" href="#686order" title='order' data-ref="686order">order</a>);</td></tr>
<tr><th id="2798">2798</th><td>		<a class="tu ref fn" href="#zone_statistics" title='zone_statistics' data-use='c' data-ref="zone_statistics">zone_statistics</a>(<a class="local col4 ref" href="#684preferred_zone" title='preferred_zone' data-ref="684preferred_zone">preferred_zone</a>, <a class="local col5 ref" href="#685zone" title='zone' data-ref="685zone">zone</a>);</td></tr>
<tr><th id="2799">2799</th><td>	}</td></tr>
<tr><th id="2800">2800</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col3 ref" href="#693flags" title='flags' data-ref="693flags">flags</a>);</td></tr>
<tr><th id="2801">2801</th><td>	<b>return</b> <a class="local col2 ref" href="#692page" title='page' data-ref="692page">page</a>;</td></tr>
<tr><th id="2802">2802</th><td>}</td></tr>
<tr><th id="2803">2803</th><td></td></tr>
<tr><th id="2804">2804</th><td><i  data-doc="rmqueue">/*</i></td></tr>
<tr><th id="2805">2805</th><td><i  data-doc="rmqueue"> * Allocate a page from the given zone. Use pcplists for order-0 allocations.</i></td></tr>
<tr><th id="2806">2806</th><td><i  data-doc="rmqueue"> */</i></td></tr>
<tr><th id="2807">2807</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a></td></tr>
<tr><th id="2808">2808</th><td><b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="rmqueue" title='rmqueue' data-type='struct page * rmqueue(struct zone * preferred_zone, struct zone * zone, unsigned int order, gfp_t gfp_flags, unsigned int alloc_flags, int migratetype)' data-ref="rmqueue">rmqueue</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="694preferred_zone" title='preferred_zone' data-type='struct zone *' data-ref="694preferred_zone">preferred_zone</dfn>,</td></tr>
<tr><th id="2809">2809</th><td>			<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col5 decl" id="695zone" title='zone' data-type='struct zone *' data-ref="695zone">zone</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="696order" title='order' data-type='unsigned int' data-ref="696order">order</dfn>,</td></tr>
<tr><th id="2810">2810</th><td>			<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col7 decl" id="697gfp_flags" title='gfp_flags' data-type='gfp_t' data-ref="697gfp_flags">gfp_flags</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="698alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="698alloc_flags">alloc_flags</dfn>,</td></tr>
<tr><th id="2811">2811</th><td>			<em>int</em> <dfn class="local col9 decl" id="699migratetype" title='migratetype' data-type='int' data-ref="699migratetype">migratetype</dfn>)</td></tr>
<tr><th id="2812">2812</th><td>{</td></tr>
<tr><th id="2813">2813</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="700flags" title='flags' data-type='unsigned long' data-ref="700flags">flags</dfn>;</td></tr>
<tr><th id="2814">2814</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col1 decl" id="701page" title='page' data-type='struct page *' data-ref="701page">page</dfn>;</td></tr>
<tr><th id="2815">2815</th><td></td></tr>
<tr><th id="2816">2816</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(order == 0), 1)" data-ref="_M/likely">likely</a>(<a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a> == <var>0</var>)) {</td></tr>
<tr><th id="2817">2817</th><td>		<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a> = <a class="tu ref fn" href="#rmqueue_pcplist" title='rmqueue_pcplist' data-use='c' data-ref="rmqueue_pcplist">rmqueue_pcplist</a>(<a class="local col4 ref" href="#694preferred_zone" title='preferred_zone' data-ref="694preferred_zone">preferred_zone</a>, <a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>, <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>,</td></tr>
<tr><th id="2818">2818</th><td>				<a class="local col7 ref" href="#697gfp_flags" title='gfp_flags' data-ref="697gfp_flags">gfp_flags</a>, <a class="local col9 ref" href="#699migratetype" title='migratetype' data-ref="699migratetype">migratetype</a>);</td></tr>
<tr><th id="2819">2819</th><td>		<b>goto</b> <a class="lbl" href="#702out" data-ref="702out">out</a>;</td></tr>
<tr><th id="2820">2820</th><td>	}</td></tr>
<tr><th id="2821">2821</th><td></td></tr>
<tr><th id="2822">2822</th><td>	<i>/*</i></td></tr>
<tr><th id="2823">2823</th><td><i>	 * We most definitely don't want callers attempting to</i></td></tr>
<tr><th id="2824">2824</th><td><i>	 * allocate greater than order-1 page units with __GFP_NOFAIL.</i></td></tr>
<tr><th id="2825">2825</th><td><i>	 */</i></td></tr>
<tr><th id="2826">2826</th><td>	<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!((gfp_flags &amp; (( gfp_t)0x800u)) &amp;&amp; (order &gt; 1)); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (2826), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (165)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>((<a class="local col7 ref" href="#697gfp_flags" title='gfp_flags' data-ref="697gfp_flags">gfp_flags</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#189" title="(( gfp_t)0x800u)" data-ref="_M/__GFP_NOFAIL">__GFP_NOFAIL</a>) &amp;&amp; (<a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a> &gt; <var>1</var>));</td></tr>
<tr><th id="2827">2827</th><td>	<a class="macro" href="../include/linux/spinlock.h.html#345" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = _raw_spin_lock_irqsave(spinlock_check(&amp;zone-&gt;lock)); } while (0); } while (0)" data-ref="_M/spin_lock_irqsave">spin_lock_irqsave</a>(&amp;<a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col0 ref" href="#700flags" title='flags' data-ref="700flags">flags</a>);</td></tr>
<tr><th id="2828">2828</th><td></td></tr>
<tr><th id="2829">2829</th><td>	<b>do</b> {</td></tr>
<tr><th id="2830">2830</th><td>		<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2831">2831</th><td>		<b>if</b> (<a class="local col8 ref" href="#698alloc_flags" title='alloc_flags' data-ref="698alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#494" title="0x10" data-ref="_M/ALLOC_HARDER">ALLOC_HARDER</a>) {</td></tr>
<tr><th id="2832">2832</th><td>			<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a> = <a class="tu ref fn" href="#__rmqueue_smallest" title='__rmqueue_smallest' data-use='c' data-ref="__rmqueue_smallest">__rmqueue_smallest</a>(<a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>, <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_HIGHATOMIC" title='MIGRATE_HIGHATOMIC' data-ref="MIGRATE_HIGHATOMIC">MIGRATE_HIGHATOMIC</a>);</td></tr>
<tr><th id="2833">2833</th><td>			<b>if</b> (<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>)</td></tr>
<tr><th id="2834">2834</th><td>				<a class="ref fn" href="../include/trace/events/kmem.h.html#250" title='trace_mm_page_alloc_zone_locked' data-ref="trace_mm_page_alloc_zone_locked">trace_mm_page_alloc_zone_locked</a>(<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>, <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>, <a class="local col9 ref" href="#699migratetype" title='migratetype' data-ref="699migratetype">migratetype</a>);</td></tr>
<tr><th id="2835">2835</th><td>		}</td></tr>
<tr><th id="2836">2836</th><td>		<b>if</b> (!<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>)</td></tr>
<tr><th id="2837">2837</th><td>			<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a> = <a class="tu ref fn" href="#__rmqueue" title='__rmqueue' data-use='c' data-ref="__rmqueue">__rmqueue</a>(<a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>, <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>, <a class="local col9 ref" href="#699migratetype" title='migratetype' data-ref="699migratetype">migratetype</a>);</td></tr>
<tr><th id="2838">2838</th><td>	} <b>while</b> (<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a> &amp;&amp; <a class="tu ref fn" href="#check_new_pages" title='check_new_pages' data-use='c' data-ref="check_new_pages">check_new_pages</a>(<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>, <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>));</td></tr>
<tr><th id="2839">2839</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="2840">2840</th><td>	<b>if</b> (!<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>)</td></tr>
<tr><th id="2841">2841</th><td>		<b>goto</b> <a class="lbl" href="#703failed" data-ref="703failed">failed</a>;</td></tr>
<tr><th id="2842">2842</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#__mod_zone_freepage_state" title='__mod_zone_freepage_state' data-ref="__mod_zone_freepage_state">__mod_zone_freepage_state</a>(<a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>, -(<var>1</var> &lt;&lt; <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>),</td></tr>
<tr><th id="2843">2843</th><td>				  <a class="tu ref fn" href="#get_pcppage_migratetype" title='get_pcppage_migratetype' data-use='c' data-ref="get_pcppage_migratetype">get_pcppage_migratetype</a>(<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>));</td></tr>
<tr><th id="2844">2844</th><td></td></tr>
<tr><th id="2845">2845</th><td>	<a class="macro" href="../include/linux/vmstat.h.html#104" title="__count_vm_events(PGALLOC_NORMAL - ZONE_NORMAL + page_zonenum(page), 1 &lt;&lt; order)" data-ref="_M/__count_zid_vm_events">__count_zid_vm_events</a>(PGALLOC, <a class="ref fn" href="../include/linux/mm.h.html#page_zonenum" title='page_zonenum' data-ref="page_zonenum">page_zonenum</a>(<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>), <var>1</var> &lt;&lt; <a class="local col6 ref" href="#696order" title='order' data-ref="696order">order</a>);</td></tr>
<tr><th id="2846">2846</th><td>	<a class="tu ref fn" href="#zone_statistics" title='zone_statistics' data-use='c' data-ref="zone_statistics">zone_statistics</a>(<a class="local col4 ref" href="#694preferred_zone" title='preferred_zone' data-ref="694preferred_zone">preferred_zone</a>, <a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>);</td></tr>
<tr><th id="2847">2847</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col0 ref" href="#700flags" title='flags' data-ref="700flags">flags</a>);</td></tr>
<tr><th id="2848">2848</th><td></td></tr>
<tr><th id="2849">2849</th><td><dfn class="lbl" id="702out" data-ref="702out">out</dfn>:</td></tr>
<tr><th id="2850">2850</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(page &amp;&amp; bad_range(zone, page)))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a> &amp;&amp; <a class="tu ref fn" href="#bad_range" title='bad_range' data-use='c' data-ref="bad_range">bad_range</a>(<a class="local col5 ref" href="#695zone" title='zone' data-ref="695zone">zone</a>, <a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>), page);</td></tr>
<tr><th id="2851">2851</th><td>	<b>return</b> <a class="local col1 ref" href="#701page" title='page' data-ref="701page">page</a>;</td></tr>
<tr><th id="2852">2852</th><td></td></tr>
<tr><th id="2853">2853</th><td><dfn class="lbl" id="703failed" data-ref="703failed">failed</dfn>:</td></tr>
<tr><th id="2854">2854</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col0 ref" href="#700flags" title='flags' data-ref="700flags">flags</a>);</td></tr>
<tr><th id="2855">2855</th><td>	<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2856">2856</th><td>}</td></tr>
<tr><th id="2857">2857</th><td></td></tr>
<tr><th id="2858">2858</th><td><u>#<span data-ppcond="2858">ifdef</span> <span class="macro" data-ref="_M/CONFIG_FAIL_PAGE_ALLOC">CONFIG_FAIL_PAGE_ALLOC</span></u></td></tr>
<tr><th id="2859">2859</th><td></td></tr>
<tr><th id="2860">2860</th><td><em>static</em> <b>struct</b> {</td></tr>
<tr><th id="2861">2861</th><td>	<b>struct</b> fault_attr attr;</td></tr>
<tr><th id="2862">2862</th><td></td></tr>
<tr><th id="2863">2863</th><td>	bool ignore_gfp_highmem;</td></tr>
<tr><th id="2864">2864</th><td>	bool ignore_gfp_reclaim;</td></tr>
<tr><th id="2865">2865</th><td>	u32 min_order;</td></tr>
<tr><th id="2866">2866</th><td>} fail_page_alloc = {</td></tr>
<tr><th id="2867">2867</th><td>	.attr = FAULT_ATTR_INITIALIZER,</td></tr>
<tr><th id="2868">2868</th><td>	.ignore_gfp_reclaim = true,</td></tr>
<tr><th id="2869">2869</th><td>	.ignore_gfp_highmem = true,</td></tr>
<tr><th id="2870">2870</th><td>	.min_order = <var>1</var>,</td></tr>
<tr><th id="2871">2871</th><td>};</td></tr>
<tr><th id="2872">2872</th><td></td></tr>
<tr><th id="2873">2873</th><td><em>static</em> <em>int</em> __init setup_fail_page_alloc(<em>char</em> *str)</td></tr>
<tr><th id="2874">2874</th><td>{</td></tr>
<tr><th id="2875">2875</th><td>	<b>return</b> setup_fault_attr(&amp;fail_page_alloc.attr, str);</td></tr>
<tr><th id="2876">2876</th><td>}</td></tr>
<tr><th id="2877">2877</th><td>__setup(<q>"fail_page_alloc="</q>, setup_fail_page_alloc);</td></tr>
<tr><th id="2878">2878</th><td></td></tr>
<tr><th id="2879">2879</th><td><em>static</em> bool should_fail_alloc_page(gfp_t gfp_mask, <em>unsigned</em> <em>int</em> order)</td></tr>
<tr><th id="2880">2880</th><td>{</td></tr>
<tr><th id="2881">2881</th><td>	<b>if</b> (order &lt; fail_page_alloc.min_order)</td></tr>
<tr><th id="2882">2882</th><td>		<b>return</b> false;</td></tr>
<tr><th id="2883">2883</th><td>	<b>if</b> (gfp_mask &amp; __GFP_NOFAIL)</td></tr>
<tr><th id="2884">2884</th><td>		<b>return</b> false;</td></tr>
<tr><th id="2885">2885</th><td>	<b>if</b> (fail_page_alloc.ignore_gfp_highmem &amp;&amp; (gfp_mask &amp; __GFP_HIGHMEM))</td></tr>
<tr><th id="2886">2886</th><td>		<b>return</b> false;</td></tr>
<tr><th id="2887">2887</th><td>	<b>if</b> (fail_page_alloc.ignore_gfp_reclaim &amp;&amp;</td></tr>
<tr><th id="2888">2888</th><td>			(gfp_mask &amp; __GFP_DIRECT_RECLAIM))</td></tr>
<tr><th id="2889">2889</th><td>		<b>return</b> false;</td></tr>
<tr><th id="2890">2890</th><td></td></tr>
<tr><th id="2891">2891</th><td>	<b>return</b> should_fail(&amp;fail_page_alloc.attr, <var>1</var> &lt;&lt; order);</td></tr>
<tr><th id="2892">2892</th><td>}</td></tr>
<tr><th id="2893">2893</th><td></td></tr>
<tr><th id="2894">2894</th><td><u>#ifdef CONFIG_FAULT_INJECTION_DEBUG_FS</u></td></tr>
<tr><th id="2895">2895</th><td></td></tr>
<tr><th id="2896">2896</th><td><em>static</em> <em>int</em> __init fail_page_alloc_debugfs(<em>void</em>)</td></tr>
<tr><th id="2897">2897</th><td>{</td></tr>
<tr><th id="2898">2898</th><td>	umode_t mode = S_IFREG | S_IRUSR | S_IWUSR;</td></tr>
<tr><th id="2899">2899</th><td>	<b>struct</b> dentry *dir;</td></tr>
<tr><th id="2900">2900</th><td></td></tr>
<tr><th id="2901">2901</th><td>	dir = fault_create_debugfs_attr(<q>"fail_page_alloc"</q>, NULL,</td></tr>
<tr><th id="2902">2902</th><td>					&amp;fail_page_alloc.attr);</td></tr>
<tr><th id="2903">2903</th><td>	<b>if</b> (IS_ERR(dir))</td></tr>
<tr><th id="2904">2904</th><td>		<b>return</b> PTR_ERR(dir);</td></tr>
<tr><th id="2905">2905</th><td></td></tr>
<tr><th id="2906">2906</th><td>	<b>if</b> (!debugfs_create_bool(<q>"ignore-gfp-wait"</q>, mode, dir,</td></tr>
<tr><th id="2907">2907</th><td>				&amp;fail_page_alloc.ignore_gfp_reclaim))</td></tr>
<tr><th id="2908">2908</th><td>		<b>goto</b> fail;</td></tr>
<tr><th id="2909">2909</th><td>	<b>if</b> (!debugfs_create_bool(<q>"ignore-gfp-highmem"</q>, mode, dir,</td></tr>
<tr><th id="2910">2910</th><td>				&amp;fail_page_alloc.ignore_gfp_highmem))</td></tr>
<tr><th id="2911">2911</th><td>		<b>goto</b> fail;</td></tr>
<tr><th id="2912">2912</th><td>	<b>if</b> (!debugfs_create_u32(<q>"min-order"</q>, mode, dir,</td></tr>
<tr><th id="2913">2913</th><td>				&amp;fail_page_alloc.min_order))</td></tr>
<tr><th id="2914">2914</th><td>		<b>goto</b> fail;</td></tr>
<tr><th id="2915">2915</th><td></td></tr>
<tr><th id="2916">2916</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2917">2917</th><td>fail:</td></tr>
<tr><th id="2918">2918</th><td>	debugfs_remove_recursive(dir);</td></tr>
<tr><th id="2919">2919</th><td></td></tr>
<tr><th id="2920">2920</th><td>	<b>return</b> -ENOMEM;</td></tr>
<tr><th id="2921">2921</th><td>}</td></tr>
<tr><th id="2922">2922</th><td></td></tr>
<tr><th id="2923">2923</th><td>late_initcall(fail_page_alloc_debugfs);</td></tr>
<tr><th id="2924">2924</th><td></td></tr>
<tr><th id="2925">2925</th><td><u>#endif /* CONFIG_FAULT_INJECTION_DEBUG_FS */</u></td></tr>
<tr><th id="2926">2926</th><td></td></tr>
<tr><th id="2927">2927</th><td><u>#<span data-ppcond="2858">else</span> /* CONFIG_FAIL_PAGE_ALLOC */</u></td></tr>
<tr><th id="2928">2928</th><td></td></tr>
<tr><th id="2929">2929</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="should_fail_alloc_page" title='should_fail_alloc_page' data-type='bool should_fail_alloc_page(gfp_t gfp_mask, unsigned int order)' data-ref="should_fail_alloc_page">should_fail_alloc_page</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col4 decl" id="704gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="704gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="705order" title='order' data-type='unsigned int' data-ref="705order">order</dfn>)</td></tr>
<tr><th id="2930">2930</th><td>{</td></tr>
<tr><th id="2931">2931</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="2932">2932</th><td>}</td></tr>
<tr><th id="2933">2933</th><td></td></tr>
<tr><th id="2934">2934</th><td><u>#<span data-ppcond="2858">endif</span> /* CONFIG_FAIL_PAGE_ALLOC */</u></td></tr>
<tr><th id="2935">2935</th><td></td></tr>
<tr><th id="2936">2936</th><td><i>/*</i></td></tr>
<tr><th id="2937">2937</th><td><i> * Return true if free base pages are above 'mark'. For high-order checks it</i></td></tr>
<tr><th id="2938">2938</th><td><i> * will return true of the order-0 watermark is reached and there is at least</i></td></tr>
<tr><th id="2939">2939</th><td><i> * one free page of a suitable size. Checking now avoids taking the zone lock</i></td></tr>
<tr><th id="2940">2940</th><td><i> * to check in the allocation paths if no pages are free.</i></td></tr>
<tr><th id="2941">2941</th><td><i> */</i></td></tr>
<tr><th id="2942">2942</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="__zone_watermark_ok" title='__zone_watermark_ok' data-ref="__zone_watermark_ok">__zone_watermark_ok</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="706z" title='z' data-type='struct zone *' data-ref="706z">z</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="707order" title='order' data-type='unsigned int' data-ref="707order">order</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="708mark" title='mark' data-type='unsigned long' data-ref="708mark">mark</dfn>,</td></tr>
<tr><th id="2943">2943</th><td>			 <em>int</em> <dfn class="local col9 decl" id="709classzone_idx" title='classzone_idx' data-type='int' data-ref="709classzone_idx">classzone_idx</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="710alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="710alloc_flags">alloc_flags</dfn>,</td></tr>
<tr><th id="2944">2944</th><td>			 <em>long</em> <dfn class="local col1 decl" id="711free_pages" title='free_pages' data-type='long' data-ref="711free_pages">free_pages</dfn>)</td></tr>
<tr><th id="2945">2945</th><td>{</td></tr>
<tr><th id="2946">2946</th><td>	<em>long</em> <dfn class="local col2 decl" id="712min" title='min' data-type='long' data-ref="712min">min</dfn> = <a class="local col8 ref" href="#708mark" title='mark' data-ref="708mark">mark</a>;</td></tr>
<tr><th id="2947">2947</th><td>	<em>int</em> <dfn class="local col3 decl" id="713o" title='o' data-type='int' data-ref="713o">o</dfn>;</td></tr>
<tr><th id="2948">2948</th><td>	<em>const</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col4 decl" id="714alloc_harder" title='alloc_harder' data-type='const bool' data-ref="714alloc_harder">alloc_harder</dfn> = (<a class="local col0 ref" href="#710alloc_flags" title='alloc_flags' data-ref="710alloc_flags">alloc_flags</a> &amp; (<a class="macro" href="internal.h.html#494" title="0x10" data-ref="_M/ALLOC_HARDER">ALLOC_HARDER</a>|<a class="macro" href="internal.h.html#489" title="0x08" data-ref="_M/ALLOC_OOM">ALLOC_OOM</a>));</td></tr>
<tr><th id="2949">2949</th><td></td></tr>
<tr><th id="2950">2950</th><td>	<i>/* free_pages may go negative - that's OK */</i></td></tr>
<tr><th id="2951">2951</th><td>	<a class="local col1 ref" href="#711free_pages" title='free_pages' data-ref="711free_pages">free_pages</a> -= (<var>1</var> &lt;&lt; <a class="local col7 ref" href="#707order" title='order' data-ref="707order">order</a>) - <var>1</var>;</td></tr>
<tr><th id="2952">2952</th><td></td></tr>
<tr><th id="2953">2953</th><td>	<b>if</b> (<a class="local col0 ref" href="#710alloc_flags" title='alloc_flags' data-ref="710alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#495" title="0x20" data-ref="_M/ALLOC_HIGH">ALLOC_HIGH</a>)</td></tr>
<tr><th id="2954">2954</th><td>		<a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> -= <a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> / <var>2</var>;</td></tr>
<tr><th id="2955">2955</th><td></td></tr>
<tr><th id="2956">2956</th><td>	<i>/*</i></td></tr>
<tr><th id="2957">2957</th><td><i>	 * If the caller does not have rights to ALLOC_HARDER then subtract</i></td></tr>
<tr><th id="2958">2958</th><td><i>	 * the high-atomic reserves. This will over-estimate the size of the</i></td></tr>
<tr><th id="2959">2959</th><td><i>	 * atomic reserve but it avoids a search.</i></td></tr>
<tr><th id="2960">2960</th><td><i>	 */</i></td></tr>
<tr><th id="2961">2961</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(!alloc_harder), 1)" data-ref="_M/likely">likely</a>(!<a class="local col4 ref" href="#714alloc_harder" title='alloc_harder' data-ref="714alloc_harder">alloc_harder</a>)) {</td></tr>
<tr><th id="2962">2962</th><td>		<a class="local col1 ref" href="#711free_pages" title='free_pages' data-ref="711free_pages">free_pages</a> -= <a class="local col6 ref" href="#706z" title='z' data-ref="706z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::nr_reserved_highatomic" title='zone::nr_reserved_highatomic' data-ref="zone::nr_reserved_highatomic">nr_reserved_highatomic</a>;</td></tr>
<tr><th id="2963">2963</th><td>	} <b>else</b> {</td></tr>
<tr><th id="2964">2964</th><td>		<i>/*</i></td></tr>
<tr><th id="2965">2965</th><td><i>		 * OOM victims can try even harder than normal ALLOC_HARDER</i></td></tr>
<tr><th id="2966">2966</th><td><i>		 * users on the grounds that it's definitely going to be in</i></td></tr>
<tr><th id="2967">2967</th><td><i>		 * the exit path shortly and free memory. Any allocation it</i></td></tr>
<tr><th id="2968">2968</th><td><i>		 * makes during the free path will be small and short-lived.</i></td></tr>
<tr><th id="2969">2969</th><td><i>		 */</i></td></tr>
<tr><th id="2970">2970</th><td>		<b>if</b> (<a class="local col0 ref" href="#710alloc_flags" title='alloc_flags' data-ref="710alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#489" title="0x08" data-ref="_M/ALLOC_OOM">ALLOC_OOM</a>)</td></tr>
<tr><th id="2971">2971</th><td>			<a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> -= <a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> / <var>2</var>;</td></tr>
<tr><th id="2972">2972</th><td>		<b>else</b></td></tr>
<tr><th id="2973">2973</th><td>			<a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> -= <a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> / <var>4</var>;</td></tr>
<tr><th id="2974">2974</th><td>	}</td></tr>
<tr><th id="2975">2975</th><td></td></tr>
<tr><th id="2976">2976</th><td></td></tr>
<tr><th id="2977">2977</th><td><u>#<span data-ppcond="2977">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="2978">2978</th><td>	<i>/* If allocation can't use CMA areas don't use free CMA pages */</i></td></tr>
<tr><th id="2979">2979</th><td>	<b>if</b> (!(alloc_flags &amp; ALLOC_CMA))</td></tr>
<tr><th id="2980">2980</th><td>		free_pages -= zone_page_state(z, NR_FREE_CMA_PAGES);</td></tr>
<tr><th id="2981">2981</th><td><u>#<span data-ppcond="2977">endif</span></u></td></tr>
<tr><th id="2982">2982</th><td></td></tr>
<tr><th id="2983">2983</th><td>	<i>/*</i></td></tr>
<tr><th id="2984">2984</th><td><i>	 * Check watermarks for an order-0 allocation request. If these</i></td></tr>
<tr><th id="2985">2985</th><td><i>	 * are not met, then a high-order request also cannot go ahead</i></td></tr>
<tr><th id="2986">2986</th><td><i>	 * even if a suitable page happened to be free.</i></td></tr>
<tr><th id="2987">2987</th><td><i>	 */</i></td></tr>
<tr><th id="2988">2988</th><td>	<b>if</b> (<a class="local col1 ref" href="#711free_pages" title='free_pages' data-ref="711free_pages">free_pages</a> &lt;= <a class="local col2 ref" href="#712min" title='min' data-ref="712min">min</a> + <a class="local col6 ref" href="#706z" title='z' data-ref="706z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col9 ref" href="#709classzone_idx" title='classzone_idx' data-ref="709classzone_idx">classzone_idx</a>])</td></tr>
<tr><th id="2989">2989</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="2990">2990</th><td></td></tr>
<tr><th id="2991">2991</th><td>	<i>/* If this is an order-0 request then the watermark is fine */</i></td></tr>
<tr><th id="2992">2992</th><td>	<b>if</b> (!<a class="local col7 ref" href="#707order" title='order' data-ref="707order">order</a>)</td></tr>
<tr><th id="2993">2993</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="2994">2994</th><td></td></tr>
<tr><th id="2995">2995</th><td>	<i>/* For a high-order request, check at least one suitable page is free */</i></td></tr>
<tr><th id="2996">2996</th><td>	<b>for</b> (<a class="local col3 ref" href="#713o" title='o' data-ref="713o">o</a> = <a class="local col7 ref" href="#707order" title='order' data-ref="707order">order</a>; <a class="local col3 ref" href="#713o" title='o' data-ref="713o">o</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>; <a class="local col3 ref" href="#713o" title='o' data-ref="713o">o</a>++) {</td></tr>
<tr><th id="2997">2997</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col5 decl" id="715area" title='area' data-type='struct free_area *' data-ref="715area">area</dfn> = &amp;<a class="local col6 ref" href="#706z" title='z' data-ref="706z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col3 ref" href="#713o" title='o' data-ref="713o">o</a>];</td></tr>
<tr><th id="2998">2998</th><td>		<em>int</em> <dfn class="local col6 decl" id="716mt" title='mt' data-type='int' data-ref="716mt">mt</dfn>;</td></tr>
<tr><th id="2999">2999</th><td></td></tr>
<tr><th id="3000">3000</th><td>		<b>if</b> (!<a class="local col5 ref" href="#715area" title='area' data-ref="715area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>)</td></tr>
<tr><th id="3001">3001</th><td>			<b>continue</b>;</td></tr>
<tr><th id="3002">3002</th><td></td></tr>
<tr><th id="3003">3003</th><td>		<b>for</b> (<a class="local col6 ref" href="#716mt" title='mt' data-ref="716mt">mt</a> = <var>0</var>; <a class="local col6 ref" href="#716mt" title='mt' data-ref="716mt">mt</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_PCPTYPES" title='MIGRATE_PCPTYPES' data-ref="MIGRATE_PCPTYPES">MIGRATE_PCPTYPES</a>; <a class="local col6 ref" href="#716mt" title='mt' data-ref="716mt">mt</a>++) {</td></tr>
<tr><th id="3004">3004</th><td>			<b>if</b> (!<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(&amp;<a class="local col5 ref" href="#715area" title='area' data-ref="715area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col6 ref" href="#716mt" title='mt' data-ref="716mt">mt</a>]))</td></tr>
<tr><th id="3005">3005</th><td>				<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3006">3006</th><td>		}</td></tr>
<tr><th id="3007">3007</th><td></td></tr>
<tr><th id="3008">3008</th><td><u>#<span data-ppcond="3008">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="3009">3009</th><td>		<b>if</b> ((alloc_flags &amp; ALLOC_CMA) &amp;&amp;</td></tr>
<tr><th id="3010">3010</th><td>		    !list_empty(&amp;area-&gt;free_list[MIGRATE_CMA])) {</td></tr>
<tr><th id="3011">3011</th><td>			<b>return</b> true;</td></tr>
<tr><th id="3012">3012</th><td>		}</td></tr>
<tr><th id="3013">3013</th><td><u>#<span data-ppcond="3008">endif</span></u></td></tr>
<tr><th id="3014">3014</th><td>		<b>if</b> (<a class="local col4 ref" href="#714alloc_harder" title='alloc_harder' data-ref="714alloc_harder">alloc_harder</a> &amp;&amp;</td></tr>
<tr><th id="3015">3015</th><td>			!<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(&amp;<a class="local col5 ref" href="#715area" title='area' data-ref="715area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_HIGHATOMIC" title='MIGRATE_HIGHATOMIC' data-ref="MIGRATE_HIGHATOMIC">MIGRATE_HIGHATOMIC</a>]))</td></tr>
<tr><th id="3016">3016</th><td>			<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3017">3017</th><td>	}</td></tr>
<tr><th id="3018">3018</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3019">3019</th><td>}</td></tr>
<tr><th id="3020">3020</th><td></td></tr>
<tr><th id="3021">3021</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="zone_watermark_ok" title='zone_watermark_ok' data-ref="zone_watermark_ok">zone_watermark_ok</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="717z" title='z' data-type='struct zone *' data-ref="717z">z</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="718order" title='order' data-type='unsigned int' data-ref="718order">order</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="719mark" title='mark' data-type='unsigned long' data-ref="719mark">mark</dfn>,</td></tr>
<tr><th id="3022">3022</th><td>		      <em>int</em> <dfn class="local col0 decl" id="720classzone_idx" title='classzone_idx' data-type='int' data-ref="720classzone_idx">classzone_idx</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="721alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="721alloc_flags">alloc_flags</dfn>)</td></tr>
<tr><th id="3023">3023</th><td>{</td></tr>
<tr><th id="3024">3024</th><td>	<b>return</b> <a class="ref fn" href="#__zone_watermark_ok" title='__zone_watermark_ok' data-ref="__zone_watermark_ok">__zone_watermark_ok</a>(<a class="local col7 ref" href="#717z" title='z' data-ref="717z">z</a>, <a class="local col8 ref" href="#718order" title='order' data-ref="718order">order</a>, <a class="local col9 ref" href="#719mark" title='mark' data-ref="719mark">mark</a>, <a class="local col0 ref" href="#720classzone_idx" title='classzone_idx' data-ref="720classzone_idx">classzone_idx</a>, <a class="local col1 ref" href="#721alloc_flags" title='alloc_flags' data-ref="721alloc_flags">alloc_flags</a>,</td></tr>
<tr><th id="3025">3025</th><td>					<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col7 ref" href="#717z" title='z' data-ref="717z">z</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>));</td></tr>
<tr><th id="3026">3026</th><td>}</td></tr>
<tr><th id="3027">3027</th><td></td></tr>
<tr><th id="3028">3028</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="zone_watermark_fast" title='zone_watermark_fast' data-type='bool zone_watermark_fast(struct zone * z, unsigned int order, unsigned long mark, int classzone_idx, unsigned int alloc_flags)' data-ref="zone_watermark_fast">zone_watermark_fast</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="722z" title='z' data-type='struct zone *' data-ref="722z">z</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="723order" title='order' data-type='unsigned int' data-ref="723order">order</dfn>,</td></tr>
<tr><th id="3029">3029</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="724mark" title='mark' data-type='unsigned long' data-ref="724mark">mark</dfn>, <em>int</em> <dfn class="local col5 decl" id="725classzone_idx" title='classzone_idx' data-type='int' data-ref="725classzone_idx">classzone_idx</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="726alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="726alloc_flags">alloc_flags</dfn>)</td></tr>
<tr><th id="3030">3030</th><td>{</td></tr>
<tr><th id="3031">3031</th><td>	<em>long</em> <dfn class="local col7 decl" id="727free_pages" title='free_pages' data-type='long' data-ref="727free_pages">free_pages</dfn> = <a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#722z" title='z' data-ref="722z">z</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>);</td></tr>
<tr><th id="3032">3032</th><td>	<em>long</em> <dfn class="local col8 decl" id="728cma_pages" title='cma_pages' data-type='long' data-ref="728cma_pages">cma_pages</dfn> = <var>0</var>;</td></tr>
<tr><th id="3033">3033</th><td></td></tr>
<tr><th id="3034">3034</th><td><u>#<span data-ppcond="3034">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="3035">3035</th><td>	<i>/* If allocation can't use CMA areas don't use free CMA pages */</i></td></tr>
<tr><th id="3036">3036</th><td>	<b>if</b> (!(alloc_flags &amp; ALLOC_CMA))</td></tr>
<tr><th id="3037">3037</th><td>		cma_pages = zone_page_state(z, NR_FREE_CMA_PAGES);</td></tr>
<tr><th id="3038">3038</th><td><u>#<span data-ppcond="3034">endif</span></u></td></tr>
<tr><th id="3039">3039</th><td></td></tr>
<tr><th id="3040">3040</th><td>	<i>/*</i></td></tr>
<tr><th id="3041">3041</th><td><i>	 * Fast check for order-0 only. If this fails then the reserves</i></td></tr>
<tr><th id="3042">3042</th><td><i>	 * need to be calculated. There is a corner case where the check</i></td></tr>
<tr><th id="3043">3043</th><td><i>	 * passes but only the high-order atomic reserve are free. If</i></td></tr>
<tr><th id="3044">3044</th><td><i>	 * the caller is !atomic then it'll uselessly search the free</i></td></tr>
<tr><th id="3045">3045</th><td><i>	 * list. That corner case is then slower but it is harmless.</i></td></tr>
<tr><th id="3046">3046</th><td><i>	 */</i></td></tr>
<tr><th id="3047">3047</th><td>	<b>if</b> (!<a class="local col3 ref" href="#723order" title='order' data-ref="723order">order</a> &amp;&amp; (<a class="local col7 ref" href="#727free_pages" title='free_pages' data-ref="727free_pages">free_pages</a> - <a class="local col8 ref" href="#728cma_pages" title='cma_pages' data-ref="728cma_pages">cma_pages</a>) &gt; <a class="local col4 ref" href="#724mark" title='mark' data-ref="724mark">mark</a> + <a class="local col2 ref" href="#722z" title='z' data-ref="722z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col5 ref" href="#725classzone_idx" title='classzone_idx' data-ref="725classzone_idx">classzone_idx</a>])</td></tr>
<tr><th id="3048">3048</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3049">3049</th><td></td></tr>
<tr><th id="3050">3050</th><td>	<b>return</b> <a class="ref fn" href="#__zone_watermark_ok" title='__zone_watermark_ok' data-ref="__zone_watermark_ok">__zone_watermark_ok</a>(<a class="local col2 ref" href="#722z" title='z' data-ref="722z">z</a>, <a class="local col3 ref" href="#723order" title='order' data-ref="723order">order</a>, <a class="local col4 ref" href="#724mark" title='mark' data-ref="724mark">mark</a>, <a class="local col5 ref" href="#725classzone_idx" title='classzone_idx' data-ref="725classzone_idx">classzone_idx</a>, <a class="local col6 ref" href="#726alloc_flags" title='alloc_flags' data-ref="726alloc_flags">alloc_flags</a>,</td></tr>
<tr><th id="3051">3051</th><td>					<a class="local col7 ref" href="#727free_pages" title='free_pages' data-ref="727free_pages">free_pages</a>);</td></tr>
<tr><th id="3052">3052</th><td>}</td></tr>
<tr><th id="3053">3053</th><td></td></tr>
<tr><th id="3054">3054</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="zone_watermark_ok_safe" title='zone_watermark_ok_safe' data-ref="zone_watermark_ok_safe">zone_watermark_ok_safe</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col9 decl" id="729z" title='z' data-type='struct zone *' data-ref="729z">z</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="730order" title='order' data-type='unsigned int' data-ref="730order">order</dfn>,</td></tr>
<tr><th id="3055">3055</th><td>			<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="731mark" title='mark' data-type='unsigned long' data-ref="731mark">mark</dfn>, <em>int</em> <dfn class="local col2 decl" id="732classzone_idx" title='classzone_idx' data-type='int' data-ref="732classzone_idx">classzone_idx</dfn>)</td></tr>
<tr><th id="3056">3056</th><td>{</td></tr>
<tr><th id="3057">3057</th><td>	<em>long</em> <dfn class="local col3 decl" id="733free_pages" title='free_pages' data-type='long' data-ref="733free_pages">free_pages</dfn> = <a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col9 ref" href="#729z" title='z' data-ref="729z">z</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>);</td></tr>
<tr><th id="3058">3058</th><td></td></tr>
<tr><th id="3059">3059</th><td>	<b>if</b> (<a class="local col9 ref" href="#729z" title='z' data-ref="729z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::percpu_drift_mark" title='zone::percpu_drift_mark' data-ref="zone::percpu_drift_mark">percpu_drift_mark</a> &amp;&amp; <a class="local col3 ref" href="#733free_pages" title='free_pages' data-ref="733free_pages">free_pages</a> &lt; <a class="local col9 ref" href="#729z" title='z' data-ref="729z">z</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::percpu_drift_mark" title='zone::percpu_drift_mark' data-ref="zone::percpu_drift_mark">percpu_drift_mark</a>)</td></tr>
<tr><th id="3060">3060</th><td>		<a class="local col3 ref" href="#733free_pages" title='free_pages' data-ref="733free_pages">free_pages</a> = <a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state_snapshot" title='zone_page_state_snapshot' data-ref="zone_page_state_snapshot">zone_page_state_snapshot</a>(<a class="local col9 ref" href="#729z" title='z' data-ref="729z">z</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>);</td></tr>
<tr><th id="3061">3061</th><td></td></tr>
<tr><th id="3062">3062</th><td>	<b>return</b> <a class="ref fn" href="#__zone_watermark_ok" title='__zone_watermark_ok' data-ref="__zone_watermark_ok">__zone_watermark_ok</a>(<a class="local col9 ref" href="#729z" title='z' data-ref="729z">z</a>, <a class="local col0 ref" href="#730order" title='order' data-ref="730order">order</a>, <a class="local col1 ref" href="#731mark" title='mark' data-ref="731mark">mark</a>, <a class="local col2 ref" href="#732classzone_idx" title='classzone_idx' data-ref="732classzone_idx">classzone_idx</a>, <var>0</var>,</td></tr>
<tr><th id="3063">3063</th><td>								<a class="local col3 ref" href="#733free_pages" title='free_pages' data-ref="733free_pages">free_pages</a>);</td></tr>
<tr><th id="3064">3064</th><td>}</td></tr>
<tr><th id="3065">3065</th><td></td></tr>
<tr><th id="3066">3066</th><td><u>#<span data-ppcond="3066">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="3067">3067</th><td><em>static</em> bool zone_allows_reclaim(<b>struct</b> zone *local_zone, <b>struct</b> zone *zone)</td></tr>
<tr><th id="3068">3068</th><td>{</td></tr>
<tr><th id="3069">3069</th><td>	<b>return</b> node_distance(zone_to_nid(local_zone), zone_to_nid(zone)) &lt;=</td></tr>
<tr><th id="3070">3070</th><td>				RECLAIM_DISTANCE;</td></tr>
<tr><th id="3071">3071</th><td>}</td></tr>
<tr><th id="3072">3072</th><td><u>#<span data-ppcond="3066">else</span>	/* CONFIG_NUMA */</u></td></tr>
<tr><th id="3073">3073</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="zone_allows_reclaim" title='zone_allows_reclaim' data-type='bool zone_allows_reclaim(struct zone * local_zone, struct zone * zone)' data-ref="zone_allows_reclaim">zone_allows_reclaim</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="734local_zone" title='local_zone' data-type='struct zone *' data-ref="734local_zone">local_zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col5 decl" id="735zone" title='zone' data-type='struct zone *' data-ref="735zone">zone</dfn>)</td></tr>
<tr><th id="3074">3074</th><td>{</td></tr>
<tr><th id="3075">3075</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3076">3076</th><td>}</td></tr>
<tr><th id="3077">3077</th><td><u>#<span data-ppcond="3066">endif</span>	/* CONFIG_NUMA */</u></td></tr>
<tr><th id="3078">3078</th><td></td></tr>
<tr><th id="3079">3079</th><td><i  data-doc="get_page_from_freelist">/*</i></td></tr>
<tr><th id="3080">3080</th><td><i  data-doc="get_page_from_freelist"> * get_page_from_freelist goes through the zonelist trying to allocate</i></td></tr>
<tr><th id="3081">3081</th><td><i  data-doc="get_page_from_freelist"> * a page.</i></td></tr>
<tr><th id="3082">3082</th><td><i  data-doc="get_page_from_freelist"> */</i></td></tr>
<tr><th id="3083">3083</th><td><em>static</em> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="3084">3084</th><td><dfn class="tu decl def fn" id="get_page_from_freelist" title='get_page_from_freelist' data-type='struct page * get_page_from_freelist(gfp_t gfp_mask, unsigned int order, int alloc_flags, const struct alloc_context * ac)' data-ref="get_page_from_freelist">get_page_from_freelist</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col6 decl" id="736gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="736gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="737order" title='order' data-type='unsigned int' data-ref="737order">order</dfn>, <em>int</em> <dfn class="local col8 decl" id="738alloc_flags" title='alloc_flags' data-type='int' data-ref="738alloc_flags">alloc_flags</dfn>,</td></tr>
<tr><th id="3085">3085</th><td>						<em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col9 decl" id="739ac" title='ac' data-type='const struct alloc_context *' data-ref="739ac">ac</dfn>)</td></tr>
<tr><th id="3086">3086</th><td>{</td></tr>
<tr><th id="3087">3087</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col0 decl" id="740z" title='z' data-type='struct zoneref *' data-ref="740z">z</dfn> = <a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a>;</td></tr>
<tr><th id="3088">3088</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="741zone" title='zone' data-type='struct zone *' data-ref="741zone">zone</dfn>;</td></tr>
<tr><th id="3089">3089</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col2 decl" id="742last_pgdat_dirty_limit" title='last_pgdat_dirty_limit' data-type='struct pglist_data *' data-ref="742last_pgdat_dirty_limit">last_pgdat_dirty_limit</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3090">3090</th><td></td></tr>
<tr><th id="3091">3091</th><td>	<i>/*</i></td></tr>
<tr><th id="3092">3092</th><td><i>	 * Scan zonelist, looking for a zone with enough free.</i></td></tr>
<tr><th id="3093">3093</th><td><i>	 * See also __cpuset_node_allowed() comment in kernel/cpuset.c.</i></td></tr>
<tr><th id="3094">3094</th><td><i>	 */</i></td></tr>
<tr><th id="3095">3095</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#1040" title="for (zone = z-&gt;zone; zone; z = next_zones_zonelist(++z, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z))" data-ref="_M/for_next_zone_zonelist_nodemask">for_next_zone_zonelist_nodemask</a>(<a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone"><a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone" title='zoneref::zone' data-ref="zoneref::zone">zone</a></a>, <a class="local col0 ref" href="#740z" title='z' data-ref="740z">z</a>, ac-&gt;zonelist, <a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>,</td></tr>
<tr><th id="3096">3096</th><td>								<a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>) {</td></tr>
<tr><th id="3097">3097</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="743page" title='page' data-type='struct page *' data-ref="743page">page</dfn>;</td></tr>
<tr><th id="3098">3098</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="744mark" title='mark' data-type='unsigned long' data-ref="744mark">mark</dfn>;</td></tr>
<tr><th id="3099">3099</th><td></td></tr>
<tr><th id="3100">3100</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/cpuset.h.html#cpusets_enabled" title='cpusets_enabled' data-ref="cpusets_enabled">cpusets_enabled</a>() &amp;&amp;</td></tr>
<tr><th id="3101">3101</th><td>			(<a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>) &amp;&amp;</td></tr>
<tr><th id="3102">3102</th><td>			!<a class="ref fn" href="../include/linux/cpuset.h.html#__cpuset_zone_allowed" title='__cpuset_zone_allowed' data-ref="__cpuset_zone_allowed">__cpuset_zone_allowed</a>(<a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>, <a class="local col6 ref" href="#736gfp_mask" title='gfp_mask' data-ref="736gfp_mask">gfp_mask</a>))</td></tr>
<tr><th id="3103">3103</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3104">3104</th><td>		<i>/*</i></td></tr>
<tr><th id="3105">3105</th><td><i>		 * When allocating a page cache page for writing, we</i></td></tr>
<tr><th id="3106">3106</th><td><i>		 * want to get it from a node that is within its dirty</i></td></tr>
<tr><th id="3107">3107</th><td><i>		 * limit, such that no single node holds more than its</i></td></tr>
<tr><th id="3108">3108</th><td><i>		 * proportional share of globally allowed dirty pages.</i></td></tr>
<tr><th id="3109">3109</th><td><i>		 * The dirty limits take into account the node's</i></td></tr>
<tr><th id="3110">3110</th><td><i>		 * lowmem reserves and high watermark so that kswapd</i></td></tr>
<tr><th id="3111">3111</th><td><i>		 * should be able to balance it without having to</i></td></tr>
<tr><th id="3112">3112</th><td><i>		 * write pages from its LRU list.</i></td></tr>
<tr><th id="3113">3113</th><td><i>		 *</i></td></tr>
<tr><th id="3114">3114</th><td><i>		 * XXX: For now, allow allocations to potentially</i></td></tr>
<tr><th id="3115">3115</th><td><i>		 * exceed the per-node dirty limit in the slowpath</i></td></tr>
<tr><th id="3116">3116</th><td><i>		 * (spread_dirty_pages unset) before going into reclaim,</i></td></tr>
<tr><th id="3117">3117</th><td><i>		 * which is important when on a NUMA setup the allowed</i></td></tr>
<tr><th id="3118">3118</th><td><i>		 * nodes are together not big enough to reach the</i></td></tr>
<tr><th id="3119">3119</th><td><i>		 * global limit.  The proper fix for these situations</i></td></tr>
<tr><th id="3120">3120</th><td><i>		 * will require awareness of nodes in the</i></td></tr>
<tr><th id="3121">3121</th><td><i>		 * dirty-throttling and the flusher threads.</i></td></tr>
<tr><th id="3122">3122</th><td><i>		 */</i></td></tr>
<tr><th id="3123">3123</th><td>		<b>if</b> (<a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::spread_dirty_pages" title='alloc_context::spread_dirty_pages' data-ref="alloc_context::spread_dirty_pages">spread_dirty_pages</a>) {</td></tr>
<tr><th id="3124">3124</th><td>			<b>if</b> (<a class="local col2 ref" href="#742last_pgdat_dirty_limit" title='last_pgdat_dirty_limit' data-ref="742last_pgdat_dirty_limit">last_pgdat_dirty_limit</a> == <a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>)</td></tr>
<tr><th id="3125">3125</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3126">3126</th><td></td></tr>
<tr><th id="3127">3127</th><td>			<b>if</b> (!<a class="ref fn" href="../include/linux/writeback.h.html#node_dirty_ok" title='node_dirty_ok' data-ref="node_dirty_ok">node_dirty_ok</a>(<a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>)) {</td></tr>
<tr><th id="3128">3128</th><td>				<a class="local col2 ref" href="#742last_pgdat_dirty_limit" title='last_pgdat_dirty_limit' data-ref="742last_pgdat_dirty_limit">last_pgdat_dirty_limit</a> = <a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>;</td></tr>
<tr><th id="3129">3129</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3130">3130</th><td>			}</td></tr>
<tr><th id="3131">3131</th><td>		}</td></tr>
<tr><th id="3132">3132</th><td></td></tr>
<tr><th id="3133">3133</th><td>		<a class="local col4 ref" href="#744mark" title='mark' data-ref="744mark">mark</a> = <a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::watermark" title='zone::watermark' data-ref="zone::watermark">watermark</a>[<a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#481" title="(0x04-1)" data-ref="_M/ALLOC_WMARK_MASK">ALLOC_WMARK_MASK</a>];</td></tr>
<tr><th id="3134">3134</th><td>		<b>if</b> (!<a class="tu ref fn" href="#zone_watermark_fast" title='zone_watermark_fast' data-use='c' data-ref="zone_watermark_fast">zone_watermark_fast</a>(<a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>, <a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a>, <a class="local col4 ref" href="#744mark" title='mark' data-ref="744mark">mark</a>,</td></tr>
<tr><th id="3135">3135</th><td>				       <a class="macro" href="internal.h.html#126" title="zonelist_zone_idx(ac-&gt;preferred_zoneref)" data-ref="_M/ac_classzone_idx">ac_classzone_idx</a>(<a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>), <a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a>)) {</td></tr>
<tr><th id="3136">3136</th><td>			<em>int</em> <dfn class="local col5 decl" id="745ret" title='ret' data-type='int' data-ref="745ret">ret</dfn>;</td></tr>
<tr><th id="3137">3137</th><td></td></tr>
<tr><th id="3138">3138</th><td>			<i>/* Checked here to keep the fast path fast */</i></td></tr>
<tr><th id="3139">3139</th><td>			<a class="macro" href="../include/linux/build_bug.h.html#70" title="do { bool __cond = !(!(0x04 &lt; NR_WMARK)); extern void __compiletime_assert_3139(void) ; if (__cond) __compiletime_assert_3139(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0)" data-ref="_M/BUILD_BUG_ON">BUILD_BUG_ON</a>(<a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#NR_WMARK" title='NR_WMARK' data-ref="NR_WMARK">NR_WMARK</a>);</td></tr>
<tr><th id="3140">3140</th><td>			<b>if</b> (<a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a>)</td></tr>
<tr><th id="3141">3141</th><td>				<b>goto</b> <a class="lbl" href="#746try_this_zone" data-ref="746try_this_zone">try_this_zone</a>;</td></tr>
<tr><th id="3142">3142</th><td></td></tr>
<tr><th id="3143">3143</th><td>			<b>if</b> (<a class="macro" href="../include/linux/swap.h.html#359" title="0" data-ref="_M/node_reclaim_mode">node_reclaim_mode</a> == <var>0</var> ||</td></tr>
<tr><th id="3144">3144</th><td>			    !<a class="tu ref fn" href="#zone_allows_reclaim" title='zone_allows_reclaim' data-use='c' data-ref="zone_allows_reclaim">zone_allows_reclaim</a>(<a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone" title='zoneref::zone' data-ref="zoneref::zone">zone</a>, <a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>))</td></tr>
<tr><th id="3145">3145</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3146">3146</th><td></td></tr>
<tr><th id="3147">3147</th><td>			<a class="local col5 ref" href="#745ret" title='ret' data-ref="745ret">ret</a> = <a class="ref fn" href="../include/linux/swap.h.html#node_reclaim" title='node_reclaim' data-ref="node_reclaim">node_reclaim</a>(<a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>, <a class="local col6 ref" href="#736gfp_mask" title='gfp_mask' data-ref="736gfp_mask">gfp_mask</a>, <a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a>);</td></tr>
<tr><th id="3148">3148</th><td>			<b>switch</b> (<a class="local col5 ref" href="#745ret" title='ret' data-ref="745ret">ret</a>) {</td></tr>
<tr><th id="3149">3149</th><td>			<b>case</b> <a class="macro" href="internal.h.html#453" title="-2" data-ref="_M/NODE_RECLAIM_NOSCAN">NODE_RECLAIM_NOSCAN</a>:</td></tr>
<tr><th id="3150">3150</th><td>				<i>/* did not scan */</i></td></tr>
<tr><th id="3151">3151</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3152">3152</th><td>			<b>case</b> <a class="macro" href="internal.h.html#454" title="-1" data-ref="_M/NODE_RECLAIM_FULL">NODE_RECLAIM_FULL</a>:</td></tr>
<tr><th id="3153">3153</th><td>				<i>/* scanned but unreclaimable */</i></td></tr>
<tr><th id="3154">3154</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3155">3155</th><td>			<b>default</b>:</td></tr>
<tr><th id="3156">3156</th><td>				<i>/* did we reclaim enough */</i></td></tr>
<tr><th id="3157">3157</th><td>				<b>if</b> (<a class="ref fn" href="#zone_watermark_ok" title='zone_watermark_ok' data-ref="zone_watermark_ok">zone_watermark_ok</a>(<a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>, <a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a>, <a class="local col4 ref" href="#744mark" title='mark' data-ref="744mark">mark</a>,</td></tr>
<tr><th id="3158">3158</th><td>						<a class="macro" href="internal.h.html#126" title="zonelist_zone_idx(ac-&gt;preferred_zoneref)" data-ref="_M/ac_classzone_idx">ac_classzone_idx</a>(<a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>), <a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a>))</td></tr>
<tr><th id="3159">3159</th><td>					<b>goto</b> <a class="lbl" href="#746try_this_zone" data-ref="746try_this_zone">try_this_zone</a>;</td></tr>
<tr><th id="3160">3160</th><td></td></tr>
<tr><th id="3161">3161</th><td>				<b>continue</b>;</td></tr>
<tr><th id="3162">3162</th><td>			}</td></tr>
<tr><th id="3163">3163</th><td>		}</td></tr>
<tr><th id="3164">3164</th><td></td></tr>
<tr><th id="3165">3165</th><td><dfn class="lbl" id="746try_this_zone" data-ref="746try_this_zone">try_this_zone</dfn>:</td></tr>
<tr><th id="3166">3166</th><td>		<a class="local col3 ref" href="#743page" title='page' data-ref="743page">page</a> = <a class="tu ref fn" href="#rmqueue" title='rmqueue' data-use='c' data-ref="rmqueue">rmqueue</a>(<a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone" title='zoneref::zone' data-ref="zoneref::zone">zone</a>, <a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>, <a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a>,</td></tr>
<tr><th id="3167">3167</th><td>				<a class="local col6 ref" href="#736gfp_mask" title='gfp_mask' data-ref="736gfp_mask">gfp_mask</a>, <a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a>, <a class="local col9 ref" href="#739ac" title='ac' data-ref="739ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a>);</td></tr>
<tr><th id="3168">3168</th><td>		<b>if</b> (<a class="local col3 ref" href="#743page" title='page' data-ref="743page">page</a>) {</td></tr>
<tr><th id="3169">3169</th><td>			<a class="tu ref fn" href="#prep_new_page" title='prep_new_page' data-use='c' data-ref="prep_new_page">prep_new_page</a>(<a class="local col3 ref" href="#743page" title='page' data-ref="743page">page</a>, <a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a>, <a class="local col6 ref" href="#736gfp_mask" title='gfp_mask' data-ref="736gfp_mask">gfp_mask</a>, <a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a>);</td></tr>
<tr><th id="3170">3170</th><td></td></tr>
<tr><th id="3171">3171</th><td>			<i>/*</i></td></tr>
<tr><th id="3172">3172</th><td><i>			 * If this is a high-order atomic allocation then check</i></td></tr>
<tr><th id="3173">3173</th><td><i>			 * if the pageblock should be reserved for the future</i></td></tr>
<tr><th id="3174">3174</th><td><i>			 */</i></td></tr>
<tr><th id="3175">3175</th><td>			<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(order &amp;&amp; (alloc_flags &amp; 0x10)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a> &amp;&amp; (<a class="local col8 ref" href="#738alloc_flags" title='alloc_flags' data-ref="738alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#494" title="0x10" data-ref="_M/ALLOC_HARDER">ALLOC_HARDER</a>)))</td></tr>
<tr><th id="3176">3176</th><td>				<a class="tu ref fn" href="#reserve_highatomic_pageblock" title='reserve_highatomic_pageblock' data-use='c' data-ref="reserve_highatomic_pageblock">reserve_highatomic_pageblock</a>(<a class="local col3 ref" href="#743page" title='page' data-ref="743page">page</a>, <a class="local col1 ref" href="#741zone" title='zone' data-ref="741zone">zone</a>, <a class="local col7 ref" href="#737order" title='order' data-ref="737order">order</a>);</td></tr>
<tr><th id="3177">3177</th><td></td></tr>
<tr><th id="3178">3178</th><td>			<b>return</b> <a class="local col3 ref" href="#743page" title='page' data-ref="743page">page</a>;</td></tr>
<tr><th id="3179">3179</th><td>		}</td></tr>
<tr><th id="3180">3180</th><td>	}</td></tr>
<tr><th id="3181">3181</th><td></td></tr>
<tr><th id="3182">3182</th><td>	<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3183">3183</th><td>}</td></tr>
<tr><th id="3184">3184</th><td></td></tr>
<tr><th id="3185">3185</th><td><i  data-doc="should_suppress_show_mem">/*</i></td></tr>
<tr><th id="3186">3186</th><td><i  data-doc="should_suppress_show_mem"> * Large machines with many possible nodes should not always dump per-node</i></td></tr>
<tr><th id="3187">3187</th><td><i  data-doc="should_suppress_show_mem"> * meminfo in irq context.</i></td></tr>
<tr><th id="3188">3188</th><td><i  data-doc="should_suppress_show_mem"> */</i></td></tr>
<tr><th id="3189">3189</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="should_suppress_show_mem" title='should_suppress_show_mem' data-type='bool should_suppress_show_mem()' data-ref="should_suppress_show_mem">should_suppress_show_mem</dfn>(<em>void</em>)</td></tr>
<tr><th id="3190">3190</th><td>{</td></tr>
<tr><th id="3191">3191</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col7 decl" id="747ret" title='ret' data-type='bool' data-ref="747ret">ret</dfn> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3192">3192</th><td></td></tr>
<tr><th id="3193">3193</th><td><u>#<span data-ppcond="3193">if</span> <a class="macro" href="../include/linux/numa.h.html#9" title="0" data-ref="_M/NODES_SHIFT">NODES_SHIFT</a> &gt; 8</u></td></tr>
<tr><th id="3194">3194</th><td>	ret = in_interrupt();</td></tr>
<tr><th id="3195">3195</th><td><u>#<span data-ppcond="3193">endif</span></u></td></tr>
<tr><th id="3196">3196</th><td>	<b>return</b> <a class="local col7 ref" href="#747ret" title='ret' data-ref="747ret">ret</a>;</td></tr>
<tr><th id="3197">3197</th><td>}</td></tr>
<tr><th id="3198">3198</th><td></td></tr>
<tr><th id="3199">3199</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="warn_alloc_show_mem" title='warn_alloc_show_mem' data-type='void warn_alloc_show_mem(gfp_t gfp_mask, nodemask_t * nodemask)' data-ref="warn_alloc_show_mem">warn_alloc_show_mem</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col8 decl" id="748gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="748gfp_mask">gfp_mask</dfn>, <a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> *<dfn class="local col9 decl" id="749nodemask" title='nodemask' data-type='nodemask_t *' data-ref="749nodemask">nodemask</dfn>)</td></tr>
<tr><th id="3200">3200</th><td>{</td></tr>
<tr><th id="3201">3201</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="750filter" title='filter' data-type='unsigned int' data-ref="750filter">filter</dfn> = <a class="macro" href="../include/linux/mm.h.html#1222" title="(0x0001u)" data-ref="_M/SHOW_MEM_FILTER_NODES">SHOW_MEM_FILTER_NODES</a>;</td></tr>
<tr><th id="3202">3202</th><td>	<em>static</em> <a class="macro" href="../include/linux/ratelimit.h.html#35" title="struct ratelimit_state show_mem_rs = { .lock = (raw_spinlock_t) { .raw_lock = { { (0) } }, }, .interval = 100, .burst = 1, }" data-ref="_M/DEFINE_RATELIMIT_STATE">DEFINE_RATELIMIT_STATE</a>(<dfn class="local col1 decl" id="751show_mem_rs" title='show_mem_rs' data-type='struct ratelimit_state' data-ref="751show_mem_rs">show_mem_rs</dfn>, <a class="macro" href="../include/asm-generic/param.h.html#8" title="100" data-ref="_M/HZ">HZ</a>, <var>1</var>);</td></tr>
<tr><th id="3203">3203</th><td></td></tr>
<tr><th id="3204">3204</th><td>	<b>if</b> (<a class="tu ref fn" href="#should_suppress_show_mem" title='should_suppress_show_mem' data-use='c' data-ref="should_suppress_show_mem">should_suppress_show_mem</a>() || !<a class="macro" href="../include/linux/ratelimit.h.html#77" title="___ratelimit(&amp;show_mem_rs, __func__)" data-ref="_M/__ratelimit">__ratelimit</a>(&amp;<a class="local col1 ref" href="#3202" title='show_mem_rs' data-ref="751show_mem_rs">show_mem_rs</a>))</td></tr>
<tr><th id="3205">3205</th><td>		<b>return</b>;</td></tr>
<tr><th id="3206">3206</th><td></td></tr>
<tr><th id="3207">3207</th><td>	<i>/*</i></td></tr>
<tr><th id="3208">3208</th><td><i>	 * This documents exceptions given to allocations in certain</i></td></tr>
<tr><th id="3209">3209</th><td><i>	 * contexts that are allowed to allocate outside current's set</i></td></tr>
<tr><th id="3210">3210</th><td><i>	 * of allowed nodes.</i></td></tr>
<tr><th id="3211">3211</th><td><i>	 */</i></td></tr>
<tr><th id="3212">3212</th><td>	<b>if</b> (!(<a class="local col8 ref" href="#748gfp_mask" title='gfp_mask' data-ref="748gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#115" title="(( gfp_t)0x10000u)" data-ref="_M/__GFP_NOMEMALLOC">__GFP_NOMEMALLOC</a>))</td></tr>
<tr><th id="3213">3213</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/oom.h.html#tsk_is_oom_victim" title='tsk_is_oom_victim' data-ref="tsk_is_oom_victim">tsk_is_oom_victim</a>(<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>) ||</td></tr>
<tr><th id="3214">3214</th><td>		    (<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; (<a class="macro" href="../include/linux/sched.h.html#1345" title="0x00000800" data-ref="_M/PF_MEMALLOC">PF_MEMALLOC</a> | <a class="macro" href="../include/linux/sched.h.html#1336" title="0x00000004" data-ref="_M/PF_EXITING">PF_EXITING</a>)))</td></tr>
<tr><th id="3215">3215</th><td>			<a class="local col0 ref" href="#750filter" title='filter' data-ref="750filter">filter</a> &amp;= ~<a class="macro" href="../include/linux/mm.h.html#1222" title="(0x0001u)" data-ref="_M/SHOW_MEM_FILTER_NODES">SHOW_MEM_FILTER_NODES</a>;</td></tr>
<tr><th id="3216">3216</th><td>	<b>if</b> (<a class="macro" href="../include/linux/preempt.h.html#103" title="((preempt_count() &amp; ((((1UL &lt;&lt; (4))-1) &lt;&lt; ((0 + 8) + 8)) | (((1UL &lt;&lt; (8))-1) &lt;&lt; (0 + 8)) | (((1UL &lt;&lt; (1))-1) &lt;&lt; (((0 + 8) + 8) + 4)))))" data-ref="_M/in_interrupt">in_interrupt</a>() || !(<a class="local col8 ref" href="#748gfp_mask" title='gfp_mask' data-ref="748gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#185" title="(( gfp_t)0x400000u)" data-ref="_M/__GFP_DIRECT_RECLAIM">__GFP_DIRECT_RECLAIM</a>))</td></tr>
<tr><th id="3217">3217</th><td>		<a class="local col0 ref" href="#750filter" title='filter' data-ref="750filter">filter</a> &amp;= ~<a class="macro" href="../include/linux/mm.h.html#1222" title="(0x0001u)" data-ref="_M/SHOW_MEM_FILTER_NODES">SHOW_MEM_FILTER_NODES</a>;</td></tr>
<tr><th id="3218">3218</th><td></td></tr>
<tr><th id="3219">3219</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#show_mem" title='show_mem' data-ref="show_mem">show_mem</a>(<a class="local col0 ref" href="#750filter" title='filter' data-ref="750filter">filter</a>, <a class="local col9 ref" href="#749nodemask" title='nodemask' data-ref="749nodemask">nodemask</a>);</td></tr>
<tr><th id="3220">3220</th><td>}</td></tr>
<tr><th id="3221">3221</th><td></td></tr>
<tr><th id="3222">3222</th><td><em>void</em> <dfn class="decl def fn" id="warn_alloc" title='warn_alloc' data-ref="warn_alloc">warn_alloc</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col2 decl" id="752gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="752gfp_mask">gfp_mask</dfn>, <a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> *<dfn class="local col3 decl" id="753nodemask" title='nodemask' data-type='nodemask_t *' data-ref="753nodemask">nodemask</dfn>, <em>const</em> <em>char</em> *<dfn class="local col4 decl" id="754fmt" title='fmt' data-type='const char *' data-ref="754fmt">fmt</dfn>, ...)</td></tr>
<tr><th id="3223">3223</th><td>{</td></tr>
<tr><th id="3224">3224</th><td>	<b>struct</b> <a class="type" href="../include/linux/printk.h.html#va_format" title='va_format' data-ref="va_format">va_format</a> <dfn class="local col5 decl" id="755vaf" title='vaf' data-type='struct va_format' data-ref="755vaf">vaf</dfn>;</td></tr>
<tr><th id="3225">3225</th><td>	<span class='typedef' title='va_list' data-type='__gnuc_va_list' data-ref="va_list">va_list</span> <dfn class="local col6 decl" id="756args" title='args' data-type='va_list' data-ref="756args">args</dfn>;</td></tr>
<tr><th id="3226">3226</th><td>	<em>static</em> <a class="macro" href="../include/linux/ratelimit.h.html#35" title="struct ratelimit_state nopage_rs = { .lock = (raw_spinlock_t) { .raw_lock = { { (0) } }, }, .interval = (5 * 100), .burst = 10, }" data-ref="_M/DEFINE_RATELIMIT_STATE">DEFINE_RATELIMIT_STATE</a>(<dfn class="local col7 decl" id="757nopage_rs" title='nopage_rs' data-type='struct ratelimit_state' data-ref="757nopage_rs">nopage_rs</dfn>, <a class="macro" href="../include/linux/ratelimit.h.html#9" title="(5 * 100)" data-ref="_M/DEFAULT_RATELIMIT_INTERVAL">DEFAULT_RATELIMIT_INTERVAL</a>,</td></tr>
<tr><th id="3227">3227</th><td>				      <a class="macro" href="../include/linux/ratelimit.h.html#10" title="10" data-ref="_M/DEFAULT_RATELIMIT_BURST">DEFAULT_RATELIMIT_BURST</a>);</td></tr>
<tr><th id="3228">3228</th><td></td></tr>
<tr><th id="3229">3229</th><td>	<b>if</b> ((<a class="local col2 ref" href="#752gfp_mask" title='gfp_mask' data-ref="752gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#205" title="(( gfp_t)0x200u)" data-ref="_M/__GFP_NOWARN">__GFP_NOWARN</a>) || !<a class="macro" href="../include/linux/ratelimit.h.html#77" title="___ratelimit(&amp;nopage_rs, __func__)" data-ref="_M/__ratelimit">__ratelimit</a>(&amp;<a class="local col7 ref" href="#3226" title='nopage_rs' data-ref="757nopage_rs">nopage_rs</a>))</td></tr>
<tr><th id="3230">3230</th><td>		<b>return</b>;</td></tr>
<tr><th id="3231">3231</th><td></td></tr>
<tr><th id="3232">3232</th><td>	<a class="macro" href="../include/linux/printk.h.html#305" title="pr_warning" data-ref="_M/pr_warn">pr_warn</a>(<q>"%s: "</q>, current-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::comm" title='task_struct::comm' data-ref="task_struct::comm">comm</a>);</td></tr>
<tr><th id="3233">3233</th><td></td></tr>
<tr><th id="3234">3234</th><td>	<span class="macro" title="__builtin_va_start(args,fmt)" data-ref="_M/va_start">va_start</span>(<a class="local col6 ref" href="#756args" title='args' data-ref="756args">args</a>, <a class="local col4 ref" href="#754fmt" title='fmt' data-ref="754fmt">fmt</a>);</td></tr>
<tr><th id="3235">3235</th><td>	<a class="local col5 ref" href="#755vaf" title='vaf' data-ref="755vaf">vaf</a>.<a class="ref field" href="../include/linux/printk.h.html#va_format::fmt" title='va_format::fmt' data-ref="va_format::fmt">fmt</a> = <a class="local col4 ref" href="#754fmt" title='fmt' data-ref="754fmt">fmt</a>;</td></tr>
<tr><th id="3236">3236</th><td>	<a class="local col5 ref" href="#755vaf" title='vaf' data-ref="755vaf">vaf</a>.<a class="ref field" href="../include/linux/printk.h.html#va_format::va" title='va_format::va' data-ref="va_format::va">va</a> = &amp;<a class="local col6 ref" href="#756args" title='args' data-ref="756args">args</a>;</td></tr>
<tr><th id="3237">3237</th><td>	<a class="macro" href="../include/linux/printk.h.html#315" title="printk(&quot;\001&quot; &quot;c&quot; &quot;%pV&quot;, &amp;vaf)" data-ref="_M/pr_cont">pr_cont</a>(<q>"%pV"</q>, &amp;<a class="local col5 ref" href="#755vaf" title='vaf' data-ref="755vaf">vaf</a>);</td></tr>
<tr><th id="3238">3238</th><td>	<span class="macro" title="__builtin_va_end(args)" data-ref="_M/va_end">va_end</span>(<a class="local col6 ref" href="#756args" title='args' data-ref="756args">args</a>);</td></tr>
<tr><th id="3239">3239</th><td></td></tr>
<tr><th id="3240">3240</th><td>	<a class="macro" href="../include/linux/printk.h.html#315" title="printk(&quot;\001&quot; &quot;c&quot; &quot;, mode:%#x(%pGg), nodemask=&quot;, gfp_mask, &amp;gfp_mask)" data-ref="_M/pr_cont">pr_cont</a>(<q>", mode:%#x(%pGg), nodemask="</q>, <a class="local col2 ref" href="#752gfp_mask" title='gfp_mask' data-ref="752gfp_mask">gfp_mask</a>, &amp;<a class="local col2 ref" href="#752gfp_mask" title='gfp_mask' data-ref="752gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="3241">3241</th><td>	<b>if</b> (<a class="local col3 ref" href="#753nodemask" title='nodemask' data-ref="753nodemask">nodemask</a>)</td></tr>
<tr><th id="3242">3242</th><td>		<a class="macro" href="../include/linux/printk.h.html#315" title="printk(&quot;\001&quot; &quot;c&quot; &quot;%*pbl\n&quot;, (1 &lt;&lt; 0), (nodemask)-&gt;bits)" data-ref="_M/pr_cont">pr_cont</a>(<q>"%*pbl\n"</q>, nodemask_pr_args(<a class="local col3 ref" href="#753nodemask" title='nodemask' data-ref="753nodemask">nodemask</a>));</td></tr>
<tr><th id="3243">3243</th><td>	<b>else</b></td></tr>
<tr><th id="3244">3244</th><td>		<a class="macro" href="../include/linux/printk.h.html#315" title="printk(&quot;\001&quot; &quot;c&quot; &quot;(null)\n&quot;)" data-ref="_M/pr_cont">pr_cont</a>(<q>"(null)\n"</q>);</td></tr>
<tr><th id="3245">3245</th><td></td></tr>
<tr><th id="3246">3246</th><td>	<a class="ref fn" href="../include/linux/cpuset.h.html#cpuset_print_current_mems_allowed" title='cpuset_print_current_mems_allowed' data-ref="cpuset_print_current_mems_allowed">cpuset_print_current_mems_allowed</a>();</td></tr>
<tr><th id="3247">3247</th><td></td></tr>
<tr><th id="3248">3248</th><td>	<a class="ref fn" href="../include/linux/printk.h.html#dump_stack" title='dump_stack' data-ref="dump_stack">dump_stack</a>();</td></tr>
<tr><th id="3249">3249</th><td>	<a class="tu ref fn" href="#warn_alloc_show_mem" title='warn_alloc_show_mem' data-use='c' data-ref="warn_alloc_show_mem">warn_alloc_show_mem</a>(<a class="local col2 ref" href="#752gfp_mask" title='gfp_mask' data-ref="752gfp_mask">gfp_mask</a>, <a class="local col3 ref" href="#753nodemask" title='nodemask' data-ref="753nodemask">nodemask</a>);</td></tr>
<tr><th id="3250">3250</th><td>}</td></tr>
<tr><th id="3251">3251</th><td></td></tr>
<tr><th id="3252">3252</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="3253">3253</th><td><dfn class="tu decl def fn" id="__alloc_pages_cpuset_fallback" title='__alloc_pages_cpuset_fallback' data-type='struct page * __alloc_pages_cpuset_fallback(gfp_t gfp_mask, unsigned int order, unsigned int alloc_flags, const struct alloc_context * ac)' data-ref="__alloc_pages_cpuset_fallback">__alloc_pages_cpuset_fallback</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col8 decl" id="758gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="758gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="759order" title='order' data-type='unsigned int' data-ref="759order">order</dfn>,</td></tr>
<tr><th id="3254">3254</th><td>			      <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="760alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="760alloc_flags">alloc_flags</dfn>,</td></tr>
<tr><th id="3255">3255</th><td>			      <em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col1 decl" id="761ac" title='ac' data-type='const struct alloc_context *' data-ref="761ac">ac</dfn>)</td></tr>
<tr><th id="3256">3256</th><td>{</td></tr>
<tr><th id="3257">3257</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="762page" title='page' data-type='struct page *' data-ref="762page">page</dfn>;</td></tr>
<tr><th id="3258">3258</th><td></td></tr>
<tr><th id="3259">3259</th><td>	<a class="local col2 ref" href="#762page" title='page' data-ref="762page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>(<a class="local col8 ref" href="#758gfp_mask" title='gfp_mask' data-ref="758gfp_mask">gfp_mask</a>, <a class="local col9 ref" href="#759order" title='order' data-ref="759order">order</a>,</td></tr>
<tr><th id="3260">3260</th><td>			<a class="local col0 ref" href="#760alloc_flags" title='alloc_flags' data-ref="760alloc_flags">alloc_flags</a>|<a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>, <a class="local col1 ref" href="#761ac" title='ac' data-ref="761ac">ac</a>);</td></tr>
<tr><th id="3261">3261</th><td>	<i>/*</i></td></tr>
<tr><th id="3262">3262</th><td><i>	 * fallback to ignore cpuset restriction if our nodes</i></td></tr>
<tr><th id="3263">3263</th><td><i>	 * are depleted</i></td></tr>
<tr><th id="3264">3264</th><td><i>	 */</i></td></tr>
<tr><th id="3265">3265</th><td>	<b>if</b> (!<a class="local col2 ref" href="#762page" title='page' data-ref="762page">page</a>)</td></tr>
<tr><th id="3266">3266</th><td>		<a class="local col2 ref" href="#762page" title='page' data-ref="762page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>(<a class="local col8 ref" href="#758gfp_mask" title='gfp_mask' data-ref="758gfp_mask">gfp_mask</a>, <a class="local col9 ref" href="#759order" title='order' data-ref="759order">order</a>,</td></tr>
<tr><th id="3267">3267</th><td>				<a class="local col0 ref" href="#760alloc_flags" title='alloc_flags' data-ref="760alloc_flags">alloc_flags</a>, <a class="local col1 ref" href="#761ac" title='ac' data-ref="761ac">ac</a>);</td></tr>
<tr><th id="3268">3268</th><td></td></tr>
<tr><th id="3269">3269</th><td>	<b>return</b> <a class="local col2 ref" href="#762page" title='page' data-ref="762page">page</a>;</td></tr>
<tr><th id="3270">3270</th><td>}</td></tr>
<tr><th id="3271">3271</th><td></td></tr>
<tr><th id="3272">3272</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="3273">3273</th><td><dfn class="tu decl def fn" id="__alloc_pages_may_oom" title='__alloc_pages_may_oom' data-type='struct page * __alloc_pages_may_oom(gfp_t gfp_mask, unsigned int order, const struct alloc_context * ac, unsigned long * did_some_progress)' data-ref="__alloc_pages_may_oom">__alloc_pages_may_oom</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col3 decl" id="763gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="763gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="764order" title='order' data-type='unsigned int' data-ref="764order">order</dfn>,</td></tr>
<tr><th id="3274">3274</th><td>	<em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col5 decl" id="765ac" title='ac' data-type='const struct alloc_context *' data-ref="765ac">ac</dfn>, <em>unsigned</em> <em>long</em> *<dfn class="local col6 decl" id="766did_some_progress" title='did_some_progress' data-type='unsigned long *' data-ref="766did_some_progress">did_some_progress</dfn>)</td></tr>
<tr><th id="3275">3275</th><td>{</td></tr>
<tr><th id="3276">3276</th><td>	<b>struct</b> <a class="type" href="../include/linux/oom.h.html#oom_control" title='oom_control' data-ref="oom_control">oom_control</a> <dfn class="local col7 decl" id="767oc" title='oc' data-type='struct oom_control' data-ref="767oc">oc</dfn> = {</td></tr>
<tr><th id="3277">3277</th><td>		.<a class="ref field" href="../include/linux/oom.h.html#oom_control::zonelist" title='oom_control::zonelist' data-ref="oom_control::zonelist">zonelist</a> = <a class="local col5 ref" href="#765ac" title='ac' data-ref="765ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>,</td></tr>
<tr><th id="3278">3278</th><td>		.<a class="ref field" href="../include/linux/oom.h.html#oom_control::nodemask" title='oom_control::nodemask' data-ref="oom_control::nodemask">nodemask</a> = <a class="local col5 ref" href="#765ac" title='ac' data-ref="765ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>,</td></tr>
<tr><th id="3279">3279</th><td>		.<a class="ref field" href="../include/linux/oom.h.html#oom_control::memcg" title='oom_control::memcg' data-ref="oom_control::memcg">memcg</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="3280">3280</th><td>		.<a class="ref field" href="../include/linux/oom.h.html#oom_control::gfp_mask" title='oom_control::gfp_mask' data-ref="oom_control::gfp_mask">gfp_mask</a> = <a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a>,</td></tr>
<tr><th id="3281">3281</th><td>		.<a class="ref field" href="../include/linux/oom.h.html#oom_control::order" title='oom_control::order' data-ref="oom_control::order">order</a> = <a class="local col4 ref" href="#764order" title='order' data-ref="764order">order</a>,</td></tr>
<tr><th id="3282">3282</th><td>	};</td></tr>
<tr><th id="3283">3283</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="768page" title='page' data-type='struct page *' data-ref="768page">page</dfn>;</td></tr>
<tr><th id="3284">3284</th><td></td></tr>
<tr><th id="3285">3285</th><td>	*<a class="local col6 ref" href="#766did_some_progress" title='did_some_progress' data-ref="766did_some_progress">did_some_progress</a> = <var>0</var>;</td></tr>
<tr><th id="3286">3286</th><td></td></tr>
<tr><th id="3287">3287</th><td>	<i>/*</i></td></tr>
<tr><th id="3288">3288</th><td><i>	 * Acquire the oom lock.  If that fails, somebody else is</i></td></tr>
<tr><th id="3289">3289</th><td><i>	 * making progress for us.</i></td></tr>
<tr><th id="3290">3290</th><td><i>	 */</i></td></tr>
<tr><th id="3291">3291</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/mutex.h.html#mutex_trylock" title='mutex_trylock' data-ref="mutex_trylock">mutex_trylock</a>(&amp;<a class="ref" href="../include/linux/oom.h.html#oom_lock" title='oom_lock' data-ref="oom_lock">oom_lock</a>)) {</td></tr>
<tr><th id="3292">3292</th><td>		*<a class="local col6 ref" href="#766did_some_progress" title='did_some_progress' data-ref="766did_some_progress">did_some_progress</a> = <var>1</var>;</td></tr>
<tr><th id="3293">3293</th><td>		<a class="ref fn" href="../include/linux/sched.h.html#schedule_timeout_uninterruptible" title='schedule_timeout_uninterruptible' data-ref="schedule_timeout_uninterruptible">schedule_timeout_uninterruptible</a>(<var>1</var>);</td></tr>
<tr><th id="3294">3294</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3295">3295</th><td>	}</td></tr>
<tr><th id="3296">3296</th><td></td></tr>
<tr><th id="3297">3297</th><td>	<i>/*</i></td></tr>
<tr><th id="3298">3298</th><td><i>	 * Go through the zonelist yet one more time, keep very high watermark</i></td></tr>
<tr><th id="3299">3299</th><td><i>	 * here, this is only to catch a parallel oom killing, we must fail if</i></td></tr>
<tr><th id="3300">3300</th><td><i>	 * we're still under heavy pressure. But make sure that this reclaim</i></td></tr>
<tr><th id="3301">3301</th><td><i>	 * attempt shall not depend on __GFP_DIRECT_RECLAIM &amp;&amp; !__GFP_NORETRY</i></td></tr>
<tr><th id="3302">3302</th><td><i>	 * allocation which will never fail due to oom_lock already held.</i></td></tr>
<tr><th id="3303">3303</th><td><i>	 */</i></td></tr>
<tr><th id="3304">3304</th><td>	<a class="local col8 ref" href="#768page" title='page' data-ref="768page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>((<a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a> | <a class="macro" href="../include/linux/gfp.h.html#89" title="(( gfp_t)0x20000u)" data-ref="_M/__GFP_HARDWALL">__GFP_HARDWALL</a>) &amp;</td></tr>
<tr><th id="3305">3305</th><td>				      ~<a class="macro" href="../include/linux/gfp.h.html#185" title="(( gfp_t)0x400000u)" data-ref="_M/__GFP_DIRECT_RECLAIM">__GFP_DIRECT_RECLAIM</a>, <a class="local col4 ref" href="#764order" title='order' data-ref="764order">order</a>,</td></tr>
<tr><th id="3306">3306</th><td>				      <a class="macro" href="internal.h.html#477" title="WMARK_HIGH" data-ref="_M/ALLOC_WMARK_HIGH">ALLOC_WMARK_HIGH</a>|<a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>, <a class="local col5 ref" href="#765ac" title='ac' data-ref="765ac">ac</a>);</td></tr>
<tr><th id="3307">3307</th><td>	<b>if</b> (<a class="local col8 ref" href="#768page" title='page' data-ref="768page">page</a>)</td></tr>
<tr><th id="3308">3308</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3309">3309</th><td></td></tr>
<tr><th id="3310">3310</th><td>	<i>/* Coredumps can quickly deplete all memory reserves */</i></td></tr>
<tr><th id="3311">3311</th><td>	<b>if</b> (<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; <a class="macro" href="../include/linux/sched.h.html#1343" title="0x00000200" data-ref="_M/PF_DUMPCORE">PF_DUMPCORE</a>)</td></tr>
<tr><th id="3312">3312</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3313">3313</th><td>	<i>/* The OOM killer will not help higher order allocs */</i></td></tr>
<tr><th id="3314">3314</th><td>	<b>if</b> (<a class="local col4 ref" href="#764order" title='order' data-ref="764order">order</a> &gt; <a class="macro" href="../include/linux/mmzone.h.html#37" title="3" data-ref="_M/PAGE_ALLOC_COSTLY_ORDER">PAGE_ALLOC_COSTLY_ORDER</a>)</td></tr>
<tr><th id="3315">3315</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3316">3316</th><td>	<i>/*</i></td></tr>
<tr><th id="3317">3317</th><td><i>	 * We have already exhausted all our reclaim opportunities without any</i></td></tr>
<tr><th id="3318">3318</th><td><i>	 * success so it is time to admit defeat. We will skip the OOM killer</i></td></tr>
<tr><th id="3319">3319</th><td><i>	 * because it is very likely that the caller has a more reasonable</i></td></tr>
<tr><th id="3320">3320</th><td><i>	 * fallback than shooting a random task.</i></td></tr>
<tr><th id="3321">3321</th><td><i>	 */</i></td></tr>
<tr><th id="3322">3322</th><td>	<b>if</b> (<a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#188" title="(( gfp_t)0x400u)" data-ref="_M/__GFP_RETRY_MAYFAIL">__GFP_RETRY_MAYFAIL</a>)</td></tr>
<tr><th id="3323">3323</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3324">3324</th><td>	<i>/* The OOM killer does not needlessly kill tasks for lowmem */</i></td></tr>
<tr><th id="3325">3325</th><td>	<b>if</b> (<a class="local col5 ref" href="#765ac" title='ac' data-ref="765ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#ZONE_NORMAL" title='ZONE_NORMAL' data-ref="ZONE_NORMAL">ZONE_NORMAL</a>)</td></tr>
<tr><th id="3326">3326</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3327">3327</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/gfp.h.html#pm_suspended_storage" title='pm_suspended_storage' data-ref="pm_suspended_storage">pm_suspended_storage</a>())</td></tr>
<tr><th id="3328">3328</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3329">3329</th><td>	<i>/*</i></td></tr>
<tr><th id="3330">3330</th><td><i>	 * XXX: GFP_NOFS allocations should rather fail than rely on</i></td></tr>
<tr><th id="3331">3331</th><td><i>	 * other request to make a forward progress.</i></td></tr>
<tr><th id="3332">3332</th><td><i>	 * We are in an unfortunate situation where out_of_memory cannot</i></td></tr>
<tr><th id="3333">3333</th><td><i>	 * do much for this context but let's try it to at least get</i></td></tr>
<tr><th id="3334">3334</th><td><i>	 * access to memory reserved if the current task is killed (see</i></td></tr>
<tr><th id="3335">3335</th><td><i>	 * out_of_memory). Once filesystems are ready to handle allocation</i></td></tr>
<tr><th id="3336">3336</th><td><i>	 * failures more gracefully we should just bail out here.</i></td></tr>
<tr><th id="3337">3337</th><td><i>	 */</i></td></tr>
<tr><th id="3338">3338</th><td></td></tr>
<tr><th id="3339">3339</th><td>	<i>/* The OOM killer may not free memory on a specific node */</i></td></tr>
<tr><th id="3340">3340</th><td>	<b>if</b> (<a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#90" title="(( gfp_t)0x40000u)" data-ref="_M/__GFP_THISNODE">__GFP_THISNODE</a>)</td></tr>
<tr><th id="3341">3341</th><td>		<b>goto</b> <a class="lbl" href="#769out" data-ref="769out">out</a>;</td></tr>
<tr><th id="3342">3342</th><td></td></tr>
<tr><th id="3343">3343</th><td>	<i>/* Exhausted what can be done so it's blamo time */</i></td></tr>
<tr><th id="3344">3344</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/oom.h.html#out_of_memory" title='out_of_memory' data-ref="out_of_memory">out_of_memory</a>(&amp;<a class="local col7 ref" href="#767oc" title='oc' data-ref="767oc">oc</a>) || <a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!(gfp_mask &amp; (( gfp_t)0x800u)); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (3344), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (167)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>(<a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#189" title="(( gfp_t)0x800u)" data-ref="_M/__GFP_NOFAIL">__GFP_NOFAIL</a>)) {</td></tr>
<tr><th id="3345">3345</th><td>		*<a class="local col6 ref" href="#766did_some_progress" title='did_some_progress' data-ref="766did_some_progress">did_some_progress</a> = <var>1</var>;</td></tr>
<tr><th id="3346">3346</th><td></td></tr>
<tr><th id="3347">3347</th><td>		<i>/*</i></td></tr>
<tr><th id="3348">3348</th><td><i>		 * Help non-failing allocations by giving them access to memory</i></td></tr>
<tr><th id="3349">3349</th><td><i>		 * reserves</i></td></tr>
<tr><th id="3350">3350</th><td><i>		 */</i></td></tr>
<tr><th id="3351">3351</th><td>		<b>if</b> (<a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#189" title="(( gfp_t)0x800u)" data-ref="_M/__GFP_NOFAIL">__GFP_NOFAIL</a>)</td></tr>
<tr><th id="3352">3352</th><td>			<a class="local col8 ref" href="#768page" title='page' data-ref="768page">page</a> = <a class="tu ref fn" href="#__alloc_pages_cpuset_fallback" title='__alloc_pages_cpuset_fallback' data-use='c' data-ref="__alloc_pages_cpuset_fallback">__alloc_pages_cpuset_fallback</a>(<a class="local col3 ref" href="#763gfp_mask" title='gfp_mask' data-ref="763gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#764order" title='order' data-ref="764order">order</a>,</td></tr>
<tr><th id="3353">3353</th><td>					<a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a>, <a class="local col5 ref" href="#765ac" title='ac' data-ref="765ac">ac</a>);</td></tr>
<tr><th id="3354">3354</th><td>	}</td></tr>
<tr><th id="3355">3355</th><td><dfn class="lbl" id="769out" data-ref="769out">out</dfn>:</td></tr>
<tr><th id="3356">3356</th><td>	<a class="ref fn" href="../include/linux/mutex.h.html#mutex_unlock" title='mutex_unlock' data-ref="mutex_unlock">mutex_unlock</a>(&amp;<a class="ref" href="../include/linux/oom.h.html#oom_lock" title='oom_lock' data-ref="oom_lock">oom_lock</a>);</td></tr>
<tr><th id="3357">3357</th><td>	<b>return</b> <a class="local col8 ref" href="#768page" title='page' data-ref="768page">page</a>;</td></tr>
<tr><th id="3358">3358</th><td>}</td></tr>
<tr><th id="3359">3359</th><td></td></tr>
<tr><th id="3360">3360</th><td><i>/*</i></td></tr>
<tr><th id="3361">3361</th><td><i> * Maximum number of compaction retries wit a progress before OOM</i></td></tr>
<tr><th id="3362">3362</th><td><i> * killer is consider as the only way to move forward.</i></td></tr>
<tr><th id="3363">3363</th><td><i> */</i></td></tr>
<tr><th id="3364">3364</th><td><u>#define <dfn class="macro" id="_M/MAX_COMPACT_RETRIES" data-ref="_M/MAX_COMPACT_RETRIES">MAX_COMPACT_RETRIES</dfn> 16</u></td></tr>
<tr><th id="3365">3365</th><td></td></tr>
<tr><th id="3366">3366</th><td><u>#<span data-ppcond="3366">ifdef</span> <span class="macro" data-ref="_M/CONFIG_COMPACTION">CONFIG_COMPACTION</span></u></td></tr>
<tr><th id="3367">3367</th><td><i>/* Try memory compaction for high-order allocations before reclaim */</i></td></tr>
<tr><th id="3368">3368</th><td><em>static</em> <b>struct</b> page *</td></tr>
<tr><th id="3369">3369</th><td>__alloc_pages_direct_compact(gfp_t gfp_mask, <em>unsigned</em> <em>int</em> order,</td></tr>
<tr><th id="3370">3370</th><td>		<em>unsigned</em> <em>int</em> alloc_flags, <em>const</em> <b>struct</b> alloc_context *ac,</td></tr>
<tr><th id="3371">3371</th><td>		<b>enum</b> compact_priority prio, <b>enum</b> compact_result *compact_result)</td></tr>
<tr><th id="3372">3372</th><td>{</td></tr>
<tr><th id="3373">3373</th><td>	<b>struct</b> page *page;</td></tr>
<tr><th id="3374">3374</th><td>	<em>unsigned</em> <em>int</em> noreclaim_flag;</td></tr>
<tr><th id="3375">3375</th><td></td></tr>
<tr><th id="3376">3376</th><td>	<b>if</b> (!order)</td></tr>
<tr><th id="3377">3377</th><td>		<b>return</b> NULL;</td></tr>
<tr><th id="3378">3378</th><td></td></tr>
<tr><th id="3379">3379</th><td>	noreclaim_flag = memalloc_noreclaim_save();</td></tr>
<tr><th id="3380">3380</th><td>	*compact_result = try_to_compact_pages(gfp_mask, order, alloc_flags, ac,</td></tr>
<tr><th id="3381">3381</th><td>									prio);</td></tr>
<tr><th id="3382">3382</th><td>	memalloc_noreclaim_restore(noreclaim_flag);</td></tr>
<tr><th id="3383">3383</th><td></td></tr>
<tr><th id="3384">3384</th><td>	<b>if</b> (*compact_result &lt;= COMPACT_INACTIVE)</td></tr>
<tr><th id="3385">3385</th><td>		<b>return</b> NULL;</td></tr>
<tr><th id="3386">3386</th><td></td></tr>
<tr><th id="3387">3387</th><td>	<i>/*</i></td></tr>
<tr><th id="3388">3388</th><td><i>	 * At least in one zone compaction wasn't deferred or skipped, so let's</i></td></tr>
<tr><th id="3389">3389</th><td><i>	 * count a compaction stall</i></td></tr>
<tr><th id="3390">3390</th><td><i>	 */</i></td></tr>
<tr><th id="3391">3391</th><td>	count_vm_event(COMPACTSTALL);</td></tr>
<tr><th id="3392">3392</th><td></td></tr>
<tr><th id="3393">3393</th><td>	page = get_page_from_freelist(gfp_mask, order, alloc_flags, ac);</td></tr>
<tr><th id="3394">3394</th><td></td></tr>
<tr><th id="3395">3395</th><td>	<b>if</b> (page) {</td></tr>
<tr><th id="3396">3396</th><td>		<b>struct</b> zone *zone = page_zone(page);</td></tr>
<tr><th id="3397">3397</th><td></td></tr>
<tr><th id="3398">3398</th><td>		zone-&gt;compact_blockskip_flush = false;</td></tr>
<tr><th id="3399">3399</th><td>		compaction_defer_reset(zone, order, true);</td></tr>
<tr><th id="3400">3400</th><td>		count_vm_event(COMPACTSUCCESS);</td></tr>
<tr><th id="3401">3401</th><td>		<b>return</b> page;</td></tr>
<tr><th id="3402">3402</th><td>	}</td></tr>
<tr><th id="3403">3403</th><td></td></tr>
<tr><th id="3404">3404</th><td>	<i>/*</i></td></tr>
<tr><th id="3405">3405</th><td><i>	 * It's bad if compaction run occurs and fails. The most likely reason</i></td></tr>
<tr><th id="3406">3406</th><td><i>	 * is that pages exist, but not enough to satisfy watermarks.</i></td></tr>
<tr><th id="3407">3407</th><td><i>	 */</i></td></tr>
<tr><th id="3408">3408</th><td>	count_vm_event(COMPACTFAIL);</td></tr>
<tr><th id="3409">3409</th><td></td></tr>
<tr><th id="3410">3410</th><td>	cond_resched();</td></tr>
<tr><th id="3411">3411</th><td></td></tr>
<tr><th id="3412">3412</th><td>	<b>return</b> NULL;</td></tr>
<tr><th id="3413">3413</th><td>}</td></tr>
<tr><th id="3414">3414</th><td></td></tr>
<tr><th id="3415">3415</th><td><em>static</em> <b>inline</b> bool</td></tr>
<tr><th id="3416">3416</th><td>should_compact_retry(<b>struct</b> alloc_context *ac, <em>int</em> order, <em>int</em> alloc_flags,</td></tr>
<tr><th id="3417">3417</th><td>		     <b>enum</b> compact_result compact_result,</td></tr>
<tr><th id="3418">3418</th><td>		     <b>enum</b> compact_priority *compact_priority,</td></tr>
<tr><th id="3419">3419</th><td>		     <em>int</em> *compaction_retries)</td></tr>
<tr><th id="3420">3420</th><td>{</td></tr>
<tr><th id="3421">3421</th><td>	<em>int</em> max_retries = MAX_COMPACT_RETRIES;</td></tr>
<tr><th id="3422">3422</th><td>	<em>int</em> min_priority;</td></tr>
<tr><th id="3423">3423</th><td>	bool ret = false;</td></tr>
<tr><th id="3424">3424</th><td>	<em>int</em> retries = *compaction_retries;</td></tr>
<tr><th id="3425">3425</th><td>	<b>enum</b> compact_priority priority = *compact_priority;</td></tr>
<tr><th id="3426">3426</th><td></td></tr>
<tr><th id="3427">3427</th><td>	<b>if</b> (!order)</td></tr>
<tr><th id="3428">3428</th><td>		<b>return</b> false;</td></tr>
<tr><th id="3429">3429</th><td></td></tr>
<tr><th id="3430">3430</th><td>	<b>if</b> (compaction_made_progress(compact_result))</td></tr>
<tr><th id="3431">3431</th><td>		(*compaction_retries)++;</td></tr>
<tr><th id="3432">3432</th><td></td></tr>
<tr><th id="3433">3433</th><td>	<i>/*</i></td></tr>
<tr><th id="3434">3434</th><td><i>	 * compaction considers all the zone as desperately out of memory</i></td></tr>
<tr><th id="3435">3435</th><td><i>	 * so it doesn't really make much sense to retry except when the</i></td></tr>
<tr><th id="3436">3436</th><td><i>	 * failure could be caused by insufficient priority</i></td></tr>
<tr><th id="3437">3437</th><td><i>	 */</i></td></tr>
<tr><th id="3438">3438</th><td>	<b>if</b> (compaction_failed(compact_result))</td></tr>
<tr><th id="3439">3439</th><td>		<b>goto</b> check_priority;</td></tr>
<tr><th id="3440">3440</th><td></td></tr>
<tr><th id="3441">3441</th><td>	<i>/*</i></td></tr>
<tr><th id="3442">3442</th><td><i>	 * make sure the compaction wasn't deferred or didn't bail out early</i></td></tr>
<tr><th id="3443">3443</th><td><i>	 * due to locks contention before we declare that we should give up.</i></td></tr>
<tr><th id="3444">3444</th><td><i>	 * But do not retry if the given zonelist is not suitable for</i></td></tr>
<tr><th id="3445">3445</th><td><i>	 * compaction.</i></td></tr>
<tr><th id="3446">3446</th><td><i>	 */</i></td></tr>
<tr><th id="3447">3447</th><td>	<b>if</b> (compaction_withdrawn(compact_result)) {</td></tr>
<tr><th id="3448">3448</th><td>		ret = compaction_zonelist_suitable(ac, order, alloc_flags);</td></tr>
<tr><th id="3449">3449</th><td>		<b>goto</b> out;</td></tr>
<tr><th id="3450">3450</th><td>	}</td></tr>
<tr><th id="3451">3451</th><td></td></tr>
<tr><th id="3452">3452</th><td>	<i>/*</i></td></tr>
<tr><th id="3453">3453</th><td><i>	 * !costly requests are much more important than __GFP_RETRY_MAYFAIL</i></td></tr>
<tr><th id="3454">3454</th><td><i>	 * costly ones because they are de facto nofail and invoke OOM</i></td></tr>
<tr><th id="3455">3455</th><td><i>	 * killer to move on while costly can fail and users are ready</i></td></tr>
<tr><th id="3456">3456</th><td><i>	 * to cope with that. 1/4 retries is rather arbitrary but we</i></td></tr>
<tr><th id="3457">3457</th><td><i>	 * would need much more detailed feedback from compaction to</i></td></tr>
<tr><th id="3458">3458</th><td><i>	 * make a better decision.</i></td></tr>
<tr><th id="3459">3459</th><td><i>	 */</i></td></tr>
<tr><th id="3460">3460</th><td>	<b>if</b> (order &gt; PAGE_ALLOC_COSTLY_ORDER)</td></tr>
<tr><th id="3461">3461</th><td>		max_retries /= <var>4</var>;</td></tr>
<tr><th id="3462">3462</th><td>	<b>if</b> (*compaction_retries &lt;= max_retries) {</td></tr>
<tr><th id="3463">3463</th><td>		ret = true;</td></tr>
<tr><th id="3464">3464</th><td>		<b>goto</b> out;</td></tr>
<tr><th id="3465">3465</th><td>	}</td></tr>
<tr><th id="3466">3466</th><td></td></tr>
<tr><th id="3467">3467</th><td>	<i>/*</i></td></tr>
<tr><th id="3468">3468</th><td><i>	 * Make sure there are attempts at the highest priority if we exhausted</i></td></tr>
<tr><th id="3469">3469</th><td><i>	 * all retries or failed at the lower priorities.</i></td></tr>
<tr><th id="3470">3470</th><td><i>	 */</i></td></tr>
<tr><th id="3471">3471</th><td>check_priority:</td></tr>
<tr><th id="3472">3472</th><td>	min_priority = (order &gt; PAGE_ALLOC_COSTLY_ORDER) ?</td></tr>
<tr><th id="3473">3473</th><td>			MIN_COMPACT_COSTLY_PRIORITY : MIN_COMPACT_PRIORITY;</td></tr>
<tr><th id="3474">3474</th><td></td></tr>
<tr><th id="3475">3475</th><td>	<b>if</b> (*compact_priority &gt; min_priority) {</td></tr>
<tr><th id="3476">3476</th><td>		(*compact_priority)--;</td></tr>
<tr><th id="3477">3477</th><td>		*compaction_retries = <var>0</var>;</td></tr>
<tr><th id="3478">3478</th><td>		ret = true;</td></tr>
<tr><th id="3479">3479</th><td>	}</td></tr>
<tr><th id="3480">3480</th><td>out:</td></tr>
<tr><th id="3481">3481</th><td>	trace_compact_retry(order, priority, compact_result, retries, max_retries, ret);</td></tr>
<tr><th id="3482">3482</th><td>	<b>return</b> ret;</td></tr>
<tr><th id="3483">3483</th><td>}</td></tr>
<tr><th id="3484">3484</th><td><u>#<span data-ppcond="3366">else</span></u></td></tr>
<tr><th id="3485">3485</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="3486">3486</th><td><dfn class="tu decl def fn" id="__alloc_pages_direct_compact" title='__alloc_pages_direct_compact' data-type='struct page * __alloc_pages_direct_compact(gfp_t gfp_mask, unsigned int order, unsigned int alloc_flags, const struct alloc_context * ac, enum compact_priority prio, enum compact_result * compact_result)' data-ref="__alloc_pages_direct_compact">__alloc_pages_direct_compact</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col0 decl" id="770gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="770gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="771order" title='order' data-type='unsigned int' data-ref="771order">order</dfn>,</td></tr>
<tr><th id="3487">3487</th><td>		<em>unsigned</em> <em>int</em> <dfn class="local col2 decl" id="772alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="772alloc_flags">alloc_flags</dfn>, <em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col3 decl" id="773ac" title='ac' data-type='const struct alloc_context *' data-ref="773ac">ac</dfn>,</td></tr>
<tr><th id="3488">3488</th><td>		<b>enum</b> <a class="type" href="../include/linux/compaction.h.html#compact_priority" title='compact_priority' data-ref="compact_priority">compact_priority</a> <dfn class="local col4 decl" id="774prio" title='prio' data-type='enum compact_priority' data-ref="774prio">prio</dfn>, <b>enum</b> <a class="type" href="../include/linux/compaction.h.html#compact_result" title='compact_result' data-ref="compact_result">compact_result</a> *<dfn class="local col5 decl" id="775compact_result" title='compact_result' data-type='enum compact_result *' data-ref="775compact_result">compact_result</dfn>)</td></tr>
<tr><th id="3489">3489</th><td>{</td></tr>
<tr><th id="3490">3490</th><td>	*<a class="local col5 ref" href="#775compact_result" title='compact_result' data-ref="775compact_result">compact_result</a> = <a class="enum" href="../include/linux/compaction.h.html#COMPACT_SKIPPED" title='COMPACT_SKIPPED' data-ref="COMPACT_SKIPPED">COMPACT_SKIPPED</a>;</td></tr>
<tr><th id="3491">3491</th><td>	<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3492">3492</th><td>}</td></tr>
<tr><th id="3493">3493</th><td></td></tr>
<tr><th id="3494">3494</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a></td></tr>
<tr><th id="3495">3495</th><td><dfn class="tu decl def fn" id="should_compact_retry" title='should_compact_retry' data-type='bool should_compact_retry(struct alloc_context * ac, unsigned int order, int alloc_flags, enum compact_result compact_result, enum compact_priority * compact_priority, int * compaction_retries)' data-ref="should_compact_retry">should_compact_retry</dfn>(<b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col6 decl" id="776ac" title='ac' data-type='struct alloc_context *' data-ref="776ac">ac</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="777order" title='order' data-type='unsigned int' data-ref="777order">order</dfn>, <em>int</em> <dfn class="local col8 decl" id="778alloc_flags" title='alloc_flags' data-type='int' data-ref="778alloc_flags">alloc_flags</dfn>,</td></tr>
<tr><th id="3496">3496</th><td>		     <b>enum</b> <a class="type" href="../include/linux/compaction.h.html#compact_result" title='compact_result' data-ref="compact_result">compact_result</a> <dfn class="local col9 decl" id="779compact_result" title='compact_result' data-type='enum compact_result' data-ref="779compact_result">compact_result</dfn>,</td></tr>
<tr><th id="3497">3497</th><td>		     <b>enum</b> <a class="type" href="../include/linux/compaction.h.html#compact_priority" title='compact_priority' data-ref="compact_priority">compact_priority</a> *<dfn class="local col0 decl" id="780compact_priority" title='compact_priority' data-type='enum compact_priority *' data-ref="780compact_priority">compact_priority</dfn>,</td></tr>
<tr><th id="3498">3498</th><td>		     <em>int</em> *<dfn class="local col1 decl" id="781compaction_retries" title='compaction_retries' data-type='int *' data-ref="781compaction_retries">compaction_retries</dfn>)</td></tr>
<tr><th id="3499">3499</th><td>{</td></tr>
<tr><th id="3500">3500</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="782zone" title='zone' data-type='struct zone *' data-ref="782zone">zone</dfn>;</td></tr>
<tr><th id="3501">3501</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col3 decl" id="783z" title='z' data-type='struct zoneref *' data-ref="783z">z</dfn>;</td></tr>
<tr><th id="3502">3502</th><td></td></tr>
<tr><th id="3503">3503</th><td>	<b>if</b> (!<a class="local col7 ref" href="#777order" title='order' data-ref="777order">order</a> || <a class="local col7 ref" href="#777order" title='order' data-ref="777order">order</a> &gt; <a class="macro" href="../include/linux/mmzone.h.html#37" title="3" data-ref="_M/PAGE_ALLOC_COSTLY_ORDER">PAGE_ALLOC_COSTLY_ORDER</a>)</td></tr>
<tr><th id="3504">3504</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3505">3505</th><td></td></tr>
<tr><th id="3506">3506</th><td>	<i>/*</i></td></tr>
<tr><th id="3507">3507</th><td><i>	 * There are setups with compaction disabled which would prefer to loop</i></td></tr>
<tr><th id="3508">3508</th><td><i>	 * inside the allocator rather than hit the oom killer prematurely.</i></td></tr>
<tr><th id="3509">3509</th><td><i>	 * Let's give them a good hope and keep retrying while the order-0</i></td></tr>
<tr><th id="3510">3510</th><td><i>	 * watermarks are OK.</i></td></tr>
<tr><th id="3511">3511</th><td><i>	 */</i></td></tr>
<tr><th id="3512">3512</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#1034" title="for (z = first_zones_zonelist(ac-&gt;zonelist, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z); zone; z = next_zones_zonelist(++z, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z))" data-ref="_M/for_each_zone_zonelist_nodemask">for_each_zone_zonelist_nodemask</a>(<a class="local col2 ref" href="#782zone" title='zone' data-ref="782zone">zone</a>, <a class="local col3 ref" href="#783z" title='z' data-ref="783z">z</a>, <a class="local col6 ref" href="#776ac" title='ac' data-ref="776ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>, <a class="local col6 ref" href="#776ac" title='ac' data-ref="776ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>,</td></tr>
<tr><th id="3513">3513</th><td>					<a class="local col6 ref" href="#776ac" title='ac' data-ref="776ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>) {</td></tr>
<tr><th id="3514">3514</th><td>		<b>if</b> (<a class="ref fn" href="#zone_watermark_ok" title='zone_watermark_ok' data-ref="zone_watermark_ok">zone_watermark_ok</a>(<a class="local col2 ref" href="#782zone" title='zone' data-ref="782zone">zone</a>, <var>0</var>, <a class="macro" href="../include/linux/mmzone.h.html#269" title="(zone-&gt;watermark[WMARK_MIN])" data-ref="_M/min_wmark_pages">min_wmark_pages</a>(<a class="local col2 ref" href="#782zone" title='zone' data-ref="782zone">zone</a>),</td></tr>
<tr><th id="3515">3515</th><td>					<a class="macro" href="internal.h.html#126" title="zonelist_zone_idx(ac-&gt;preferred_zoneref)" data-ref="_M/ac_classzone_idx">ac_classzone_idx</a>(<a class="local col6 ref" href="#776ac" title='ac' data-ref="776ac">ac</a>), <a class="local col8 ref" href="#778alloc_flags" title='alloc_flags' data-ref="778alloc_flags">alloc_flags</a>))</td></tr>
<tr><th id="3516">3516</th><td>			<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3517">3517</th><td>	}</td></tr>
<tr><th id="3518">3518</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3519">3519</th><td>}</td></tr>
<tr><th id="3520">3520</th><td><u>#<span data-ppcond="3366">endif</span> /* CONFIG_COMPACTION */</u></td></tr>
<tr><th id="3521">3521</th><td></td></tr>
<tr><th id="3522">3522</th><td><u>#<span data-ppcond="3522">ifdef</span> <span class="macro" data-ref="_M/CONFIG_LOCKDEP">CONFIG_LOCKDEP</span></u></td></tr>
<tr><th id="3523">3523</th><td><b>struct</b> lockdep_map __fs_reclaim_map =</td></tr>
<tr><th id="3524">3524</th><td>	STATIC_LOCKDEP_MAP_INIT(<q>"fs_reclaim"</q>, &amp;__fs_reclaim_map);</td></tr>
<tr><th id="3525">3525</th><td></td></tr>
<tr><th id="3526">3526</th><td><em>static</em> bool __need_fs_reclaim(gfp_t gfp_mask)</td></tr>
<tr><th id="3527">3527</th><td>{</td></tr>
<tr><th id="3528">3528</th><td>	gfp_mask = current_gfp_context(gfp_mask);</td></tr>
<tr><th id="3529">3529</th><td></td></tr>
<tr><th id="3530">3530</th><td>	<i>/* no reclaim without waiting on it */</i></td></tr>
<tr><th id="3531">3531</th><td>	<b>if</b> (!(gfp_mask &amp; __GFP_DIRECT_RECLAIM))</td></tr>
<tr><th id="3532">3532</th><td>		<b>return</b> false;</td></tr>
<tr><th id="3533">3533</th><td></td></tr>
<tr><th id="3534">3534</th><td>	<i>/* this guy won't enter reclaim */</i></td></tr>
<tr><th id="3535">3535</th><td>	<b>if</b> (current-&gt;flags &amp; PF_MEMALLOC)</td></tr>
<tr><th id="3536">3536</th><td>		<b>return</b> false;</td></tr>
<tr><th id="3537">3537</th><td></td></tr>
<tr><th id="3538">3538</th><td>	<i>/* We're only interested __GFP_FS allocations for now */</i></td></tr>
<tr><th id="3539">3539</th><td>	<b>if</b> (!(gfp_mask &amp; __GFP_FS))</td></tr>
<tr><th id="3540">3540</th><td>		<b>return</b> false;</td></tr>
<tr><th id="3541">3541</th><td></td></tr>
<tr><th id="3542">3542</th><td>	<b>if</b> (gfp_mask &amp; __GFP_NOLOCKDEP)</td></tr>
<tr><th id="3543">3543</th><td>		<b>return</b> false;</td></tr>
<tr><th id="3544">3544</th><td></td></tr>
<tr><th id="3545">3545</th><td>	<b>return</b> true;</td></tr>
<tr><th id="3546">3546</th><td>}</td></tr>
<tr><th id="3547">3547</th><td></td></tr>
<tr><th id="3548">3548</th><td><em>void</em> fs_reclaim_acquire(gfp_t gfp_mask)</td></tr>
<tr><th id="3549">3549</th><td>{</td></tr>
<tr><th id="3550">3550</th><td>	<b>if</b> (__need_fs_reclaim(gfp_mask))</td></tr>
<tr><th id="3551">3551</th><td>		lock_map_acquire(&amp;__fs_reclaim_map);</td></tr>
<tr><th id="3552">3552</th><td>}</td></tr>
<tr><th id="3553">3553</th><td>EXPORT_SYMBOL_GPL(fs_reclaim_acquire);</td></tr>
<tr><th id="3554">3554</th><td></td></tr>
<tr><th id="3555">3555</th><td><em>void</em> fs_reclaim_release(gfp_t gfp_mask)</td></tr>
<tr><th id="3556">3556</th><td>{</td></tr>
<tr><th id="3557">3557</th><td>	<b>if</b> (__need_fs_reclaim(gfp_mask))</td></tr>
<tr><th id="3558">3558</th><td>		lock_map_release(&amp;__fs_reclaim_map);</td></tr>
<tr><th id="3559">3559</th><td>}</td></tr>
<tr><th id="3560">3560</th><td>EXPORT_SYMBOL_GPL(fs_reclaim_release);</td></tr>
<tr><th id="3561">3561</th><td><u>#<span data-ppcond="3522">endif</span></u></td></tr>
<tr><th id="3562">3562</th><td></td></tr>
<tr><th id="3563">3563</th><td><i  data-doc="__perform_reclaim">/* Perform direct synchronous page reclaim */</i></td></tr>
<tr><th id="3564">3564</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3565">3565</th><td><dfn class="tu decl def fn" id="__perform_reclaim" title='__perform_reclaim' data-type='int __perform_reclaim(gfp_t gfp_mask, unsigned int order, const struct alloc_context * ac)' data-ref="__perform_reclaim">__perform_reclaim</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col4 decl" id="784gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="784gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="785order" title='order' data-type='unsigned int' data-ref="785order">order</dfn>,</td></tr>
<tr><th id="3566">3566</th><td>					<em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col6 decl" id="786ac" title='ac' data-type='const struct alloc_context *' data-ref="786ac">ac</dfn>)</td></tr>
<tr><th id="3567">3567</th><td>{</td></tr>
<tr><th id="3568">3568</th><td>	<b>struct</b> <a class="type" href="../include/linux/swap.h.html#reclaim_state" title='reclaim_state' data-ref="reclaim_state">reclaim_state</a> <dfn class="local col7 decl" id="787reclaim_state" title='reclaim_state' data-type='struct reclaim_state' data-ref="787reclaim_state">reclaim_state</dfn>;</td></tr>
<tr><th id="3569">3569</th><td>	<em>int</em> <dfn class="local col8 decl" id="788progress" title='progress' data-type='int' data-ref="788progress">progress</dfn>;</td></tr>
<tr><th id="3570">3570</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="789noreclaim_flag" title='noreclaim_flag' data-type='unsigned int' data-ref="789noreclaim_flag">noreclaim_flag</dfn>;</td></tr>
<tr><th id="3571">3571</th><td></td></tr>
<tr><th id="3572">3572</th><td>	<a class="macro" href="../include/linux/sched.h.html#1627" title="({ ___might_sleep(&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;, 3572, 0); _cond_resched(); })" data-ref="_M/cond_resched">cond_resched</a>();</td></tr>
<tr><th id="3573">3573</th><td></td></tr>
<tr><th id="3574">3574</th><td>	<i>/* We now go into synchronous reclaim */</i></td></tr>
<tr><th id="3575">3575</th><td>	<a class="macro" href="../include/linux/cpuset.h.html#89" title="do { if (cpuset_memory_pressure_enabled) __cpuset_memory_pressure_bump(); } while (0)" data-ref="_M/cpuset_memory_pressure_bump">cpuset_memory_pressure_bump</a>();</td></tr>
<tr><th id="3576">3576</th><td>	<a class="local col9 ref" href="#789noreclaim_flag" title='noreclaim_flag' data-ref="789noreclaim_flag">noreclaim_flag</a> = <a class="ref fn" href="../include/linux/sched/mm.h.html#memalloc_noreclaim_save" title='memalloc_noreclaim_save' data-ref="memalloc_noreclaim_save">memalloc_noreclaim_save</a>();</td></tr>
<tr><th id="3577">3577</th><td>	<a class="ref fn" href="../include/linux/sched/mm.h.html#fs_reclaim_acquire" title='fs_reclaim_acquire' data-ref="fs_reclaim_acquire">fs_reclaim_acquire</a>(<a class="local col4 ref" href="#784gfp_mask" title='gfp_mask' data-ref="784gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="3578">3578</th><td>	<a class="local col7 ref" href="#787reclaim_state" title='reclaim_state' data-ref="787reclaim_state">reclaim_state</a>.<a class="ref field" href="../include/linux/swap.h.html#reclaim_state::reclaimed_slab" title='reclaim_state::reclaimed_slab' data-ref="reclaim_state::reclaimed_slab">reclaimed_slab</a> = <var>0</var>;</td></tr>
<tr><th id="3579">3579</th><td>	<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::reclaim_state" title='task_struct::reclaim_state' data-ref="task_struct::reclaim_state">reclaim_state</a> = &amp;<a class="local col7 ref" href="#787reclaim_state" title='reclaim_state' data-ref="787reclaim_state">reclaim_state</a>;</td></tr>
<tr><th id="3580">3580</th><td></td></tr>
<tr><th id="3581">3581</th><td>	<a class="local col8 ref" href="#788progress" title='progress' data-ref="788progress">progress</a> = <a class="ref fn" href="../include/linux/swap.h.html#try_to_free_pages" title='try_to_free_pages' data-ref="try_to_free_pages">try_to_free_pages</a>(<a class="local col6 ref" href="#786ac" title='ac' data-ref="786ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>, <a class="local col5 ref" href="#785order" title='order' data-ref="785order">order</a>, <a class="local col4 ref" href="#784gfp_mask" title='gfp_mask' data-ref="784gfp_mask">gfp_mask</a>,</td></tr>
<tr><th id="3582">3582</th><td>								<a class="local col6 ref" href="#786ac" title='ac' data-ref="786ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>);</td></tr>
<tr><th id="3583">3583</th><td></td></tr>
<tr><th id="3584">3584</th><td>	<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::reclaim_state" title='task_struct::reclaim_state' data-ref="task_struct::reclaim_state">reclaim_state</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3585">3585</th><td>	<a class="ref fn" href="../include/linux/sched/mm.h.html#fs_reclaim_release" title='fs_reclaim_release' data-ref="fs_reclaim_release">fs_reclaim_release</a>(<a class="local col4 ref" href="#784gfp_mask" title='gfp_mask' data-ref="784gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="3586">3586</th><td>	<a class="ref fn" href="../include/linux/sched/mm.h.html#memalloc_noreclaim_restore" title='memalloc_noreclaim_restore' data-ref="memalloc_noreclaim_restore">memalloc_noreclaim_restore</a>(<a class="local col9 ref" href="#789noreclaim_flag" title='noreclaim_flag' data-ref="789noreclaim_flag">noreclaim_flag</a>);</td></tr>
<tr><th id="3587">3587</th><td></td></tr>
<tr><th id="3588">3588</th><td>	<a class="macro" href="../include/linux/sched.h.html#1627" title="({ ___might_sleep(&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;, 3588, 0); _cond_resched(); })" data-ref="_M/cond_resched">cond_resched</a>();</td></tr>
<tr><th id="3589">3589</th><td></td></tr>
<tr><th id="3590">3590</th><td>	<b>return</b> <a class="local col8 ref" href="#788progress" title='progress' data-ref="788progress">progress</a>;</td></tr>
<tr><th id="3591">3591</th><td>}</td></tr>
<tr><th id="3592">3592</th><td></td></tr>
<tr><th id="3593">3593</th><td><i  data-doc="__alloc_pages_direct_reclaim">/* The really slow allocator path where we enter direct reclaim */</i></td></tr>
<tr><th id="3594">3594</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="3595">3595</th><td><dfn class="tu decl def fn" id="__alloc_pages_direct_reclaim" title='__alloc_pages_direct_reclaim' data-type='struct page * __alloc_pages_direct_reclaim(gfp_t gfp_mask, unsigned int order, unsigned int alloc_flags, const struct alloc_context * ac, unsigned long * did_some_progress)' data-ref="__alloc_pages_direct_reclaim">__alloc_pages_direct_reclaim</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col0 decl" id="790gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="790gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="791order" title='order' data-type='unsigned int' data-ref="791order">order</dfn>,</td></tr>
<tr><th id="3596">3596</th><td>		<em>unsigned</em> <em>int</em> <dfn class="local col2 decl" id="792alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="792alloc_flags">alloc_flags</dfn>, <em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col3 decl" id="793ac" title='ac' data-type='const struct alloc_context *' data-ref="793ac">ac</dfn>,</td></tr>
<tr><th id="3597">3597</th><td>		<em>unsigned</em> <em>long</em> *<dfn class="local col4 decl" id="794did_some_progress" title='did_some_progress' data-type='unsigned long *' data-ref="794did_some_progress">did_some_progress</dfn>)</td></tr>
<tr><th id="3598">3598</th><td>{</td></tr>
<tr><th id="3599">3599</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="795page" title='page' data-type='struct page *' data-ref="795page">page</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3600">3600</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col6 decl" id="796drained" title='drained' data-type='bool' data-ref="796drained">drained</dfn> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3601">3601</th><td></td></tr>
<tr><th id="3602">3602</th><td>	*<a class="local col4 ref" href="#794did_some_progress" title='did_some_progress' data-ref="794did_some_progress">did_some_progress</a> = <a class="tu ref fn" href="#__perform_reclaim" title='__perform_reclaim' data-use='c' data-ref="__perform_reclaim">__perform_reclaim</a>(<a class="local col0 ref" href="#790gfp_mask" title='gfp_mask' data-ref="790gfp_mask">gfp_mask</a>, <a class="local col1 ref" href="#791order" title='order' data-ref="791order">order</a>, <a class="local col3 ref" href="#793ac" title='ac' data-ref="793ac">ac</a>);</td></tr>
<tr><th id="3603">3603</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(!(*did_some_progress)), 0)" data-ref="_M/unlikely">unlikely</a>(!(*<a class="local col4 ref" href="#794did_some_progress" title='did_some_progress' data-ref="794did_some_progress">did_some_progress</a>)))</td></tr>
<tr><th id="3604">3604</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3605">3605</th><td></td></tr>
<tr><th id="3606">3606</th><td><dfn class="lbl" id="797retry" data-ref="797retry">retry</dfn>:</td></tr>
<tr><th id="3607">3607</th><td>	<a class="local col5 ref" href="#795page" title='page' data-ref="795page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>(<a class="local col0 ref" href="#790gfp_mask" title='gfp_mask' data-ref="790gfp_mask">gfp_mask</a>, <a class="local col1 ref" href="#791order" title='order' data-ref="791order">order</a>, <a class="local col2 ref" href="#792alloc_flags" title='alloc_flags' data-ref="792alloc_flags">alloc_flags</a>, <a class="local col3 ref" href="#793ac" title='ac' data-ref="793ac">ac</a>);</td></tr>
<tr><th id="3608">3608</th><td></td></tr>
<tr><th id="3609">3609</th><td>	<i>/*</i></td></tr>
<tr><th id="3610">3610</th><td><i>	 * If an allocation failed after direct reclaim, it could be because</i></td></tr>
<tr><th id="3611">3611</th><td><i>	 * pages are pinned on the per-cpu lists or in high alloc reserves.</i></td></tr>
<tr><th id="3612">3612</th><td><i>	 * Shrink them them and try again</i></td></tr>
<tr><th id="3613">3613</th><td><i>	 */</i></td></tr>
<tr><th id="3614">3614</th><td>	<b>if</b> (!<a class="local col5 ref" href="#795page" title='page' data-ref="795page">page</a> &amp;&amp; !<a class="local col6 ref" href="#796drained" title='drained' data-ref="796drained">drained</a>) {</td></tr>
<tr><th id="3615">3615</th><td>		<a class="tu ref fn" href="#unreserve_highatomic_pageblock" title='unreserve_highatomic_pageblock' data-use='c' data-ref="unreserve_highatomic_pageblock">unreserve_highatomic_pageblock</a>(<a class="local col3 ref" href="#793ac" title='ac' data-ref="793ac">ac</a>, <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>);</td></tr>
<tr><th id="3616">3616</th><td>		<a class="ref fn" href="#drain_all_pages" title='drain_all_pages' data-ref="drain_all_pages">drain_all_pages</a>(<a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="3617">3617</th><td>		<a class="local col6 ref" href="#796drained" title='drained' data-ref="796drained">drained</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3618">3618</th><td>		<b>goto</b> <a class="lbl" href="#797retry" data-ref="797retry">retry</a>;</td></tr>
<tr><th id="3619">3619</th><td>	}</td></tr>
<tr><th id="3620">3620</th><td></td></tr>
<tr><th id="3621">3621</th><td>	<b>return</b> <a class="local col5 ref" href="#795page" title='page' data-ref="795page">page</a>;</td></tr>
<tr><th id="3622">3622</th><td>}</td></tr>
<tr><th id="3623">3623</th><td></td></tr>
<tr><th id="3624">3624</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="wake_all_kswapds" title='wake_all_kswapds' data-type='void wake_all_kswapds(unsigned int order, const struct alloc_context * ac)' data-ref="wake_all_kswapds">wake_all_kswapds</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="798order" title='order' data-type='unsigned int' data-ref="798order">order</dfn>, <em>const</em> <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col9 decl" id="799ac" title='ac' data-type='const struct alloc_context *' data-ref="799ac">ac</dfn>)</td></tr>
<tr><th id="3625">3625</th><td>{</td></tr>
<tr><th id="3626">3626</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col0 decl" id="800z" title='z' data-type='struct zoneref *' data-ref="800z">z</dfn>;</td></tr>
<tr><th id="3627">3627</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="801zone" title='zone' data-type='struct zone *' data-ref="801zone">zone</dfn>;</td></tr>
<tr><th id="3628">3628</th><td>	<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col2 decl" id="802last_pgdat" title='last_pgdat' data-type='pg_data_t *' data-ref="802last_pgdat">last_pgdat</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3629">3629</th><td></td></tr>
<tr><th id="3630">3630</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#1034" title="for (z = first_zones_zonelist(ac-&gt;zonelist, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z); zone; z = next_zones_zonelist(++z, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z))" data-ref="_M/for_each_zone_zonelist_nodemask">for_each_zone_zonelist_nodemask</a>(<a class="local col1 ref" href="#801zone" title='zone' data-ref="801zone">zone</a>, <a class="local col0 ref" href="#800z" title='z' data-ref="800z">z</a>, <a class="local col9 ref" href="#799ac" title='ac' data-ref="799ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>,</td></tr>
<tr><th id="3631">3631</th><td>					<a class="local col9 ref" href="#799ac" title='ac' data-ref="799ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>, <a class="local col9 ref" href="#799ac" title='ac' data-ref="799ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>) {</td></tr>
<tr><th id="3632">3632</th><td>		<b>if</b> (<a class="local col2 ref" href="#802last_pgdat" title='last_pgdat' data-ref="802last_pgdat">last_pgdat</a> != <a class="local col1 ref" href="#801zone" title='zone' data-ref="801zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>)</td></tr>
<tr><th id="3633">3633</th><td>			<a class="ref fn" href="../include/linux/mmzone.h.html#wakeup_kswapd" title='wakeup_kswapd' data-ref="wakeup_kswapd">wakeup_kswapd</a>(<a class="local col1 ref" href="#801zone" title='zone' data-ref="801zone">zone</a>, <a class="local col8 ref" href="#798order" title='order' data-ref="798order">order</a>, <a class="local col9 ref" href="#799ac" title='ac' data-ref="799ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>);</td></tr>
<tr><th id="3634">3634</th><td>		<a class="local col2 ref" href="#802last_pgdat" title='last_pgdat' data-ref="802last_pgdat">last_pgdat</a> = <a class="local col1 ref" href="#801zone" title='zone' data-ref="801zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>;</td></tr>
<tr><th id="3635">3635</th><td>	}</td></tr>
<tr><th id="3636">3636</th><td>}</td></tr>
<tr><th id="3637">3637</th><td></td></tr>
<tr><th id="3638">3638</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em></td></tr>
<tr><th id="3639">3639</th><td><dfn class="tu decl def fn" id="gfp_to_alloc_flags" title='gfp_to_alloc_flags' data-type='unsigned int gfp_to_alloc_flags(gfp_t gfp_mask)' data-ref="gfp_to_alloc_flags">gfp_to_alloc_flags</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col3 decl" id="803gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="803gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="3640">3640</th><td>{</td></tr>
<tr><th id="3641">3641</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="804alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="804alloc_flags">alloc_flags</dfn> = <a class="macro" href="internal.h.html#475" title="WMARK_MIN" data-ref="_M/ALLOC_WMARK_MIN">ALLOC_WMARK_MIN</a> | <a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>;</td></tr>
<tr><th id="3642">3642</th><td></td></tr>
<tr><th id="3643">3643</th><td>	<i>/* __GFP_HIGH is assumed to be the same as ALLOC_HIGH to save a branch. */</i></td></tr>
<tr><th id="3644">3644</th><td>	<a class="macro" href="../include/linux/build_bug.h.html#70" title="do { bool __cond = !(!((( gfp_t)0x20u) != ( gfp_t) 0x20)); extern void __compiletime_assert_3644(void) ; if (__cond) __compiletime_assert_3644(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0)" data-ref="_M/BUILD_BUG_ON">BUILD_BUG_ON</a>(<a class="macro" href="../include/linux/gfp.h.html#113" title="(( gfp_t)0x20u)" data-ref="_M/__GFP_HIGH">__GFP_HIGH</a> != (<a class="macro" href="../include/linux/compiler_types.h.html#33" title="" data-ref="_M/__force">__force</a> <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a>) <a class="macro" href="internal.h.html#495" title="0x20" data-ref="_M/ALLOC_HIGH">ALLOC_HIGH</a>);</td></tr>
<tr><th id="3645">3645</th><td></td></tr>
<tr><th id="3646">3646</th><td>	<i>/*</i></td></tr>
<tr><th id="3647">3647</th><td><i>	 * The caller may dip into page reserves a bit more if the caller</i></td></tr>
<tr><th id="3648">3648</th><td><i>	 * cannot run direct reclaim, or if the caller has realtime scheduling</i></td></tr>
<tr><th id="3649">3649</th><td><i>	 * policy or is asking for __GFP_HIGH memory.  GFP_ATOMIC requests will</i></td></tr>
<tr><th id="3650">3650</th><td><i>	 * set both ALLOC_HARDER (__GFP_ATOMIC) and ALLOC_HIGH (__GFP_HIGH).</i></td></tr>
<tr><th id="3651">3651</th><td><i>	 */</i></td></tr>
<tr><th id="3652">3652</th><td>	<a class="local col4 ref" href="#804alloc_flags" title='alloc_flags' data-ref="804alloc_flags">alloc_flags</a> |= (<a class="macro" href="../include/linux/compiler_types.h.html#33" title="" data-ref="_M/__force">__force</a> <em>int</em>) (<a class="local col3 ref" href="#803gfp_mask" title='gfp_mask' data-ref="803gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#113" title="(( gfp_t)0x20u)" data-ref="_M/__GFP_HIGH">__GFP_HIGH</a>);</td></tr>
<tr><th id="3653">3653</th><td></td></tr>
<tr><th id="3654">3654</th><td>	<b>if</b> (<a class="local col3 ref" href="#803gfp_mask" title='gfp_mask' data-ref="803gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#112" title="(( gfp_t)0x80000u)" data-ref="_M/__GFP_ATOMIC">__GFP_ATOMIC</a>) {</td></tr>
<tr><th id="3655">3655</th><td>		<i>/*</i></td></tr>
<tr><th id="3656">3656</th><td><i>		 * Not worth trying to allocate harder for __GFP_NOMEMALLOC even</i></td></tr>
<tr><th id="3657">3657</th><td><i>		 * if it can't schedule.</i></td></tr>
<tr><th id="3658">3658</th><td><i>		 */</i></td></tr>
<tr><th id="3659">3659</th><td>		<b>if</b> (!(<a class="local col3 ref" href="#803gfp_mask" title='gfp_mask' data-ref="803gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#115" title="(( gfp_t)0x10000u)" data-ref="_M/__GFP_NOMEMALLOC">__GFP_NOMEMALLOC</a>))</td></tr>
<tr><th id="3660">3660</th><td>			<a class="local col4 ref" href="#804alloc_flags" title='alloc_flags' data-ref="804alloc_flags">alloc_flags</a> |= <a class="macro" href="internal.h.html#494" title="0x10" data-ref="_M/ALLOC_HARDER">ALLOC_HARDER</a>;</td></tr>
<tr><th id="3661">3661</th><td>		<i>/*</i></td></tr>
<tr><th id="3662">3662</th><td><i>		 * Ignore cpuset mems for GFP_ATOMIC rather than fail, see the</i></td></tr>
<tr><th id="3663">3663</th><td><i>		 * comment for __cpuset_node_allowed().</i></td></tr>
<tr><th id="3664">3664</th><td><i>		 */</i></td></tr>
<tr><th id="3665">3665</th><td>		<a class="local col4 ref" href="#804alloc_flags" title='alloc_flags' data-ref="804alloc_flags">alloc_flags</a> &amp;= ~<a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>;</td></tr>
<tr><th id="3666">3666</th><td>	} <b>else</b> <b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(rt_task(get_current())), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/sched/rt.h.html#rt_task" title='rt_task' data-ref="rt_task">rt_task</a>(<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>)) &amp;&amp; !<a class="macro" href="../include/linux/preempt.h.html#103" title="((preempt_count() &amp; ((((1UL &lt;&lt; (4))-1) &lt;&lt; ((0 + 8) + 8)) | (((1UL &lt;&lt; (8))-1) &lt;&lt; (0 + 8)) | (((1UL &lt;&lt; (1))-1) &lt;&lt; (((0 + 8) + 8) + 4)))))" data-ref="_M/in_interrupt">in_interrupt</a>())</td></tr>
<tr><th id="3667">3667</th><td>		<a class="local col4 ref" href="#804alloc_flags" title='alloc_flags' data-ref="804alloc_flags">alloc_flags</a> |= <a class="macro" href="internal.h.html#494" title="0x10" data-ref="_M/ALLOC_HARDER">ALLOC_HARDER</a>;</td></tr>
<tr><th id="3668">3668</th><td></td></tr>
<tr><th id="3669">3669</th><td><u>#<span data-ppcond="3669">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="3670">3670</th><td>	<b>if</b> (gfpflags_to_migratetype(gfp_mask) == MIGRATE_MOVABLE)</td></tr>
<tr><th id="3671">3671</th><td>		alloc_flags |= ALLOC_CMA;</td></tr>
<tr><th id="3672">3672</th><td><u>#<span data-ppcond="3669">endif</span></u></td></tr>
<tr><th id="3673">3673</th><td>	<b>return</b> <a class="local col4 ref" href="#804alloc_flags" title='alloc_flags' data-ref="804alloc_flags">alloc_flags</a>;</td></tr>
<tr><th id="3674">3674</th><td>}</td></tr>
<tr><th id="3675">3675</th><td></td></tr>
<tr><th id="3676">3676</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="oom_reserves_allowed" title='oom_reserves_allowed' data-type='bool oom_reserves_allowed(struct task_struct * tsk)' data-ref="oom_reserves_allowed">oom_reserves_allowed</dfn>(<b>struct</b> <a class="type" href="../include/linux/sched.h.html#task_struct" title='task_struct' data-ref="task_struct">task_struct</a> *<dfn class="local col5 decl" id="805tsk" title='tsk' data-type='struct task_struct *' data-ref="805tsk">tsk</dfn>)</td></tr>
<tr><th id="3677">3677</th><td>{</td></tr>
<tr><th id="3678">3678</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/oom.h.html#tsk_is_oom_victim" title='tsk_is_oom_victim' data-ref="tsk_is_oom_victim">tsk_is_oom_victim</a>(<a class="local col5 ref" href="#805tsk" title='tsk' data-ref="805tsk">tsk</a>))</td></tr>
<tr><th id="3679">3679</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3680">3680</th><td></td></tr>
<tr><th id="3681">3681</th><td>	<i>/*</i></td></tr>
<tr><th id="3682">3682</th><td><i>	 * !MMU doesn't have oom reaper so give access to memory reserves</i></td></tr>
<tr><th id="3683">3683</th><td><i>	 * only to the thread with TIF_MEMDIE set</i></td></tr>
<tr><th id="3684">3684</th><td><i>	 */</i></td></tr>
<tr><th id="3685">3685</th><td>	<b>if</b> (!<a class="macro" href="../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../include/generated/autoconf.h.html#1307" title="1" data-ref="_M/CONFIG_MMU">CONFIG_MMU</a>) &amp;&amp; !<a class="macro" href="../include/linux/thread_info.h.html#90" title="test_ti_thread_flag(((struct thread_info *)get_current()), 20)" data-ref="_M/test_thread_flag">test_thread_flag</a>(<a class="macro" href="../arch/x86/include/asm/thread_info.h.html#95" title="20" data-ref="_M/TIF_MEMDIE">TIF_MEMDIE</a>))</td></tr>
<tr><th id="3686">3686</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3687">3687</th><td></td></tr>
<tr><th id="3688">3688</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3689">3689</th><td>}</td></tr>
<tr><th id="3690">3690</th><td></td></tr>
<tr><th id="3691">3691</th><td><i  data-doc="__gfp_pfmemalloc_flags">/*</i></td></tr>
<tr><th id="3692">3692</th><td><i  data-doc="__gfp_pfmemalloc_flags"> * Distinguish requests which really need access to full memory</i></td></tr>
<tr><th id="3693">3693</th><td><i  data-doc="__gfp_pfmemalloc_flags"> * reserves from oom victims which can live with a portion of it</i></td></tr>
<tr><th id="3694">3694</th><td><i  data-doc="__gfp_pfmemalloc_flags"> */</i></td></tr>
<tr><th id="3695">3695</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="__gfp_pfmemalloc_flags" title='__gfp_pfmemalloc_flags' data-type='int __gfp_pfmemalloc_flags(gfp_t gfp_mask)' data-ref="__gfp_pfmemalloc_flags">__gfp_pfmemalloc_flags</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col6 decl" id="806gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="806gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="3696">3696</th><td>{</td></tr>
<tr><th id="3697">3697</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(gfp_mask &amp; (( gfp_t)0x10000u)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col6 ref" href="#806gfp_mask" title='gfp_mask' data-ref="806gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#115" title="(( gfp_t)0x10000u)" data-ref="_M/__GFP_NOMEMALLOC">__GFP_NOMEMALLOC</a>))</td></tr>
<tr><th id="3698">3698</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3699">3699</th><td>	<b>if</b> (<a class="local col6 ref" href="#806gfp_mask" title='gfp_mask' data-ref="806gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#114" title="(( gfp_t)0x2000u)" data-ref="_M/__GFP_MEMALLOC">__GFP_MEMALLOC</a>)</td></tr>
<tr><th id="3700">3700</th><td>		<b>return</b> <a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a>;</td></tr>
<tr><th id="3701">3701</th><td>	<b>if</b> (<a class="macro" href="../include/linux/preempt.h.html#104" title="((preempt_count() &amp; (((1UL &lt;&lt; (8))-1) &lt;&lt; (0 + 8))) &amp; (1UL &lt;&lt; (0 + 8)))" data-ref="_M/in_serving_softirq">in_serving_softirq</a>() &amp;&amp; (<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; <a class="macro" href="../include/linux/sched.h.html#1345" title="0x00000800" data-ref="_M/PF_MEMALLOC">PF_MEMALLOC</a>))</td></tr>
<tr><th id="3702">3702</th><td>		<b>return</b> <a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a>;</td></tr>
<tr><th id="3703">3703</th><td>	<b>if</b> (!<a class="macro" href="../include/linux/preempt.h.html#103" title="((preempt_count() &amp; ((((1UL &lt;&lt; (4))-1) &lt;&lt; ((0 + 8) + 8)) | (((1UL &lt;&lt; (8))-1) &lt;&lt; (0 + 8)) | (((1UL &lt;&lt; (1))-1) &lt;&lt; (((0 + 8) + 8) + 4)))))" data-ref="_M/in_interrupt">in_interrupt</a>()) {</td></tr>
<tr><th id="3704">3704</th><td>		<b>if</b> (<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; <a class="macro" href="../include/linux/sched.h.html#1345" title="0x00000800" data-ref="_M/PF_MEMALLOC">PF_MEMALLOC</a>)</td></tr>
<tr><th id="3705">3705</th><td>			<b>return</b> <a class="macro" href="internal.h.html#478" title="0x04" data-ref="_M/ALLOC_NO_WATERMARKS">ALLOC_NO_WATERMARKS</a>;</td></tr>
<tr><th id="3706">3706</th><td>		<b>else</b> <b>if</b> (<a class="tu ref fn" href="#oom_reserves_allowed" title='oom_reserves_allowed' data-use='c' data-ref="oom_reserves_allowed">oom_reserves_allowed</a>(<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>))</td></tr>
<tr><th id="3707">3707</th><td>			<b>return</b> <a class="macro" href="internal.h.html#489" title="0x08" data-ref="_M/ALLOC_OOM">ALLOC_OOM</a>;</td></tr>
<tr><th id="3708">3708</th><td>	}</td></tr>
<tr><th id="3709">3709</th><td></td></tr>
<tr><th id="3710">3710</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3711">3711</th><td>}</td></tr>
<tr><th id="3712">3712</th><td></td></tr>
<tr><th id="3713">3713</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="gfp_pfmemalloc_allowed" title='gfp_pfmemalloc_allowed' data-ref="gfp_pfmemalloc_allowed">gfp_pfmemalloc_allowed</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col7 decl" id="807gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="807gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="3714">3714</th><td>{</td></tr>
<tr><th id="3715">3715</th><td>	<b>return</b> !!<a class="tu ref fn" href="#__gfp_pfmemalloc_flags" title='__gfp_pfmemalloc_flags' data-use='c' data-ref="__gfp_pfmemalloc_flags">__gfp_pfmemalloc_flags</a>(<a class="local col7 ref" href="#807gfp_mask" title='gfp_mask' data-ref="807gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="3716">3716</th><td>}</td></tr>
<tr><th id="3717">3717</th><td></td></tr>
<tr><th id="3718">3718</th><td><i  data-doc="should_reclaim_retry">/*</i></td></tr>
<tr><th id="3719">3719</th><td><i  data-doc="should_reclaim_retry"> * Checks whether it makes sense to retry the reclaim to make a forward progress</i></td></tr>
<tr><th id="3720">3720</th><td><i  data-doc="should_reclaim_retry"> * for the given allocation request.</i></td></tr>
<tr><th id="3721">3721</th><td><i  data-doc="should_reclaim_retry"> *</i></td></tr>
<tr><th id="3722">3722</th><td><i  data-doc="should_reclaim_retry"> * We give up when we either have tried MAX_RECLAIM_RETRIES in a row</i></td></tr>
<tr><th id="3723">3723</th><td><i  data-doc="should_reclaim_retry"> * without success, or when we couldn't even meet the watermark if we</i></td></tr>
<tr><th id="3724">3724</th><td><i  data-doc="should_reclaim_retry"> * reclaimed all remaining pages on the LRU lists.</i></td></tr>
<tr><th id="3725">3725</th><td><i  data-doc="should_reclaim_retry"> *</i></td></tr>
<tr><th id="3726">3726</th><td><i  data-doc="should_reclaim_retry"> * Returns true if a retry is viable or false to enter the oom path.</i></td></tr>
<tr><th id="3727">3727</th><td><i  data-doc="should_reclaim_retry"> */</i></td></tr>
<tr><th id="3728">3728</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a></td></tr>
<tr><th id="3729">3729</th><td><dfn class="tu decl def fn" id="should_reclaim_retry" title='should_reclaim_retry' data-type='bool should_reclaim_retry(gfp_t gfp_mask, unsigned int order, struct alloc_context * ac, int alloc_flags, bool did_some_progress, int * no_progress_loops)' data-ref="should_reclaim_retry">should_reclaim_retry</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col8 decl" id="808gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="808gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <dfn class="local col9 decl" id="809order" title='order' data-type='unsigned int' data-ref="809order">order</dfn>,</td></tr>
<tr><th id="3730">3730</th><td>		     <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col0 decl" id="810ac" title='ac' data-type='struct alloc_context *' data-ref="810ac">ac</dfn>, <em>int</em> <dfn class="local col1 decl" id="811alloc_flags" title='alloc_flags' data-type='int' data-ref="811alloc_flags">alloc_flags</dfn>,</td></tr>
<tr><th id="3731">3731</th><td>		     <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col2 decl" id="812did_some_progress" title='did_some_progress' data-type='bool' data-ref="812did_some_progress">did_some_progress</dfn>, <em>int</em> *<dfn class="local col3 decl" id="813no_progress_loops" title='no_progress_loops' data-type='int *' data-ref="813no_progress_loops">no_progress_loops</dfn>)</td></tr>
<tr><th id="3732">3732</th><td>{</td></tr>
<tr><th id="3733">3733</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="814zone" title='zone' data-type='struct zone *' data-ref="814zone">zone</dfn>;</td></tr>
<tr><th id="3734">3734</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col5 decl" id="815z" title='z' data-type='struct zoneref *' data-ref="815z">z</dfn>;</td></tr>
<tr><th id="3735">3735</th><td></td></tr>
<tr><th id="3736">3736</th><td>	<i>/*</i></td></tr>
<tr><th id="3737">3737</th><td><i>	 * Costly allocations might have made a progress but this doesn't mean</i></td></tr>
<tr><th id="3738">3738</th><td><i>	 * their order will become available due to high fragmentation so</i></td></tr>
<tr><th id="3739">3739</th><td><i>	 * always increment the no progress counter for them</i></td></tr>
<tr><th id="3740">3740</th><td><i>	 */</i></td></tr>
<tr><th id="3741">3741</th><td>	<b>if</b> (<a class="local col2 ref" href="#812did_some_progress" title='did_some_progress' data-ref="812did_some_progress">did_some_progress</a> &amp;&amp; <a class="local col9 ref" href="#809order" title='order' data-ref="809order">order</a> &lt;= <a class="macro" href="../include/linux/mmzone.h.html#37" title="3" data-ref="_M/PAGE_ALLOC_COSTLY_ORDER">PAGE_ALLOC_COSTLY_ORDER</a>)</td></tr>
<tr><th id="3742">3742</th><td>		*<a class="local col3 ref" href="#813no_progress_loops" title='no_progress_loops' data-ref="813no_progress_loops">no_progress_loops</a> = <var>0</var>;</td></tr>
<tr><th id="3743">3743</th><td>	<b>else</b></td></tr>
<tr><th id="3744">3744</th><td>		(*<a class="local col3 ref" href="#813no_progress_loops" title='no_progress_loops' data-ref="813no_progress_loops">no_progress_loops</a>)++;</td></tr>
<tr><th id="3745">3745</th><td></td></tr>
<tr><th id="3746">3746</th><td>	<i>/*</i></td></tr>
<tr><th id="3747">3747</th><td><i>	 * Make sure we converge to OOM if we cannot make any progress</i></td></tr>
<tr><th id="3748">3748</th><td><i>	 * several times in the row.</i></td></tr>
<tr><th id="3749">3749</th><td><i>	 */</i></td></tr>
<tr><th id="3750">3750</th><td>	<b>if</b> (*<a class="local col3 ref" href="#813no_progress_loops" title='no_progress_loops' data-ref="813no_progress_loops">no_progress_loops</a> &gt; <a class="macro" href="internal.h.html#87" title="16" data-ref="_M/MAX_RECLAIM_RETRIES">MAX_RECLAIM_RETRIES</a>) {</td></tr>
<tr><th id="3751">3751</th><td>		<i>/* Before OOM, exhaust highatomic_reserve */</i></td></tr>
<tr><th id="3752">3752</th><td>		<b>return</b> <a class="tu ref fn" href="#unreserve_highatomic_pageblock" title='unreserve_highatomic_pageblock' data-use='c' data-ref="unreserve_highatomic_pageblock">unreserve_highatomic_pageblock</a>(<a class="local col0 ref" href="#810ac" title='ac' data-ref="810ac">ac</a>, <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>);</td></tr>
<tr><th id="3753">3753</th><td>	}</td></tr>
<tr><th id="3754">3754</th><td></td></tr>
<tr><th id="3755">3755</th><td>	<i>/*</i></td></tr>
<tr><th id="3756">3756</th><td><i>	 * Keep reclaiming pages while there is a chance this will lead</i></td></tr>
<tr><th id="3757">3757</th><td><i>	 * somewhere.  If none of the target zones can satisfy our allocation</i></td></tr>
<tr><th id="3758">3758</th><td><i>	 * request even if all reclaimable pages are considered then we are</i></td></tr>
<tr><th id="3759">3759</th><td><i>	 * screwed and have to go OOM.</i></td></tr>
<tr><th id="3760">3760</th><td><i>	 */</i></td></tr>
<tr><th id="3761">3761</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#1034" title="for (z = first_zones_zonelist(ac-&gt;zonelist, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z); zone; z = next_zones_zonelist(++z, ac-&gt;high_zoneidx, ac-&gt;nodemask), zone = zonelist_zone(z))" data-ref="_M/for_each_zone_zonelist_nodemask">for_each_zone_zonelist_nodemask</a>(<a class="local col4 ref" href="#814zone" title='zone' data-ref="814zone">zone</a>, <a class="local col5 ref" href="#815z" title='z' data-ref="815z">z</a>, <a class="local col0 ref" href="#810ac" title='ac' data-ref="810ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>, <a class="local col0 ref" href="#810ac" title='ac' data-ref="810ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>,</td></tr>
<tr><th id="3762">3762</th><td>					<a class="local col0 ref" href="#810ac" title='ac' data-ref="810ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>) {</td></tr>
<tr><th id="3763">3763</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="816available" title='available' data-type='unsigned long' data-ref="816available">available</dfn>;</td></tr>
<tr><th id="3764">3764</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="817reclaimable" title='reclaimable' data-type='unsigned long' data-ref="817reclaimable">reclaimable</dfn>;</td></tr>
<tr><th id="3765">3765</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="818min_wmark" title='min_wmark' data-type='unsigned long' data-ref="818min_wmark">min_wmark</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#269" title="(zone-&gt;watermark[WMARK_MIN])" data-ref="_M/min_wmark_pages">min_wmark_pages</a>(<a class="local col4 ref" href="#814zone" title='zone' data-ref="814zone">zone</a>);</td></tr>
<tr><th id="3766">3766</th><td>		<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col9 decl" id="819wmark" title='wmark' data-type='bool' data-ref="819wmark">wmark</dfn>;</td></tr>
<tr><th id="3767">3767</th><td></td></tr>
<tr><th id="3768">3768</th><td>		<a class="local col6 ref" href="#816available" title='available' data-ref="816available">available</a> = <a class="local col7 ref" href="#817reclaimable" title='reclaimable' data-ref="817reclaimable">reclaimable</a> = <a class="ref fn" href="../include/linux/swap.h.html#zone_reclaimable_pages" title='zone_reclaimable_pages' data-ref="zone_reclaimable_pages">zone_reclaimable_pages</a>(<a class="local col4 ref" href="#814zone" title='zone' data-ref="814zone">zone</a>);</td></tr>
<tr><th id="3769">3769</th><td>		<a class="local col6 ref" href="#816available" title='available' data-ref="816available">available</a> += <a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state_snapshot" title='zone_page_state_snapshot' data-ref="zone_page_state_snapshot">zone_page_state_snapshot</a>(<a class="local col4 ref" href="#814zone" title='zone' data-ref="814zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>);</td></tr>
<tr><th id="3770">3770</th><td></td></tr>
<tr><th id="3771">3771</th><td>		<i>/*</i></td></tr>
<tr><th id="3772">3772</th><td><i>		 * Would the allocation succeed if we reclaimed all</i></td></tr>
<tr><th id="3773">3773</th><td><i>		 * reclaimable pages?</i></td></tr>
<tr><th id="3774">3774</th><td><i>		 */</i></td></tr>
<tr><th id="3775">3775</th><td>		<a class="local col9 ref" href="#819wmark" title='wmark' data-ref="819wmark">wmark</a> = <a class="ref fn" href="#__zone_watermark_ok" title='__zone_watermark_ok' data-ref="__zone_watermark_ok">__zone_watermark_ok</a>(<a class="local col4 ref" href="#814zone" title='zone' data-ref="814zone">zone</a>, <a class="local col9 ref" href="#809order" title='order' data-ref="809order">order</a>, <a class="local col8 ref" href="#818min_wmark" title='min_wmark' data-ref="818min_wmark">min_wmark</a>,</td></tr>
<tr><th id="3776">3776</th><td>				<a class="macro" href="internal.h.html#126" title="zonelist_zone_idx(ac-&gt;preferred_zoneref)" data-ref="_M/ac_classzone_idx">ac_classzone_idx</a>(<a class="local col0 ref" href="#810ac" title='ac' data-ref="810ac">ac</a>), <a class="local col1 ref" href="#811alloc_flags" title='alloc_flags' data-ref="811alloc_flags">alloc_flags</a>, <a class="local col6 ref" href="#816available" title='available' data-ref="816available">available</a>);</td></tr>
<tr><th id="3777">3777</th><td>		<a class="ref fn" href="../include/trace/events/oom.h.html#32" title='trace_reclaim_retry_zone' data-ref="trace_reclaim_retry_zone">trace_reclaim_retry_zone</a>(<a class="local col5 ref" href="#815z" title='z' data-ref="815z">z</a>, <a class="local col9 ref" href="#809order" title='order' data-ref="809order">order</a>, <a class="local col7 ref" href="#817reclaimable" title='reclaimable' data-ref="817reclaimable">reclaimable</a>,</td></tr>
<tr><th id="3778">3778</th><td>				<a class="local col6 ref" href="#816available" title='available' data-ref="816available">available</a>, <a class="local col8 ref" href="#818min_wmark" title='min_wmark' data-ref="818min_wmark">min_wmark</a>, *<a class="local col3 ref" href="#813no_progress_loops" title='no_progress_loops' data-ref="813no_progress_loops">no_progress_loops</a>, <a class="local col9 ref" href="#819wmark" title='wmark' data-ref="819wmark">wmark</a>);</td></tr>
<tr><th id="3779">3779</th><td>		<b>if</b> (<a class="local col9 ref" href="#819wmark" title='wmark' data-ref="819wmark">wmark</a>) {</td></tr>
<tr><th id="3780">3780</th><td>			<i>/*</i></td></tr>
<tr><th id="3781">3781</th><td><i>			 * If we didn't make any progress and have a lot of</i></td></tr>
<tr><th id="3782">3782</th><td><i>			 * dirty + writeback pages then we should wait for</i></td></tr>
<tr><th id="3783">3783</th><td><i>			 * an IO to complete to slow down the reclaim and</i></td></tr>
<tr><th id="3784">3784</th><td><i>			 * prevent from pre mature OOM</i></td></tr>
<tr><th id="3785">3785</th><td><i>			 */</i></td></tr>
<tr><th id="3786">3786</th><td>			<b>if</b> (!<a class="local col2 ref" href="#812did_some_progress" title='did_some_progress' data-ref="812did_some_progress">did_some_progress</a>) {</td></tr>
<tr><th id="3787">3787</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="820write_pending" title='write_pending' data-type='unsigned long' data-ref="820write_pending">write_pending</dfn>;</td></tr>
<tr><th id="3788">3788</th><td></td></tr>
<tr><th id="3789">3789</th><td>				<a class="local col0 ref" href="#820write_pending" title='write_pending' data-ref="820write_pending">write_pending</a> = <a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state_snapshot" title='zone_page_state_snapshot' data-ref="zone_page_state_snapshot">zone_page_state_snapshot</a>(<a class="local col4 ref" href="#814zone" title='zone' data-ref="814zone">zone</a>,</td></tr>
<tr><th id="3790">3790</th><td>							<a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_WRITE_PENDING" title='NR_ZONE_WRITE_PENDING' data-ref="NR_ZONE_WRITE_PENDING">NR_ZONE_WRITE_PENDING</a>);</td></tr>
<tr><th id="3791">3791</th><td></td></tr>
<tr><th id="3792">3792</th><td>				<b>if</b> (<var>2</var> * <a class="local col0 ref" href="#820write_pending" title='write_pending' data-ref="820write_pending">write_pending</a> &gt; <a class="local col7 ref" href="#817reclaimable" title='reclaimable' data-ref="817reclaimable">reclaimable</a>) {</td></tr>
<tr><th id="3793">3793</th><td>					<a class="ref fn" href="../include/linux/backing-dev.h.html#congestion_wait" title='congestion_wait' data-ref="congestion_wait">congestion_wait</a>(<a class="enum" href="../include/linux/backing-dev-defs.h.html#BLK_RW_ASYNC" title='BLK_RW_ASYNC' data-ref="BLK_RW_ASYNC">BLK_RW_ASYNC</a>, <a class="macro" href="../include/asm-generic/param.h.html#8" title="100" data-ref="_M/HZ">HZ</a>/<var>10</var>);</td></tr>
<tr><th id="3794">3794</th><td>					<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3795">3795</th><td>				}</td></tr>
<tr><th id="3796">3796</th><td>			}</td></tr>
<tr><th id="3797">3797</th><td></td></tr>
<tr><th id="3798">3798</th><td>			<i>/*</i></td></tr>
<tr><th id="3799">3799</th><td><i>			 * Memory allocation/reclaim might be called from a WQ</i></td></tr>
<tr><th id="3800">3800</th><td><i>			 * context and the current implementation of the WQ</i></td></tr>
<tr><th id="3801">3801</th><td><i>			 * concurrency control doesn't recognize that</i></td></tr>
<tr><th id="3802">3802</th><td><i>			 * a particular WQ is congested if the worker thread is</i></td></tr>
<tr><th id="3803">3803</th><td><i>			 * looping without ever sleeping. Therefore we have to</i></td></tr>
<tr><th id="3804">3804</th><td><i>			 * do a short sleep here rather than calling</i></td></tr>
<tr><th id="3805">3805</th><td><i>			 * cond_resched().</i></td></tr>
<tr><th id="3806">3806</th><td><i>			 */</i></td></tr>
<tr><th id="3807">3807</th><td>			<b>if</b> (<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; <a class="macro" href="../include/linux/sched.h.html#1339" title="0x00000020" data-ref="_M/PF_WQ_WORKER">PF_WQ_WORKER</a>)</td></tr>
<tr><th id="3808">3808</th><td>				<a class="ref fn" href="../include/linux/sched.h.html#schedule_timeout_uninterruptible" title='schedule_timeout_uninterruptible' data-ref="schedule_timeout_uninterruptible">schedule_timeout_uninterruptible</a>(<var>1</var>);</td></tr>
<tr><th id="3809">3809</th><td>			<b>else</b></td></tr>
<tr><th id="3810">3810</th><td>				<a class="macro" href="../include/linux/sched.h.html#1627" title="({ ___might_sleep(&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;, 3810, 0); _cond_resched(); })" data-ref="_M/cond_resched">cond_resched</a>();</td></tr>
<tr><th id="3811">3811</th><td></td></tr>
<tr><th id="3812">3812</th><td>			<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3813">3813</th><td>		}</td></tr>
<tr><th id="3814">3814</th><td>	}</td></tr>
<tr><th id="3815">3815</th><td></td></tr>
<tr><th id="3816">3816</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3817">3817</th><td>}</td></tr>
<tr><th id="3818">3818</th><td></td></tr>
<tr><th id="3819">3819</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a></td></tr>
<tr><th id="3820">3820</th><td><dfn class="tu decl def fn" id="check_retry_cpuset" title='check_retry_cpuset' data-type='bool check_retry_cpuset(int cpuset_mems_cookie, struct alloc_context * ac)' data-ref="check_retry_cpuset">check_retry_cpuset</dfn>(<em>int</em> <dfn class="local col1 decl" id="821cpuset_mems_cookie" title='cpuset_mems_cookie' data-type='int' data-ref="821cpuset_mems_cookie">cpuset_mems_cookie</dfn>, <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col2 decl" id="822ac" title='ac' data-type='struct alloc_context *' data-ref="822ac">ac</dfn>)</td></tr>
<tr><th id="3821">3821</th><td>{</td></tr>
<tr><th id="3822">3822</th><td>	<i>/*</i></td></tr>
<tr><th id="3823">3823</th><td><i>	 * It's possible that cpuset's mems_allowed and the nodemask from</i></td></tr>
<tr><th id="3824">3824</th><td><i>	 * mempolicy don't intersect. This should be normally dealt with by</i></td></tr>
<tr><th id="3825">3825</th><td><i>	 * policy_nodemask(), but it's possible to race with cpuset update in</i></td></tr>
<tr><th id="3826">3826</th><td><i>	 * such a way the check therein was true, and then it became false</i></td></tr>
<tr><th id="3827">3827</th><td><i>	 * before we got our cpuset_mems_cookie here.</i></td></tr>
<tr><th id="3828">3828</th><td><i>	 * This assumes that for all allocations, ac-&gt;nodemask can come only</i></td></tr>
<tr><th id="3829">3829</th><td><i>	 * from MPOL_BIND mempolicy (whose documented semantics is to be ignored</i></td></tr>
<tr><th id="3830">3830</th><td><i>	 * when it does not intersect with the cpuset restrictions) or the</i></td></tr>
<tr><th id="3831">3831</th><td><i>	 * caller can deal with a violated nodemask.</i></td></tr>
<tr><th id="3832">3832</th><td><i>	 */</i></td></tr>
<tr><th id="3833">3833</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/cpuset.h.html#cpusets_enabled" title='cpusets_enabled' data-ref="cpusets_enabled">cpusets_enabled</a>() &amp;&amp; <a class="local col2 ref" href="#822ac" title='ac' data-ref="822ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a> &amp;&amp;</td></tr>
<tr><th id="3834">3834</th><td>			!<a class="ref fn" href="../include/linux/cpuset.h.html#cpuset_nodemask_valid_mems_allowed" title='cpuset_nodemask_valid_mems_allowed' data-ref="cpuset_nodemask_valid_mems_allowed">cpuset_nodemask_valid_mems_allowed</a>(<a class="local col2 ref" href="#822ac" title='ac' data-ref="822ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>)) {</td></tr>
<tr><th id="3835">3835</th><td>		<a class="local col2 ref" href="#822ac" title='ac' data-ref="822ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3836">3836</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3837">3837</th><td>	}</td></tr>
<tr><th id="3838">3838</th><td></td></tr>
<tr><th id="3839">3839</th><td>	<i>/*</i></td></tr>
<tr><th id="3840">3840</th><td><i>	 * When updating a task's mems_allowed or mempolicy nodemask, it is</i></td></tr>
<tr><th id="3841">3841</th><td><i>	 * possible to race with parallel threads in such a way that our</i></td></tr>
<tr><th id="3842">3842</th><td><i>	 * allocation can fail while the mask is being updated. If we are about</i></td></tr>
<tr><th id="3843">3843</th><td><i>	 * to fail, check if the cpuset changed during allocation and if so,</i></td></tr>
<tr><th id="3844">3844</th><td><i>	 * retry.</i></td></tr>
<tr><th id="3845">3845</th><td><i>	 */</i></td></tr>
<tr><th id="3846">3846</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/cpuset.h.html#read_mems_allowed_retry" title='read_mems_allowed_retry' data-ref="read_mems_allowed_retry">read_mems_allowed_retry</a>(<a class="local col1 ref" href="#821cpuset_mems_cookie" title='cpuset_mems_cookie' data-ref="821cpuset_mems_cookie">cpuset_mems_cookie</a>))</td></tr>
<tr><th id="3847">3847</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="3848">3848</th><td></td></tr>
<tr><th id="3849">3849</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="3850">3850</th><td>}</td></tr>
<tr><th id="3851">3851</th><td></td></tr>
<tr><th id="3852">3852</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="3853">3853</th><td><dfn class="tu decl def fn" id="__alloc_pages_slowpath" title='__alloc_pages_slowpath' data-type='struct page * __alloc_pages_slowpath(gfp_t gfp_mask, unsigned int order, struct alloc_context * ac)' data-ref="__alloc_pages_slowpath">__alloc_pages_slowpath</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col3 decl" id="823gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="823gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="824order" title='order' data-type='unsigned int' data-ref="824order">order</dfn>,</td></tr>
<tr><th id="3854">3854</th><td>						<b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col5 decl" id="825ac" title='ac' data-type='struct alloc_context *' data-ref="825ac">ac</dfn>)</td></tr>
<tr><th id="3855">3855</th><td>{</td></tr>
<tr><th id="3856">3856</th><td>	<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col6 decl" id="826can_direct_reclaim" title='can_direct_reclaim' data-type='bool' data-ref="826can_direct_reclaim">can_direct_reclaim</dfn> = <a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#185" title="(( gfp_t)0x400000u)" data-ref="_M/__GFP_DIRECT_RECLAIM">__GFP_DIRECT_RECLAIM</a>;</td></tr>
<tr><th id="3857">3857</th><td>	<em>const</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col7 decl" id="827costly_order" title='costly_order' data-type='const bool' data-ref="827costly_order">costly_order</dfn> = <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a> &gt; <a class="macro" href="../include/linux/mmzone.h.html#37" title="3" data-ref="_M/PAGE_ALLOC_COSTLY_ORDER">PAGE_ALLOC_COSTLY_ORDER</a>;</td></tr>
<tr><th id="3858">3858</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="828page" title='page' data-type='struct page *' data-ref="828page">page</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3859">3859</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="829alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="829alloc_flags">alloc_flags</dfn>;</td></tr>
<tr><th id="3860">3860</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="830did_some_progress" title='did_some_progress' data-type='unsigned long' data-ref="830did_some_progress">did_some_progress</dfn>;</td></tr>
<tr><th id="3861">3861</th><td>	<b>enum</b> <a class="type" href="../include/linux/compaction.h.html#compact_priority" title='compact_priority' data-ref="compact_priority">compact_priority</a> <dfn class="local col1 decl" id="831compact_priority" title='compact_priority' data-type='enum compact_priority' data-ref="831compact_priority">compact_priority</dfn>;</td></tr>
<tr><th id="3862">3862</th><td>	<b>enum</b> <a class="type" href="../include/linux/compaction.h.html#compact_result" title='compact_result' data-ref="compact_result">compact_result</a> <dfn class="local col2 decl" id="832compact_result" title='compact_result' data-type='enum compact_result' data-ref="832compact_result">compact_result</dfn>;</td></tr>
<tr><th id="3863">3863</th><td>	<em>int</em> <dfn class="local col3 decl" id="833compaction_retries" title='compaction_retries' data-type='int' data-ref="833compaction_retries">compaction_retries</dfn>;</td></tr>
<tr><th id="3864">3864</th><td>	<em>int</em> <dfn class="local col4 decl" id="834no_progress_loops" title='no_progress_loops' data-type='int' data-ref="834no_progress_loops">no_progress_loops</dfn>;</td></tr>
<tr><th id="3865">3865</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="835alloc_start" title='alloc_start' data-type='unsigned long' data-ref="835alloc_start">alloc_start</dfn> = <a class="ref" href="../include/linux/jiffies.h.html#jiffies" title='jiffies' data-ref="jiffies">jiffies</a>;</td></tr>
<tr><th id="3866">3866</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="836stall_timeout" title='stall_timeout' data-type='unsigned int' data-ref="836stall_timeout">stall_timeout</dfn> = <var>10</var> * <a class="macro" href="../include/asm-generic/param.h.html#8" title="100" data-ref="_M/HZ">HZ</a>;</td></tr>
<tr><th id="3867">3867</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="837cpuset_mems_cookie" title='cpuset_mems_cookie' data-type='unsigned int' data-ref="837cpuset_mems_cookie">cpuset_mems_cookie</dfn>;</td></tr>
<tr><th id="3868">3868</th><td>	<em>int</em> <dfn class="local col8 decl" id="838reserve_flags" title='reserve_flags' data-type='int' data-ref="838reserve_flags">reserve_flags</dfn>;</td></tr>
<tr><th id="3869">3869</th><td></td></tr>
<tr><th id="3870">3870</th><td>	<i>/*</i></td></tr>
<tr><th id="3871">3871</th><td><i>	 * In the slowpath, we sanity check order to avoid ever trying to</i></td></tr>
<tr><th id="3872">3872</th><td><i>	 * reclaim &gt;= MAX_ORDER areas which will never succeed. Callers may</i></td></tr>
<tr><th id="3873">3873</th><td><i>	 * be using allocators in order of preference for an area that is</i></td></tr>
<tr><th id="3874">3874</th><td><i>	 * too large.</i></td></tr>
<tr><th id="3875">3875</th><td><i>	 */</i></td></tr>
<tr><th id="3876">3876</th><td>	<b>if</b> (<a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a> &gt;= <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>) {</td></tr>
<tr><th id="3877">3877</th><td>		<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!(!(gfp_mask &amp; (( gfp_t)0x200u))); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (3877), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (169)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>(!(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#205" title="(( gfp_t)0x200u)" data-ref="_M/__GFP_NOWARN">__GFP_NOWARN</a>));</td></tr>
<tr><th id="3878">3878</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="3879">3879</th><td>	}</td></tr>
<tr><th id="3880">3880</th><td></td></tr>
<tr><th id="3881">3881</th><td>	<i>/*</i></td></tr>
<tr><th id="3882">3882</th><td><i>	 * We also sanity check to catch abuse of atomic reserves being used by</i></td></tr>
<tr><th id="3883">3883</th><td><i>	 * callers that are not in atomic context.</i></td></tr>
<tr><th id="3884">3884</th><td><i>	 */</i></td></tr>
<tr><th id="3885">3885</th><td>	<b>if</b> (<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!((gfp_mask &amp; ((( gfp_t)0x80000u)|(( gfp_t)0x400000u))) == ((( gfp_t)0x80000u)|(( gfp_t)0x400000u))); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (3886), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (171)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>((<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; (<a class="macro" href="../include/linux/gfp.h.html#112" title="(( gfp_t)0x80000u)" data-ref="_M/__GFP_ATOMIC">__GFP_ATOMIC</a>|<a class="macro" href="../include/linux/gfp.h.html#185" title="(( gfp_t)0x400000u)" data-ref="_M/__GFP_DIRECT_RECLAIM">__GFP_DIRECT_RECLAIM</a>)) ==</td></tr>
<tr><th id="3886">3886</th><td>				(<a class="macro" href="../include/linux/gfp.h.html#112" title="(( gfp_t)0x80000u)" data-ref="_M/__GFP_ATOMIC">__GFP_ATOMIC</a>|<a class="macro" href="../include/linux/gfp.h.html#185" title="(( gfp_t)0x400000u)" data-ref="_M/__GFP_DIRECT_RECLAIM">__GFP_DIRECT_RECLAIM</a>)))</td></tr>
<tr><th id="3887">3887</th><td>		<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp;= ~<a class="macro" href="../include/linux/gfp.h.html#112" title="(( gfp_t)0x80000u)" data-ref="_M/__GFP_ATOMIC">__GFP_ATOMIC</a>;</td></tr>
<tr><th id="3888">3888</th><td></td></tr>
<tr><th id="3889">3889</th><td><dfn class="lbl" id="839retry_cpuset" data-ref="839retry_cpuset">retry_cpuset</dfn>:</td></tr>
<tr><th id="3890">3890</th><td>	<a class="local col3 ref" href="#833compaction_retries" title='compaction_retries' data-ref="833compaction_retries">compaction_retries</a> = <var>0</var>;</td></tr>
<tr><th id="3891">3891</th><td>	<a class="local col4 ref" href="#834no_progress_loops" title='no_progress_loops' data-ref="834no_progress_loops">no_progress_loops</a> = <var>0</var>;</td></tr>
<tr><th id="3892">3892</th><td>	<a class="local col1 ref" href="#831compact_priority" title='compact_priority' data-ref="831compact_priority">compact_priority</a> = <a class="enum" href="../include/linux/compaction.h.html#DEF_COMPACT_PRIORITY" title='DEF_COMPACT_PRIORITY' data-ref="DEF_COMPACT_PRIORITY">DEF_COMPACT_PRIORITY</a>;</td></tr>
<tr><th id="3893">3893</th><td>	<a class="local col7 ref" href="#837cpuset_mems_cookie" title='cpuset_mems_cookie' data-ref="837cpuset_mems_cookie">cpuset_mems_cookie</a> = <a class="ref fn" href="../include/linux/cpuset.h.html#read_mems_allowed_begin" title='read_mems_allowed_begin' data-ref="read_mems_allowed_begin">read_mems_allowed_begin</a>();</td></tr>
<tr><th id="3894">3894</th><td></td></tr>
<tr><th id="3895">3895</th><td>	<i>/*</i></td></tr>
<tr><th id="3896">3896</th><td><i>	 * The fast path uses conservative alloc_flags to succeed only until</i></td></tr>
<tr><th id="3897">3897</th><td><i>	 * kswapd needs to be woken up, and to avoid the cost of setting up</i></td></tr>
<tr><th id="3898">3898</th><td><i>	 * alloc_flags precisely. So we do that now.</i></td></tr>
<tr><th id="3899">3899</th><td><i>	 */</i></td></tr>
<tr><th id="3900">3900</th><td>	<a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a> = <a class="tu ref fn" href="#gfp_to_alloc_flags" title='gfp_to_alloc_flags' data-use='c' data-ref="gfp_to_alloc_flags">gfp_to_alloc_flags</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="3901">3901</th><td></td></tr>
<tr><th id="3902">3902</th><td>	<i>/*</i></td></tr>
<tr><th id="3903">3903</th><td><i>	 * We need to recalculate the starting point for the zonelist iterator</i></td></tr>
<tr><th id="3904">3904</th><td><i>	 * because we might have used different nodemask in the fast path, or</i></td></tr>
<tr><th id="3905">3905</th><td><i>	 * there was a cpuset modification and we are retrying - otherwise we</i></td></tr>
<tr><th id="3906">3906</th><td><i>	 * could end up iterating over non-eligible zones endlessly.</i></td></tr>
<tr><th id="3907">3907</th><td><i>	 */</i></td></tr>
<tr><th id="3908">3908</th><td>	<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a> = <a class="ref fn" href="../include/linux/mmzone.h.html#first_zones_zonelist" title='first_zones_zonelist' data-ref="first_zones_zonelist">first_zones_zonelist</a>(<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>,</td></tr>
<tr><th id="3909">3909</th><td>					<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>);</td></tr>
<tr><th id="3910">3910</th><td>	<b>if</b> (!<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone" title='zoneref::zone' data-ref="zoneref::zone">zone</a>)</td></tr>
<tr><th id="3911">3911</th><td>		<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="3912">3912</th><td></td></tr>
<tr><th id="3913">3913</th><td>	<b>if</b> (<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#186" title="(( gfp_t)0x1000000u)" data-ref="_M/__GFP_KSWAPD_RECLAIM">__GFP_KSWAPD_RECLAIM</a>)</td></tr>
<tr><th id="3914">3914</th><td>		<a class="tu ref fn" href="#wake_all_kswapds" title='wake_all_kswapds' data-use='c' data-ref="wake_all_kswapds">wake_all_kswapds</a>(<a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>);</td></tr>
<tr><th id="3915">3915</th><td></td></tr>
<tr><th id="3916">3916</th><td>	<i>/*</i></td></tr>
<tr><th id="3917">3917</th><td><i>	 * The adjusted alloc_flags might result in immediate success, so try</i></td></tr>
<tr><th id="3918">3918</th><td><i>	 * that first</i></td></tr>
<tr><th id="3919">3919</th><td><i>	 */</i></td></tr>
<tr><th id="3920">3920</th><td>	<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>);</td></tr>
<tr><th id="3921">3921</th><td>	<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="3922">3922</th><td>		<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="3923">3923</th><td></td></tr>
<tr><th id="3924">3924</th><td>	<i>/*</i></td></tr>
<tr><th id="3925">3925</th><td><i>	 * For costly allocations, try direct compaction first, as it's likely</i></td></tr>
<tr><th id="3926">3926</th><td><i>	 * that we have enough base pages and don't need to reclaim. For non-</i></td></tr>
<tr><th id="3927">3927</th><td><i>	 * movable high-order allocations, do that as well, as compaction will</i></td></tr>
<tr><th id="3928">3928</th><td><i>	 * try prevent permanent fragmentation by migrating from blocks of the</i></td></tr>
<tr><th id="3929">3929</th><td><i>	 * same migratetype.</i></td></tr>
<tr><th id="3930">3930</th><td><i>	 * Don't try this for allocations that are allowed to ignore</i></td></tr>
<tr><th id="3931">3931</th><td><i>	 * watermarks, as the ALLOC_NO_WATERMARKS attempt didn't yet happen.</i></td></tr>
<tr><th id="3932">3932</th><td><i>	 */</i></td></tr>
<tr><th id="3933">3933</th><td>	<b>if</b> (<a class="local col6 ref" href="#826can_direct_reclaim" title='can_direct_reclaim' data-ref="826can_direct_reclaim">can_direct_reclaim</a> &amp;&amp;</td></tr>
<tr><th id="3934">3934</th><td>			(<a class="local col7 ref" href="#827costly_order" title='costly_order' data-ref="827costly_order">costly_order</a> ||</td></tr>
<tr><th id="3935">3935</th><td>			   (<a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a> &gt; <var>0</var> &amp;&amp; <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a> != <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>))</td></tr>
<tr><th id="3936">3936</th><td>			&amp;&amp; !<a class="ref fn" href="#gfp_pfmemalloc_allowed" title='gfp_pfmemalloc_allowed' data-ref="gfp_pfmemalloc_allowed">gfp_pfmemalloc_allowed</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>)) {</td></tr>
<tr><th id="3937">3937</th><td>		<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#__alloc_pages_direct_compact" title='__alloc_pages_direct_compact' data-use='c' data-ref="__alloc_pages_direct_compact">__alloc_pages_direct_compact</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>,</td></tr>
<tr><th id="3938">3938</th><td>						<a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>,</td></tr>
<tr><th id="3939">3939</th><td>						<a class="enum" href="../include/linux/compaction.h.html#INIT_COMPACT_PRIORITY" title='INIT_COMPACT_PRIORITY' data-ref="INIT_COMPACT_PRIORITY">INIT_COMPACT_PRIORITY</a>,</td></tr>
<tr><th id="3940">3940</th><td>						&amp;<a class="local col2 ref" href="#832compact_result" title='compact_result' data-ref="832compact_result">compact_result</a>);</td></tr>
<tr><th id="3941">3941</th><td>		<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="3942">3942</th><td>			<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="3943">3943</th><td></td></tr>
<tr><th id="3944">3944</th><td>		<i>/*</i></td></tr>
<tr><th id="3945">3945</th><td><i>		 * Checks for costly allocations with __GFP_NORETRY, which</i></td></tr>
<tr><th id="3946">3946</th><td><i>		 * includes THP page fault allocations</i></td></tr>
<tr><th id="3947">3947</th><td><i>		 */</i></td></tr>
<tr><th id="3948">3948</th><td>		<b>if</b> (<a class="local col7 ref" href="#827costly_order" title='costly_order' data-ref="827costly_order">costly_order</a> &amp;&amp; (<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#190" title="(( gfp_t)0x1000u)" data-ref="_M/__GFP_NORETRY">__GFP_NORETRY</a>)) {</td></tr>
<tr><th id="3949">3949</th><td>			<i>/*</i></td></tr>
<tr><th id="3950">3950</th><td><i>			 * If compaction is deferred for high-order allocations,</i></td></tr>
<tr><th id="3951">3951</th><td><i>			 * it is because sync compaction recently failed. If</i></td></tr>
<tr><th id="3952">3952</th><td><i>			 * this is the case and the caller requested a THP</i></td></tr>
<tr><th id="3953">3953</th><td><i>			 * allocation, we do not want to heavily disrupt the</i></td></tr>
<tr><th id="3954">3954</th><td><i>			 * system, so we fail the allocation instead of entering</i></td></tr>
<tr><th id="3955">3955</th><td><i>			 * direct reclaim.</i></td></tr>
<tr><th id="3956">3956</th><td><i>			 */</i></td></tr>
<tr><th id="3957">3957</th><td>			<b>if</b> (<a class="local col2 ref" href="#832compact_result" title='compact_result' data-ref="832compact_result">compact_result</a> == <a class="enum" href="../include/linux/compaction.h.html#COMPACT_DEFERRED" title='COMPACT_DEFERRED' data-ref="COMPACT_DEFERRED">COMPACT_DEFERRED</a>)</td></tr>
<tr><th id="3958">3958</th><td>				<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="3959">3959</th><td></td></tr>
<tr><th id="3960">3960</th><td>			<i>/*</i></td></tr>
<tr><th id="3961">3961</th><td><i>			 * Looks like reclaim/compaction is worth trying, but</i></td></tr>
<tr><th id="3962">3962</th><td><i>			 * sync compaction could be very expensive, so keep</i></td></tr>
<tr><th id="3963">3963</th><td><i>			 * using async compaction.</i></td></tr>
<tr><th id="3964">3964</th><td><i>			 */</i></td></tr>
<tr><th id="3965">3965</th><td>			<a class="local col1 ref" href="#831compact_priority" title='compact_priority' data-ref="831compact_priority">compact_priority</a> = <a class="enum" href="../include/linux/compaction.h.html#INIT_COMPACT_PRIORITY" title='INIT_COMPACT_PRIORITY' data-ref="INIT_COMPACT_PRIORITY">INIT_COMPACT_PRIORITY</a>;</td></tr>
<tr><th id="3966">3966</th><td>		}</td></tr>
<tr><th id="3967">3967</th><td>	}</td></tr>
<tr><th id="3968">3968</th><td></td></tr>
<tr><th id="3969">3969</th><td><dfn class="lbl" id="842retry" data-ref="842retry">retry</dfn>:</td></tr>
<tr><th id="3970">3970</th><td>	<i>/* Ensure kswapd doesn't accidentally go to sleep as long as we loop */</i></td></tr>
<tr><th id="3971">3971</th><td>	<b>if</b> (<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#186" title="(( gfp_t)0x1000000u)" data-ref="_M/__GFP_KSWAPD_RECLAIM">__GFP_KSWAPD_RECLAIM</a>)</td></tr>
<tr><th id="3972">3972</th><td>		<a class="tu ref fn" href="#wake_all_kswapds" title='wake_all_kswapds' data-use='c' data-ref="wake_all_kswapds">wake_all_kswapds</a>(<a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>);</td></tr>
<tr><th id="3973">3973</th><td></td></tr>
<tr><th id="3974">3974</th><td>	<a class="local col8 ref" href="#838reserve_flags" title='reserve_flags' data-ref="838reserve_flags">reserve_flags</a> = <a class="tu ref fn" href="#__gfp_pfmemalloc_flags" title='__gfp_pfmemalloc_flags' data-use='c' data-ref="__gfp_pfmemalloc_flags">__gfp_pfmemalloc_flags</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="3975">3975</th><td>	<b>if</b> (<a class="local col8 ref" href="#838reserve_flags" title='reserve_flags' data-ref="838reserve_flags">reserve_flags</a>)</td></tr>
<tr><th id="3976">3976</th><td>		<a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a> = <a class="local col8 ref" href="#838reserve_flags" title='reserve_flags' data-ref="838reserve_flags">reserve_flags</a>;</td></tr>
<tr><th id="3977">3977</th><td></td></tr>
<tr><th id="3978">3978</th><td>	<i>/*</i></td></tr>
<tr><th id="3979">3979</th><td><i>	 * Reset the zonelist iterators if memory policies can be ignored.</i></td></tr>
<tr><th id="3980">3980</th><td><i>	 * These allocations are high priority and system rather than user</i></td></tr>
<tr><th id="3981">3981</th><td><i>	 * orientated.</i></td></tr>
<tr><th id="3982">3982</th><td><i>	 */</i></td></tr>
<tr><th id="3983">3983</th><td>	<b>if</b> (!(<a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a> &amp; <a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>) || <a class="local col8 ref" href="#838reserve_flags" title='reserve_flags' data-ref="838reserve_flags">reserve_flags</a>) {</td></tr>
<tr><th id="3984">3984</th><td>		<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a> = <a class="ref fn" href="../include/linux/mmzone.h.html#first_zones_zonelist" title='first_zones_zonelist' data-ref="first_zones_zonelist">first_zones_zonelist</a>(<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>,</td></tr>
<tr><th id="3985">3985</th><td>					<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>);</td></tr>
<tr><th id="3986">3986</th><td>	}</td></tr>
<tr><th id="3987">3987</th><td></td></tr>
<tr><th id="3988">3988</th><td>	<i>/* Attempt with potentially adjusted zonelist and alloc_flags */</i></td></tr>
<tr><th id="3989">3989</th><td>	<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>);</td></tr>
<tr><th id="3990">3990</th><td>	<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="3991">3991</th><td>		<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="3992">3992</th><td></td></tr>
<tr><th id="3993">3993</th><td>	<i>/* Caller is not willing to reclaim, we can't balance anything */</i></td></tr>
<tr><th id="3994">3994</th><td>	<b>if</b> (!<a class="local col6 ref" href="#826can_direct_reclaim" title='can_direct_reclaim' data-ref="826can_direct_reclaim">can_direct_reclaim</a>)</td></tr>
<tr><th id="3995">3995</th><td>		<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="3996">3996</th><td></td></tr>
<tr><th id="3997">3997</th><td>	<i>/* Make sure we know about allocations which stall for too long */</i></td></tr>
<tr><th id="3998">3998</th><td>	<b>if</b> (<a class="macro" href="../include/linux/jiffies.h.html#102" title="(({ unsigned long __dummy; typeof(jiffies) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }) &amp;&amp; ({ unsigned long __dummy; typeof(alloc_start + stall_timeout) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }) &amp;&amp; ((long)((alloc_start + stall_timeout) - (jiffies)) &lt; 0))" data-ref="_M/time_after">time_after</a>(<a class="ref" href="../include/linux/jiffies.h.html#jiffies" title='jiffies' data-ref="jiffies">jiffies</a>, <a class="local col5 ref" href="#835alloc_start" title='alloc_start' data-ref="835alloc_start">alloc_start</a> + <a class="local col6 ref" href="#836stall_timeout" title='stall_timeout' data-ref="836stall_timeout">stall_timeout</a>)) {</td></tr>
<tr><th id="3999">3999</th><td>		<a class="ref fn" href="#warn_alloc" title='warn_alloc' data-ref="warn_alloc">warn_alloc</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; ~<a class="macro" href="../include/linux/gfp.h.html#205" title="(( gfp_t)0x200u)" data-ref="_M/__GFP_NOWARN">__GFP_NOWARN</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>,</td></tr>
<tr><th id="4000">4000</th><td>			<q>"page allocation stalls for %ums, order:%u"</q>,</td></tr>
<tr><th id="4001">4001</th><td>			<a class="ref fn" href="../include/linux/jiffies.h.html#jiffies_to_msecs" title='jiffies_to_msecs' data-ref="jiffies_to_msecs">jiffies_to_msecs</a>(<a class="ref" href="../include/linux/jiffies.h.html#jiffies" title='jiffies' data-ref="jiffies">jiffies</a>-<a class="local col5 ref" href="#835alloc_start" title='alloc_start' data-ref="835alloc_start">alloc_start</a>), <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>);</td></tr>
<tr><th id="4002">4002</th><td>		<a class="local col6 ref" href="#836stall_timeout" title='stall_timeout' data-ref="836stall_timeout">stall_timeout</a> += <var>10</var> * <a class="macro" href="../include/asm-generic/param.h.html#8" title="100" data-ref="_M/HZ">HZ</a>;</td></tr>
<tr><th id="4003">4003</th><td>	}</td></tr>
<tr><th id="4004">4004</th><td></td></tr>
<tr><th id="4005">4005</th><td>	<i>/* Avoid recursion of direct reclaim */</i></td></tr>
<tr><th id="4006">4006</th><td>	<b>if</b> (<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; <a class="macro" href="../include/linux/sched.h.html#1345" title="0x00000800" data-ref="_M/PF_MEMALLOC">PF_MEMALLOC</a>)</td></tr>
<tr><th id="4007">4007</th><td>		<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="4008">4008</th><td></td></tr>
<tr><th id="4009">4009</th><td>	<i>/* Try direct reclaim and then allocating */</i></td></tr>
<tr><th id="4010">4010</th><td>	<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#__alloc_pages_direct_reclaim" title='__alloc_pages_direct_reclaim' data-use='c' data-ref="__alloc_pages_direct_reclaim">__alloc_pages_direct_reclaim</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>,</td></tr>
<tr><th id="4011">4011</th><td>							&amp;<a class="local col0 ref" href="#830did_some_progress" title='did_some_progress' data-ref="830did_some_progress">did_some_progress</a>);</td></tr>
<tr><th id="4012">4012</th><td>	<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="4013">4013</th><td>		<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="4014">4014</th><td></td></tr>
<tr><th id="4015">4015</th><td>	<i>/* Try direct compaction and then allocating */</i></td></tr>
<tr><th id="4016">4016</th><td>	<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#__alloc_pages_direct_compact" title='__alloc_pages_direct_compact' data-use='c' data-ref="__alloc_pages_direct_compact">__alloc_pages_direct_compact</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>,</td></tr>
<tr><th id="4017">4017</th><td>					<a class="local col1 ref" href="#831compact_priority" title='compact_priority' data-ref="831compact_priority">compact_priority</a>, &amp;<a class="local col2 ref" href="#832compact_result" title='compact_result' data-ref="832compact_result">compact_result</a>);</td></tr>
<tr><th id="4018">4018</th><td>	<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="4019">4019</th><td>		<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="4020">4020</th><td></td></tr>
<tr><th id="4021">4021</th><td>	<i>/* Do not loop if specifically requested */</i></td></tr>
<tr><th id="4022">4022</th><td>	<b>if</b> (<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#190" title="(( gfp_t)0x1000u)" data-ref="_M/__GFP_NORETRY">__GFP_NORETRY</a>)</td></tr>
<tr><th id="4023">4023</th><td>		<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="4024">4024</th><td></td></tr>
<tr><th id="4025">4025</th><td>	<i>/*</i></td></tr>
<tr><th id="4026">4026</th><td><i>	 * Do not retry costly high order allocations unless they are</i></td></tr>
<tr><th id="4027">4027</th><td><i>	 * __GFP_RETRY_MAYFAIL</i></td></tr>
<tr><th id="4028">4028</th><td><i>	 */</i></td></tr>
<tr><th id="4029">4029</th><td>	<b>if</b> (<a class="local col7 ref" href="#827costly_order" title='costly_order' data-ref="827costly_order">costly_order</a> &amp;&amp; !(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#188" title="(( gfp_t)0x400u)" data-ref="_M/__GFP_RETRY_MAYFAIL">__GFP_RETRY_MAYFAIL</a>))</td></tr>
<tr><th id="4030">4030</th><td>		<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="4031">4031</th><td></td></tr>
<tr><th id="4032">4032</th><td>	<b>if</b> (<a class="tu ref fn" href="#should_reclaim_retry" title='should_reclaim_retry' data-use='c' data-ref="should_reclaim_retry">should_reclaim_retry</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>, <a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>,</td></tr>
<tr><th id="4033">4033</th><td>				 <a class="local col0 ref" href="#830did_some_progress" title='did_some_progress' data-ref="830did_some_progress">did_some_progress</a> &gt; <var>0</var>, &amp;<a class="local col4 ref" href="#834no_progress_loops" title='no_progress_loops' data-ref="834no_progress_loops">no_progress_loops</a>))</td></tr>
<tr><th id="4034">4034</th><td>		<b>goto</b> <a class="lbl" href="#842retry" data-ref="842retry">retry</a>;</td></tr>
<tr><th id="4035">4035</th><td></td></tr>
<tr><th id="4036">4036</th><td>	<i>/*</i></td></tr>
<tr><th id="4037">4037</th><td><i>	 * It doesn't make any sense to retry for the compaction if the order-0</i></td></tr>
<tr><th id="4038">4038</th><td><i>	 * reclaim is not able to make any progress because the current</i></td></tr>
<tr><th id="4039">4039</th><td><i>	 * implementation of the compaction depends on the sufficient amount</i></td></tr>
<tr><th id="4040">4040</th><td><i>	 * of free memory (see __compaction_suitable)</i></td></tr>
<tr><th id="4041">4041</th><td><i>	 */</i></td></tr>
<tr><th id="4042">4042</th><td>	<b>if</b> (<a class="local col0 ref" href="#830did_some_progress" title='did_some_progress' data-ref="830did_some_progress">did_some_progress</a> &gt; <var>0</var> &amp;&amp;</td></tr>
<tr><th id="4043">4043</th><td>			<a class="tu ref fn" href="#should_compact_retry" title='should_compact_retry' data-use='c' data-ref="should_compact_retry">should_compact_retry</a>(<a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a>,</td></tr>
<tr><th id="4044">4044</th><td>				<a class="local col2 ref" href="#832compact_result" title='compact_result' data-ref="832compact_result">compact_result</a>, &amp;<a class="local col1 ref" href="#831compact_priority" title='compact_priority' data-ref="831compact_priority">compact_priority</a>,</td></tr>
<tr><th id="4045">4045</th><td>				&amp;<a class="local col3 ref" href="#833compaction_retries" title='compaction_retries' data-ref="833compaction_retries">compaction_retries</a>))</td></tr>
<tr><th id="4046">4046</th><td>		<b>goto</b> <a class="lbl" href="#842retry" data-ref="842retry">retry</a>;</td></tr>
<tr><th id="4047">4047</th><td></td></tr>
<tr><th id="4048">4048</th><td></td></tr>
<tr><th id="4049">4049</th><td>	<i>/* Deal with possible cpuset update races before we start OOM killing */</i></td></tr>
<tr><th id="4050">4050</th><td>	<b>if</b> (<a class="tu ref fn" href="#check_retry_cpuset" title='check_retry_cpuset' data-use='c' data-ref="check_retry_cpuset">check_retry_cpuset</a>(<a class="local col7 ref" href="#837cpuset_mems_cookie" title='cpuset_mems_cookie' data-ref="837cpuset_mems_cookie">cpuset_mems_cookie</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>))</td></tr>
<tr><th id="4051">4051</th><td>		<b>goto</b> <a class="lbl" href="#839retry_cpuset" data-ref="839retry_cpuset">retry_cpuset</a>;</td></tr>
<tr><th id="4052">4052</th><td></td></tr>
<tr><th id="4053">4053</th><td>	<i>/* Reclaim has failed us, start killing things */</i></td></tr>
<tr><th id="4054">4054</th><td>	<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#__alloc_pages_may_oom" title='__alloc_pages_may_oom' data-use='c' data-ref="__alloc_pages_may_oom">__alloc_pages_may_oom</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>, &amp;<a class="local col0 ref" href="#830did_some_progress" title='did_some_progress' data-ref="830did_some_progress">did_some_progress</a>);</td></tr>
<tr><th id="4055">4055</th><td>	<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="4056">4056</th><td>		<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="4057">4057</th><td></td></tr>
<tr><th id="4058">4058</th><td>	<i>/* Avoid allocations with no watermarks from looping endlessly */</i></td></tr>
<tr><th id="4059">4059</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/oom.h.html#tsk_is_oom_victim" title='tsk_is_oom_victim' data-ref="tsk_is_oom_victim">tsk_is_oom_victim</a>(<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>) &amp;&amp;</td></tr>
<tr><th id="4060">4060</th><td>	    (<a class="local col9 ref" href="#829alloc_flags" title='alloc_flags' data-ref="829alloc_flags">alloc_flags</a> == <a class="macro" href="internal.h.html#489" title="0x08" data-ref="_M/ALLOC_OOM">ALLOC_OOM</a> ||</td></tr>
<tr><th id="4061">4061</th><td>	     (<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#115" title="(( gfp_t)0x10000u)" data-ref="_M/__GFP_NOMEMALLOC">__GFP_NOMEMALLOC</a>)))</td></tr>
<tr><th id="4062">4062</th><td>		<b>goto</b> <a class="lbl" href="#840nopage" data-ref="840nopage">nopage</a>;</td></tr>
<tr><th id="4063">4063</th><td></td></tr>
<tr><th id="4064">4064</th><td>	<i>/* Retry as long as the OOM killer is making progress */</i></td></tr>
<tr><th id="4065">4065</th><td>	<b>if</b> (<a class="local col0 ref" href="#830did_some_progress" title='did_some_progress' data-ref="830did_some_progress">did_some_progress</a>) {</td></tr>
<tr><th id="4066">4066</th><td>		<a class="local col4 ref" href="#834no_progress_loops" title='no_progress_loops' data-ref="834no_progress_loops">no_progress_loops</a> = <var>0</var>;</td></tr>
<tr><th id="4067">4067</th><td>		<b>goto</b> <a class="lbl" href="#842retry" data-ref="842retry">retry</a>;</td></tr>
<tr><th id="4068">4068</th><td>	}</td></tr>
<tr><th id="4069">4069</th><td></td></tr>
<tr><th id="4070">4070</th><td><dfn class="lbl" id="840nopage" data-ref="840nopage">nopage</dfn>:</td></tr>
<tr><th id="4071">4071</th><td>	<i>/* Deal with possible cpuset update races before we fail */</i></td></tr>
<tr><th id="4072">4072</th><td>	<b>if</b> (<a class="tu ref fn" href="#check_retry_cpuset" title='check_retry_cpuset' data-use='c' data-ref="check_retry_cpuset">check_retry_cpuset</a>(<a class="local col7 ref" href="#837cpuset_mems_cookie" title='cpuset_mems_cookie' data-ref="837cpuset_mems_cookie">cpuset_mems_cookie</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>))</td></tr>
<tr><th id="4073">4073</th><td>		<b>goto</b> <a class="lbl" href="#839retry_cpuset" data-ref="839retry_cpuset">retry_cpuset</a>;</td></tr>
<tr><th id="4074">4074</th><td></td></tr>
<tr><th id="4075">4075</th><td>	<i>/*</i></td></tr>
<tr><th id="4076">4076</th><td><i>	 * Make sure that __GFP_NOFAIL request doesn't leak out and make sure</i></td></tr>
<tr><th id="4077">4077</th><td><i>	 * we always retry</i></td></tr>
<tr><th id="4078">4078</th><td><i>	 */</i></td></tr>
<tr><th id="4079">4079</th><td>	<b>if</b> (<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#189" title="(( gfp_t)0x800u)" data-ref="_M/__GFP_NOFAIL">__GFP_NOFAIL</a>) {</td></tr>
<tr><th id="4080">4080</th><td>		<i>/*</i></td></tr>
<tr><th id="4081">4081</th><td><i>		 * All existing users of the __GFP_NOFAIL are blockable, so warn</i></td></tr>
<tr><th id="4082">4082</th><td><i>		 * of any new users that actually require GFP_NOWAIT</i></td></tr>
<tr><th id="4083">4083</th><td><i>		 */</i></td></tr>
<tr><th id="4084">4084</th><td>		<b>if</b> (<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!(!can_direct_reclaim); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (4084), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (173)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>(!<a class="local col6 ref" href="#826can_direct_reclaim" title='can_direct_reclaim' data-ref="826can_direct_reclaim">can_direct_reclaim</a>))</td></tr>
<tr><th id="4085">4085</th><td>			<b>goto</b> <a class="lbl" href="#843fail" data-ref="843fail">fail</a>;</td></tr>
<tr><th id="4086">4086</th><td></td></tr>
<tr><th id="4087">4087</th><td>		<i>/*</i></td></tr>
<tr><th id="4088">4088</th><td><i>		 * PF_MEMALLOC request from this context is rather bizarre</i></td></tr>
<tr><th id="4089">4089</th><td><i>		 * because we cannot reclaim anything and only can loop waiting</i></td></tr>
<tr><th id="4090">4090</th><td><i>		 * for somebody to do a work for us</i></td></tr>
<tr><th id="4091">4091</th><td><i>		 */</i></td></tr>
<tr><th id="4092">4092</th><td>		<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!(get_current()-&gt;flags &amp; 0x00000800); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (4092), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (175)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>(<a class="macro" href="../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../include/linux/sched.h.html#task_struct::flags" title='task_struct::flags' data-ref="task_struct::flags">flags</a> &amp; <a class="macro" href="../include/linux/sched.h.html#1345" title="0x00000800" data-ref="_M/PF_MEMALLOC">PF_MEMALLOC</a>);</td></tr>
<tr><th id="4093">4093</th><td></td></tr>
<tr><th id="4094">4094</th><td>		<i>/*</i></td></tr>
<tr><th id="4095">4095</th><td><i>		 * non failing costly orders are a hard requirement which we</i></td></tr>
<tr><th id="4096">4096</th><td><i>		 * are not prepared for much so let's warn about these users</i></td></tr>
<tr><th id="4097">4097</th><td><i>		 * so that we can identify them and convert them to something</i></td></tr>
<tr><th id="4098">4098</th><td><i>		 * else.</i></td></tr>
<tr><th id="4099">4099</th><td><i>		 */</i></td></tr>
<tr><th id="4100">4100</th><td>		<a class="macro" href="../include/asm-generic/bug.h.html#66" title="({ int __ret_warn_on = !!(order &gt; 3); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (4100), &quot;i&quot; ((1 &lt;&lt; 0)|((1 &lt;&lt; 1)|((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (177)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON_ONCE">WARN_ON_ONCE</a>(<a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a> &gt; <a class="macro" href="../include/linux/mmzone.h.html#37" title="3" data-ref="_M/PAGE_ALLOC_COSTLY_ORDER">PAGE_ALLOC_COSTLY_ORDER</a>);</td></tr>
<tr><th id="4101">4101</th><td></td></tr>
<tr><th id="4102">4102</th><td>		<i>/*</i></td></tr>
<tr><th id="4103">4103</th><td><i>		 * Help non-failing allocations by giving them access to memory</i></td></tr>
<tr><th id="4104">4104</th><td><i>		 * reserves but do not use ALLOC_NO_WATERMARKS because this</i></td></tr>
<tr><th id="4105">4105</th><td><i>		 * could deplete whole memory reserves which would just make</i></td></tr>
<tr><th id="4106">4106</th><td><i>		 * the situation worse</i></td></tr>
<tr><th id="4107">4107</th><td><i>		 */</i></td></tr>
<tr><th id="4108">4108</th><td>		<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a> = <a class="tu ref fn" href="#__alloc_pages_cpuset_fallback" title='__alloc_pages_cpuset_fallback' data-use='c' data-ref="__alloc_pages_cpuset_fallback">__alloc_pages_cpuset_fallback</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>, <a class="macro" href="internal.h.html#494" title="0x10" data-ref="_M/ALLOC_HARDER">ALLOC_HARDER</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>);</td></tr>
<tr><th id="4109">4109</th><td>		<b>if</b> (<a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>)</td></tr>
<tr><th id="4110">4110</th><td>			<b>goto</b> <a class="lbl" href="#841got_pg" data-ref="841got_pg">got_pg</a>;</td></tr>
<tr><th id="4111">4111</th><td></td></tr>
<tr><th id="4112">4112</th><td>		<a class="macro" href="../include/linux/sched.h.html#1627" title="({ ___might_sleep(&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;, 4112, 0); _cond_resched(); })" data-ref="_M/cond_resched">cond_resched</a>();</td></tr>
<tr><th id="4113">4113</th><td>		<b>goto</b> <a class="lbl" href="#842retry" data-ref="842retry">retry</a>;</td></tr>
<tr><th id="4114">4114</th><td>	}</td></tr>
<tr><th id="4115">4115</th><td><dfn class="lbl" id="843fail" data-ref="843fail">fail</dfn>:</td></tr>
<tr><th id="4116">4116</th><td>	<a class="ref fn" href="#warn_alloc" title='warn_alloc' data-ref="warn_alloc">warn_alloc</a>(<a class="local col3 ref" href="#823gfp_mask" title='gfp_mask' data-ref="823gfp_mask">gfp_mask</a>, <a class="local col5 ref" href="#825ac" title='ac' data-ref="825ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>,</td></tr>
<tr><th id="4117">4117</th><td>			<q>"page allocation failure: order:%u"</q>, <a class="local col4 ref" href="#824order" title='order' data-ref="824order">order</a>);</td></tr>
<tr><th id="4118">4118</th><td><dfn class="lbl" id="841got_pg" data-ref="841got_pg">got_pg</dfn>:</td></tr>
<tr><th id="4119">4119</th><td>	<b>return</b> <a class="local col8 ref" href="#828page" title='page' data-ref="828page">page</a>;</td></tr>
<tr><th id="4120">4120</th><td>}</td></tr>
<tr><th id="4121">4121</th><td></td></tr>
<tr><th id="4122">4122</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="prepare_alloc_pages" title='prepare_alloc_pages' data-type='bool prepare_alloc_pages(gfp_t gfp_mask, unsigned int order, int preferred_nid, nodemask_t * nodemask, struct alloc_context * ac, gfp_t * alloc_mask, unsigned int * alloc_flags)' data-ref="prepare_alloc_pages">prepare_alloc_pages</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col4 decl" id="844gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="844gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="845order" title='order' data-type='unsigned int' data-ref="845order">order</dfn>,</td></tr>
<tr><th id="4123">4123</th><td>		<em>int</em> <dfn class="local col6 decl" id="846preferred_nid" title='preferred_nid' data-type='int' data-ref="846preferred_nid">preferred_nid</dfn>, <a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> *<dfn class="local col7 decl" id="847nodemask" title='nodemask' data-type='nodemask_t *' data-ref="847nodemask">nodemask</dfn>,</td></tr>
<tr><th id="4124">4124</th><td>		<b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col8 decl" id="848ac" title='ac' data-type='struct alloc_context *' data-ref="848ac">ac</dfn>, <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> *<dfn class="local col9 decl" id="849alloc_mask" title='alloc_mask' data-type='gfp_t *' data-ref="849alloc_mask">alloc_mask</dfn>,</td></tr>
<tr><th id="4125">4125</th><td>		<em>unsigned</em> <em>int</em> *<dfn class="local col0 decl" id="850alloc_flags" title='alloc_flags' data-type='unsigned int *' data-ref="850alloc_flags">alloc_flags</dfn>)</td></tr>
<tr><th id="4126">4126</th><td>{</td></tr>
<tr><th id="4127">4127</th><td>	<a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a> = <a class="ref fn" href="../include/linux/gfp.h.html#gfp_zone" title='gfp_zone' data-ref="gfp_zone">gfp_zone</a>(<a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4128">4128</th><td>	<a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a> = <a class="ref fn" href="../include/linux/gfp.h.html#node_zonelist" title='node_zonelist' data-ref="node_zonelist">node_zonelist</a>(<a class="local col6 ref" href="#846preferred_nid" title='preferred_nid' data-ref="846preferred_nid">preferred_nid</a>, <a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4129">4129</th><td>	<a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a> = <a class="local col7 ref" href="#847nodemask" title='nodemask' data-ref="847nodemask">nodemask</a>;</td></tr>
<tr><th id="4130">4130</th><td>	<a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a> = <a class="ref fn" href="../include/linux/gfp.h.html#gfpflags_to_migratetype" title='gfpflags_to_migratetype' data-ref="gfpflags_to_migratetype">gfpflags_to_migratetype</a>(<a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4131">4131</th><td></td></tr>
<tr><th id="4132">4132</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/cpuset.h.html#cpusets_enabled" title='cpusets_enabled' data-ref="cpusets_enabled">cpusets_enabled</a>()) {</td></tr>
<tr><th id="4133">4133</th><td>		*<a class="local col9 ref" href="#849alloc_mask" title='alloc_mask' data-ref="849alloc_mask">alloc_mask</a> |= <a class="macro" href="../include/linux/gfp.h.html#89" title="(( gfp_t)0x20000u)" data-ref="_M/__GFP_HARDWALL">__GFP_HARDWALL</a>;</td></tr>
<tr><th id="4134">4134</th><td>		<b>if</b> (!<a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>)</td></tr>
<tr><th id="4135">4135</th><td>			<a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a> = &amp;<a class="macro" href="../include/linux/cpuset.h.html#61" title="(get_current()-&gt;mems_allowed)" data-ref="_M/cpuset_current_mems_allowed">cpuset_current_mems_allowed</a>;</td></tr>
<tr><th id="4136">4136</th><td>		<b>else</b></td></tr>
<tr><th id="4137">4137</th><td>			*<a class="local col0 ref" href="#850alloc_flags" title='alloc_flags' data-ref="850alloc_flags">alloc_flags</a> |= <a class="macro" href="internal.h.html#496" title="0x40" data-ref="_M/ALLOC_CPUSET">ALLOC_CPUSET</a>;</td></tr>
<tr><th id="4138">4138</th><td>	}</td></tr>
<tr><th id="4139">4139</th><td></td></tr>
<tr><th id="4140">4140</th><td>	<a class="ref fn" href="../include/linux/sched/mm.h.html#fs_reclaim_acquire" title='fs_reclaim_acquire' data-ref="fs_reclaim_acquire">fs_reclaim_acquire</a>(<a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4141">4141</th><td>	<a class="ref fn" href="../include/linux/sched/mm.h.html#fs_reclaim_release" title='fs_reclaim_release' data-ref="fs_reclaim_release">fs_reclaim_release</a>(<a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4142">4142</th><td></td></tr>
<tr><th id="4143">4143</th><td>	<a class="macro" href="../include/linux/kernel.h.html#238" title="do { if (gfp_mask &amp; (( gfp_t)0x400000u)) do { do { } while (0); } while (0); } while (0)" data-ref="_M/might_sleep_if">might_sleep_if</a>(<a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#185" title="(( gfp_t)0x400000u)" data-ref="_M/__GFP_DIRECT_RECLAIM">__GFP_DIRECT_RECLAIM</a>);</td></tr>
<tr><th id="4144">4144</th><td></td></tr>
<tr><th id="4145">4145</th><td>	<b>if</b> (<a class="tu ref fn" href="#should_fail_alloc_page" title='should_fail_alloc_page' data-use='c' data-ref="should_fail_alloc_page">should_fail_alloc_page</a>(<a class="local col4 ref" href="#844gfp_mask" title='gfp_mask' data-ref="844gfp_mask">gfp_mask</a>, <a class="local col5 ref" href="#845order" title='order' data-ref="845order">order</a>))</td></tr>
<tr><th id="4146">4146</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="4147">4147</th><td></td></tr>
<tr><th id="4148">4148</th><td>	<b>if</b> (<a class="macro" href="../include/linux/kconfig.h.html#71" title="0" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(CONFIG_CMA) &amp;&amp; <a class="local col8 ref" href="#848ac" title='ac' data-ref="848ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>)</td></tr>
<tr><th id="4149">4149</th><td>		*<a class="local col0 ref" href="#850alloc_flags" title='alloc_flags' data-ref="850alloc_flags">alloc_flags</a> |= <a class="macro" href="internal.h.html#497" title="0x80" data-ref="_M/ALLOC_CMA">ALLOC_CMA</a>;</td></tr>
<tr><th id="4150">4150</th><td></td></tr>
<tr><th id="4151">4151</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="4152">4152</th><td>}</td></tr>
<tr><th id="4153">4153</th><td></td></tr>
<tr><th id="4154">4154</th><td><i  data-doc="finalise_ac">/* Determine whether to spread dirty pages and what the first usable zone */</i></td></tr>
<tr><th id="4155">4155</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="finalise_ac" title='finalise_ac' data-type='void finalise_ac(gfp_t gfp_mask, unsigned int order, struct alloc_context * ac)' data-ref="finalise_ac">finalise_ac</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col1 decl" id="851gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="851gfp_mask">gfp_mask</dfn>,</td></tr>
<tr><th id="4156">4156</th><td>		<em>unsigned</em> <em>int</em> <dfn class="local col2 decl" id="852order" title='order' data-type='unsigned int' data-ref="852order">order</dfn>, <b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> *<dfn class="local col3 decl" id="853ac" title='ac' data-type='struct alloc_context *' data-ref="853ac">ac</dfn>)</td></tr>
<tr><th id="4157">4157</th><td>{</td></tr>
<tr><th id="4158">4158</th><td>	<i>/* Dirty zone balancing only done in the fast path */</i></td></tr>
<tr><th id="4159">4159</th><td>	<a class="local col3 ref" href="#853ac" title='ac' data-ref="853ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::spread_dirty_pages" title='alloc_context::spread_dirty_pages' data-ref="alloc_context::spread_dirty_pages">spread_dirty_pages</a> = (<a class="local col1 ref" href="#851gfp_mask" title='gfp_mask' data-ref="851gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#88" title="(( gfp_t)0x800000u)" data-ref="_M/__GFP_WRITE">__GFP_WRITE</a>);</td></tr>
<tr><th id="4160">4160</th><td></td></tr>
<tr><th id="4161">4161</th><td>	<i>/*</i></td></tr>
<tr><th id="4162">4162</th><td><i>	 * The preferred zone is used for statistics but crucially it is</i></td></tr>
<tr><th id="4163">4163</th><td><i>	 * also used as the starting point for the zonelist iterator. It</i></td></tr>
<tr><th id="4164">4164</th><td><i>	 * may get reset for allocations that ignore memory policies.</i></td></tr>
<tr><th id="4165">4165</th><td><i>	 */</i></td></tr>
<tr><th id="4166">4166</th><td>	<a class="local col3 ref" href="#853ac" title='ac' data-ref="853ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::preferred_zoneref" title='alloc_context::preferred_zoneref' data-ref="alloc_context::preferred_zoneref">preferred_zoneref</a> = <a class="ref fn" href="../include/linux/mmzone.h.html#first_zones_zonelist" title='first_zones_zonelist' data-ref="first_zones_zonelist">first_zones_zonelist</a>(<a class="local col3 ref" href="#853ac" title='ac' data-ref="853ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::zonelist" title='alloc_context::zonelist' data-ref="alloc_context::zonelist">zonelist</a>,</td></tr>
<tr><th id="4167">4167</th><td>					<a class="local col3 ref" href="#853ac" title='ac' data-ref="853ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::high_zoneidx" title='alloc_context::high_zoneidx' data-ref="alloc_context::high_zoneidx">high_zoneidx</a>, <a class="local col3 ref" href="#853ac" title='ac' data-ref="853ac">ac</a>-&gt;<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a>);</td></tr>
<tr><th id="4168">4168</th><td>}</td></tr>
<tr><th id="4169">4169</th><td></td></tr>
<tr><th id="4170">4170</th><td><i>/*</i></td></tr>
<tr><th id="4171">4171</th><td><i> * This is the 'heart' of the zoned buddy allocator.</i></td></tr>
<tr><th id="4172">4172</th><td><i> */</i></td></tr>
<tr><th id="4173">4173</th><td><b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *</td></tr>
<tr><th id="4174">4174</th><td><dfn class="decl def fn" id="__alloc_pages_nodemask" title='__alloc_pages_nodemask' data-ref="__alloc_pages_nodemask">__alloc_pages_nodemask</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col4 decl" id="854gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="854gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="855order" title='order' data-type='unsigned int' data-ref="855order">order</dfn>, <em>int</em> <dfn class="local col6 decl" id="856preferred_nid" title='preferred_nid' data-type='int' data-ref="856preferred_nid">preferred_nid</dfn>,</td></tr>
<tr><th id="4175">4175</th><td>							<a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> *<dfn class="local col7 decl" id="857nodemask" title='nodemask' data-type='nodemask_t *' data-ref="857nodemask">nodemask</dfn>)</td></tr>
<tr><th id="4176">4176</th><td>{</td></tr>
<tr><th id="4177">4177</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="858page" title='page' data-type='struct page *' data-ref="858page">page</dfn>;</td></tr>
<tr><th id="4178">4178</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="859alloc_flags" title='alloc_flags' data-type='unsigned int' data-ref="859alloc_flags">alloc_flags</dfn> = <a class="macro" href="internal.h.html#476" title="WMARK_LOW" data-ref="_M/ALLOC_WMARK_LOW">ALLOC_WMARK_LOW</a>;</td></tr>
<tr><th id="4179">4179</th><td>	<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col0 decl" id="860alloc_mask" title='alloc_mask' data-type='gfp_t' data-ref="860alloc_mask">alloc_mask</dfn>; <i>/* The gfp_t that was actually used for allocation */</i></td></tr>
<tr><th id="4180">4180</th><td>	<b>struct</b> <a class="type" href="internal.h.html#alloc_context" title='alloc_context' data-ref="alloc_context">alloc_context</a> <dfn class="local col1 decl" id="861ac" title='ac' data-type='struct alloc_context' data-ref="861ac">ac</dfn> = { };</td></tr>
<tr><th id="4181">4181</th><td></td></tr>
<tr><th id="4182">4182</th><td>	<a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a> &amp;= <a class="ref" href="../include/linux/gfp.h.html#gfp_allowed_mask" title='gfp_allowed_mask' data-ref="gfp_allowed_mask">gfp_allowed_mask</a>;</td></tr>
<tr><th id="4183">4183</th><td>	<a class="local col0 ref" href="#860alloc_mask" title='alloc_mask' data-ref="860alloc_mask">alloc_mask</a> = <a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a>;</td></tr>
<tr><th id="4184">4184</th><td>	<b>if</b> (!<a class="tu ref fn" href="#prepare_alloc_pages" title='prepare_alloc_pages' data-use='c' data-ref="prepare_alloc_pages">prepare_alloc_pages</a>(<a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>, <a class="local col6 ref" href="#856preferred_nid" title='preferred_nid' data-ref="856preferred_nid">preferred_nid</a>, <a class="local col7 ref" href="#857nodemask" title='nodemask' data-ref="857nodemask">nodemask</a>, &amp;<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>, &amp;<a class="local col0 ref" href="#860alloc_mask" title='alloc_mask' data-ref="860alloc_mask">alloc_mask</a>, &amp;<a class="local col9 ref" href="#859alloc_flags" title='alloc_flags' data-ref="859alloc_flags">alloc_flags</a>))</td></tr>
<tr><th id="4185">4185</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4186">4186</th><td></td></tr>
<tr><th id="4187">4187</th><td>	<a class="tu ref fn" href="#finalise_ac" title='finalise_ac' data-use='c' data-ref="finalise_ac">finalise_ac</a>(<a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>, &amp;<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>);</td></tr>
<tr><th id="4188">4188</th><td></td></tr>
<tr><th id="4189">4189</th><td>	<i>/* First allocation attempt */</i></td></tr>
<tr><th id="4190">4190</th><td>	<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a> = <a class="tu ref fn" href="#get_page_from_freelist" title='get_page_from_freelist' data-use='c' data-ref="get_page_from_freelist">get_page_from_freelist</a>(<a class="local col0 ref" href="#860alloc_mask" title='alloc_mask' data-ref="860alloc_mask">alloc_mask</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>, <a class="local col9 ref" href="#859alloc_flags" title='alloc_flags' data-ref="859alloc_flags">alloc_flags</a>, &amp;<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>);</td></tr>
<tr><th id="4191">4191</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#76" title="__builtin_expect(!!(page), 1)" data-ref="_M/likely">likely</a>(<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a>))</td></tr>
<tr><th id="4192">4192</th><td>		<b>goto</b> <a class="lbl" href="#862out" data-ref="862out">out</a>;</td></tr>
<tr><th id="4193">4193</th><td></td></tr>
<tr><th id="4194">4194</th><td>	<i>/*</i></td></tr>
<tr><th id="4195">4195</th><td><i>	 * Apply scoped allocation constraints. This is mainly about GFP_NOFS</i></td></tr>
<tr><th id="4196">4196</th><td><i>	 * resp. GFP_NOIO which has to be inherited for all allocation requests</i></td></tr>
<tr><th id="4197">4197</th><td><i>	 * from a particular context which has been marked by</i></td></tr>
<tr><th id="4198">4198</th><td><i>	 * memalloc_no{fs,io}_{save,restore}.</i></td></tr>
<tr><th id="4199">4199</th><td><i>	 */</i></td></tr>
<tr><th id="4200">4200</th><td>	<a class="local col0 ref" href="#860alloc_mask" title='alloc_mask' data-ref="860alloc_mask">alloc_mask</a> = <a class="ref fn" href="../include/linux/sched/mm.h.html#current_gfp_context" title='current_gfp_context' data-ref="current_gfp_context">current_gfp_context</a>(<a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4201">4201</th><td>	<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>.<a class="ref field" href="internal.h.html#alloc_context::spread_dirty_pages" title='alloc_context::spread_dirty_pages' data-ref="alloc_context::spread_dirty_pages">spread_dirty_pages</a> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="4202">4202</th><td></td></tr>
<tr><th id="4203">4203</th><td>	<i>/*</i></td></tr>
<tr><th id="4204">4204</th><td><i>	 * Restore the original nodemask if it was potentially replaced with</i></td></tr>
<tr><th id="4205">4205</th><td><i>	 * &amp;cpuset_current_mems_allowed to optimize the fast-path attempt.</i></td></tr>
<tr><th id="4206">4206</th><td><i>	 */</i></td></tr>
<tr><th id="4207">4207</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(ac.nodemask != nodemask), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>.<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a> != <a class="local col7 ref" href="#857nodemask" title='nodemask' data-ref="857nodemask">nodemask</a>))</td></tr>
<tr><th id="4208">4208</th><td>		<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>.<a class="ref field" href="internal.h.html#alloc_context::nodemask" title='alloc_context::nodemask' data-ref="alloc_context::nodemask">nodemask</a> = <a class="local col7 ref" href="#857nodemask" title='nodemask' data-ref="857nodemask">nodemask</a>;</td></tr>
<tr><th id="4209">4209</th><td></td></tr>
<tr><th id="4210">4210</th><td>	<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a> = <a class="tu ref fn" href="#__alloc_pages_slowpath" title='__alloc_pages_slowpath' data-use='c' data-ref="__alloc_pages_slowpath">__alloc_pages_slowpath</a>(<a class="local col0 ref" href="#860alloc_mask" title='alloc_mask' data-ref="860alloc_mask">alloc_mask</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>, &amp;<a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>);</td></tr>
<tr><th id="4211">4211</th><td></td></tr>
<tr><th id="4212">4212</th><td><dfn class="lbl" id="862out" data-ref="862out">out</dfn>:</td></tr>
<tr><th id="4213">4213</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/memcontrol.h.html#memcg_kmem_enabled" title='memcg_kmem_enabled' data-ref="memcg_kmem_enabled">memcg_kmem_enabled</a>() &amp;&amp; (<a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#91" title="(( gfp_t)0x100000u)" data-ref="_M/__GFP_ACCOUNT">__GFP_ACCOUNT</a>) &amp;&amp; <a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a> &amp;&amp;</td></tr>
<tr><th id="4214">4214</th><td>	    <a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(memcg_kmem_charge(page, gfp_mask, order) != 0), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/memcontrol.h.html#memcg_kmem_charge" title='memcg_kmem_charge' data-ref="memcg_kmem_charge">memcg_kmem_charge</a>(<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a>, <a class="local col4 ref" href="#854gfp_mask" title='gfp_mask' data-ref="854gfp_mask">gfp_mask</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>) != <var>0</var>)) {</td></tr>
<tr><th id="4215">4215</th><td>		<a class="ref fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages">__free_pages</a>(<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>);</td></tr>
<tr><th id="4216">4216</th><td>		<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4217">4217</th><td>	}</td></tr>
<tr><th id="4218">4218</th><td></td></tr>
<tr><th id="4219">4219</th><td>	<a class="ref fn" href="../include/trace/events/kmem.h.html#195" title='trace_mm_page_alloc' data-ref="trace_mm_page_alloc">trace_mm_page_alloc</a>(<a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a>, <a class="local col5 ref" href="#855order" title='order' data-ref="855order">order</a>, <a class="local col0 ref" href="#860alloc_mask" title='alloc_mask' data-ref="860alloc_mask">alloc_mask</a>, <a class="local col1 ref" href="#861ac" title='ac' data-ref="861ac">ac</a>.<a class="ref field" href="internal.h.html#alloc_context::migratetype" title='alloc_context::migratetype' data-ref="alloc_context::migratetype">migratetype</a>);</td></tr>
<tr><th id="4220">4220</th><td></td></tr>
<tr><th id="4221">4221</th><td>	<b>return</b> <a class="local col8 ref" href="#858page" title='page' data-ref="858page">page</a>;</td></tr>
<tr><th id="4222">4222</th><td>}</td></tr>
<tr><th id="4223">4223</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(__alloc_pages_nodemask) __alloc_pages_nodemask; static const char __kstrtab___alloc_pages_nodemask[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;__alloc_pages_nodemask&quot;; static const struct kernel_symbol __ksymtab___alloc_pages_nodemask __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;__alloc_pages_nodemask&quot;), used)) = { (unsigned long)&amp;__alloc_pages_nodemask, __kstrtab___alloc_pages_nodemask }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#__alloc_pages_nodemask" title='__alloc_pages_nodemask' data-ref="__alloc_pages_nodemask"><a class="ref fn" href="#__alloc_pages_nodemask" title='__alloc_pages_nodemask' data-ref="__alloc_pages_nodemask"><a class="ref fn" href="#__alloc_pages_nodemask" title='__alloc_pages_nodemask' data-ref="__alloc_pages_nodemask"><a class="ref fn" href="#__alloc_pages_nodemask" title='__alloc_pages_nodemask' data-ref="__alloc_pages_nodemask">__alloc_pages_nodemask</a></a></a></a>);</td></tr>
<tr><th id="4224">4224</th><td></td></tr>
<tr><th id="4225">4225</th><td><i>/*</i></td></tr>
<tr><th id="4226">4226</th><td><i> * Common helper functions.</i></td></tr>
<tr><th id="4227">4227</th><td><i> */</i></td></tr>
<tr><th id="4228">4228</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def fn" id="__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages">__get_free_pages</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col3 decl" id="863gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="863gfp_mask">gfp_mask</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="864order" title='order' data-type='unsigned int' data-ref="864order">order</dfn>)</td></tr>
<tr><th id="4229">4229</th><td>{</td></tr>
<tr><th id="4230">4230</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="865page" title='page' data-type='struct page *' data-ref="865page">page</dfn>;</td></tr>
<tr><th id="4231">4231</th><td></td></tr>
<tr><th id="4232">4232</th><td>	<i>/*</i></td></tr>
<tr><th id="4233">4233</th><td><i>	 * __get_free_pages() returns a 32-bit address, which cannot represent</i></td></tr>
<tr><th id="4234">4234</th><td><i>	 * a highmem page</i></td></tr>
<tr><th id="4235">4235</th><td><i>	 */</i></td></tr>
<tr><th id="4236">4236</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)((gfp_mask &amp; (( gfp_t)0x02u)) != 0))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>((<a class="local col3 ref" href="#863gfp_mask" title='gfp_mask' data-ref="863gfp_mask">gfp_mask</a> &amp; <a class="macro" href="../include/linux/gfp.h.html#58" title="(( gfp_t)0x02u)" data-ref="_M/__GFP_HIGHMEM">__GFP_HIGHMEM</a>) != <var>0</var>);</td></tr>
<tr><th id="4237">4237</th><td></td></tr>
<tr><th id="4238">4238</th><td>	<a class="local col5 ref" href="#865page" title='page' data-ref="865page">page</a> = <a class="macro" href="../include/linux/gfp.h.html#505" title="alloc_pages_node(numa_node_id(), gfp_mask, order)" data-ref="_M/alloc_pages">alloc_pages</a>(<a class="local col3 ref" href="#863gfp_mask" title='gfp_mask' data-ref="863gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#864order" title='order' data-ref="864order">order</a>);</td></tr>
<tr><th id="4239">4239</th><td>	<b>if</b> (!<a class="local col5 ref" href="#865page" title='page' data-ref="865page">page</a>)</td></tr>
<tr><th id="4240">4240</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4241">4241</th><td>	<b>return</b> (<em>unsigned</em> <em>long</em>) <a class="macro" href="../include/linux/mm.h.html#1103" title="lowmem_page_address(page)" data-ref="_M/page_address">page_address</a>(<a class="local col5 ref" href="#865page" title='page' data-ref="865page">page</a>);</td></tr>
<tr><th id="4242">4242</th><td>}</td></tr>
<tr><th id="4243">4243</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(__get_free_pages) __get_free_pages; static const char __kstrtab___get_free_pages[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;__get_free_pages&quot;; static const struct kernel_symbol __ksymtab___get_free_pages __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;__get_free_pages&quot;), used)) = { (unsigned long)&amp;__get_free_pages, __kstrtab___get_free_pages }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages"><a class="ref fn" href="#__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages"><a class="ref fn" href="#__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages"><a class="ref fn" href="#__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages">__get_free_pages</a></a></a></a>);</td></tr>
<tr><th id="4244">4244</th><td></td></tr>
<tr><th id="4245">4245</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def fn" id="get_zeroed_page" title='get_zeroed_page' data-ref="get_zeroed_page">get_zeroed_page</dfn>(<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col6 decl" id="866gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="866gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="4246">4246</th><td>{</td></tr>
<tr><th id="4247">4247</th><td>	<b>return</b> <a class="ref fn" href="#__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages">__get_free_pages</a>(<a class="local col6 ref" href="#866gfp_mask" title='gfp_mask' data-ref="866gfp_mask">gfp_mask</a> | <a class="macro" href="../include/linux/gfp.h.html#207" title="(( gfp_t)0x8000u)" data-ref="_M/__GFP_ZERO">__GFP_ZERO</a>, <var>0</var>);</td></tr>
<tr><th id="4248">4248</th><td>}</td></tr>
<tr><th id="4249">4249</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(get_zeroed_page) get_zeroed_page; static const char __kstrtab_get_zeroed_page[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;get_zeroed_page&quot;; static const struct kernel_symbol __ksymtab_get_zeroed_page __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;get_zeroed_page&quot;), used)) = { (unsigned long)&amp;get_zeroed_page, __kstrtab_get_zeroed_page }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#get_zeroed_page" title='get_zeroed_page' data-ref="get_zeroed_page"><a class="ref fn" href="#get_zeroed_page" title='get_zeroed_page' data-ref="get_zeroed_page"><a class="ref fn" href="#get_zeroed_page" title='get_zeroed_page' data-ref="get_zeroed_page"><a class="ref fn" href="#get_zeroed_page" title='get_zeroed_page' data-ref="get_zeroed_page">get_zeroed_page</a></a></a></a>);</td></tr>
<tr><th id="4250">4250</th><td></td></tr>
<tr><th id="4251">4251</th><td><em>void</em> <dfn class="decl def fn" id="__free_pages" title='__free_pages' data-ref="__free_pages">__free_pages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col7 decl" id="867page" title='page' data-type='struct page *' data-ref="867page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="868order" title='order' data-type='unsigned int' data-ref="868order">order</dfn>)</td></tr>
<tr><th id="4252">4252</th><td>{</td></tr>
<tr><th id="4253">4253</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/mm.h.html#put_page_testzero" title='put_page_testzero' data-ref="put_page_testzero">put_page_testzero</a>(<a class="local col7 ref" href="#867page" title='page' data-ref="867page">page</a>)) {</td></tr>
<tr><th id="4254">4254</th><td>		<b>if</b> (<a class="local col8 ref" href="#868order" title='order' data-ref="868order">order</a> == <var>0</var>)</td></tr>
<tr><th id="4255">4255</th><td>			<a class="ref fn" href="#free_hot_cold_page" title='free_hot_cold_page' data-ref="free_hot_cold_page">free_hot_cold_page</a>(<a class="local col7 ref" href="#867page" title='page' data-ref="867page">page</a>, <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>);</td></tr>
<tr><th id="4256">4256</th><td>		<b>else</b></td></tr>
<tr><th id="4257">4257</th><td>			<a class="tu ref fn" href="#__free_pages_ok" title='__free_pages_ok' data-use='c' data-ref="__free_pages_ok">__free_pages_ok</a>(<a class="local col7 ref" href="#867page" title='page' data-ref="867page">page</a>, <a class="local col8 ref" href="#868order" title='order' data-ref="868order">order</a>);</td></tr>
<tr><th id="4258">4258</th><td>	}</td></tr>
<tr><th id="4259">4259</th><td>}</td></tr>
<tr><th id="4260">4260</th><td></td></tr>
<tr><th id="4261">4261</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(__free_pages) __free_pages; static const char __kstrtab___free_pages[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;__free_pages&quot;; static const struct kernel_symbol __ksymtab___free_pages __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;__free_pages&quot;), used)) = { (unsigned long)&amp;__free_pages, __kstrtab___free_pages }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages"><a class="ref fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages"><a class="ref fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages"><a class="ref fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages">__free_pages</a></a></a></a>);</td></tr>
<tr><th id="4262">4262</th><td></td></tr>
<tr><th id="4263">4263</th><td><em>void</em> <dfn class="decl def fn" id="free_pages" title='free_pages' data-ref="free_pages">free_pages</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="869addr" title='addr' data-type='unsigned long' data-ref="869addr">addr</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="870order" title='order' data-type='unsigned int' data-ref="870order">order</dfn>)</td></tr>
<tr><th id="4264">4264</th><td>{</td></tr>
<tr><th id="4265">4265</th><td>	<b>if</b> (<a class="local col9 ref" href="#869addr" title='addr' data-ref="869addr">addr</a> != <var>0</var>) {</td></tr>
<tr><th id="4266">4266</th><td>		<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)(!__virt_addr_valid((unsigned long) ((void *)addr))))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>(!<a class="macro" href="../arch/x86/include/asm/page.h.html#72" title="__virt_addr_valid((unsigned long) ((void *)addr))" data-ref="_M/virt_addr_valid">virt_addr_valid</a>((<em>void</em> *)<a class="local col9 ref" href="#869addr" title='addr' data-ref="869addr">addr</a>));</td></tr>
<tr><th id="4267">4267</th><td>		<a class="ref fn" href="#__free_pages" title='__free_pages' data-ref="__free_pages">__free_pages</a>(<a class="macro" href="../arch/x86/include/asm/page.h.html#69" title="(((struct page *)vmemmap_base) + (__phys_addr_nodebug((unsigned long)((void *)addr)) &gt;&gt; 12))" data-ref="_M/virt_to_page">virt_to_page</a>((<em>void</em> *)<a class="local col9 ref" href="#869addr" title='addr' data-ref="869addr">addr</a>), <a class="local col0 ref" href="#870order" title='order' data-ref="870order">order</a>);</td></tr>
<tr><th id="4268">4268</th><td>	}</td></tr>
<tr><th id="4269">4269</th><td>}</td></tr>
<tr><th id="4270">4270</th><td></td></tr>
<tr><th id="4271">4271</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(free_pages) free_pages; static const char __kstrtab_free_pages[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;free_pages&quot;; static const struct kernel_symbol __ksymtab_free_pages __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;free_pages&quot;), used)) = { (unsigned long)&amp;free_pages, __kstrtab_free_pages }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#free_pages" title='free_pages' data-ref="free_pages"><a class="ref fn" href="#free_pages" title='free_pages' data-ref="free_pages"><a class="ref fn" href="#free_pages" title='free_pages' data-ref="free_pages"><a class="ref fn" href="#free_pages" title='free_pages' data-ref="free_pages">free_pages</a></a></a></a>);</td></tr>
<tr><th id="4272">4272</th><td></td></tr>
<tr><th id="4273">4273</th><td><i  data-doc="__page_frag_cache_refill">/*</i></td></tr>
<tr><th id="4274">4274</th><td><i  data-doc="__page_frag_cache_refill"> * Page Fragment:</i></td></tr>
<tr><th id="4275">4275</th><td><i  data-doc="__page_frag_cache_refill"> *  An arbitrary-length arbitrary-offset area of memory which resides</i></td></tr>
<tr><th id="4276">4276</th><td><i  data-doc="__page_frag_cache_refill"> *  within a 0 or higher order page.  Multiple fragments within that page</i></td></tr>
<tr><th id="4277">4277</th><td><i  data-doc="__page_frag_cache_refill"> *  are individually refcounted, in the page's reference counter.</i></td></tr>
<tr><th id="4278">4278</th><td><i  data-doc="__page_frag_cache_refill"> *</i></td></tr>
<tr><th id="4279">4279</th><td><i  data-doc="__page_frag_cache_refill"> * The page_frag functions below provide a simple allocation framework for</i></td></tr>
<tr><th id="4280">4280</th><td><i  data-doc="__page_frag_cache_refill"> * page fragments.  This is used by the network stack and network device</i></td></tr>
<tr><th id="4281">4281</th><td><i  data-doc="__page_frag_cache_refill"> * drivers to provide a backing region of memory for use as either an</i></td></tr>
<tr><th id="4282">4282</th><td><i  data-doc="__page_frag_cache_refill"> * sk_buff-&gt;head, or to be used in the "frags" portion of skb_shared_info.</i></td></tr>
<tr><th id="4283">4283</th><td><i  data-doc="__page_frag_cache_refill"> */</i></td></tr>
<tr><th id="4284">4284</th><td><em>static</em> <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="tu decl def fn" id="__page_frag_cache_refill" title='__page_frag_cache_refill' data-type='struct page * __page_frag_cache_refill(struct page_frag_cache * nc, gfp_t gfp_mask)' data-ref="__page_frag_cache_refill">__page_frag_cache_refill</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page_frag_cache" title='page_frag_cache' data-ref="page_frag_cache">page_frag_cache</a> *<dfn class="local col1 decl" id="871nc" title='nc' data-type='struct page_frag_cache *' data-ref="871nc">nc</dfn>,</td></tr>
<tr><th id="4285">4285</th><td>					     <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col2 decl" id="872gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="872gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="4286">4286</th><td>{</td></tr>
<tr><th id="4287">4287</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col3 decl" id="873page" title='page' data-type='struct page *' data-ref="873page">page</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4288">4288</th><td>	<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col4 decl" id="874gfp" title='gfp' data-type='gfp_t' data-ref="874gfp">gfp</dfn> = <a class="local col2 ref" href="#872gfp_mask" title='gfp_mask' data-ref="872gfp_mask">gfp_mask</a>;</td></tr>
<tr><th id="4289">4289</th><td></td></tr>
<tr><th id="4290">4290</th><td><u>#<span data-ppcond="4290">if</span> (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &lt; <a class="macro" href="../include/linux/mm_types.h.html#223" title="((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))" data-ref="_M/PAGE_FRAG_CACHE_MAX_SIZE">PAGE_FRAG_CACHE_MAX_SIZE</a>)</u></td></tr>
<tr><th id="4291">4291</th><td>	<a class="local col2 ref" href="#872gfp_mask" title='gfp_mask' data-ref="872gfp_mask">gfp_mask</a> |= <a class="macro" href="../include/linux/gfp.h.html#206" title="(( gfp_t)0x4000u)" data-ref="_M/__GFP_COMP">__GFP_COMP</a> | <a class="macro" href="../include/linux/gfp.h.html#205" title="(( gfp_t)0x200u)" data-ref="_M/__GFP_NOWARN">__GFP_NOWARN</a> | <a class="macro" href="../include/linux/gfp.h.html#190" title="(( gfp_t)0x1000u)" data-ref="_M/__GFP_NORETRY">__GFP_NORETRY</a> |</td></tr>
<tr><th id="4292">4292</th><td>		    <a class="macro" href="../include/linux/gfp.h.html#115" title="(( gfp_t)0x10000u)" data-ref="_M/__GFP_NOMEMALLOC">__GFP_NOMEMALLOC</a>;</td></tr>
<tr><th id="4293">4293</th><td>	<a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a> = <a class="ref fn" href="../include/linux/gfp.h.html#alloc_pages_node" title='alloc_pages_node' data-ref="alloc_pages_node">alloc_pages_node</a>(<a class="macro" href="../include/linux/numa.h.html#14" title="(-1)" data-ref="_M/NUMA_NO_NODE">NUMA_NO_NODE</a>, <a class="local col2 ref" href="#872gfp_mask" title='gfp_mask' data-ref="872gfp_mask">gfp_mask</a>,</td></tr>
<tr><th id="4294">4294</th><td>				<a class="macro" href="../include/linux/mm_types.h.html#224" title="( __builtin_constant_p(((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) ? ( ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) == 0UL) ? 64 - 12 : (((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) &lt; (1UL &lt;&lt; 12)) ? 0 : ( __builtin_constant_p((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) ? ( ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &lt; 2 ? 0 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 63) ? 63 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 62) ? 62 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 61) ? 61 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 60) ? 60 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 59) ? 59 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 58) ? 58 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 57) ? 57 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 56) ? 56 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 55) ? 55 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 54) ? 54 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 53) ? 53 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 52) ? 52 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 51) ? 51 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 50) ? 50 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 49) ? 49 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 48) ? 48 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 47) ? 47 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 46) ? 46 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 45) ? 45 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 44) ? 44 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 43) ? 43 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 42) ? 42 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 41) ? 41 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 40) ? 40 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 39) ? 39 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 38) ? 38 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 37) ? 37 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 36) ? 36 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 35) ? 35 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 34) ? 34 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 33) ? 33 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 32) ? 32 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 31) ? 31 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 30) ? 30 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 29) ? 29 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 28) ? 28 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 27) ? 27 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 26) ? 26 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 25) ? 25 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 24) ? 24 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 23) ? 23 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 22) ? 22 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 21) ? 21 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 20) ? 20 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 19) ? 19 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 18) ? 18 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 17) ? 17 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 16) ? 16 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 15) ? 15 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 14) ? 14 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 13) ? 13 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 12) ? 12 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 11) ? 11 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 10) ? 10 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 9) ? 9 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 8) ? 8 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 7) ? 7 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 6) ? 6 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 5) ? 5 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 4) ? 4 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 3) ? 3 : ((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) &lt;= 4) ? __ilog2_u32((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) : __ilog2_u64((((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) - 1) ) - 12 + 1) ) : __get_order(((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))) )" data-ref="_M/PAGE_FRAG_CACHE_MAX_ORDER">PAGE_FRAG_CACHE_MAX_ORDER</a>);</td></tr>
<tr><th id="4295">4295</th><td>	<a class="local col1 ref" href="#871nc" title='nc' data-ref="871nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::size" title='page_frag_cache::size' data-ref="page_frag_cache::size">size</a> = <a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a> ? <a class="macro" href="../include/linux/mm_types.h.html#223" title="((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))" data-ref="_M/PAGE_FRAG_CACHE_MAX_SIZE">PAGE_FRAG_CACHE_MAX_SIZE</a> : <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>;</td></tr>
<tr><th id="4296">4296</th><td><u>#<span data-ppcond="4290">endif</span></u></td></tr>
<tr><th id="4297">4297</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(!page), 0)" data-ref="_M/unlikely">unlikely</a>(!<a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a>))</td></tr>
<tr><th id="4298">4298</th><td>		<a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a> = <a class="ref fn" href="../include/linux/gfp.h.html#alloc_pages_node" title='alloc_pages_node' data-ref="alloc_pages_node">alloc_pages_node</a>(<a class="macro" href="../include/linux/numa.h.html#14" title="(-1)" data-ref="_M/NUMA_NO_NODE">NUMA_NO_NODE</a>, <a class="local col4 ref" href="#874gfp" title='gfp' data-ref="874gfp">gfp</a>, <var>0</var>);</td></tr>
<tr><th id="4299">4299</th><td></td></tr>
<tr><th id="4300">4300</th><td>	<a class="local col1 ref" href="#871nc" title='nc' data-ref="871nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::va" title='page_frag_cache::va' data-ref="page_frag_cache::va">va</a> = <a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a> ? <a class="macro" href="../include/linux/mm.h.html#1103" title="lowmem_page_address(page)" data-ref="_M/page_address">page_address</a>(<a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a>) : <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4301">4301</th><td></td></tr>
<tr><th id="4302">4302</th><td>	<b>return</b> <a class="local col3 ref" href="#873page" title='page' data-ref="873page">page</a>;</td></tr>
<tr><th id="4303">4303</th><td>}</td></tr>
<tr><th id="4304">4304</th><td></td></tr>
<tr><th id="4305">4305</th><td><em>void</em> <dfn class="decl def fn" id="__page_frag_cache_drain" title='__page_frag_cache_drain' data-ref="__page_frag_cache_drain">__page_frag_cache_drain</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col5 decl" id="875page" title='page' data-type='struct page *' data-ref="875page">page</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="876count" title='count' data-type='unsigned int' data-ref="876count">count</dfn>)</td></tr>
<tr><th id="4306">4306</th><td>{</td></tr>
<tr><th id="4307">4307</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#46" title="((void)(sizeof(( long)(page_ref_count(page) == 0))))" data-ref="_M/VM_BUG_ON_PAGE">VM_BUG_ON_PAGE</a>(<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_count" title='page_ref_count' data-ref="page_ref_count">page_ref_count</a>(<a class="local col5 ref" href="#875page" title='page' data-ref="875page">page</a>) == <var>0</var>, page);</td></tr>
<tr><th id="4308">4308</th><td></td></tr>
<tr><th id="4309">4309</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_sub_and_test" title='page_ref_sub_and_test' data-ref="page_ref_sub_and_test">page_ref_sub_and_test</a>(<a class="local col5 ref" href="#875page" title='page' data-ref="875page">page</a>, <a class="local col6 ref" href="#876count" title='count' data-ref="876count">count</a>)) {</td></tr>
<tr><th id="4310">4310</th><td>		<em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="877order" title='order' data-type='unsigned int' data-ref="877order">order</dfn> = <a class="ref fn" href="../include/linux/mm.h.html#compound_order" title='compound_order' data-ref="compound_order">compound_order</a>(<a class="local col5 ref" href="#875page" title='page' data-ref="875page">page</a>);</td></tr>
<tr><th id="4311">4311</th><td></td></tr>
<tr><th id="4312">4312</th><td>		<b>if</b> (<a class="local col7 ref" href="#877order" title='order' data-ref="877order">order</a> == <var>0</var>)</td></tr>
<tr><th id="4313">4313</th><td>			<a class="ref fn" href="#free_hot_cold_page" title='free_hot_cold_page' data-ref="free_hot_cold_page">free_hot_cold_page</a>(<a class="local col5 ref" href="#875page" title='page' data-ref="875page">page</a>, <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>);</td></tr>
<tr><th id="4314">4314</th><td>		<b>else</b></td></tr>
<tr><th id="4315">4315</th><td>			<a class="tu ref fn" href="#__free_pages_ok" title='__free_pages_ok' data-use='c' data-ref="__free_pages_ok">__free_pages_ok</a>(<a class="local col5 ref" href="#875page" title='page' data-ref="875page">page</a>, <a class="local col7 ref" href="#877order" title='order' data-ref="877order">order</a>);</td></tr>
<tr><th id="4316">4316</th><td>	}</td></tr>
<tr><th id="4317">4317</th><td>}</td></tr>
<tr><th id="4318">4318</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(__page_frag_cache_drain) __page_frag_cache_drain; static const char __kstrtab___page_frag_cache_drain[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;__page_frag_cache_drain&quot;; static const struct kernel_symbol __ksymtab___page_frag_cache_drain __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;__page_frag_cache_drain&quot;), used)) = { (unsigned long)&amp;__page_frag_cache_drain, __kstrtab___page_frag_cache_drain }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#__page_frag_cache_drain" title='__page_frag_cache_drain' data-ref="__page_frag_cache_drain"><a class="ref fn" href="#__page_frag_cache_drain" title='__page_frag_cache_drain' data-ref="__page_frag_cache_drain"><a class="ref fn" href="#__page_frag_cache_drain" title='__page_frag_cache_drain' data-ref="__page_frag_cache_drain"><a class="ref fn" href="#__page_frag_cache_drain" title='__page_frag_cache_drain' data-ref="__page_frag_cache_drain">__page_frag_cache_drain</a></a></a></a>);</td></tr>
<tr><th id="4319">4319</th><td></td></tr>
<tr><th id="4320">4320</th><td><em>void</em> *<dfn class="decl def fn" id="page_frag_alloc" title='page_frag_alloc' data-ref="page_frag_alloc">page_frag_alloc</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page_frag_cache" title='page_frag_cache' data-ref="page_frag_cache">page_frag_cache</a> *<dfn class="local col8 decl" id="878nc" title='nc' data-type='struct page_frag_cache *' data-ref="878nc">nc</dfn>,</td></tr>
<tr><th id="4321">4321</th><td>		      <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="879fragsz" title='fragsz' data-type='unsigned int' data-ref="879fragsz">fragsz</dfn>, <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col0 decl" id="880gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="880gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="4322">4322</th><td>{</td></tr>
<tr><th id="4323">4323</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="881size" title='size' data-type='unsigned int' data-ref="881size">size</dfn> = <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>;</td></tr>
<tr><th id="4324">4324</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="882page" title='page' data-type='struct page *' data-ref="882page">page</dfn>;</td></tr>
<tr><th id="4325">4325</th><td>	<em>int</em> <dfn class="local col3 decl" id="883offset" title='offset' data-type='int' data-ref="883offset">offset</dfn>;</td></tr>
<tr><th id="4326">4326</th><td></td></tr>
<tr><th id="4327">4327</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(!nc-&gt;va), 0)" data-ref="_M/unlikely">unlikely</a>(!<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::va" title='page_frag_cache::va' data-ref="page_frag_cache::va">va</a>)) {</td></tr>
<tr><th id="4328">4328</th><td><dfn class="lbl" id="884refill" data-ref="884refill">refill</dfn>:</td></tr>
<tr><th id="4329">4329</th><td>		<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a> = <a class="tu ref fn" href="#__page_frag_cache_refill" title='__page_frag_cache_refill' data-use='c' data-ref="__page_frag_cache_refill">__page_frag_cache_refill</a>(<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>, <a class="local col0 ref" href="#880gfp_mask" title='gfp_mask' data-ref="880gfp_mask">gfp_mask</a>);</td></tr>
<tr><th id="4330">4330</th><td>		<b>if</b> (!<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a>)</td></tr>
<tr><th id="4331">4331</th><td>			<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4332">4332</th><td></td></tr>
<tr><th id="4333">4333</th><td><u>#<span data-ppcond="4333">if</span> (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &lt; <a class="macro" href="../include/linux/mm_types.h.html#223" title="((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))" data-ref="_M/PAGE_FRAG_CACHE_MAX_SIZE">PAGE_FRAG_CACHE_MAX_SIZE</a>)</u></td></tr>
<tr><th id="4334">4334</th><td>		<i>/* if size can vary use size else just use PAGE_SIZE */</i></td></tr>
<tr><th id="4335">4335</th><td>		<a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a> = <a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::size" title='page_frag_cache::size' data-ref="page_frag_cache::size">size</a>;</td></tr>
<tr><th id="4336">4336</th><td><u>#<span data-ppcond="4333">endif</span></u></td></tr>
<tr><th id="4337">4337</th><td>		<i>/* Even if we own the page, we do not use atomic_set().</i></td></tr>
<tr><th id="4338">4338</th><td><i>		 * This would break get_page_unless_zero() users.</i></td></tr>
<tr><th id="4339">4339</th><td><i>		 */</i></td></tr>
<tr><th id="4340">4340</th><td>		<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_add" title='page_ref_add' data-ref="page_ref_add">page_ref_add</a>(<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a>, <a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a> - <var>1</var>);</td></tr>
<tr><th id="4341">4341</th><td></td></tr>
<tr><th id="4342">4342</th><td>		<i>/* reset page count bias and offset to start of new frag */</i></td></tr>
<tr><th id="4343">4343</th><td>		<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::pfmemalloc" title='page_frag_cache::pfmemalloc' data-ref="page_frag_cache::pfmemalloc">pfmemalloc</a> = <a class="ref fn" href="../include/linux/mm.h.html#page_is_pfmemalloc" title='page_is_pfmemalloc' data-ref="page_is_pfmemalloc">page_is_pfmemalloc</a>(<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a>);</td></tr>
<tr><th id="4344">4344</th><td>		<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::pagecnt_bias" title='page_frag_cache::pagecnt_bias' data-ref="page_frag_cache::pagecnt_bias">pagecnt_bias</a> = <a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a>;</td></tr>
<tr><th id="4345">4345</th><td>		<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::offset" title='page_frag_cache::offset' data-ref="page_frag_cache::offset">offset</a> = <a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a>;</td></tr>
<tr><th id="4346">4346</th><td>	}</td></tr>
<tr><th id="4347">4347</th><td></td></tr>
<tr><th id="4348">4348</th><td>	<a class="local col3 ref" href="#883offset" title='offset' data-ref="883offset">offset</a> = <a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::offset" title='page_frag_cache::offset' data-ref="page_frag_cache::offset">offset</a> - <a class="local col9 ref" href="#879fragsz" title='fragsz' data-ref="879fragsz">fragsz</a>;</td></tr>
<tr><th id="4349">4349</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(offset &lt; 0), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col3 ref" href="#883offset" title='offset' data-ref="883offset">offset</a> &lt; <var>0</var>)) {</td></tr>
<tr><th id="4350">4350</th><td>		<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a> = <a class="macro" href="../arch/x86/include/asm/page.h.html#69" title="(((struct page *)vmemmap_base) + (__phys_addr_nodebug((unsigned long)(nc-&gt;va)) &gt;&gt; 12))" data-ref="_M/virt_to_page">virt_to_page</a>(<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::va" title='page_frag_cache::va' data-ref="page_frag_cache::va">va</a>);</td></tr>
<tr><th id="4351">4351</th><td></td></tr>
<tr><th id="4352">4352</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_sub_and_test" title='page_ref_sub_and_test' data-ref="page_ref_sub_and_test">page_ref_sub_and_test</a>(<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a>, <a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::pagecnt_bias" title='page_frag_cache::pagecnt_bias' data-ref="page_frag_cache::pagecnt_bias">pagecnt_bias</a>))</td></tr>
<tr><th id="4353">4353</th><td>			<b>goto</b> <a class="lbl" href="#884refill" data-ref="884refill">refill</a>;</td></tr>
<tr><th id="4354">4354</th><td></td></tr>
<tr><th id="4355">4355</th><td><u>#<span data-ppcond="4355">if</span> (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &lt; <a class="macro" href="../include/linux/mm_types.h.html#223" title="((((32768)) + ((~(~(((1UL) &lt;&lt; 12)-1))))) &amp; ~((~(~(((1UL) &lt;&lt; 12)-1)))))" data-ref="_M/PAGE_FRAG_CACHE_MAX_SIZE">PAGE_FRAG_CACHE_MAX_SIZE</a>)</u></td></tr>
<tr><th id="4356">4356</th><td>		<i>/* if size can vary use size else just use PAGE_SIZE */</i></td></tr>
<tr><th id="4357">4357</th><td>		<a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a> = <a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::size" title='page_frag_cache::size' data-ref="page_frag_cache::size">size</a>;</td></tr>
<tr><th id="4358">4358</th><td><u>#<span data-ppcond="4355">endif</span></u></td></tr>
<tr><th id="4359">4359</th><td>		<i>/* OK, page count is 0, we can safely set it */</i></td></tr>
<tr><th id="4360">4360</th><td>		<a class="ref fn" href="../include/linux/page_ref.h.html#set_page_count" title='set_page_count' data-ref="set_page_count">set_page_count</a>(<a class="local col2 ref" href="#882page" title='page' data-ref="882page">page</a>, <a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a>);</td></tr>
<tr><th id="4361">4361</th><td></td></tr>
<tr><th id="4362">4362</th><td>		<i>/* reset page count bias and offset to start of new frag */</i></td></tr>
<tr><th id="4363">4363</th><td>		<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::pagecnt_bias" title='page_frag_cache::pagecnt_bias' data-ref="page_frag_cache::pagecnt_bias">pagecnt_bias</a> = <a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a>;</td></tr>
<tr><th id="4364">4364</th><td>		<a class="local col3 ref" href="#883offset" title='offset' data-ref="883offset">offset</a> = <a class="local col1 ref" href="#881size" title='size' data-ref="881size">size</a> - <a class="local col9 ref" href="#879fragsz" title='fragsz' data-ref="879fragsz">fragsz</a>;</td></tr>
<tr><th id="4365">4365</th><td>	}</td></tr>
<tr><th id="4366">4366</th><td></td></tr>
<tr><th id="4367">4367</th><td>	<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::pagecnt_bias" title='page_frag_cache::pagecnt_bias' data-ref="page_frag_cache::pagecnt_bias">pagecnt_bias</a>--;</td></tr>
<tr><th id="4368">4368</th><td>	<a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::offset" title='page_frag_cache::offset' data-ref="page_frag_cache::offset">offset</a> = <a class="local col3 ref" href="#883offset" title='offset' data-ref="883offset">offset</a>;</td></tr>
<tr><th id="4369">4369</th><td></td></tr>
<tr><th id="4370">4370</th><td>	<b>return</b> <a class="local col8 ref" href="#878nc" title='nc' data-ref="878nc">nc</a>-&gt;<a class="ref field" href="../include/linux/mm_types.h.html#page_frag_cache::va" title='page_frag_cache::va' data-ref="page_frag_cache::va">va</a> + <a class="local col3 ref" href="#883offset" title='offset' data-ref="883offset">offset</a>;</td></tr>
<tr><th id="4371">4371</th><td>}</td></tr>
<tr><th id="4372">4372</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(page_frag_alloc) page_frag_alloc; static const char __kstrtab_page_frag_alloc[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;page_frag_alloc&quot;; static const struct kernel_symbol __ksymtab_page_frag_alloc __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;page_frag_alloc&quot;), used)) = { (unsigned long)&amp;page_frag_alloc, __kstrtab_page_frag_alloc }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#page_frag_alloc" title='page_frag_alloc' data-ref="page_frag_alloc"><a class="ref fn" href="#page_frag_alloc" title='page_frag_alloc' data-ref="page_frag_alloc"><a class="ref fn" href="#page_frag_alloc" title='page_frag_alloc' data-ref="page_frag_alloc"><a class="ref fn" href="#page_frag_alloc" title='page_frag_alloc' data-ref="page_frag_alloc">page_frag_alloc</a></a></a></a>);</td></tr>
<tr><th id="4373">4373</th><td></td></tr>
<tr><th id="4374">4374</th><td><i>/*</i></td></tr>
<tr><th id="4375">4375</th><td><i> * Frees a page fragment allocated out of either a compound or order 0 page.</i></td></tr>
<tr><th id="4376">4376</th><td><i> */</i></td></tr>
<tr><th id="4377">4377</th><td><em>void</em> <dfn class="decl def fn" id="page_frag_free" title='page_frag_free' data-ref="page_frag_free">page_frag_free</dfn>(<em>void</em> *<dfn class="local col5 decl" id="885addr" title='addr' data-type='void *' data-ref="885addr">addr</dfn>)</td></tr>
<tr><th id="4378">4378</th><td>{</td></tr>
<tr><th id="4379">4379</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col6 decl" id="886page" title='page' data-type='struct page *' data-ref="886page">page</dfn> = <a class="ref fn" href="../include/linux/mm.h.html#virt_to_head_page" title='virt_to_head_page' data-ref="virt_to_head_page">virt_to_head_page</a>(<a class="local col5 ref" href="#885addr" title='addr' data-ref="885addr">addr</a>);</td></tr>
<tr><th id="4380">4380</th><td></td></tr>
<tr><th id="4381">4381</th><td>	<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(put_page_testzero(page)), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="ref fn" href="../include/linux/mm.h.html#put_page_testzero" title='put_page_testzero' data-ref="put_page_testzero">put_page_testzero</a>(<a class="local col6 ref" href="#886page" title='page' data-ref="886page">page</a>)))</td></tr>
<tr><th id="4382">4382</th><td>		<a class="tu ref fn" href="#__free_pages_ok" title='__free_pages_ok' data-use='c' data-ref="__free_pages_ok">__free_pages_ok</a>(<a class="local col6 ref" href="#886page" title='page' data-ref="886page">page</a>, <a class="ref fn" href="../include/linux/mm.h.html#compound_order" title='compound_order' data-ref="compound_order">compound_order</a>(<a class="local col6 ref" href="#886page" title='page' data-ref="886page">page</a>));</td></tr>
<tr><th id="4383">4383</th><td>}</td></tr>
<tr><th id="4384">4384</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(page_frag_free) page_frag_free; static const char __kstrtab_page_frag_free[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;page_frag_free&quot;; static const struct kernel_symbol __ksymtab_page_frag_free __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;page_frag_free&quot;), used)) = { (unsigned long)&amp;page_frag_free, __kstrtab_page_frag_free }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#page_frag_free" title='page_frag_free' data-ref="page_frag_free"><a class="ref fn" href="#page_frag_free" title='page_frag_free' data-ref="page_frag_free"><a class="ref fn" href="#page_frag_free" title='page_frag_free' data-ref="page_frag_free"><a class="ref fn" href="#page_frag_free" title='page_frag_free' data-ref="page_frag_free">page_frag_free</a></a></a></a>);</td></tr>
<tr><th id="4385">4385</th><td></td></tr>
<tr><th id="4386">4386</th><td><em>static</em> <em>void</em> *<dfn class="tu decl def fn" id="make_alloc_exact" title='make_alloc_exact' data-type='void * make_alloc_exact(unsigned long addr, unsigned int order, size_t size)' data-ref="make_alloc_exact">make_alloc_exact</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="887addr" title='addr' data-type='unsigned long' data-ref="887addr">addr</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="888order" title='order' data-type='unsigned int' data-ref="888order">order</dfn>,</td></tr>
<tr><th id="4387">4387</th><td>		<a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> <dfn class="local col9 decl" id="889size" title='size' data-type='size_t' data-ref="889size">size</dfn>)</td></tr>
<tr><th id="4388">4388</th><td>{</td></tr>
<tr><th id="4389">4389</th><td>	<b>if</b> (<a class="local col7 ref" href="#887addr" title='addr' data-ref="887addr">addr</a>) {</td></tr>
<tr><th id="4390">4390</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="890alloc_end" title='alloc_end' data-type='unsigned long' data-ref="890alloc_end">alloc_end</dfn> = <a class="local col7 ref" href="#887addr" title='addr' data-ref="887addr">addr</a> + (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &lt;&lt; <a class="local col8 ref" href="#888order" title='order' data-ref="888order">order</a>);</td></tr>
<tr><th id="4391">4391</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="891used" title='used' data-type='unsigned long' data-ref="891used">used</dfn> = <a class="local col7 ref" href="#887addr" title='addr' data-ref="887addr">addr</a> + <a class="macro" href="../include/linux/mm.h.html#134" title="((((size)) + ((typeof((size)))((((1UL) &lt;&lt; 12))) - 1)) &amp; ~((typeof((size)))((((1UL) &lt;&lt; 12))) - 1))" data-ref="_M/PAGE_ALIGN">PAGE_ALIGN</a>(<a class="local col9 ref" href="#889size" title='size' data-ref="889size">size</a>);</td></tr>
<tr><th id="4392">4392</th><td></td></tr>
<tr><th id="4393">4393</th><td>		<a class="ref fn" href="#split_page" title='split_page' data-ref="split_page">split_page</a>(<a class="macro" href="../arch/x86/include/asm/page.h.html#69" title="(((struct page *)vmemmap_base) + (__phys_addr_nodebug((unsigned long)((void *)addr)) &gt;&gt; 12))" data-ref="_M/virt_to_page">virt_to_page</a>((<em>void</em> *)<a class="local col7 ref" href="#887addr" title='addr' data-ref="887addr">addr</a>), <a class="local col8 ref" href="#888order" title='order' data-ref="888order">order</a>);</td></tr>
<tr><th id="4394">4394</th><td>		<b>while</b> (<a class="local col1 ref" href="#891used" title='used' data-ref="891used">used</a> &lt; <a class="local col0 ref" href="#890alloc_end" title='alloc_end' data-ref="890alloc_end">alloc_end</a>) {</td></tr>
<tr><th id="4395">4395</th><td>			<a class="macro" href="../include/linux/gfp.h.html#543" title="free_pages((used), 0)" data-ref="_M/free_page">free_page</a>(<a class="local col1 ref" href="#891used" title='used' data-ref="891used">used</a>);</td></tr>
<tr><th id="4396">4396</th><td>			<a class="local col1 ref" href="#891used" title='used' data-ref="891used">used</a> += <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>;</td></tr>
<tr><th id="4397">4397</th><td>		}</td></tr>
<tr><th id="4398">4398</th><td>	}</td></tr>
<tr><th id="4399">4399</th><td>	<b>return</b> (<em>void</em> *)<a class="local col7 ref" href="#887addr" title='addr' data-ref="887addr">addr</a>;</td></tr>
<tr><th id="4400">4400</th><td>}</td></tr>
<tr><th id="4401">4401</th><td></td></tr>
<tr><th id="4402">4402</th><td><i class="doc">/**</i></td></tr>
<tr><th id="4403">4403</th><td><i class="doc"> * alloc_pages_exact - allocate an exact number physically-contiguous pages.</i></td></tr>
<tr><th id="4404">4404</th><td><i class="doc"> *<span class="command"> @size</span>: the number of bytes to allocate</i></td></tr>
<tr><th id="4405">4405</th><td><i class="doc"> *<span class="command"> @gfp</span>_mask: GFP flags for the allocation</i></td></tr>
<tr><th id="4406">4406</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4407">4407</th><td><i class="doc"> * This function is similar to alloc_pages(), except that it allocates the</i></td></tr>
<tr><th id="4408">4408</th><td><i class="doc"> * minimum number of pages to satisfy the request.  alloc_pages() can only</i></td></tr>
<tr><th id="4409">4409</th><td><i class="doc"> * allocate memory in power-of-two pages.</i></td></tr>
<tr><th id="4410">4410</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4411">4411</th><td><i class="doc"> * This function is also limited by MAX_ORDER.</i></td></tr>
<tr><th id="4412">4412</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4413">4413</th><td><i class="doc"> * Memory allocated by this function must be released by free_pages_exact().</i></td></tr>
<tr><th id="4414">4414</th><td><i class="doc"> */</i></td></tr>
<tr><th id="4415">4415</th><td><em>void</em> *<dfn class="decl def fn" id="alloc_pages_exact" title='alloc_pages_exact' data-ref="alloc_pages_exact">alloc_pages_exact</dfn>(<a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> <dfn class="local col2 decl" id="892size" title='size' data-type='size_t' data-ref="892size">size</dfn>, <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col3 decl" id="893gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="893gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="4416">4416</th><td>{</td></tr>
<tr><th id="4417">4417</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="894order" title='order' data-type='unsigned int' data-ref="894order">order</dfn> = <a class="macro" href="../include/asm-generic/getorder.h.html#50" title="( __builtin_constant_p(size) ? ( ((size) == 0UL) ? 64 - 12 : (((size) &lt; (1UL &lt;&lt; 12)) ? 0 : ( __builtin_constant_p((size) - 1) ? ( ((size) - 1) &lt; 2 ? 0 : ((size) - 1) &amp; (1ULL &lt;&lt; 63) ? 63 : ((size) - 1) &amp; (1ULL &lt;&lt; 62) ? 62 : ((size) - 1) &amp; (1ULL &lt;&lt; 61) ? 61 : ((size) - 1) &amp; (1ULL &lt;&lt; 60) ? 60 : ((size) - 1) &amp; (1ULL &lt;&lt; 59) ? 59 : ((size) - 1) &amp; (1ULL &lt;&lt; 58) ? 58 : ((size) - 1) &amp; (1ULL &lt;&lt; 57) ? 57 : ((size) - 1) &amp; (1ULL &lt;&lt; 56) ? 56 : ((size) - 1) &amp; (1ULL &lt;&lt; 55) ? 55 : ((size) - 1) &amp; (1ULL &lt;&lt; 54) ? 54 : ((size) - 1) &amp; (1ULL &lt;&lt; 53) ? 53 : ((size) - 1) &amp; (1ULL &lt;&lt; 52) ? 52 : ((size) - 1) &amp; (1ULL &lt;&lt; 51) ? 51 : ((size) - 1) &amp; (1ULL &lt;&lt; 50) ? 50 : ((size) - 1) &amp; (1ULL &lt;&lt; 49) ? 49 : ((size) - 1) &amp; (1ULL &lt;&lt; 48) ? 48 : ((size) - 1) &amp; (1ULL &lt;&lt; 47) ? 47 : ((size) - 1) &amp; (1ULL &lt;&lt; 46) ? 46 : ((size) - 1) &amp; (1ULL &lt;&lt; 45) ? 45 : ((size) - 1) &amp; (1ULL &lt;&lt; 44) ? 44 : ((size) - 1) &amp; (1ULL &lt;&lt; 43) ? 43 : ((size) - 1) &amp; (1ULL &lt;&lt; 42) ? 42 : ((size) - 1) &amp; (1ULL &lt;&lt; 41) ? 41 : ((size) - 1) &amp; (1ULL &lt;&lt; 40) ? 40 : ((size) - 1) &amp; (1ULL &lt;&lt; 39) ? 39 : ((size) - 1) &amp; (1ULL &lt;&lt; 38) ? 38 : ((size) - 1) &amp; (1ULL &lt;&lt; 37) ? 37 : ((size) - 1) &amp; (1ULL &lt;&lt; 36) ? 36 : ((size) - 1) &amp; (1ULL &lt;&lt; 35) ? 35 : ((size) - 1) &amp; (1ULL &lt;&lt; 34) ? 34 : ((size) - 1) &amp; (1ULL &lt;&lt; 33) ? 33 : ((size) - 1) &amp; (1ULL &lt;&lt; 32) ? 32 : ((size) - 1) &amp; (1ULL &lt;&lt; 31) ? 31 : ((size) - 1) &amp; (1ULL &lt;&lt; 30) ? 30 : ((size) - 1) &amp; (1ULL &lt;&lt; 29) ? 29 : ((size) - 1) &amp; (1ULL &lt;&lt; 28) ? 28 : ((size) - 1) &amp; (1ULL &lt;&lt; 27) ? 27 : ((size) - 1) &amp; (1ULL &lt;&lt; 26) ? 26 : ((size) - 1) &amp; (1ULL &lt;&lt; 25) ? 25 : ((size) - 1) &amp; (1ULL &lt;&lt; 24) ? 24 : ((size) - 1) &amp; (1ULL &lt;&lt; 23) ? 23 : ((size) - 1) &amp; (1ULL &lt;&lt; 22) ? 22 : ((size) - 1) &amp; (1ULL &lt;&lt; 21) ? 21 : ((size) - 1) &amp; (1ULL &lt;&lt; 20) ? 20 : ((size) - 1) &amp; (1ULL &lt;&lt; 19) ? 19 : ((size) - 1) &amp; (1ULL &lt;&lt; 18) ? 18 : ((size) - 1) &amp; (1ULL &lt;&lt; 17) ? 17 : ((size) - 1) &amp; (1ULL &lt;&lt; 16) ? 16 : ((size) - 1) &amp; (1ULL &lt;&lt; 15) ? 15 : ((size) - 1) &amp; (1ULL &lt;&lt; 14) ? 14 : ((size) - 1) &amp; (1ULL &lt;&lt; 13) ? 13 : ((size) - 1) &amp; (1ULL &lt;&lt; 12) ? 12 : ((size) - 1) &amp; (1ULL &lt;&lt; 11) ? 11 : ((size) - 1) &amp; (1ULL &lt;&lt; 10) ? 10 : ((size) - 1) &amp; (1ULL &lt;&lt; 9) ? 9 : ((size) - 1) &amp; (1ULL &lt;&lt; 8) ? 8 : ((size) - 1) &amp; (1ULL &lt;&lt; 7) ? 7 : ((size) - 1) &amp; (1ULL &lt;&lt; 6) ? 6 : ((size) - 1) &amp; (1ULL &lt;&lt; 5) ? 5 : ((size) - 1) &amp; (1ULL &lt;&lt; 4) ? 4 : ((size) - 1) &amp; (1ULL &lt;&lt; 3) ? 3 : ((size) - 1) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof((size) - 1) &lt;= 4) ? __ilog2_u32((size) - 1) : __ilog2_u64((size) - 1) ) - 12 + 1) ) : __get_order(size) )" data-ref="_M/get_order">get_order</a>(<a class="local col2 ref" href="#892size" title='size' data-ref="892size">size</a>);</td></tr>
<tr><th id="4418">4418</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="895addr" title='addr' data-type='unsigned long' data-ref="895addr">addr</dfn>;</td></tr>
<tr><th id="4419">4419</th><td></td></tr>
<tr><th id="4420">4420</th><td>	<a class="local col5 ref" href="#895addr" title='addr' data-ref="895addr">addr</a> = <a class="ref fn" href="#__get_free_pages" title='__get_free_pages' data-ref="__get_free_pages">__get_free_pages</a>(<a class="local col3 ref" href="#893gfp_mask" title='gfp_mask' data-ref="893gfp_mask">gfp_mask</a>, <a class="local col4 ref" href="#894order" title='order' data-ref="894order">order</a>);</td></tr>
<tr><th id="4421">4421</th><td>	<b>return</b> <a class="tu ref fn" href="#make_alloc_exact" title='make_alloc_exact' data-use='c' data-ref="make_alloc_exact">make_alloc_exact</a>(<a class="local col5 ref" href="#895addr" title='addr' data-ref="895addr">addr</a>, <a class="local col4 ref" href="#894order" title='order' data-ref="894order">order</a>, <a class="local col2 ref" href="#892size" title='size' data-ref="892size">size</a>);</td></tr>
<tr><th id="4422">4422</th><td>}</td></tr>
<tr><th id="4423">4423</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(alloc_pages_exact) alloc_pages_exact; static const char __kstrtab_alloc_pages_exact[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;alloc_pages_exact&quot;; static const struct kernel_symbol __ksymtab_alloc_pages_exact __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;alloc_pages_exact&quot;), used)) = { (unsigned long)&amp;alloc_pages_exact, __kstrtab_alloc_pages_exact }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#alloc_pages_exact" title='alloc_pages_exact' data-ref="alloc_pages_exact"><a class="ref fn" href="#alloc_pages_exact" title='alloc_pages_exact' data-ref="alloc_pages_exact"><a class="ref fn" href="#alloc_pages_exact" title='alloc_pages_exact' data-ref="alloc_pages_exact"><a class="ref fn" href="#alloc_pages_exact" title='alloc_pages_exact' data-ref="alloc_pages_exact">alloc_pages_exact</a></a></a></a>);</td></tr>
<tr><th id="4424">4424</th><td></td></tr>
<tr><th id="4425">4425</th><td><i class="doc">/**</i></td></tr>
<tr><th id="4426">4426</th><td><i class="doc"> * alloc_pages_exact_nid - allocate an exact number of physically-contiguous</i></td></tr>
<tr><th id="4427">4427</th><td><i class="doc"> *			   pages on a node.</i></td></tr>
<tr><th id="4428">4428</th><td><i class="doc"> *<span class="command"> @nid</span>: the preferred node ID where memory should be allocated</i></td></tr>
<tr><th id="4429">4429</th><td><i class="doc"> *<span class="command"> @size</span>: the number of bytes to allocate</i></td></tr>
<tr><th id="4430">4430</th><td><i class="doc"> *<span class="command"> @gfp</span>_mask: GFP flags for the allocation</i></td></tr>
<tr><th id="4431">4431</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4432">4432</th><td><i class="doc"> * Like alloc_pages_exact(), but try to allocate on node nid first before falling</i></td></tr>
<tr><th id="4433">4433</th><td><i class="doc"> * back.</i></td></tr>
<tr><th id="4434">4434</th><td><i class="doc"> */</i></td></tr>
<tr><th id="4435">4435</th><td><em>void</em> * <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="alloc_pages_exact_nid" title='alloc_pages_exact_nid' data-ref="alloc_pages_exact_nid">alloc_pages_exact_nid</dfn>(<em>int</em> <dfn class="local col6 decl" id="896nid" title='nid' data-type='int' data-ref="896nid">nid</dfn>, <a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> <dfn class="local col7 decl" id="897size" title='size' data-type='size_t' data-ref="897size">size</dfn>, <a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col8 decl" id="898gfp_mask" title='gfp_mask' data-type='gfp_t' data-ref="898gfp_mask">gfp_mask</dfn>)</td></tr>
<tr><th id="4436">4436</th><td>{</td></tr>
<tr><th id="4437">4437</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="899order" title='order' data-type='unsigned int' data-ref="899order">order</dfn> = <a class="macro" href="../include/asm-generic/getorder.h.html#50" title="( __builtin_constant_p(size) ? ( ((size) == 0UL) ? 64 - 12 : (((size) &lt; (1UL &lt;&lt; 12)) ? 0 : ( __builtin_constant_p((size) - 1) ? ( ((size) - 1) &lt; 2 ? 0 : ((size) - 1) &amp; (1ULL &lt;&lt; 63) ? 63 : ((size) - 1) &amp; (1ULL &lt;&lt; 62) ? 62 : ((size) - 1) &amp; (1ULL &lt;&lt; 61) ? 61 : ((size) - 1) &amp; (1ULL &lt;&lt; 60) ? 60 : ((size) - 1) &amp; (1ULL &lt;&lt; 59) ? 59 : ((size) - 1) &amp; (1ULL &lt;&lt; 58) ? 58 : ((size) - 1) &amp; (1ULL &lt;&lt; 57) ? 57 : ((size) - 1) &amp; (1ULL &lt;&lt; 56) ? 56 : ((size) - 1) &amp; (1ULL &lt;&lt; 55) ? 55 : ((size) - 1) &amp; (1ULL &lt;&lt; 54) ? 54 : ((size) - 1) &amp; (1ULL &lt;&lt; 53) ? 53 : ((size) - 1) &amp; (1ULL &lt;&lt; 52) ? 52 : ((size) - 1) &amp; (1ULL &lt;&lt; 51) ? 51 : ((size) - 1) &amp; (1ULL &lt;&lt; 50) ? 50 : ((size) - 1) &amp; (1ULL &lt;&lt; 49) ? 49 : ((size) - 1) &amp; (1ULL &lt;&lt; 48) ? 48 : ((size) - 1) &amp; (1ULL &lt;&lt; 47) ? 47 : ((size) - 1) &amp; (1ULL &lt;&lt; 46) ? 46 : ((size) - 1) &amp; (1ULL &lt;&lt; 45) ? 45 : ((size) - 1) &amp; (1ULL &lt;&lt; 44) ? 44 : ((size) - 1) &amp; (1ULL &lt;&lt; 43) ? 43 : ((size) - 1) &amp; (1ULL &lt;&lt; 42) ? 42 : ((size) - 1) &amp; (1ULL &lt;&lt; 41) ? 41 : ((size) - 1) &amp; (1ULL &lt;&lt; 40) ? 40 : ((size) - 1) &amp; (1ULL &lt;&lt; 39) ? 39 : ((size) - 1) &amp; (1ULL &lt;&lt; 38) ? 38 : ((size) - 1) &amp; (1ULL &lt;&lt; 37) ? 37 : ((size) - 1) &amp; (1ULL &lt;&lt; 36) ? 36 : ((size) - 1) &amp; (1ULL &lt;&lt; 35) ? 35 : ((size) - 1) &amp; (1ULL &lt;&lt; 34) ? 34 : ((size) - 1) &amp; (1ULL &lt;&lt; 33) ? 33 : ((size) - 1) &amp; (1ULL &lt;&lt; 32) ? 32 : ((size) - 1) &amp; (1ULL &lt;&lt; 31) ? 31 : ((size) - 1) &amp; (1ULL &lt;&lt; 30) ? 30 : ((size) - 1) &amp; (1ULL &lt;&lt; 29) ? 29 : ((size) - 1) &amp; (1ULL &lt;&lt; 28) ? 28 : ((size) - 1) &amp; (1ULL &lt;&lt; 27) ? 27 : ((size) - 1) &amp; (1ULL &lt;&lt; 26) ? 26 : ((size) - 1) &amp; (1ULL &lt;&lt; 25) ? 25 : ((size) - 1) &amp; (1ULL &lt;&lt; 24) ? 24 : ((size) - 1) &amp; (1ULL &lt;&lt; 23) ? 23 : ((size) - 1) &amp; (1ULL &lt;&lt; 22) ? 22 : ((size) - 1) &amp; (1ULL &lt;&lt; 21) ? 21 : ((size) - 1) &amp; (1ULL &lt;&lt; 20) ? 20 : ((size) - 1) &amp; (1ULL &lt;&lt; 19) ? 19 : ((size) - 1) &amp; (1ULL &lt;&lt; 18) ? 18 : ((size) - 1) &amp; (1ULL &lt;&lt; 17) ? 17 : ((size) - 1) &amp; (1ULL &lt;&lt; 16) ? 16 : ((size) - 1) &amp; (1ULL &lt;&lt; 15) ? 15 : ((size) - 1) &amp; (1ULL &lt;&lt; 14) ? 14 : ((size) - 1) &amp; (1ULL &lt;&lt; 13) ? 13 : ((size) - 1) &amp; (1ULL &lt;&lt; 12) ? 12 : ((size) - 1) &amp; (1ULL &lt;&lt; 11) ? 11 : ((size) - 1) &amp; (1ULL &lt;&lt; 10) ? 10 : ((size) - 1) &amp; (1ULL &lt;&lt; 9) ? 9 : ((size) - 1) &amp; (1ULL &lt;&lt; 8) ? 8 : ((size) - 1) &amp; (1ULL &lt;&lt; 7) ? 7 : ((size) - 1) &amp; (1ULL &lt;&lt; 6) ? 6 : ((size) - 1) &amp; (1ULL &lt;&lt; 5) ? 5 : ((size) - 1) &amp; (1ULL &lt;&lt; 4) ? 4 : ((size) - 1) &amp; (1ULL &lt;&lt; 3) ? 3 : ((size) - 1) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof((size) - 1) &lt;= 4) ? __ilog2_u32((size) - 1) : __ilog2_u64((size) - 1) ) - 12 + 1) ) : __get_order(size) )" data-ref="_M/get_order">get_order</a>(<a class="local col7 ref" href="#897size" title='size' data-ref="897size">size</a>);</td></tr>
<tr><th id="4438">4438</th><td>	<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="900p" title='p' data-type='struct page *' data-ref="900p">p</dfn> = <a class="ref fn" href="../include/linux/gfp.h.html#alloc_pages_node" title='alloc_pages_node' data-ref="alloc_pages_node">alloc_pages_node</a>(<a class="local col6 ref" href="#896nid" title='nid' data-ref="896nid">nid</a>, <a class="local col8 ref" href="#898gfp_mask" title='gfp_mask' data-ref="898gfp_mask">gfp_mask</a>, <a class="local col9 ref" href="#899order" title='order' data-ref="899order">order</a>);</td></tr>
<tr><th id="4439">4439</th><td>	<b>if</b> (!<a class="local col0 ref" href="#900p" title='p' data-ref="900p">p</a>)</td></tr>
<tr><th id="4440">4440</th><td>		<b>return</b> <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4441">4441</th><td>	<b>return</b> <a class="tu ref fn" href="#make_alloc_exact" title='make_alloc_exact' data-use='c' data-ref="make_alloc_exact">make_alloc_exact</a>((<em>unsigned</em> <em>long</em>)<a class="macro" href="../include/linux/mm.h.html#1103" title="lowmem_page_address(p)" data-ref="_M/page_address">page_address</a>(<a class="local col0 ref" href="#900p" title='p' data-ref="900p">p</a>), <a class="local col9 ref" href="#899order" title='order' data-ref="899order">order</a>, <a class="local col7 ref" href="#897size" title='size' data-ref="897size">size</a>);</td></tr>
<tr><th id="4442">4442</th><td>}</td></tr>
<tr><th id="4443">4443</th><td></td></tr>
<tr><th id="4444">4444</th><td><i class="doc">/**</i></td></tr>
<tr><th id="4445">4445</th><td><i class="doc"> * free_pages_exact - release memory allocated via alloc_pages_exact()</i></td></tr>
<tr><th id="4446">4446</th><td><i class="doc"> *<span class="command"> @virt</span>: the value returned by alloc_pages_exact.</i></td></tr>
<tr><th id="4447">4447</th><td><i class="doc"> *<span class="command"> @size</span>: size of allocation, same value as passed to alloc_pages_exact().</i></td></tr>
<tr><th id="4448">4448</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4449">4449</th><td><i class="doc"> * Release the memory allocated by a previous call to alloc_pages_exact.</i></td></tr>
<tr><th id="4450">4450</th><td><i class="doc"> */</i></td></tr>
<tr><th id="4451">4451</th><td><em>void</em> <dfn class="decl def fn" id="free_pages_exact" title='free_pages_exact' data-ref="free_pages_exact">free_pages_exact</dfn>(<em>void</em> *<dfn class="local col1 decl" id="901virt" title='virt' data-type='void *' data-ref="901virt">virt</dfn>, <a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> <dfn class="local col2 decl" id="902size" title='size' data-type='size_t' data-ref="902size">size</dfn>)</td></tr>
<tr><th id="4452">4452</th><td>{</td></tr>
<tr><th id="4453">4453</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="903addr" title='addr' data-type='unsigned long' data-ref="903addr">addr</dfn> = (<em>unsigned</em> <em>long</em>)<a class="local col1 ref" href="#901virt" title='virt' data-ref="901virt">virt</a>;</td></tr>
<tr><th id="4454">4454</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="904end" title='end' data-type='unsigned long' data-ref="904end">end</dfn> = <a class="local col3 ref" href="#903addr" title='addr' data-ref="903addr">addr</a> + <a class="macro" href="../include/linux/mm.h.html#134" title="((((size)) + ((typeof((size)))((((1UL) &lt;&lt; 12))) - 1)) &amp; ~((typeof((size)))((((1UL) &lt;&lt; 12))) - 1))" data-ref="_M/PAGE_ALIGN">PAGE_ALIGN</a>(<a class="local col2 ref" href="#902size" title='size' data-ref="902size">size</a>);</td></tr>
<tr><th id="4455">4455</th><td></td></tr>
<tr><th id="4456">4456</th><td>	<b>while</b> (<a class="local col3 ref" href="#903addr" title='addr' data-ref="903addr">addr</a> &lt; <a class="local col4 ref" href="#904end" title='end' data-ref="904end">end</a>) {</td></tr>
<tr><th id="4457">4457</th><td>		<a class="macro" href="../include/linux/gfp.h.html#543" title="free_pages((addr), 0)" data-ref="_M/free_page">free_page</a>(<a class="local col3 ref" href="#903addr" title='addr' data-ref="903addr">addr</a>);</td></tr>
<tr><th id="4458">4458</th><td>		<a class="local col3 ref" href="#903addr" title='addr' data-ref="903addr">addr</a> += <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>;</td></tr>
<tr><th id="4459">4459</th><td>	}</td></tr>
<tr><th id="4460">4460</th><td>}</td></tr>
<tr><th id="4461">4461</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(free_pages_exact) free_pages_exact; static const char __kstrtab_free_pages_exact[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;free_pages_exact&quot;; static const struct kernel_symbol __ksymtab_free_pages_exact __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;free_pages_exact&quot;), used)) = { (unsigned long)&amp;free_pages_exact, __kstrtab_free_pages_exact }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#free_pages_exact" title='free_pages_exact' data-ref="free_pages_exact"><a class="ref fn" href="#free_pages_exact" title='free_pages_exact' data-ref="free_pages_exact"><a class="ref fn" href="#free_pages_exact" title='free_pages_exact' data-ref="free_pages_exact"><a class="ref fn" href="#free_pages_exact" title='free_pages_exact' data-ref="free_pages_exact">free_pages_exact</a></a></a></a>);</td></tr>
<tr><th id="4462">4462</th><td></td></tr>
<tr><th id="4463">4463</th><td><i class="doc" data-doc="nr_free_zone_pages">/**</i></td></tr>
<tr><th id="4464">4464</th><td><i class="doc" data-doc="nr_free_zone_pages"> * nr_free_zone_pages - count number of pages beyond high watermark</i></td></tr>
<tr><th id="4465">4465</th><td><i class="doc" data-doc="nr_free_zone_pages"> *<span class="command"> @offset</span>: The zone index of the highest zone</i></td></tr>
<tr><th id="4466">4466</th><td><i class="doc" data-doc="nr_free_zone_pages"> *</i></td></tr>
<tr><th id="4467">4467</th><td><i class="doc" data-doc="nr_free_zone_pages"> * nr_free_zone_pages() counts the number of counts pages which are beyond the</i></td></tr>
<tr><th id="4468">4468</th><td><i class="doc" data-doc="nr_free_zone_pages"> * high watermark within all zones at or below a given zone index.  For each</i></td></tr>
<tr><th id="4469">4469</th><td><i class="doc" data-doc="nr_free_zone_pages"> * zone, the number of pages is calculated as:</i></td></tr>
<tr><th id="4470">4470</th><td><i class="doc" data-doc="nr_free_zone_pages"> *</i></td></tr>
<tr><th id="4471">4471</th><td><i class="doc" data-doc="nr_free_zone_pages"> *     nr_free_zone_pages = managed_pages - high_pages</i></td></tr>
<tr><th id="4472">4472</th><td><i class="doc" data-doc="nr_free_zone_pages"> */</i></td></tr>
<tr><th id="4473">4473</th><td><em>static</em> <em>unsigned</em> <em>long</em> <dfn class="tu decl def fn" id="nr_free_zone_pages" title='nr_free_zone_pages' data-type='unsigned long nr_free_zone_pages(int offset)' data-ref="nr_free_zone_pages">nr_free_zone_pages</dfn>(<em>int</em> <dfn class="local col5 decl" id="905offset" title='offset' data-type='int' data-ref="905offset">offset</dfn>)</td></tr>
<tr><th id="4474">4474</th><td>{</td></tr>
<tr><th id="4475">4475</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col6 decl" id="906z" title='z' data-type='struct zoneref *' data-ref="906z">z</dfn>;</td></tr>
<tr><th id="4476">4476</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="907zone" title='zone' data-type='struct zone *' data-ref="907zone">zone</dfn>;</td></tr>
<tr><th id="4477">4477</th><td></td></tr>
<tr><th id="4478">4478</th><td>	<i>/* Just pick one node, since fallback list is circular */</i></td></tr>
<tr><th id="4479">4479</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="908sum" title='sum' data-type='unsigned long' data-ref="908sum">sum</dfn> = <var>0</var>;</td></tr>
<tr><th id="4480">4480</th><td></td></tr>
<tr><th id="4481">4481</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zonelist" title='zonelist' data-ref="zonelist">zonelist</a> *<dfn class="local col9 decl" id="909zonelist" title='zonelist' data-type='struct zonelist *' data-ref="909zonelist">zonelist</dfn> = <a class="ref fn" href="../include/linux/gfp.h.html#node_zonelist" title='node_zonelist' data-ref="node_zonelist">node_zonelist</a>(<a class="macro" href="../arch/x86/include/asm/topology.h.html#92" title="numa_node_id" data-ref="_M/numa_node_id">numa_node_id</a>(), <a class="macro" href="../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="4482">4482</th><td></td></tr>
<tr><th id="4483">4483</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#1056" title="for (z = first_zones_zonelist(zonelist, offset, ((void *)0)), zone = zonelist_zone(z); zone; z = next_zones_zonelist(++z, offset, ((void *)0)), zone = zonelist_zone(z))" data-ref="_M/for_each_zone_zonelist">for_each_zone_zonelist</a>(<a class="local col7 ref" href="#907zone" title='zone' data-ref="907zone">zone</a>, <a class="local col6 ref" href="#906z" title='z' data-ref="906z">z</a>, <a class="local col9 ref" href="#909zonelist" title='zonelist' data-ref="909zonelist">zonelist</a>, <a class="local col5 ref" href="#905offset" title='offset' data-ref="905offset">offset</a>) {</td></tr>
<tr><th id="4484">4484</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="910size" title='size' data-type='unsigned long' data-ref="910size">size</dfn> = <a class="local col7 ref" href="#907zone" title='zone' data-ref="907zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>;</td></tr>
<tr><th id="4485">4485</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="911high" title='high' data-type='unsigned long' data-ref="911high">high</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#271" title="(zone-&gt;watermark[WMARK_HIGH])" data-ref="_M/high_wmark_pages">high_wmark_pages</a>(<a class="local col7 ref" href="#907zone" title='zone' data-ref="907zone">zone</a>);</td></tr>
<tr><th id="4486">4486</th><td>		<b>if</b> (<a class="local col0 ref" href="#910size" title='size' data-ref="910size">size</a> &gt; <a class="local col1 ref" href="#911high" title='high' data-ref="911high">high</a>)</td></tr>
<tr><th id="4487">4487</th><td>			<a class="local col8 ref" href="#908sum" title='sum' data-ref="908sum">sum</a> += <a class="local col0 ref" href="#910size" title='size' data-ref="910size">size</a> - <a class="local col1 ref" href="#911high" title='high' data-ref="911high">high</a>;</td></tr>
<tr><th id="4488">4488</th><td>	}</td></tr>
<tr><th id="4489">4489</th><td></td></tr>
<tr><th id="4490">4490</th><td>	<b>return</b> <a class="local col8 ref" href="#908sum" title='sum' data-ref="908sum">sum</a>;</td></tr>
<tr><th id="4491">4491</th><td>}</td></tr>
<tr><th id="4492">4492</th><td></td></tr>
<tr><th id="4493">4493</th><td><i class="doc">/**</i></td></tr>
<tr><th id="4494">4494</th><td><i class="doc"> * nr_free_buffer_pages - count number of pages beyond high watermark</i></td></tr>
<tr><th id="4495">4495</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4496">4496</th><td><i class="doc"> * nr_free_buffer_pages() counts the number of pages which are beyond the high</i></td></tr>
<tr><th id="4497">4497</th><td><i class="doc"> * watermark within ZONE_DMA and ZONE_NORMAL.</i></td></tr>
<tr><th id="4498">4498</th><td><i class="doc"> */</i></td></tr>
<tr><th id="4499">4499</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def fn" id="nr_free_buffer_pages" title='nr_free_buffer_pages' data-ref="nr_free_buffer_pages">nr_free_buffer_pages</dfn>(<em>void</em>)</td></tr>
<tr><th id="4500">4500</th><td>{</td></tr>
<tr><th id="4501">4501</th><td>	<b>return</b> <a class="tu ref fn" href="#nr_free_zone_pages" title='nr_free_zone_pages' data-use='c' data-ref="nr_free_zone_pages">nr_free_zone_pages</a>(<a class="ref fn" href="../include/linux/gfp.h.html#gfp_zone" title='gfp_zone' data-ref="gfp_zone">gfp_zone</a>(<a class="macro" href="../include/linux/gfp.h.html#283" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u) | (( gfp_t)0x20000u))" data-ref="_M/GFP_USER">GFP_USER</a>));</td></tr>
<tr><th id="4502">4502</th><td>}</td></tr>
<tr><th id="4503">4503</th><td><a class="macro" href="../include/linux/export.h.html#106" title="extern typeof(nr_free_buffer_pages) nr_free_buffer_pages; static const char __kstrtab_nr_free_buffer_pages[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;nr_free_buffer_pages&quot;; static const struct kernel_symbol __ksymtab_nr_free_buffer_pages __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;_gpl&quot; &quot;+&quot; &quot;nr_free_buffer_pages&quot;), used)) = { (unsigned long)&amp;nr_free_buffer_pages, __kstrtab_nr_free_buffer_pages }" data-ref="_M/EXPORT_SYMBOL_GPL">EXPORT_SYMBOL_GPL</a>(<a class="decl fn" href="#nr_free_buffer_pages" title='nr_free_buffer_pages' data-ref="nr_free_buffer_pages"><a class="ref fn" href="#nr_free_buffer_pages" title='nr_free_buffer_pages' data-ref="nr_free_buffer_pages"><a class="ref fn" href="#nr_free_buffer_pages" title='nr_free_buffer_pages' data-ref="nr_free_buffer_pages"><a class="ref fn" href="#nr_free_buffer_pages" title='nr_free_buffer_pages' data-ref="nr_free_buffer_pages">nr_free_buffer_pages</a></a></a></a>);</td></tr>
<tr><th id="4504">4504</th><td></td></tr>
<tr><th id="4505">4505</th><td><i class="doc">/**</i></td></tr>
<tr><th id="4506">4506</th><td><i class="doc"> * nr_free_pagecache_pages - count number of pages beyond high watermark</i></td></tr>
<tr><th id="4507">4507</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4508">4508</th><td><i class="doc"> * nr_free_pagecache_pages() counts the number of pages which are beyond the</i></td></tr>
<tr><th id="4509">4509</th><td><i class="doc"> * high watermark within all zones.</i></td></tr>
<tr><th id="4510">4510</th><td><i class="doc"> */</i></td></tr>
<tr><th id="4511">4511</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def fn" id="nr_free_pagecache_pages" title='nr_free_pagecache_pages' data-ref="nr_free_pagecache_pages">nr_free_pagecache_pages</dfn>(<em>void</em>)</td></tr>
<tr><th id="4512">4512</th><td>{</td></tr>
<tr><th id="4513">4513</th><td>	<b>return</b> <a class="tu ref fn" href="#nr_free_zone_pages" title='nr_free_zone_pages' data-use='c' data-ref="nr_free_zone_pages">nr_free_zone_pages</a>(<a class="ref fn" href="../include/linux/gfp.h.html#gfp_zone" title='gfp_zone' data-ref="gfp_zone">gfp_zone</a>(<a class="macro" href="../include/linux/gfp.h.html#287" title="((((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u) | (( gfp_t)0x20000u)) | (( gfp_t)0x02u)) | (( gfp_t)0x08u))" data-ref="_M/GFP_HIGHUSER_MOVABLE">GFP_HIGHUSER_MOVABLE</a>));</td></tr>
<tr><th id="4514">4514</th><td>}</td></tr>
<tr><th id="4515">4515</th><td></td></tr>
<tr><th id="4516">4516</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="show_node" title='show_node' data-type='void show_node(struct zone * zone)' data-ref="show_node">show_node</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="912zone" title='zone' data-type='struct zone *' data-ref="912zone">zone</dfn>)</td></tr>
<tr><th id="4517">4517</th><td>{</td></tr>
<tr><th id="4518">4518</th><td>	<b>if</b> (<a class="macro" href="../include/linux/kconfig.h.html#71" title="0" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(CONFIG_NUMA))</td></tr>
<tr><th id="4519">4519</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<q>"Node %d "</q>, <a class="ref fn" href="../include/linux/mm.h.html#zone_to_nid" title='zone_to_nid' data-ref="zone_to_nid">zone_to_nid</a>(<a class="local col2 ref" href="#912zone" title='zone' data-ref="912zone">zone</a>));</td></tr>
<tr><th id="4520">4520</th><td>}</td></tr>
<tr><th id="4521">4521</th><td></td></tr>
<tr><th id="4522">4522</th><td><em>long</em> <dfn class="decl def fn" id="si_mem_available" title='si_mem_available' data-ref="si_mem_available">si_mem_available</dfn>(<em>void</em>)</td></tr>
<tr><th id="4523">4523</th><td>{</td></tr>
<tr><th id="4524">4524</th><td>	<em>long</em> <dfn class="local col3 decl" id="913available" title='available' data-type='long' data-ref="913available">available</dfn>;</td></tr>
<tr><th id="4525">4525</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="914pagecache" title='pagecache' data-type='unsigned long' data-ref="914pagecache">pagecache</dfn>;</td></tr>
<tr><th id="4526">4526</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="915wmark_low" title='wmark_low' data-type='unsigned long' data-ref="915wmark_low">wmark_low</dfn> = <var>0</var>;</td></tr>
<tr><th id="4527">4527</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="916pages" title='pages' data-type='unsigned long [5]' data-ref="916pages">pages</dfn>[<a class="enum" href="../include/linux/mmzone.h.html#NR_LRU_LISTS" title='NR_LRU_LISTS' data-ref="NR_LRU_LISTS">NR_LRU_LISTS</a>];</td></tr>
<tr><th id="4528">4528</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="917zone" title='zone' data-type='struct zone *' data-ref="917zone">zone</dfn>;</td></tr>
<tr><th id="4529">4529</th><td>	<em>int</em> <dfn class="local col8 decl" id="918lru" title='lru' data-type='int' data-ref="918lru">lru</dfn>;</td></tr>
<tr><th id="4530">4530</th><td></td></tr>
<tr><th id="4531">4531</th><td>	<b>for</b> (<a class="local col8 ref" href="#918lru" title='lru' data-ref="918lru">lru</a> = <a class="macro" href="../include/linux/mmzone.h.html#195" title="0" data-ref="_M/LRU_BASE">LRU_BASE</a>; <a class="local col8 ref" href="#918lru" title='lru' data-ref="918lru">lru</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#NR_LRU_LISTS" title='NR_LRU_LISTS' data-ref="NR_LRU_LISTS">NR_LRU_LISTS</a>; <a class="local col8 ref" href="#918lru" title='lru' data-ref="918lru">lru</a>++)</td></tr>
<tr><th id="4532">4532</th><td>		<a class="local col6 ref" href="#916pages" title='pages' data-ref="916pages">pages</a>[<a class="local col8 ref" href="#918lru" title='lru' data-ref="918lru">lru</a>] = <a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_LRU_BASE" title='NR_LRU_BASE' data-ref="NR_LRU_BASE">NR_LRU_BASE</a> + <a class="local col8 ref" href="#918lru" title='lru' data-ref="918lru">lru</a>);</td></tr>
<tr><th id="4533">4533</th><td></td></tr>
<tr><th id="4534">4534</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#941" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone))" data-ref="_M/for_each_zone">for_each_zone</a>(<a class="local col7 ref" href="#917zone" title='zone' data-ref="917zone">zone</a>)</td></tr>
<tr><th id="4535">4535</th><td>		<a class="local col5 ref" href="#915wmark_low" title='wmark_low' data-ref="915wmark_low">wmark_low</a> += <a class="local col7 ref" href="#917zone" title='zone' data-ref="917zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::watermark" title='zone::watermark' data-ref="zone::watermark">watermark</a>[<a class="enum" href="../include/linux/mmzone.h.html#WMARK_LOW" title='WMARK_LOW' data-ref="WMARK_LOW">WMARK_LOW</a>];</td></tr>
<tr><th id="4536">4536</th><td></td></tr>
<tr><th id="4537">4537</th><td>	<i>/*</i></td></tr>
<tr><th id="4538">4538</th><td><i>	 * Estimate the amount of memory available for userspace allocations,</i></td></tr>
<tr><th id="4539">4539</th><td><i>	 * without causing swapping.</i></td></tr>
<tr><th id="4540">4540</th><td><i>	 */</i></td></tr>
<tr><th id="4541">4541</th><td>	<a class="local col3 ref" href="#913available" title='available' data-ref="913available">available</a> = <a class="ref fn" href="../include/linux/vmstat.h.html#global_zone_page_state" title='global_zone_page_state' data-ref="global_zone_page_state">global_zone_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>) - <a class="ref" href="../include/linux/swap.h.html#totalreserve_pages" title='totalreserve_pages' data-ref="totalreserve_pages">totalreserve_pages</a>;</td></tr>
<tr><th id="4542">4542</th><td></td></tr>
<tr><th id="4543">4543</th><td>	<i>/*</i></td></tr>
<tr><th id="4544">4544</th><td><i>	 * Not all the page cache can be freed, otherwise the system will</i></td></tr>
<tr><th id="4545">4545</th><td><i>	 * start swapping. Assume at least half of the page cache, or the</i></td></tr>
<tr><th id="4546">4546</th><td><i>	 * low watermark worth of cache, needs to stay.</i></td></tr>
<tr><th id="4547">4547</th><td><i>	 */</i></td></tr>
<tr><th id="4548">4548</th><td>	<a class="local col4 ref" href="#914pagecache" title='pagecache' data-ref="914pagecache">pagecache</a> = <a class="local col6 ref" href="#916pages" title='pages' data-ref="916pages">pages</a>[<a class="enum" href="../include/linux/mmzone.h.html#LRU_ACTIVE_FILE" title='LRU_ACTIVE_FILE' data-ref="LRU_ACTIVE_FILE">LRU_ACTIVE_FILE</a>] + <a class="local col6 ref" href="#916pages" title='pages' data-ref="916pages">pages</a>[<a class="enum" href="../include/linux/mmzone.h.html#LRU_INACTIVE_FILE" title='LRU_INACTIVE_FILE' data-ref="LRU_INACTIVE_FILE">LRU_INACTIVE_FILE</a>];</td></tr>
<tr><th id="4549">4549</th><td>	<a class="local col4 ref" href="#914pagecache" title='pagecache' data-ref="914pagecache">pagecache</a> -= <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(pagecache / 2) __UNIQUE_ID_min1_179 = (pagecache / 2); typeof(wmark_low) __UNIQUE_ID_min2_180 = (wmark_low); (void) (&amp;__UNIQUE_ID_min1_179 == &amp;__UNIQUE_ID_min2_180); __UNIQUE_ID_min1_179 &lt; __UNIQUE_ID_min2_180 ? __UNIQUE_ID_min1_179 : __UNIQUE_ID_min2_180; })" data-ref="_M/min">min</a>(<a class="local col4 ref" href="#914pagecache" title='pagecache' data-ref="914pagecache">pagecache</a> / <var>2</var>, <a class="local col5 ref" href="#915wmark_low" title='wmark_low' data-ref="915wmark_low">wmark_low</a>);</td></tr>
<tr><th id="4550">4550</th><td>	<a class="local col3 ref" href="#913available" title='available' data-ref="913available">available</a> += <a class="local col4 ref" href="#914pagecache" title='pagecache' data-ref="914pagecache">pagecache</a>;</td></tr>
<tr><th id="4551">4551</th><td></td></tr>
<tr><th id="4552">4552</th><td>	<i>/*</i></td></tr>
<tr><th id="4553">4553</th><td><i>	 * Part of the reclaimable slab consists of items that are in use,</i></td></tr>
<tr><th id="4554">4554</th><td><i>	 * and cannot be freed. Cap this estimate at the low watermark.</i></td></tr>
<tr><th id="4555">4555</th><td><i>	 */</i></td></tr>
<tr><th id="4556">4556</th><td>	<a class="local col3 ref" href="#913available" title='available' data-ref="913available">available</a> += <a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_SLAB_RECLAIMABLE" title='NR_SLAB_RECLAIMABLE' data-ref="NR_SLAB_RECLAIMABLE">NR_SLAB_RECLAIMABLE</a>) -</td></tr>
<tr><th id="4557">4557</th><td>		     <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(global_node_page_state(NR_SLAB_RECLAIMABLE) / 2) __UNIQUE_ID_min1_183 = (global_node_page_state(NR_SLAB_RECLAIMABLE) / 2); typeof(wmark_low) __UNIQUE_ID_min2_184 = (wmark_low); (void) (&amp;__UNIQUE_ID_min1_183 == &amp;__UNIQUE_ID_min2_184); __UNIQUE_ID_min1_183 &lt; __UNIQUE_ID_min2_184 ? __UNIQUE_ID_min1_183 : __UNIQUE_ID_min2_184; })" data-ref="_M/min">min</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_SLAB_RECLAIMABLE" title='NR_SLAB_RECLAIMABLE' data-ref="NR_SLAB_RECLAIMABLE">NR_SLAB_RECLAIMABLE</a>) / <var>2</var>,</td></tr>
<tr><th id="4558">4558</th><td>			 <a class="local col5 ref" href="#915wmark_low" title='wmark_low' data-ref="915wmark_low">wmark_low</a>);</td></tr>
<tr><th id="4559">4559</th><td></td></tr>
<tr><th id="4560">4560</th><td>	<b>if</b> (<a class="local col3 ref" href="#913available" title='available' data-ref="913available">available</a> &lt; <var>0</var>)</td></tr>
<tr><th id="4561">4561</th><td>		<a class="local col3 ref" href="#913available" title='available' data-ref="913available">available</a> = <var>0</var>;</td></tr>
<tr><th id="4562">4562</th><td>	<b>return</b> <a class="local col3 ref" href="#913available" title='available' data-ref="913available">available</a>;</td></tr>
<tr><th id="4563">4563</th><td>}</td></tr>
<tr><th id="4564">4564</th><td><a class="macro" href="../include/linux/export.h.html#106" title="extern typeof(si_mem_available) si_mem_available; static const char __kstrtab_si_mem_available[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;si_mem_available&quot;; static const struct kernel_symbol __ksymtab_si_mem_available __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;_gpl&quot; &quot;+&quot; &quot;si_mem_available&quot;), used)) = { (unsigned long)&amp;si_mem_available, __kstrtab_si_mem_available }" data-ref="_M/EXPORT_SYMBOL_GPL">EXPORT_SYMBOL_GPL</a>(<a class="decl fn" href="#si_mem_available" title='si_mem_available' data-ref="si_mem_available"><a class="ref fn" href="#si_mem_available" title='si_mem_available' data-ref="si_mem_available"><a class="ref fn" href="#si_mem_available" title='si_mem_available' data-ref="si_mem_available"><a class="ref fn" href="#si_mem_available" title='si_mem_available' data-ref="si_mem_available">si_mem_available</a></a></a></a>);</td></tr>
<tr><th id="4565">4565</th><td></td></tr>
<tr><th id="4566">4566</th><td><em>void</em> <dfn class="decl def fn" id="si_meminfo" title='si_meminfo' data-ref="si_meminfo">si_meminfo</dfn>(<b>struct</b> <a class="type" href="../include/uapi/linux/sysinfo.h.html#sysinfo" title='sysinfo' data-ref="sysinfo">sysinfo</a> *<dfn class="local col9 decl" id="919val" title='val' data-type='struct sysinfo *' data-ref="919val">val</dfn>)</td></tr>
<tr><th id="4567">4567</th><td>{</td></tr>
<tr><th id="4568">4568</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::totalram" title='sysinfo::totalram' data-ref="sysinfo::totalram">totalram</a> = <a class="ref" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages">totalram_pages</a>;</td></tr>
<tr><th id="4569">4569</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::sharedram" title='sysinfo::sharedram' data-ref="sysinfo::sharedram">sharedram</a> = <a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_SHMEM" title='NR_SHMEM' data-ref="NR_SHMEM">NR_SHMEM</a>);</td></tr>
<tr><th id="4570">4570</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::freeram" title='sysinfo::freeram' data-ref="sysinfo::freeram">freeram</a> = <a class="ref fn" href="../include/linux/vmstat.h.html#global_zone_page_state" title='global_zone_page_state' data-ref="global_zone_page_state">global_zone_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>);</td></tr>
<tr><th id="4571">4571</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::bufferram" title='sysinfo::bufferram' data-ref="sysinfo::bufferram">bufferram</a> = <a class="ref fn" href="../include/linux/blkdev.h.html#nr_blockdev_pages" title='nr_blockdev_pages' data-ref="nr_blockdev_pages">nr_blockdev_pages</a>();</td></tr>
<tr><th id="4572">4572</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::totalhigh" title='sysinfo::totalhigh' data-ref="sysinfo::totalhigh">totalhigh</a> = <a class="macro" href="../include/linux/highmem.h.html#54" title="0UL" data-ref="_M/totalhigh_pages">totalhigh_pages</a>;</td></tr>
<tr><th id="4573">4573</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::freehigh" title='sysinfo::freehigh' data-ref="sysinfo::freehigh">freehigh</a> = <a class="ref fn" href="../include/linux/highmem.h.html#nr_free_highpages" title='nr_free_highpages' data-ref="nr_free_highpages">nr_free_highpages</a>();</td></tr>
<tr><th id="4574">4574</th><td>	<a class="local col9 ref" href="#919val" title='val' data-ref="919val">val</a>-&gt;<a class="ref field" href="../include/uapi/linux/sysinfo.h.html#sysinfo::mem_unit" title='sysinfo::mem_unit' data-ref="sysinfo::mem_unit">mem_unit</a> = <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>;</td></tr>
<tr><th id="4575">4575</th><td>}</td></tr>
<tr><th id="4576">4576</th><td></td></tr>
<tr><th id="4577">4577</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(si_meminfo) si_meminfo; static const char __kstrtab_si_meminfo[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;si_meminfo&quot;; static const struct kernel_symbol __ksymtab_si_meminfo __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;si_meminfo&quot;), used)) = { (unsigned long)&amp;si_meminfo, __kstrtab_si_meminfo }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#si_meminfo" title='si_meminfo' data-ref="si_meminfo"><a class="ref fn" href="#si_meminfo" title='si_meminfo' data-ref="si_meminfo"><a class="ref fn" href="#si_meminfo" title='si_meminfo' data-ref="si_meminfo"><a class="ref fn" href="#si_meminfo" title='si_meminfo' data-ref="si_meminfo">si_meminfo</a></a></a></a>);</td></tr>
<tr><th id="4578">4578</th><td></td></tr>
<tr><th id="4579">4579</th><td><u>#<span data-ppcond="4579">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="4580">4580</th><td><em>void</em> si_meminfo_node(<b>struct</b> sysinfo *val, <em>int</em> nid)</td></tr>
<tr><th id="4581">4581</th><td>{</td></tr>
<tr><th id="4582">4582</th><td>	<em>int</em> zone_type;		<i>/* needs to be signed */</i></td></tr>
<tr><th id="4583">4583</th><td>	<em>unsigned</em> <em>long</em> managed_pages = <var>0</var>;</td></tr>
<tr><th id="4584">4584</th><td>	<em>unsigned</em> <em>long</em> managed_highpages = <var>0</var>;</td></tr>
<tr><th id="4585">4585</th><td>	<em>unsigned</em> <em>long</em> free_highpages = <var>0</var>;</td></tr>
<tr><th id="4586">4586</th><td>	pg_data_t *pgdat = NODE_DATA(nid);</td></tr>
<tr><th id="4587">4587</th><td></td></tr>
<tr><th id="4588">4588</th><td>	<b>for</b> (zone_type = <var>0</var>; zone_type &lt; MAX_NR_ZONES; zone_type++)</td></tr>
<tr><th id="4589">4589</th><td>		managed_pages += pgdat-&gt;node_zones[zone_type].managed_pages;</td></tr>
<tr><th id="4590">4590</th><td>	val-&gt;totalram = managed_pages;</td></tr>
<tr><th id="4591">4591</th><td>	val-&gt;sharedram = node_page_state(pgdat, NR_SHMEM);</td></tr>
<tr><th id="4592">4592</th><td>	val-&gt;freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);</td></tr>
<tr><th id="4593">4593</th><td><u>#ifdef CONFIG_HIGHMEM</u></td></tr>
<tr><th id="4594">4594</th><td>	<b>for</b> (zone_type = <var>0</var>; zone_type &lt; MAX_NR_ZONES; zone_type++) {</td></tr>
<tr><th id="4595">4595</th><td>		<b>struct</b> zone *zone = &amp;pgdat-&gt;node_zones[zone_type];</td></tr>
<tr><th id="4596">4596</th><td></td></tr>
<tr><th id="4597">4597</th><td>		<b>if</b> (is_highmem(zone)) {</td></tr>
<tr><th id="4598">4598</th><td>			managed_highpages += zone-&gt;managed_pages;</td></tr>
<tr><th id="4599">4599</th><td>			free_highpages += zone_page_state(zone, NR_FREE_PAGES);</td></tr>
<tr><th id="4600">4600</th><td>		}</td></tr>
<tr><th id="4601">4601</th><td>	}</td></tr>
<tr><th id="4602">4602</th><td>	val-&gt;totalhigh = managed_highpages;</td></tr>
<tr><th id="4603">4603</th><td>	val-&gt;freehigh = free_highpages;</td></tr>
<tr><th id="4604">4604</th><td><u>#else</u></td></tr>
<tr><th id="4605">4605</th><td>	val-&gt;totalhigh = managed_highpages;</td></tr>
<tr><th id="4606">4606</th><td>	val-&gt;freehigh = free_highpages;</td></tr>
<tr><th id="4607">4607</th><td><u>#endif</u></td></tr>
<tr><th id="4608">4608</th><td>	val-&gt;mem_unit = PAGE_SIZE;</td></tr>
<tr><th id="4609">4609</th><td>}</td></tr>
<tr><th id="4610">4610</th><td><u>#<span data-ppcond="4579">endif</span></u></td></tr>
<tr><th id="4611">4611</th><td></td></tr>
<tr><th id="4612">4612</th><td><i  data-doc="show_mem_node_skip">/*</i></td></tr>
<tr><th id="4613">4613</th><td><i  data-doc="show_mem_node_skip"> * Determine whether the node should be displayed or not, depending on whether</i></td></tr>
<tr><th id="4614">4614</th><td><i  data-doc="show_mem_node_skip"> * SHOW_MEM_FILTER_NODES was passed to show_free_areas().</i></td></tr>
<tr><th id="4615">4615</th><td><i  data-doc="show_mem_node_skip"> */</i></td></tr>
<tr><th id="4616">4616</th><td><em>static</em> <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="tu decl def fn" id="show_mem_node_skip" title='show_mem_node_skip' data-type='bool show_mem_node_skip(unsigned int flags, int nid, nodemask_t * nodemask)' data-ref="show_mem_node_skip">show_mem_node_skip</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="920flags" title='flags' data-type='unsigned int' data-ref="920flags">flags</dfn>, <em>int</em> <dfn class="local col1 decl" id="921nid" title='nid' data-type='int' data-ref="921nid">nid</dfn>, <a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> *<dfn class="local col2 decl" id="922nodemask" title='nodemask' data-type='nodemask_t *' data-ref="922nodemask">nodemask</dfn>)</td></tr>
<tr><th id="4617">4617</th><td>{</td></tr>
<tr><th id="4618">4618</th><td>	<b>if</b> (!(<a class="local col0 ref" href="#920flags" title='flags' data-ref="920flags">flags</a> &amp; <a class="macro" href="../include/linux/mm.h.html#1222" title="(0x0001u)" data-ref="_M/SHOW_MEM_FILTER_NODES">SHOW_MEM_FILTER_NODES</a>))</td></tr>
<tr><th id="4619">4619</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="4620">4620</th><td></td></tr>
<tr><th id="4621">4621</th><td>	<i>/*</i></td></tr>
<tr><th id="4622">4622</th><td><i>	 * no node mask - aka implicit memory numa policy. Do not bother with</i></td></tr>
<tr><th id="4623">4623</th><td><i>	 * the synchronization - read_mems_allowed_begin - because we do not</i></td></tr>
<tr><th id="4624">4624</th><td><i>	 * have to be precise here.</i></td></tr>
<tr><th id="4625">4625</th><td><i>	 */</i></td></tr>
<tr><th id="4626">4626</th><td>	<b>if</b> (!<a class="local col2 ref" href="#922nodemask" title='nodemask' data-ref="922nodemask">nodemask</a>)</td></tr>
<tr><th id="4627">4627</th><td>		<a class="local col2 ref" href="#922nodemask" title='nodemask' data-ref="922nodemask">nodemask</a> = &amp;<a class="macro" href="../include/linux/cpuset.h.html#61" title="(get_current()-&gt;mems_allowed)" data-ref="_M/cpuset_current_mems_allowed">cpuset_current_mems_allowed</a>;</td></tr>
<tr><th id="4628">4628</th><td></td></tr>
<tr><th id="4629">4629</th><td>	<b>return</b> !<a class="macro" href="../include/linux/nodemask.h.html#143" title="(__builtin_constant_p(((nid))) ? constant_test_bit(((nid)), ((*nodemask).bits)) : variable_test_bit(((nid)), ((*nodemask).bits)))" data-ref="_M/node_isset">node_isset</a>(<a class="local col1 ref" href="#921nid" title='nid' data-ref="921nid">nid</a>, *<a class="local col2 ref" href="#922nodemask" title='nodemask' data-ref="922nodemask">nodemask</a>);</td></tr>
<tr><th id="4630">4630</th><td>}</td></tr>
<tr><th id="4631">4631</th><td></td></tr>
<tr><th id="4632">4632</th><td><u>#define <dfn class="macro" id="_M/K" data-ref="_M/K">K</dfn>(x) ((x) &lt;&lt; (PAGE_SHIFT-10))</u></td></tr>
<tr><th id="4633">4633</th><td></td></tr>
<tr><th id="4634">4634</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="show_migration_types" title='show_migration_types' data-type='void show_migration_types(unsigned char type)' data-ref="show_migration_types">show_migration_types</dfn>(<em>unsigned</em> <em>char</em> <dfn class="local col3 decl" id="923type" title='type' data-type='unsigned char' data-ref="923type">type</dfn>)</td></tr>
<tr><th id="4635">4635</th><td>{</td></tr>
<tr><th id="4636">4636</th><td>	<em>static</em> <em>const</em> <em>char</em> <dfn class="local col4 decl" id="924types" title='types' data-type='const char [4]' data-ref="924types">types</dfn>[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>] = {</td></tr>
<tr><th id="4637">4637</th><td>		[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_UNMOVABLE" title='MIGRATE_UNMOVABLE' data-ref="MIGRATE_UNMOVABLE">MIGRATE_UNMOVABLE</a>]	= <kbd>'U'</kbd>,</td></tr>
<tr><th id="4638">4638</th><td>		[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>]	= <kbd>'M'</kbd>,</td></tr>
<tr><th id="4639">4639</th><td>		[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_RECLAIMABLE" title='MIGRATE_RECLAIMABLE' data-ref="MIGRATE_RECLAIMABLE">MIGRATE_RECLAIMABLE</a>]	= <kbd>'E'</kbd>,</td></tr>
<tr><th id="4640">4640</th><td>		[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_HIGHATOMIC" title='MIGRATE_HIGHATOMIC' data-ref="MIGRATE_HIGHATOMIC">MIGRATE_HIGHATOMIC</a>]	= <kbd>'H'</kbd>,</td></tr>
<tr><th id="4641">4641</th><td><u>#<span data-ppcond="4641">ifdef</span> <span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span></u></td></tr>
<tr><th id="4642">4642</th><td>		[MIGRATE_CMA]		= <kbd>'C'</kbd>,</td></tr>
<tr><th id="4643">4643</th><td><u>#<span data-ppcond="4641">endif</span></u></td></tr>
<tr><th id="4644">4644</th><td><u>#<span data-ppcond="4644">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMORY_ISOLATION">CONFIG_MEMORY_ISOLATION</span></u></td></tr>
<tr><th id="4645">4645</th><td>		[MIGRATE_ISOLATE]	= <kbd>'I'</kbd>,</td></tr>
<tr><th id="4646">4646</th><td><u>#<span data-ppcond="4644">endif</span></u></td></tr>
<tr><th id="4647">4647</th><td>	};</td></tr>
<tr><th id="4648">4648</th><td>	<em>char</em> <dfn class="local col5 decl" id="925tmp" title='tmp' data-type='char [5]' data-ref="925tmp">tmp</dfn>[<a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a> + <var>1</var>];</td></tr>
<tr><th id="4649">4649</th><td>	<em>char</em> *<dfn class="local col6 decl" id="926p" title='p' data-type='char *' data-ref="926p">p</dfn> = <a class="local col5 ref" href="#925tmp" title='tmp' data-ref="925tmp">tmp</a>;</td></tr>
<tr><th id="4650">4650</th><td>	<em>int</em> <dfn class="local col7 decl" id="927i" title='i' data-type='int' data-ref="927i">i</dfn>;</td></tr>
<tr><th id="4651">4651</th><td></td></tr>
<tr><th id="4652">4652</th><td>	<b>for</b> (<a class="local col7 ref" href="#927i" title='i' data-ref="927i">i</a> = <var>0</var>; <a class="local col7 ref" href="#927i" title='i' data-ref="927i">i</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>; <a class="local col7 ref" href="#927i" title='i' data-ref="927i">i</a>++) {</td></tr>
<tr><th id="4653">4653</th><td>		<b>if</b> (<a class="local col3 ref" href="#923type" title='type' data-ref="923type">type</a> &amp; (<var>1</var> &lt;&lt; <a class="local col7 ref" href="#927i" title='i' data-ref="927i">i</a>))</td></tr>
<tr><th id="4654">4654</th><td>			*<a class="local col6 ref" href="#926p" title='p' data-ref="926p">p</a>++ = <a class="local col4 ref" href="#924types" title='types' data-ref="924types">types</a>[<a class="local col7 ref" href="#927i" title='i' data-ref="927i">i</a>];</td></tr>
<tr><th id="4655">4655</th><td>	}</td></tr>
<tr><th id="4656">4656</th><td></td></tr>
<tr><th id="4657">4657</th><td>	*<a class="local col6 ref" href="#926p" title='p' data-ref="926p">p</a> = <kbd>'\0'</kbd>;</td></tr>
<tr><th id="4658">4658</th><td>	<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a> <q>"(%s) "</q>, <a class="local col5 ref" href="#925tmp" title='tmp' data-ref="925tmp">tmp</a>);</td></tr>
<tr><th id="4659">4659</th><td>}</td></tr>
<tr><th id="4660">4660</th><td></td></tr>
<tr><th id="4661">4661</th><td><i>/*</i></td></tr>
<tr><th id="4662">4662</th><td><i> * Show free area list (used inside shift_scroll-lock stuff)</i></td></tr>
<tr><th id="4663">4663</th><td><i> * We also calculate the percentage fragmentation. We do this by counting the</i></td></tr>
<tr><th id="4664">4664</th><td><i> * memory on each free list with the exception of the first item on the list.</i></td></tr>
<tr><th id="4665">4665</th><td><i> *</i></td></tr>
<tr><th id="4666">4666</th><td><i> * Bits in @filter:</i></td></tr>
<tr><th id="4667">4667</th><td><i> * SHOW_MEM_FILTER_NODES: suppress nodes that are not allowed by current's</i></td></tr>
<tr><th id="4668">4668</th><td><i> *   cpuset.</i></td></tr>
<tr><th id="4669">4669</th><td><i> */</i></td></tr>
<tr><th id="4670">4670</th><td><em>void</em> <dfn class="decl def fn" id="show_free_areas" title='show_free_areas' data-ref="show_free_areas">show_free_areas</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="928filter" title='filter' data-type='unsigned int' data-ref="928filter">filter</dfn>, <a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> *<dfn class="local col9 decl" id="929nodemask" title='nodemask' data-type='nodemask_t *' data-ref="929nodemask">nodemask</dfn>)</td></tr>
<tr><th id="4671">4671</th><td>{</td></tr>
<tr><th id="4672">4672</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="930free_pcp" title='free_pcp' data-type='unsigned long' data-ref="930free_pcp">free_pcp</dfn> = <var>0</var>;</td></tr>
<tr><th id="4673">4673</th><td>	<em>int</em> <dfn class="local col1 decl" id="931cpu" title='cpu' data-type='int' data-ref="931cpu">cpu</dfn>;</td></tr>
<tr><th id="4674">4674</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="932zone" title='zone' data-type='struct zone *' data-ref="932zone">zone</dfn>;</td></tr>
<tr><th id="4675">4675</th><td>	<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col3 decl" id="933pgdat" title='pgdat' data-type='pg_data_t *' data-ref="933pgdat">pgdat</dfn>;</td></tr>
<tr><th id="4676">4676</th><td></td></tr>
<tr><th id="4677">4677</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>) {</td></tr>
<tr><th id="4678">4678</th><td>		<b>if</b> (<a class="tu ref fn" href="#show_mem_node_skip" title='show_mem_node_skip' data-use='c' data-ref="show_mem_node_skip">show_mem_node_skip</a>(<a class="local col8 ref" href="#928filter" title='filter' data-ref="928filter">filter</a>, <a class="ref fn" href="../include/linux/mm.h.html#zone_to_nid" title='zone_to_nid' data-ref="zone_to_nid">zone_to_nid</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>), <a class="local col9 ref" href="#929nodemask" title='nodemask' data-ref="929nodemask">nodemask</a>))</td></tr>
<tr><th id="4679">4679</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4680">4680</th><td></td></tr>
<tr><th id="4681">4681</th><td>		<a class="macro" href="../include/linux/cpumask.h.html#750" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_online_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_online_cpu">for_each_online_cpu</a>(<a class="local col1 ref" href="#931cpu" title='cpu' data-ref="931cpu">cpu</a>)</td></tr>
<tr><th id="4682">4682</th><td>			<a class="local col0 ref" href="#930free_pcp" title='free_pcp' data-ref="930free_pcp">free_pcp</a> += <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col1 ref" href="#931cpu" title='cpu' data-ref="931cpu">cpu</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>.<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>;</td></tr>
<tr><th id="4683">4683</th><td>	}</td></tr>
<tr><th id="4684">4684</th><td></td></tr>
<tr><th id="4685">4685</th><td>	<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<q>"active_anon:%lu inactive_anon:%lu isolated_anon:%lu\n"</q></td></tr>
<tr><th id="4686">4686</th><td>		<q>" active_file:%lu inactive_file:%lu isolated_file:%lu\n"</q></td></tr>
<tr><th id="4687">4687</th><td>		<q>" unevictable:%lu dirty:%lu writeback:%lu unstable:%lu\n"</q></td></tr>
<tr><th id="4688">4688</th><td>		<q>" slab_reclaimable:%lu slab_unreclaimable:%lu\n"</q></td></tr>
<tr><th id="4689">4689</th><td>		<q>" mapped:%lu shmem:%lu pagetables:%lu bounce:%lu\n"</q></td></tr>
<tr><th id="4690">4690</th><td>		<q>" free:%lu free_pcp:%lu free_cma:%lu\n"</q>,</td></tr>
<tr><th id="4691">4691</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_ACTIVE_ANON" title='NR_ACTIVE_ANON' data-ref="NR_ACTIVE_ANON">NR_ACTIVE_ANON</a>),</td></tr>
<tr><th id="4692">4692</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_INACTIVE_ANON" title='NR_INACTIVE_ANON' data-ref="NR_INACTIVE_ANON">NR_INACTIVE_ANON</a>),</td></tr>
<tr><th id="4693">4693</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_ISOLATED_ANON" title='NR_ISOLATED_ANON' data-ref="NR_ISOLATED_ANON">NR_ISOLATED_ANON</a>),</td></tr>
<tr><th id="4694">4694</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_ACTIVE_FILE" title='NR_ACTIVE_FILE' data-ref="NR_ACTIVE_FILE">NR_ACTIVE_FILE</a>),</td></tr>
<tr><th id="4695">4695</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_INACTIVE_FILE" title='NR_INACTIVE_FILE' data-ref="NR_INACTIVE_FILE">NR_INACTIVE_FILE</a>),</td></tr>
<tr><th id="4696">4696</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_ISOLATED_FILE" title='NR_ISOLATED_FILE' data-ref="NR_ISOLATED_FILE">NR_ISOLATED_FILE</a>),</td></tr>
<tr><th id="4697">4697</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_UNEVICTABLE" title='NR_UNEVICTABLE' data-ref="NR_UNEVICTABLE">NR_UNEVICTABLE</a>),</td></tr>
<tr><th id="4698">4698</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FILE_DIRTY" title='NR_FILE_DIRTY' data-ref="NR_FILE_DIRTY">NR_FILE_DIRTY</a>),</td></tr>
<tr><th id="4699">4699</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_WRITEBACK" title='NR_WRITEBACK' data-ref="NR_WRITEBACK">NR_WRITEBACK</a>),</td></tr>
<tr><th id="4700">4700</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_UNSTABLE_NFS" title='NR_UNSTABLE_NFS' data-ref="NR_UNSTABLE_NFS">NR_UNSTABLE_NFS</a>),</td></tr>
<tr><th id="4701">4701</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_SLAB_RECLAIMABLE" title='NR_SLAB_RECLAIMABLE' data-ref="NR_SLAB_RECLAIMABLE">NR_SLAB_RECLAIMABLE</a>),</td></tr>
<tr><th id="4702">4702</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_SLAB_UNRECLAIMABLE" title='NR_SLAB_UNRECLAIMABLE' data-ref="NR_SLAB_UNRECLAIMABLE">NR_SLAB_UNRECLAIMABLE</a>),</td></tr>
<tr><th id="4703">4703</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FILE_MAPPED" title='NR_FILE_MAPPED' data-ref="NR_FILE_MAPPED">NR_FILE_MAPPED</a>),</td></tr>
<tr><th id="4704">4704</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_SHMEM" title='NR_SHMEM' data-ref="NR_SHMEM">NR_SHMEM</a>),</td></tr>
<tr><th id="4705">4705</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_zone_page_state" title='global_zone_page_state' data-ref="global_zone_page_state">global_zone_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_PAGETABLE" title='NR_PAGETABLE' data-ref="NR_PAGETABLE">NR_PAGETABLE</a>),</td></tr>
<tr><th id="4706">4706</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_zone_page_state" title='global_zone_page_state' data-ref="global_zone_page_state">global_zone_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_BOUNCE" title='NR_BOUNCE' data-ref="NR_BOUNCE">NR_BOUNCE</a>),</td></tr>
<tr><th id="4707">4707</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_zone_page_state" title='global_zone_page_state' data-ref="global_zone_page_state">global_zone_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>),</td></tr>
<tr><th id="4708">4708</th><td>		<a class="local col0 ref" href="#930free_pcp" title='free_pcp' data-ref="930free_pcp">free_pcp</a>,</td></tr>
<tr><th id="4709">4709</th><td>		<a class="ref fn" href="../include/linux/vmstat.h.html#global_zone_page_state" title='global_zone_page_state' data-ref="global_zone_page_state">global_zone_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_CMA_PAGES" title='NR_FREE_CMA_PAGES' data-ref="NR_FREE_CMA_PAGES">NR_FREE_CMA_PAGES</a>));</td></tr>
<tr><th id="4710">4710</th><td></td></tr>
<tr><th id="4711">4711</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#930" title="for (pgdat = first_online_pgdat(); pgdat; pgdat = next_online_pgdat(pgdat))" data-ref="_M/for_each_online_pgdat">for_each_online_pgdat</a>(<a class="local col3 ref" href="#933pgdat" title='pgdat' data-ref="933pgdat">pgdat</a>) {</td></tr>
<tr><th id="4712">4712</th><td>		<b>if</b> (<a class="tu ref fn" href="#show_mem_node_skip" title='show_mem_node_skip' data-use='c' data-ref="show_mem_node_skip">show_mem_node_skip</a>(<a class="local col8 ref" href="#928filter" title='filter' data-ref="928filter">filter</a>, <a class="local col3 ref" href="#933pgdat" title='pgdat' data-ref="933pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>, <a class="local col9 ref" href="#929nodemask" title='nodemask' data-ref="929nodemask">nodemask</a>))</td></tr>
<tr><th id="4713">4713</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4714">4714</th><td></td></tr>
<tr><th id="4715">4715</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<q>"Node %d"</q></td></tr>
<tr><th id="4716">4716</th><td>			<q>" active_anon:%lukB"</q></td></tr>
<tr><th id="4717">4717</th><td>			<q>" inactive_anon:%lukB"</q></td></tr>
<tr><th id="4718">4718</th><td>			<q>" active_file:%lukB"</q></td></tr>
<tr><th id="4719">4719</th><td>			<q>" inactive_file:%lukB"</q></td></tr>
<tr><th id="4720">4720</th><td>			<q>" unevictable:%lukB"</q></td></tr>
<tr><th id="4721">4721</th><td>			<q>" isolated(anon):%lukB"</q></td></tr>
<tr><th id="4722">4722</th><td>			<q>" isolated(file):%lukB"</q></td></tr>
<tr><th id="4723">4723</th><td>			<q>" mapped:%lukB"</q></td></tr>
<tr><th id="4724">4724</th><td>			<q>" dirty:%lukB"</q></td></tr>
<tr><th id="4725">4725</th><td>			<q>" writeback:%lukB"</q></td></tr>
<tr><th id="4726">4726</th><td>			<q>" shmem:%lukB"</q></td></tr>
<tr><th id="4727">4727</th><td><u>#<span data-ppcond="4727">ifdef</span> <span class="macro" data-ref="_M/CONFIG_TRANSPARENT_HUGEPAGE">CONFIG_TRANSPARENT_HUGEPAGE</span></u></td></tr>
<tr><th id="4728">4728</th><td>			<q>" shmem_thp: %lukB"</q></td></tr>
<tr><th id="4729">4729</th><td>			<q>" shmem_pmdmapped: %lukB"</q></td></tr>
<tr><th id="4730">4730</th><td>			<q>" anon_thp: %lukB"</q></td></tr>
<tr><th id="4731">4731</th><td><u>#<span data-ppcond="4727">endif</span></u></td></tr>
<tr><th id="4732">4732</th><td>			<q>" writeback_tmp:%lukB"</q></td></tr>
<tr><th id="4733">4733</th><td>			<q>" unstable:%lukB"</q></td></tr>
<tr><th id="4734">4734</th><td>			<q>" all_unreclaimable? %s"</q></td></tr>
<tr><th id="4735">4735</th><td>			<q>"\n"</q>,</td></tr>
<tr><th id="4736">4736</th><td>			<a class="local col3 ref" href="#933pgdat" title='pgdat' data-ref="933pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>,</td></tr>
<tr><th id="4737">4737</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_ACTIVE_ANON)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_ACTIVE_ANON)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_ACTIVE_ANON" title='NR_ACTIVE_ANON' data-ref="NR_ACTIVE_ANON">NR_ACTIVE_ANON</a>)),</td></tr>
<tr><th id="4738">4738</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_INACTIVE_ANON)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_INACTIVE_ANON)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_INACTIVE_ANON" title='NR_INACTIVE_ANON' data-ref="NR_INACTIVE_ANON">NR_INACTIVE_ANON</a>)),</td></tr>
<tr><th id="4739">4739</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_ACTIVE_FILE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_ACTIVE_FILE)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_ACTIVE_FILE" title='NR_ACTIVE_FILE' data-ref="NR_ACTIVE_FILE">NR_ACTIVE_FILE</a>)),</td></tr>
<tr><th id="4740">4740</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_INACTIVE_FILE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_INACTIVE_FILE)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_INACTIVE_FILE" title='NR_INACTIVE_FILE' data-ref="NR_INACTIVE_FILE">NR_INACTIVE_FILE</a>)),</td></tr>
<tr><th id="4741">4741</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_UNEVICTABLE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_UNEVICTABLE)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_UNEVICTABLE" title='NR_UNEVICTABLE' data-ref="NR_UNEVICTABLE">NR_UNEVICTABLE</a>)),</td></tr>
<tr><th id="4742">4742</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_ISOLATED_ANON)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_ISOLATED_ANON)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_ISOLATED_ANON" title='NR_ISOLATED_ANON' data-ref="NR_ISOLATED_ANON">NR_ISOLATED_ANON</a>)),</td></tr>
<tr><th id="4743">4743</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_ISOLATED_FILE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_ISOLATED_FILE)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_ISOLATED_FILE" title='NR_ISOLATED_FILE' data-ref="NR_ISOLATED_FILE">NR_ISOLATED_FILE</a>)),</td></tr>
<tr><th id="4744">4744</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_FILE_MAPPED)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_FILE_MAPPED)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_FILE_MAPPED" title='NR_FILE_MAPPED' data-ref="NR_FILE_MAPPED">NR_FILE_MAPPED</a>)),</td></tr>
<tr><th id="4745">4745</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_FILE_DIRTY)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_FILE_DIRTY)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_FILE_DIRTY" title='NR_FILE_DIRTY' data-ref="NR_FILE_DIRTY">NR_FILE_DIRTY</a>)),</td></tr>
<tr><th id="4746">4746</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_WRITEBACK)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_WRITEBACK)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_WRITEBACK" title='NR_WRITEBACK' data-ref="NR_WRITEBACK">NR_WRITEBACK</a>)),</td></tr>
<tr><th id="4747">4747</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_SHMEM)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_SHMEM)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_SHMEM" title='NR_SHMEM' data-ref="NR_SHMEM">NR_SHMEM</a>)),</td></tr>
<tr><th id="4748">4748</th><td><u>#<span data-ppcond="4748">ifdef</span> <span class="macro" data-ref="_M/CONFIG_TRANSPARENT_HUGEPAGE">CONFIG_TRANSPARENT_HUGEPAGE</span></u></td></tr>
<tr><th id="4749">4749</th><td>			K(node_page_state(pgdat, NR_SHMEM_THPS) * HPAGE_PMD_NR),</td></tr>
<tr><th id="4750">4750</th><td>			K(node_page_state(pgdat, NR_SHMEM_PMDMAPPED)</td></tr>
<tr><th id="4751">4751</th><td>					* HPAGE_PMD_NR),</td></tr>
<tr><th id="4752">4752</th><td>			K(node_page_state(pgdat, NR_ANON_THPS) * HPAGE_PMD_NR),</td></tr>
<tr><th id="4753">4753</th><td><u>#<span data-ppcond="4748">endif</span></u></td></tr>
<tr><th id="4754">4754</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_WRITEBACK_TEMP)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_WRITEBACK_TEMP)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_WRITEBACK_TEMP" title='NR_WRITEBACK_TEMP' data-ref="NR_WRITEBACK_TEMP">NR_WRITEBACK_TEMP</a>)),</td></tr>
<tr><th id="4755">4755</th><td>			<a class="macro" href="#4632" title="((global_node_page_state(NR_UNSTABLE_NFS)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/vmstat.h.html#235" title="global_node_page_state(NR_UNSTABLE_NFS)" data-ref="_M/node_page_state">node_page_state</a>(pgdat, <a class="enum" href="../include/linux/mmzone.h.html#NR_UNSTABLE_NFS" title='NR_UNSTABLE_NFS' data-ref="NR_UNSTABLE_NFS">NR_UNSTABLE_NFS</a>)),</td></tr>
<tr><th id="4756">4756</th><td>			<a class="local col3 ref" href="#933pgdat" title='pgdat' data-ref="933pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::kswapd_failures" title='pglist_data::kswapd_failures' data-ref="pglist_data::kswapd_failures">kswapd_failures</a> &gt;= <a class="macro" href="internal.h.html#87" title="16" data-ref="_M/MAX_RECLAIM_RETRIES">MAX_RECLAIM_RETRIES</a> ?</td></tr>
<tr><th id="4757">4757</th><td>				<q>"yes"</q> : <q>"no"</q>);</td></tr>
<tr><th id="4758">4758</th><td>	}</td></tr>
<tr><th id="4759">4759</th><td></td></tr>
<tr><th id="4760">4760</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>) {</td></tr>
<tr><th id="4761">4761</th><td>		<em>int</em> <dfn class="local col4 decl" id="934i" title='i' data-type='int' data-ref="934i">i</dfn>;</td></tr>
<tr><th id="4762">4762</th><td></td></tr>
<tr><th id="4763">4763</th><td>		<b>if</b> (<a class="tu ref fn" href="#show_mem_node_skip" title='show_mem_node_skip' data-use='c' data-ref="show_mem_node_skip">show_mem_node_skip</a>(<a class="local col8 ref" href="#928filter" title='filter' data-ref="928filter">filter</a>, <a class="ref fn" href="../include/linux/mm.h.html#zone_to_nid" title='zone_to_nid' data-ref="zone_to_nid">zone_to_nid</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>), <a class="local col9 ref" href="#929nodemask" title='nodemask' data-ref="929nodemask">nodemask</a>))</td></tr>
<tr><th id="4764">4764</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4765">4765</th><td></td></tr>
<tr><th id="4766">4766</th><td>		<a class="local col0 ref" href="#930free_pcp" title='free_pcp' data-ref="930free_pcp">free_pcp</a> = <var>0</var>;</td></tr>
<tr><th id="4767">4767</th><td>		<a class="macro" href="../include/linux/cpumask.h.html#750" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_online_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_online_cpu">for_each_online_cpu</a>(<a class="local col1 ref" href="#931cpu" title='cpu' data-ref="931cpu">cpu</a>)</td></tr>
<tr><th id="4768">4768</th><td>			<a class="local col0 ref" href="#930free_pcp" title='free_pcp' data-ref="930free_pcp">free_pcp</a> += <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col1 ref" href="#931cpu" title='cpu' data-ref="931cpu">cpu</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>.<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>;</td></tr>
<tr><th id="4769">4769</th><td></td></tr>
<tr><th id="4770">4770</th><td>		<a class="tu ref fn" href="#show_node" title='show_node' data-use='c' data-ref="show_node">show_node</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>);</td></tr>
<tr><th id="4771">4771</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a></td></tr>
<tr><th id="4772">4772</th><td>			<q>"%s"</q></td></tr>
<tr><th id="4773">4773</th><td>			<q>" free:%lukB"</q></td></tr>
<tr><th id="4774">4774</th><td>			<q>" min:%lukB"</q></td></tr>
<tr><th id="4775">4775</th><td>			<q>" low:%lukB"</q></td></tr>
<tr><th id="4776">4776</th><td>			<q>" high:%lukB"</q></td></tr>
<tr><th id="4777">4777</th><td>			<q>" active_anon:%lukB"</q></td></tr>
<tr><th id="4778">4778</th><td>			<q>" inactive_anon:%lukB"</q></td></tr>
<tr><th id="4779">4779</th><td>			<q>" active_file:%lukB"</q></td></tr>
<tr><th id="4780">4780</th><td>			<q>" inactive_file:%lukB"</q></td></tr>
<tr><th id="4781">4781</th><td>			<q>" unevictable:%lukB"</q></td></tr>
<tr><th id="4782">4782</th><td>			<q>" writepending:%lukB"</q></td></tr>
<tr><th id="4783">4783</th><td>			<q>" present:%lukB"</q></td></tr>
<tr><th id="4784">4784</th><td>			<q>" managed:%lukB"</q></td></tr>
<tr><th id="4785">4785</th><td>			<q>" mlocked:%lukB"</q></td></tr>
<tr><th id="4786">4786</th><td>			<q>" kernel_stack:%lukB"</q></td></tr>
<tr><th id="4787">4787</th><td>			<q>" pagetables:%lukB"</q></td></tr>
<tr><th id="4788">4788</th><td>			<q>" bounce:%lukB"</q></td></tr>
<tr><th id="4789">4789</th><td>			<q>" free_pcp:%lukB"</q></td></tr>
<tr><th id="4790">4790</th><td>			<q>" local_pcp:%ukB"</q></td></tr>
<tr><th id="4791">4791</th><td>			<q>" free_cma:%lukB"</q></td></tr>
<tr><th id="4792">4792</th><td>			<q>"\n"</q>,</td></tr>
<tr><th id="4793">4793</th><td>			<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::name" title='zone::name' data-ref="zone::name">name</a>,</td></tr>
<tr><th id="4794">4794</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_FREE_PAGES)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_PAGES" title='NR_FREE_PAGES' data-ref="NR_FREE_PAGES">NR_FREE_PAGES</a>)),</td></tr>
<tr><th id="4795">4795</th><td>			<a class="macro" href="#4632" title="(((zone-&gt;watermark[WMARK_MIN])) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/mmzone.h.html#269" title="(zone-&gt;watermark[WMARK_MIN])" data-ref="_M/min_wmark_pages">min_wmark_pages</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>)),</td></tr>
<tr><th id="4796">4796</th><td>			<a class="macro" href="#4632" title="(((zone-&gt;watermark[WMARK_LOW])) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/mmzone.h.html#270" title="(zone-&gt;watermark[WMARK_LOW])" data-ref="_M/low_wmark_pages">low_wmark_pages</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>)),</td></tr>
<tr><th id="4797">4797</th><td>			<a class="macro" href="#4632" title="(((zone-&gt;watermark[WMARK_HIGH])) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/mmzone.h.html#271" title="(zone-&gt;watermark[WMARK_HIGH])" data-ref="_M/high_wmark_pages">high_wmark_pages</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>)),</td></tr>
<tr><th id="4798">4798</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_ZONE_ACTIVE_ANON)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_ACTIVE_ANON" title='NR_ZONE_ACTIVE_ANON' data-ref="NR_ZONE_ACTIVE_ANON">NR_ZONE_ACTIVE_ANON</a>)),</td></tr>
<tr><th id="4799">4799</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_ZONE_INACTIVE_ANON)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_INACTIVE_ANON" title='NR_ZONE_INACTIVE_ANON' data-ref="NR_ZONE_INACTIVE_ANON">NR_ZONE_INACTIVE_ANON</a>)),</td></tr>
<tr><th id="4800">4800</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_ZONE_ACTIVE_FILE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_ACTIVE_FILE" title='NR_ZONE_ACTIVE_FILE' data-ref="NR_ZONE_ACTIVE_FILE">NR_ZONE_ACTIVE_FILE</a>)),</td></tr>
<tr><th id="4801">4801</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_ZONE_INACTIVE_FILE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_INACTIVE_FILE" title='NR_ZONE_INACTIVE_FILE' data-ref="NR_ZONE_INACTIVE_FILE">NR_ZONE_INACTIVE_FILE</a>)),</td></tr>
<tr><th id="4802">4802</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_ZONE_UNEVICTABLE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_UNEVICTABLE" title='NR_ZONE_UNEVICTABLE' data-ref="NR_ZONE_UNEVICTABLE">NR_ZONE_UNEVICTABLE</a>)),</td></tr>
<tr><th id="4803">4803</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_ZONE_WRITE_PENDING)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_ZONE_WRITE_PENDING" title='NR_ZONE_WRITE_PENDING' data-ref="NR_ZONE_WRITE_PENDING">NR_ZONE_WRITE_PENDING</a>)),</td></tr>
<tr><th id="4804">4804</th><td>			<a class="macro" href="#4632" title="((zone-&gt;present_pages) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::present_pages" title='zone::present_pages' data-ref="zone::present_pages">present_pages</a>),</td></tr>
<tr><th id="4805">4805</th><td>			<a class="macro" href="#4632" title="((zone-&gt;managed_pages) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>),</td></tr>
<tr><th id="4806">4806</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_MLOCK)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_MLOCK" title='NR_MLOCK' data-ref="NR_MLOCK">NR_MLOCK</a>)),</td></tr>
<tr><th id="4807">4807</th><td>			<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_KERNEL_STACK_KB" title='NR_KERNEL_STACK_KB' data-ref="NR_KERNEL_STACK_KB">NR_KERNEL_STACK_KB</a>),</td></tr>
<tr><th id="4808">4808</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_PAGETABLE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_PAGETABLE" title='NR_PAGETABLE' data-ref="NR_PAGETABLE">NR_PAGETABLE</a>)),</td></tr>
<tr><th id="4809">4809</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_BOUNCE)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_BOUNCE" title='NR_BOUNCE' data-ref="NR_BOUNCE">NR_BOUNCE</a>)),</td></tr>
<tr><th id="4810">4810</th><td>			<a class="macro" href="#4632" title="((free_pcp) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="local col0 ref" href="#930free_pcp" title='free_pcp' data-ref="930free_pcp">free_pcp</a>),</td></tr>
<tr><th id="4811">4811</th><td>			<a class="macro" href="#4632" title="((({ typeof(zone-&gt;pageset-&gt;pcp.count) pscr_ret__; do { const void *__vpp_verify = (typeof((&amp;(zone-&gt;pageset-&gt;pcp.count)) + 0))((void *)0); (void)__vpp_verify; } while (0); switch(sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 2: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 4: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 8: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; default: __bad_size_call_parameter(); break; } pscr_ret__; })) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="macro" href="../include/linux/percpu-defs.h.html#494" title="({ typeof(zone-&gt;pageset-&gt;pcp.count) pscr_ret__; do { const void *__vpp_verify = (typeof((&amp;(zone-&gt;pageset-&gt;pcp.count)) + 0))((void *)0); (void)__vpp_verify; } while (0); switch(sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 2: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 4: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; case 8: pscr_ret__ = ({ typeof(zone-&gt;pageset-&gt;pcp.count) pfo_ret__; switch (sizeof(zone-&gt;pageset-&gt;pcp.count)) { case 1: asm(&quot;mov&quot; &quot;b &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=q&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 2: asm(&quot;mov&quot; &quot;w &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 4: asm(&quot;mov&quot; &quot;l &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; case 8: asm(&quot;mov&quot; &quot;q &quot;&quot;%%&quot;&quot;gs&quot;&quot;:&quot; &quot;%&quot; &quot;1&quot;&quot;,%0&quot; : &quot;=r&quot; (pfo_ret__) : &quot;m&quot; (zone-&gt;pageset-&gt;pcp.count)); break; default: __bad_percpu_size(); } pfo_ret__; }); break; default: __bad_size_call_parameter(); break; } pscr_ret__; })" data-ref="_M/this_cpu_read">this_cpu_read</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>.<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a>)),</td></tr>
<tr><th id="4812">4812</th><td>			<a class="macro" href="#4632" title="((zone_page_state(zone, NR_FREE_CMA_PAGES)) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="ref fn" href="../include/linux/vmstat.h.html#zone_page_state" title='zone_page_state' data-ref="zone_page_state">zone_page_state</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>, <a class="enum" href="../include/linux/mmzone.h.html#NR_FREE_CMA_PAGES" title='NR_FREE_CMA_PAGES' data-ref="NR_FREE_CMA_PAGES">NR_FREE_CMA_PAGES</a>)));</td></tr>
<tr><th id="4813">4813</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<q>"lowmem_reserve[]:"</q>);</td></tr>
<tr><th id="4814">4814</th><td>		<b>for</b> (<a class="local col4 ref" href="#934i" title='i' data-ref="934i">i</a> = <var>0</var>; <a class="local col4 ref" href="#934i" title='i' data-ref="934i">i</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col4 ref" href="#934i" title='i' data-ref="934i">i</a>++)</td></tr>
<tr><th id="4815">4815</th><td>			<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a> <q>" %ld"</q>, <a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col4 ref" href="#934i" title='i' data-ref="934i">i</a>]);</td></tr>
<tr><th id="4816">4816</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a> <q>"\n"</q>);</td></tr>
<tr><th id="4817">4817</th><td>	}</td></tr>
<tr><th id="4818">4818</th><td></td></tr>
<tr><th id="4819">4819</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>) {</td></tr>
<tr><th id="4820">4820</th><td>		<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="935order" title='order' data-type='unsigned int' data-ref="935order">order</dfn>;</td></tr>
<tr><th id="4821">4821</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="936nr" title='nr' data-type='unsigned long [11]' data-ref="936nr">nr</dfn>[<a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>], <dfn class="local col7 decl" id="937flags" title='flags' data-type='unsigned long' data-ref="937flags">flags</dfn>, <dfn class="local col8 decl" id="938total" title='total' data-type='unsigned long' data-ref="938total">total</dfn> = <var>0</var>;</td></tr>
<tr><th id="4822">4822</th><td>		<em>unsigned</em> <em>char</em> <dfn class="local col9 decl" id="939types" title='types' data-type='unsigned char [11]' data-ref="939types">types</dfn>[<a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>];</td></tr>
<tr><th id="4823">4823</th><td></td></tr>
<tr><th id="4824">4824</th><td>		<b>if</b> (<a class="tu ref fn" href="#show_mem_node_skip" title='show_mem_node_skip' data-use='c' data-ref="show_mem_node_skip">show_mem_node_skip</a>(<a class="local col8 ref" href="#928filter" title='filter' data-ref="928filter">filter</a>, <a class="ref fn" href="../include/linux/mm.h.html#zone_to_nid" title='zone_to_nid' data-ref="zone_to_nid">zone_to_nid</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>), <a class="local col9 ref" href="#929nodemask" title='nodemask' data-ref="929nodemask">nodemask</a>))</td></tr>
<tr><th id="4825">4825</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4826">4826</th><td>		<a class="tu ref fn" href="#show_node" title='show_node' data-use='c' data-ref="show_node">show_node</a>(<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>);</td></tr>
<tr><th id="4827">4827</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a> <q>"%s: "</q>, <a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::name" title='zone::name' data-ref="zone::name">name</a>);</td></tr>
<tr><th id="4828">4828</th><td></td></tr>
<tr><th id="4829">4829</th><td>		<a class="macro" href="../include/linux/spinlock.h.html#345" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = _raw_spin_lock_irqsave(spinlock_check(&amp;zone-&gt;lock)); } while (0); } while (0)" data-ref="_M/spin_lock_irqsave">spin_lock_irqsave</a>(&amp;<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col7 ref" href="#937flags" title='flags' data-ref="937flags">flags</a>);</td></tr>
<tr><th id="4830">4830</th><td>		<b>for</b> (<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a> = <var>0</var>; <a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>; <a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>++) {</td></tr>
<tr><th id="4831">4831</th><td>			<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#free_area" title='free_area' data-ref="free_area">free_area</a> *<dfn class="local col0 decl" id="940area" title='area' data-type='struct free_area *' data-ref="940area">area</dfn> = &amp;<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>];</td></tr>
<tr><th id="4832">4832</th><td>			<em>int</em> <dfn class="local col1 decl" id="941type" title='type' data-type='int' data-ref="941type">type</dfn>;</td></tr>
<tr><th id="4833">4833</th><td></td></tr>
<tr><th id="4834">4834</th><td>			<a class="local col6 ref" href="#936nr" title='nr' data-ref="936nr">nr</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>] = <a class="local col0 ref" href="#940area" title='area' data-ref="940area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a>;</td></tr>
<tr><th id="4835">4835</th><td>			<a class="local col8 ref" href="#938total" title='total' data-ref="938total">total</a> += <a class="local col6 ref" href="#936nr" title='nr' data-ref="936nr">nr</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>] &lt;&lt; <a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>;</td></tr>
<tr><th id="4836">4836</th><td></td></tr>
<tr><th id="4837">4837</th><td>			<a class="local col9 ref" href="#939types" title='types' data-ref="939types">types</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>] = <var>0</var>;</td></tr>
<tr><th id="4838">4838</th><td>			<b>for</b> (<a class="local col1 ref" href="#941type" title='type' data-ref="941type">type</a> = <var>0</var>; <a class="local col1 ref" href="#941type" title='type' data-ref="941type">type</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>; <a class="local col1 ref" href="#941type" title='type' data-ref="941type">type</a>++) {</td></tr>
<tr><th id="4839">4839</th><td>				<b>if</b> (!<a class="ref fn" href="../include/linux/list.h.html#list_empty" title='list_empty' data-ref="list_empty">list_empty</a>(&amp;<a class="local col0 ref" href="#940area" title='area' data-ref="940area">area</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col1 ref" href="#941type" title='type' data-ref="941type">type</a>]))</td></tr>
<tr><th id="4840">4840</th><td>					<a class="local col9 ref" href="#939types" title='types' data-ref="939types">types</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>] |= <var>1</var> &lt;&lt; <a class="local col1 ref" href="#941type" title='type' data-ref="941type">type</a>;</td></tr>
<tr><th id="4841">4841</th><td>			}</td></tr>
<tr><th id="4842">4842</th><td>		}</td></tr>
<tr><th id="4843">4843</th><td>		<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock_irqrestore" title='spin_unlock_irqrestore' data-ref="spin_unlock_irqrestore">spin_unlock_irqrestore</a>(&amp;<a class="local col2 ref" href="#932zone" title='zone' data-ref="932zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col7 ref" href="#937flags" title='flags' data-ref="937flags">flags</a>);</td></tr>
<tr><th id="4844">4844</th><td>		<b>for</b> (<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a> = <var>0</var>; <a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>; <a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>++) {</td></tr>
<tr><th id="4845">4845</th><td>			<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a> <q>"%lu*%lukB "</q>,</td></tr>
<tr><th id="4846">4846</th><td>			       <a class="local col6 ref" href="#936nr" title='nr' data-ref="936nr">nr</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>], <a class="macro" href="#4632" title="((1UL) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<var>1UL</var>) &lt;&lt; <a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>);</td></tr>
<tr><th id="4847">4847</th><td>			<b>if</b> (<a class="local col6 ref" href="#936nr" title='nr' data-ref="936nr">nr</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>])</td></tr>
<tr><th id="4848">4848</th><td>				<a class="tu ref fn" href="#show_migration_types" title='show_migration_types' data-use='c' data-ref="show_migration_types">show_migration_types</a>(<a class="local col9 ref" href="#939types" title='types' data-ref="939types">types</a>[<a class="local col5 ref" href="#935order" title='order' data-ref="935order">order</a>]);</td></tr>
<tr><th id="4849">4849</th><td>		}</td></tr>
<tr><th id="4850">4850</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#24" title="&quot;\001&quot; &quot;c&quot;" data-ref="_M/KERN_CONT">KERN_CONT</a> <q>"= %lukB\n"</q>, <a class="macro" href="#4632" title="((total) &lt;&lt; (12-10))" data-ref="_M/K">K</a>(<a class="local col8 ref" href="#938total" title='total' data-ref="938total">total</a>));</td></tr>
<tr><th id="4851">4851</th><td>	}</td></tr>
<tr><th id="4852">4852</th><td></td></tr>
<tr><th id="4853">4853</th><td>	<a class="ref fn" href="../include/linux/hugetlb.h.html#hugetlb_show_meminfo" title='hugetlb_show_meminfo' data-ref="hugetlb_show_meminfo">hugetlb_show_meminfo</a>();</td></tr>
<tr><th id="4854">4854</th><td></td></tr>
<tr><th id="4855">4855</th><td>	<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<q>"%ld total pagecache pages\n"</q>, <a class="ref fn" href="../include/linux/vmstat.h.html#global_node_page_state" title='global_node_page_state' data-ref="global_node_page_state">global_node_page_state</a>(<a class="enum" href="../include/linux/mmzone.h.html#NR_FILE_PAGES" title='NR_FILE_PAGES' data-ref="NR_FILE_PAGES">NR_FILE_PAGES</a>));</td></tr>
<tr><th id="4856">4856</th><td></td></tr>
<tr><th id="4857">4857</th><td>	<a class="ref fn" href="../include/linux/swap.h.html#show_swap_cache_info" title='show_swap_cache_info' data-ref="show_swap_cache_info">show_swap_cache_info</a>();</td></tr>
<tr><th id="4858">4858</th><td>}</td></tr>
<tr><th id="4859">4859</th><td></td></tr>
<tr><th id="4860">4860</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="zoneref_set_zone" title='zoneref_set_zone' data-type='void zoneref_set_zone(struct zone * zone, struct zoneref * zoneref)' data-ref="zoneref_set_zone">zoneref_set_zone</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="942zone" title='zone' data-type='struct zone *' data-ref="942zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col3 decl" id="943zoneref" title='zoneref' data-type='struct zoneref *' data-ref="943zoneref">zoneref</dfn>)</td></tr>
<tr><th id="4861">4861</th><td>{</td></tr>
<tr><th id="4862">4862</th><td>	<a class="local col3 ref" href="#943zoneref" title='zoneref' data-ref="943zoneref">zoneref</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone" title='zoneref::zone' data-ref="zoneref::zone">zone</a> = <a class="local col2 ref" href="#942zone" title='zone' data-ref="942zone">zone</a>;</td></tr>
<tr><th id="4863">4863</th><td>	<a class="local col3 ref" href="#943zoneref" title='zoneref' data-ref="943zoneref">zoneref</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone_idx" title='zoneref::zone_idx' data-ref="zoneref::zone_idx">zone_idx</a> = <a class="macro" href="../include/linux/mmzone.h.html#832" title="((zone) - (zone)-&gt;zone_pgdat-&gt;node_zones)" data-ref="_M/zone_idx">zone_idx</a>(<a class="local col2 ref" href="#942zone" title='zone' data-ref="942zone">zone</a>);</td></tr>
<tr><th id="4864">4864</th><td>}</td></tr>
<tr><th id="4865">4865</th><td></td></tr>
<tr><th id="4866">4866</th><td><i  data-doc="build_zonerefs_node">/*</i></td></tr>
<tr><th id="4867">4867</th><td><i  data-doc="build_zonerefs_node"> * Builds allocation fallback zone lists.</i></td></tr>
<tr><th id="4868">4868</th><td><i  data-doc="build_zonerefs_node"> *</i></td></tr>
<tr><th id="4869">4869</th><td><i  data-doc="build_zonerefs_node"> * Add all populated zones of a node to the zonelist.</i></td></tr>
<tr><th id="4870">4870</th><td><i  data-doc="build_zonerefs_node"> */</i></td></tr>
<tr><th id="4871">4871</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_zonerefs_node" title='build_zonerefs_node' data-type='int build_zonerefs_node(pg_data_t * pgdat, struct zoneref * zonerefs)' data-ref="build_zonerefs_node">build_zonerefs_node</dfn>(<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col4 decl" id="944pgdat" title='pgdat' data-type='pg_data_t *' data-ref="944pgdat">pgdat</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col5 decl" id="945zonerefs" title='zonerefs' data-type='struct zoneref *' data-ref="945zonerefs">zonerefs</dfn>)</td></tr>
<tr><th id="4872">4872</th><td>{</td></tr>
<tr><th id="4873">4873</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="946zone" title='zone' data-type='struct zone *' data-ref="946zone">zone</dfn>;</td></tr>
<tr><th id="4874">4874</th><td>	<b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#zone_type" title='zone_type' data-ref="zone_type">zone_type</a> <dfn class="local col7 decl" id="947zone_type" title='zone_type' data-type='enum zone_type' data-ref="947zone_type">zone_type</dfn> = <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>;</td></tr>
<tr><th id="4875">4875</th><td>	<em>int</em> <dfn class="local col8 decl" id="948nr_zones" title='nr_zones' data-type='int' data-ref="948nr_zones">nr_zones</dfn> = <var>0</var>;</td></tr>
<tr><th id="4876">4876</th><td></td></tr>
<tr><th id="4877">4877</th><td>	<b>do</b> {</td></tr>
<tr><th id="4878">4878</th><td>		<a class="local col7 ref" href="#947zone_type" title='zone_type' data-ref="947zone_type">zone_type</a>--;</td></tr>
<tr><th id="4879">4879</th><td>		<a class="local col6 ref" href="#946zone" title='zone' data-ref="946zone">zone</a> = <a class="local col4 ref" href="#944pgdat" title='pgdat' data-ref="944pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a> + <a class="local col7 ref" href="#947zone_type" title='zone_type' data-ref="947zone_type">zone_type</a>;</td></tr>
<tr><th id="4880">4880</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mmzone.h.html#managed_zone" title='managed_zone' data-ref="managed_zone">managed_zone</a>(<a class="local col6 ref" href="#946zone" title='zone' data-ref="946zone">zone</a>)) {</td></tr>
<tr><th id="4881">4881</th><td>			<a class="tu ref fn" href="#zoneref_set_zone" title='zoneref_set_zone' data-use='c' data-ref="zoneref_set_zone">zoneref_set_zone</a>(<a class="local col6 ref" href="#946zone" title='zone' data-ref="946zone">zone</a>, &amp;<a class="local col5 ref" href="#945zonerefs" title='zonerefs' data-ref="945zonerefs">zonerefs</a>[<a class="local col8 ref" href="#948nr_zones" title='nr_zones' data-ref="948nr_zones">nr_zones</a>++]);</td></tr>
<tr><th id="4882">4882</th><td>			<a class="ref fn" href="../include/linux/mempolicy.h.html#check_highest_zone" title='check_highest_zone' data-ref="check_highest_zone">check_highest_zone</a>(<a class="local col7 ref" href="#947zone_type" title='zone_type' data-ref="947zone_type">zone_type</a>);</td></tr>
<tr><th id="4883">4883</th><td>		}</td></tr>
<tr><th id="4884">4884</th><td>	} <b>while</b> (<a class="local col7 ref" href="#947zone_type" title='zone_type' data-ref="947zone_type">zone_type</a>);</td></tr>
<tr><th id="4885">4885</th><td></td></tr>
<tr><th id="4886">4886</th><td>	<b>return</b> <a class="local col8 ref" href="#948nr_zones" title='nr_zones' data-ref="948nr_zones">nr_zones</a>;</td></tr>
<tr><th id="4887">4887</th><td>}</td></tr>
<tr><th id="4888">4888</th><td></td></tr>
<tr><th id="4889">4889</th><td><u>#<span data-ppcond="4889">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="4890">4890</th><td></td></tr>
<tr><th id="4891">4891</th><td><em>static</em> <em>int</em> __parse_numa_zonelist_order(<em>char</em> *s)</td></tr>
<tr><th id="4892">4892</th><td>{</td></tr>
<tr><th id="4893">4893</th><td>	<i>/*</i></td></tr>
<tr><th id="4894">4894</th><td><i>	 * We used to support different zonlists modes but they turned</i></td></tr>
<tr><th id="4895">4895</th><td><i>	 * out to be just not useful. Let's keep the warning in place</i></td></tr>
<tr><th id="4896">4896</th><td><i>	 * if somebody still use the cmd line parameter so that we do</i></td></tr>
<tr><th id="4897">4897</th><td><i>	 * not fail it silently</i></td></tr>
<tr><th id="4898">4898</th><td><i>	 */</i></td></tr>
<tr><th id="4899">4899</th><td>	<b>if</b> (!(*s == <kbd>'d'</kbd> || *s == <kbd>'D'</kbd> || *s == <kbd>'n'</kbd> || *s == <kbd>'N'</kbd>)) {</td></tr>
<tr><th id="4900">4900</th><td>		pr_warn(<q>"Ignoring unsupported numa_zonelist_order value:  %s\n"</q>, s);</td></tr>
<tr><th id="4901">4901</th><td>		<b>return</b> -EINVAL;</td></tr>
<tr><th id="4902">4902</th><td>	}</td></tr>
<tr><th id="4903">4903</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4904">4904</th><td>}</td></tr>
<tr><th id="4905">4905</th><td></td></tr>
<tr><th id="4906">4906</th><td><em>static</em> __init <em>int</em> setup_numa_zonelist_order(<em>char</em> *s)</td></tr>
<tr><th id="4907">4907</th><td>{</td></tr>
<tr><th id="4908">4908</th><td>	<b>if</b> (!s)</td></tr>
<tr><th id="4909">4909</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4910">4910</th><td></td></tr>
<tr><th id="4911">4911</th><td>	<b>return</b> __parse_numa_zonelist_order(s);</td></tr>
<tr><th id="4912">4912</th><td>}</td></tr>
<tr><th id="4913">4913</th><td>early_param(<q>"numa_zonelist_order"</q>, setup_numa_zonelist_order);</td></tr>
<tr><th id="4914">4914</th><td></td></tr>
<tr><th id="4915">4915</th><td><em>char</em> numa_zonelist_order[] = <q>"Node"</q>;</td></tr>
<tr><th id="4916">4916</th><td></td></tr>
<tr><th id="4917">4917</th><td><i>/*</i></td></tr>
<tr><th id="4918">4918</th><td><i> * sysctl handler for numa_zonelist_order</i></td></tr>
<tr><th id="4919">4919</th><td><i> */</i></td></tr>
<tr><th id="4920">4920</th><td><em>int</em> numa_zonelist_order_handler(<b>struct</b> ctl_table *table, <em>int</em> write,</td></tr>
<tr><th id="4921">4921</th><td>		<em>void</em> __user *buffer, size_t *length,</td></tr>
<tr><th id="4922">4922</th><td>		loff_t *ppos)</td></tr>
<tr><th id="4923">4923</th><td>{</td></tr>
<tr><th id="4924">4924</th><td>	<em>char</em> *str;</td></tr>
<tr><th id="4925">4925</th><td>	<em>int</em> ret;</td></tr>
<tr><th id="4926">4926</th><td></td></tr>
<tr><th id="4927">4927</th><td>	<b>if</b> (!write)</td></tr>
<tr><th id="4928">4928</th><td>		<b>return</b> proc_dostring(table, write, buffer, length, ppos);</td></tr>
<tr><th id="4929">4929</th><td>	str = memdup_user_nul(buffer, <var>16</var>);</td></tr>
<tr><th id="4930">4930</th><td>	<b>if</b> (IS_ERR(str))</td></tr>
<tr><th id="4931">4931</th><td>		<b>return</b> PTR_ERR(str);</td></tr>
<tr><th id="4932">4932</th><td></td></tr>
<tr><th id="4933">4933</th><td>	ret = __parse_numa_zonelist_order(str);</td></tr>
<tr><th id="4934">4934</th><td>	kfree(str);</td></tr>
<tr><th id="4935">4935</th><td>	<b>return</b> ret;</td></tr>
<tr><th id="4936">4936</th><td>}</td></tr>
<tr><th id="4937">4937</th><td></td></tr>
<tr><th id="4938">4938</th><td></td></tr>
<tr><th id="4939">4939</th><td><u>#define MAX_NODE_LOAD (nr_online_nodes)</u></td></tr>
<tr><th id="4940">4940</th><td><em>static</em> <em>int</em> node_load[MAX_NUMNODES];</td></tr>
<tr><th id="4941">4941</th><td></td></tr>
<tr><th id="4942">4942</th><td><i class="doc">/**</i></td></tr>
<tr><th id="4943">4943</th><td><i class="doc"> * find_next_best_node - find the next node that should appear in a given node's fallback list</i></td></tr>
<tr><th id="4944">4944</th><td><i class="doc"> *<span class="command"> @node</span>: node whose fallback list we're appending</i></td></tr>
<tr><th id="4945">4945</th><td><i class="doc"> *<span class="command"> @used</span>_node_mask: nodemask_t of already used nodes</i></td></tr>
<tr><th id="4946">4946</th><td><i class="doc"> *</i></td></tr>
<tr><th id="4947">4947</th><td><i class="doc"> * We use a number of factors to determine which is the next node that should</i></td></tr>
<tr><th id="4948">4948</th><td><i class="doc"> * appear on a given node's fallback list.  The node should not have appeared</i></td></tr>
<tr><th id="4949">4949</th><td><i class="doc"> * already in<span class="command"> @node</span>'s fallback list, and it should be the next closest node</i></td></tr>
<tr><th id="4950">4950</th><td><i class="doc"> * according to the distance array (which contains arbitrary distance values</i></td></tr>
<tr><th id="4951">4951</th><td><i class="doc"> * from each node to each node in the system), and should also prefer nodes</i></td></tr>
<tr><th id="4952">4952</th><td><i class="doc"> * with no CPUs, since presumably they'll have very little allocation pressure</i></td></tr>
<tr><th id="4953">4953</th><td><i class="doc"> * on them otherwise.</i></td></tr>
<tr><th id="4954">4954</th><td><i class="doc"> * It returns -1 if no node is found.</i></td></tr>
<tr><th id="4955">4955</th><td><i class="doc"> */</i></td></tr>
<tr><th id="4956">4956</th><td><em>static</em> <em>int</em> find_next_best_node(<em>int</em> node, nodemask_t *used_node_mask)</td></tr>
<tr><th id="4957">4957</th><td>{</td></tr>
<tr><th id="4958">4958</th><td>	<em>int</em> n, val;</td></tr>
<tr><th id="4959">4959</th><td>	<em>int</em> min_val = INT_MAX;</td></tr>
<tr><th id="4960">4960</th><td>	<em>int</em> best_node = NUMA_NO_NODE;</td></tr>
<tr><th id="4961">4961</th><td>	<em>const</em> <b>struct</b> cpumask *tmp = cpumask_of_node(<var>0</var>);</td></tr>
<tr><th id="4962">4962</th><td></td></tr>
<tr><th id="4963">4963</th><td>	<i>/* Use the local node if we haven't already */</i></td></tr>
<tr><th id="4964">4964</th><td>	<b>if</b> (!node_isset(node, *used_node_mask)) {</td></tr>
<tr><th id="4965">4965</th><td>		node_set(node, *used_node_mask);</td></tr>
<tr><th id="4966">4966</th><td>		<b>return</b> node;</td></tr>
<tr><th id="4967">4967</th><td>	}</td></tr>
<tr><th id="4968">4968</th><td></td></tr>
<tr><th id="4969">4969</th><td>	for_each_node_state(n, N_MEMORY) {</td></tr>
<tr><th id="4970">4970</th><td></td></tr>
<tr><th id="4971">4971</th><td>		<i>/* Don't want a node to appear more than once */</i></td></tr>
<tr><th id="4972">4972</th><td>		<b>if</b> (node_isset(n, *used_node_mask))</td></tr>
<tr><th id="4973">4973</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4974">4974</th><td></td></tr>
<tr><th id="4975">4975</th><td>		<i>/* Use the distance array to find the distance */</i></td></tr>
<tr><th id="4976">4976</th><td>		val = node_distance(node, n);</td></tr>
<tr><th id="4977">4977</th><td></td></tr>
<tr><th id="4978">4978</th><td>		<i>/* Penalize nodes under us ("prefer the next node") */</i></td></tr>
<tr><th id="4979">4979</th><td>		val += (n &lt; node);</td></tr>
<tr><th id="4980">4980</th><td></td></tr>
<tr><th id="4981">4981</th><td>		<i>/* Give preference to headless and unused nodes */</i></td></tr>
<tr><th id="4982">4982</th><td>		tmp = cpumask_of_node(n);</td></tr>
<tr><th id="4983">4983</th><td>		<b>if</b> (!cpumask_empty(tmp))</td></tr>
<tr><th id="4984">4984</th><td>			val += PENALTY_FOR_NODE_WITH_CPUS;</td></tr>
<tr><th id="4985">4985</th><td></td></tr>
<tr><th id="4986">4986</th><td>		<i>/* Slight preference for less loaded node */</i></td></tr>
<tr><th id="4987">4987</th><td>		val *= (MAX_NODE_LOAD*MAX_NUMNODES);</td></tr>
<tr><th id="4988">4988</th><td>		val += node_load[n];</td></tr>
<tr><th id="4989">4989</th><td></td></tr>
<tr><th id="4990">4990</th><td>		<b>if</b> (val &lt; min_val) {</td></tr>
<tr><th id="4991">4991</th><td>			min_val = val;</td></tr>
<tr><th id="4992">4992</th><td>			best_node = n;</td></tr>
<tr><th id="4993">4993</th><td>		}</td></tr>
<tr><th id="4994">4994</th><td>	}</td></tr>
<tr><th id="4995">4995</th><td></td></tr>
<tr><th id="4996">4996</th><td>	<b>if</b> (best_node &gt;= <var>0</var>)</td></tr>
<tr><th id="4997">4997</th><td>		node_set(best_node, *used_node_mask);</td></tr>
<tr><th id="4998">4998</th><td></td></tr>
<tr><th id="4999">4999</th><td>	<b>return</b> best_node;</td></tr>
<tr><th id="5000">5000</th><td>}</td></tr>
<tr><th id="5001">5001</th><td></td></tr>
<tr><th id="5002">5002</th><td></td></tr>
<tr><th id="5003">5003</th><td><i>/*</i></td></tr>
<tr><th id="5004">5004</th><td><i> * Build zonelists ordered by node and zones within node.</i></td></tr>
<tr><th id="5005">5005</th><td><i> * This results in maximum locality--normal zone overflows into local</i></td></tr>
<tr><th id="5006">5006</th><td><i> * DMA zone, if any--but risks exhausting DMA zone.</i></td></tr>
<tr><th id="5007">5007</th><td><i> */</i></td></tr>
<tr><th id="5008">5008</th><td><em>static</em> <em>void</em> build_zonelists_in_node_order(pg_data_t *pgdat, <em>int</em> *node_order,</td></tr>
<tr><th id="5009">5009</th><td>		<em>unsigned</em> nr_nodes)</td></tr>
<tr><th id="5010">5010</th><td>{</td></tr>
<tr><th id="5011">5011</th><td>	<b>struct</b> zoneref *zonerefs;</td></tr>
<tr><th id="5012">5012</th><td>	<em>int</em> i;</td></tr>
<tr><th id="5013">5013</th><td></td></tr>
<tr><th id="5014">5014</th><td>	zonerefs = pgdat-&gt;node_zonelists[ZONELIST_FALLBACK]._zonerefs;</td></tr>
<tr><th id="5015">5015</th><td></td></tr>
<tr><th id="5016">5016</th><td>	<b>for</b> (i = <var>0</var>; i &lt; nr_nodes; i++) {</td></tr>
<tr><th id="5017">5017</th><td>		<em>int</em> nr_zones;</td></tr>
<tr><th id="5018">5018</th><td></td></tr>
<tr><th id="5019">5019</th><td>		pg_data_t *node = NODE_DATA(node_order[i]);</td></tr>
<tr><th id="5020">5020</th><td></td></tr>
<tr><th id="5021">5021</th><td>		nr_zones = build_zonerefs_node(node, zonerefs);</td></tr>
<tr><th id="5022">5022</th><td>		zonerefs += nr_zones;</td></tr>
<tr><th id="5023">5023</th><td>	}</td></tr>
<tr><th id="5024">5024</th><td>	zonerefs-&gt;zone = NULL;</td></tr>
<tr><th id="5025">5025</th><td>	zonerefs-&gt;zone_idx = <var>0</var>;</td></tr>
<tr><th id="5026">5026</th><td>}</td></tr>
<tr><th id="5027">5027</th><td></td></tr>
<tr><th id="5028">5028</th><td><i>/*</i></td></tr>
<tr><th id="5029">5029</th><td><i> * Build gfp_thisnode zonelists</i></td></tr>
<tr><th id="5030">5030</th><td><i> */</i></td></tr>
<tr><th id="5031">5031</th><td><em>static</em> <em>void</em> build_thisnode_zonelists(pg_data_t *pgdat)</td></tr>
<tr><th id="5032">5032</th><td>{</td></tr>
<tr><th id="5033">5033</th><td>	<b>struct</b> zoneref *zonerefs;</td></tr>
<tr><th id="5034">5034</th><td>	<em>int</em> nr_zones;</td></tr>
<tr><th id="5035">5035</th><td></td></tr>
<tr><th id="5036">5036</th><td>	zonerefs = pgdat-&gt;node_zonelists[ZONELIST_NOFALLBACK]._zonerefs;</td></tr>
<tr><th id="5037">5037</th><td>	nr_zones = build_zonerefs_node(pgdat, zonerefs);</td></tr>
<tr><th id="5038">5038</th><td>	zonerefs += nr_zones;</td></tr>
<tr><th id="5039">5039</th><td>	zonerefs-&gt;zone = NULL;</td></tr>
<tr><th id="5040">5040</th><td>	zonerefs-&gt;zone_idx = <var>0</var>;</td></tr>
<tr><th id="5041">5041</th><td>}</td></tr>
<tr><th id="5042">5042</th><td></td></tr>
<tr><th id="5043">5043</th><td><i>/*</i></td></tr>
<tr><th id="5044">5044</th><td><i> * Build zonelists ordered by zone and nodes within zones.</i></td></tr>
<tr><th id="5045">5045</th><td><i> * This results in conserving DMA zone[s] until all Normal memory is</i></td></tr>
<tr><th id="5046">5046</th><td><i> * exhausted, but results in overflowing to remote node while memory</i></td></tr>
<tr><th id="5047">5047</th><td><i> * may still exist in local DMA zone.</i></td></tr>
<tr><th id="5048">5048</th><td><i> */</i></td></tr>
<tr><th id="5049">5049</th><td></td></tr>
<tr><th id="5050">5050</th><td><em>static</em> <em>void</em> build_zonelists(pg_data_t *pgdat)</td></tr>
<tr><th id="5051">5051</th><td>{</td></tr>
<tr><th id="5052">5052</th><td>	<em>static</em> <em>int</em> node_order[MAX_NUMNODES];</td></tr>
<tr><th id="5053">5053</th><td>	<em>int</em> node, load, nr_nodes = <var>0</var>;</td></tr>
<tr><th id="5054">5054</th><td>	nodemask_t used_mask;</td></tr>
<tr><th id="5055">5055</th><td>	<em>int</em> local_node, prev_node;</td></tr>
<tr><th id="5056">5056</th><td></td></tr>
<tr><th id="5057">5057</th><td>	<i>/* NUMA-aware ordering of nodes */</i></td></tr>
<tr><th id="5058">5058</th><td>	local_node = pgdat-&gt;node_id;</td></tr>
<tr><th id="5059">5059</th><td>	load = nr_online_nodes;</td></tr>
<tr><th id="5060">5060</th><td>	prev_node = local_node;</td></tr>
<tr><th id="5061">5061</th><td>	nodes_clear(used_mask);</td></tr>
<tr><th id="5062">5062</th><td></td></tr>
<tr><th id="5063">5063</th><td>	memset(node_order, <var>0</var>, <b>sizeof</b>(node_order));</td></tr>
<tr><th id="5064">5064</th><td>	<b>while</b> ((node = find_next_best_node(local_node, &amp;used_mask)) &gt;= <var>0</var>) {</td></tr>
<tr><th id="5065">5065</th><td>		<i>/*</i></td></tr>
<tr><th id="5066">5066</th><td><i>		 * We don't want to pressure a particular node.</i></td></tr>
<tr><th id="5067">5067</th><td><i>		 * So adding penalty to the first node in same</i></td></tr>
<tr><th id="5068">5068</th><td><i>		 * distance group to make it round-robin.</i></td></tr>
<tr><th id="5069">5069</th><td><i>		 */</i></td></tr>
<tr><th id="5070">5070</th><td>		<b>if</b> (node_distance(local_node, node) !=</td></tr>
<tr><th id="5071">5071</th><td>		    node_distance(local_node, prev_node))</td></tr>
<tr><th id="5072">5072</th><td>			node_load[node] = load;</td></tr>
<tr><th id="5073">5073</th><td></td></tr>
<tr><th id="5074">5074</th><td>		node_order[nr_nodes++] = node;</td></tr>
<tr><th id="5075">5075</th><td>		prev_node = node;</td></tr>
<tr><th id="5076">5076</th><td>		load--;</td></tr>
<tr><th id="5077">5077</th><td>	}</td></tr>
<tr><th id="5078">5078</th><td></td></tr>
<tr><th id="5079">5079</th><td>	build_zonelists_in_node_order(pgdat, node_order, nr_nodes);</td></tr>
<tr><th id="5080">5080</th><td>	build_thisnode_zonelists(pgdat);</td></tr>
<tr><th id="5081">5081</th><td>}</td></tr>
<tr><th id="5082">5082</th><td></td></tr>
<tr><th id="5083">5083</th><td><u>#ifdef CONFIG_HAVE_MEMORYLESS_NODES</u></td></tr>
<tr><th id="5084">5084</th><td><i>/*</i></td></tr>
<tr><th id="5085">5085</th><td><i> * Return node id of node used for "local" allocations.</i></td></tr>
<tr><th id="5086">5086</th><td><i> * I.e., first node id of first zone in arg node's generic zonelist.</i></td></tr>
<tr><th id="5087">5087</th><td><i> * Used for initializing percpu 'numa_mem', which is used primarily</i></td></tr>
<tr><th id="5088">5088</th><td><i> * for kernel allocations, so use GFP_KERNEL flags to locate zonelist.</i></td></tr>
<tr><th id="5089">5089</th><td><i> */</i></td></tr>
<tr><th id="5090">5090</th><td><em>int</em> local_memory_node(<em>int</em> node)</td></tr>
<tr><th id="5091">5091</th><td>{</td></tr>
<tr><th id="5092">5092</th><td>	<b>struct</b> zoneref *z;</td></tr>
<tr><th id="5093">5093</th><td></td></tr>
<tr><th id="5094">5094</th><td>	z = first_zones_zonelist(node_zonelist(node, GFP_KERNEL),</td></tr>
<tr><th id="5095">5095</th><td>				   gfp_zone(GFP_KERNEL),</td></tr>
<tr><th id="5096">5096</th><td>				   NULL);</td></tr>
<tr><th id="5097">5097</th><td>	<b>return</b> z-&gt;zone-&gt;node;</td></tr>
<tr><th id="5098">5098</th><td>}</td></tr>
<tr><th id="5099">5099</th><td><u>#endif</u></td></tr>
<tr><th id="5100">5100</th><td></td></tr>
<tr><th id="5101">5101</th><td><em>static</em> <em>void</em> setup_min_unmapped_ratio(<em>void</em>);</td></tr>
<tr><th id="5102">5102</th><td><em>static</em> <em>void</em> setup_min_slab_ratio(<em>void</em>);</td></tr>
<tr><th id="5103">5103</th><td><u>#<span data-ppcond="4889">else</span>	/* CONFIG_NUMA */</u></td></tr>
<tr><th id="5104">5104</th><td></td></tr>
<tr><th id="5105">5105</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="build_zonelists" title='build_zonelists' data-type='void build_zonelists(pg_data_t * pgdat)' data-ref="build_zonelists">build_zonelists</dfn>(<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col9 decl" id="949pgdat" title='pgdat' data-type='pg_data_t *' data-ref="949pgdat">pgdat</dfn>)</td></tr>
<tr><th id="5106">5106</th><td>{</td></tr>
<tr><th id="5107">5107</th><td>	<em>int</em> <dfn class="local col0 decl" id="950node" title='node' data-type='int' data-ref="950node">node</dfn>, <dfn class="local col1 decl" id="951local_node" title='local_node' data-type='int' data-ref="951local_node">local_node</dfn>;</td></tr>
<tr><th id="5108">5108</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zoneref" title='zoneref' data-ref="zoneref">zoneref</a> *<dfn class="local col2 decl" id="952zonerefs" title='zonerefs' data-type='struct zoneref *' data-ref="952zonerefs">zonerefs</dfn>;</td></tr>
<tr><th id="5109">5109</th><td>	<em>int</em> <dfn class="local col3 decl" id="953nr_zones" title='nr_zones' data-type='int' data-ref="953nr_zones">nr_zones</dfn>;</td></tr>
<tr><th id="5110">5110</th><td></td></tr>
<tr><th id="5111">5111</th><td>	<a class="local col1 ref" href="#951local_node" title='local_node' data-ref="951local_node">local_node</a> = <a class="local col9 ref" href="#949pgdat" title='pgdat' data-ref="949pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>;</td></tr>
<tr><th id="5112">5112</th><td></td></tr>
<tr><th id="5113">5113</th><td>	<a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a> = <a class="local col9 ref" href="#949pgdat" title='pgdat' data-ref="949pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zonelists" title='pglist_data::node_zonelists' data-ref="pglist_data::node_zonelists">node_zonelists</a>[<a class="enum" href="../include/linux/mmzone.h.html#ZONELIST_FALLBACK" title='ZONELIST_FALLBACK' data-ref="ZONELIST_FALLBACK">ZONELIST_FALLBACK</a>].<a class="ref field" href="../include/linux/mmzone.h.html#zonelist::_zonerefs" title='zonelist::_zonerefs' data-ref="zonelist::_zonerefs">_zonerefs</a>;</td></tr>
<tr><th id="5114">5114</th><td>	<a class="local col3 ref" href="#953nr_zones" title='nr_zones' data-ref="953nr_zones">nr_zones</a> = <a class="tu ref fn" href="#build_zonerefs_node" title='build_zonerefs_node' data-use='c' data-ref="build_zonerefs_node">build_zonerefs_node</a>(<a class="local col9 ref" href="#949pgdat" title='pgdat' data-ref="949pgdat">pgdat</a>, <a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a>);</td></tr>
<tr><th id="5115">5115</th><td>	<a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a> += <a class="local col3 ref" href="#953nr_zones" title='nr_zones' data-ref="953nr_zones">nr_zones</a>;</td></tr>
<tr><th id="5116">5116</th><td></td></tr>
<tr><th id="5117">5117</th><td>	<i>/*</i></td></tr>
<tr><th id="5118">5118</th><td><i>	 * Now we build the zonelist so that it contains the zones</i></td></tr>
<tr><th id="5119">5119</th><td><i>	 * of all the other nodes.</i></td></tr>
<tr><th id="5120">5120</th><td><i>	 * We don't want to pressure a particular node, so when</i></td></tr>
<tr><th id="5121">5121</th><td><i>	 * building the zones for node N, we make sure that the</i></td></tr>
<tr><th id="5122">5122</th><td><i>	 * zones coming right after the local ones are those from</i></td></tr>
<tr><th id="5123">5123</th><td><i>	 * node N+1 (modulo N)</i></td></tr>
<tr><th id="5124">5124</th><td><i>	 */</i></td></tr>
<tr><th id="5125">5125</th><td>	<b>for</b> (<a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a> = <a class="local col1 ref" href="#951local_node" title='local_node' data-ref="951local_node">local_node</a> + <var>1</var>; <a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a> &lt; <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>; <a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a>++) {</td></tr>
<tr><th id="5126">5126</th><td>		<b>if</b> (!<a class="macro" href="../include/linux/nodemask.h.html#501" title="node_state((node), N_ONLINE)" data-ref="_M/node_online">node_online</a>(<a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a>))</td></tr>
<tr><th id="5127">5127</th><td>			<b>continue</b>;</td></tr>
<tr><th id="5128">5128</th><td>		<a class="local col3 ref" href="#953nr_zones" title='nr_zones' data-ref="953nr_zones">nr_zones</a> = <a class="tu ref fn" href="#build_zonerefs_node" title='build_zonerefs_node' data-use='c' data-ref="build_zonerefs_node">build_zonerefs_node</a>(<a class="macro" href="../include/linux/mmzone.h.html#913" title="(&amp;contig_page_data)" data-ref="_M/NODE_DATA">NODE_DATA</a>(node), <a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a>);</td></tr>
<tr><th id="5129">5129</th><td>		<a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a> += <a class="local col3 ref" href="#953nr_zones" title='nr_zones' data-ref="953nr_zones">nr_zones</a>;</td></tr>
<tr><th id="5130">5130</th><td>	}</td></tr>
<tr><th id="5131">5131</th><td>	<b>for</b> (<a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a> = <var>0</var>; <a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a> &lt; <a class="local col1 ref" href="#951local_node" title='local_node' data-ref="951local_node">local_node</a>; <a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a>++) {</td></tr>
<tr><th id="5132">5132</th><td>		<b>if</b> (!<a class="macro" href="../include/linux/nodemask.h.html#501" title="node_state((node), N_ONLINE)" data-ref="_M/node_online">node_online</a>(<a class="local col0 ref" href="#950node" title='node' data-ref="950node">node</a>))</td></tr>
<tr><th id="5133">5133</th><td>			<b>continue</b>;</td></tr>
<tr><th id="5134">5134</th><td>		<a class="local col3 ref" href="#953nr_zones" title='nr_zones' data-ref="953nr_zones">nr_zones</a> = <a class="tu ref fn" href="#build_zonerefs_node" title='build_zonerefs_node' data-use='c' data-ref="build_zonerefs_node">build_zonerefs_node</a>(<a class="macro" href="../include/linux/mmzone.h.html#913" title="(&amp;contig_page_data)" data-ref="_M/NODE_DATA">NODE_DATA</a>(node), <a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a>);</td></tr>
<tr><th id="5135">5135</th><td>		<a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a> += <a class="local col3 ref" href="#953nr_zones" title='nr_zones' data-ref="953nr_zones">nr_zones</a>;</td></tr>
<tr><th id="5136">5136</th><td>	}</td></tr>
<tr><th id="5137">5137</th><td></td></tr>
<tr><th id="5138">5138</th><td>	<a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone" title='zoneref::zone' data-ref="zoneref::zone">zone</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="5139">5139</th><td>	<a class="local col2 ref" href="#952zonerefs" title='zonerefs' data-ref="952zonerefs">zonerefs</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zoneref::zone_idx" title='zoneref::zone_idx' data-ref="zoneref::zone_idx">zone_idx</a> = <var>0</var>;</td></tr>
<tr><th id="5140">5140</th><td>}</td></tr>
<tr><th id="5141">5141</th><td></td></tr>
<tr><th id="5142">5142</th><td><u>#<span data-ppcond="4889">endif</span>	/* CONFIG_NUMA */</u></td></tr>
<tr><th id="5143">5143</th><td></td></tr>
<tr><th id="5144">5144</th><td><i  data-doc="setup_pageset">/*</i></td></tr>
<tr><th id="5145">5145</th><td><i  data-doc="setup_pageset"> * Boot pageset table. One per cpu which is going to be used for all</i></td></tr>
<tr><th id="5146">5146</th><td><i  data-doc="setup_pageset"> * zones and all nodes. The parameters will be set in such a way</i></td></tr>
<tr><th id="5147">5147</th><td><i  data-doc="setup_pageset"> * that an item put on a list will immediately be handed over to</i></td></tr>
<tr><th id="5148">5148</th><td><i  data-doc="setup_pageset"> * the buddy list. This is safe since pageset manipulation is done</i></td></tr>
<tr><th id="5149">5149</th><td><i  data-doc="setup_pageset"> * with interrupts disabled.</i></td></tr>
<tr><th id="5150">5150</th><td><i  data-doc="setup_pageset"> *</i></td></tr>
<tr><th id="5151">5151</th><td><i  data-doc="setup_pageset"> * The boot_pagesets must be kept even after bootup is complete for</i></td></tr>
<tr><th id="5152">5152</th><td><i  data-doc="setup_pageset"> * unused processors and/or zones. They do play a role for bootstrapping</i></td></tr>
<tr><th id="5153">5153</th><td><i  data-doc="setup_pageset"> * hotplugged processors.</i></td></tr>
<tr><th id="5154">5154</th><td><i  data-doc="setup_pageset"> *</i></td></tr>
<tr><th id="5155">5155</th><td><i  data-doc="setup_pageset"> * zoneinfo_show() and maybe other functions do</i></td></tr>
<tr><th id="5156">5156</th><td><i  data-doc="setup_pageset"> * not check if the processor is online before following the pageset pointer.</i></td></tr>
<tr><th id="5157">5157</th><td><i  data-doc="setup_pageset"> * Other parts of the kernel may not check if the zone is available.</i></td></tr>
<tr><th id="5158">5158</th><td><i  data-doc="setup_pageset"> */</i></td></tr>
<tr><th id="5159">5159</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#setup_pageset" title='setup_pageset' data-type='void setup_pageset(struct per_cpu_pageset * p, unsigned long batch)' data-ref="setup_pageset">setup_pageset</a>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col4 decl" id="954p" title='p' data-type='struct per_cpu_pageset *' data-ref="954p">p</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="955batch" title='batch' data-type='unsigned long' data-ref="955batch">batch</dfn>);</td></tr>
<tr><th id="5160">5160</th><td><em>static</em> <a class="macro" href="../include/linux/percpu-defs.h.html#115" title=" __attribute__((section(&quot;.data..percpu&quot; &quot;&quot;))) __typeof__(struct per_cpu_pageset) boot_pageset" data-ref="_M/DEFINE_PER_CPU">DEFINE_PER_CPU</a>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a>, <dfn class="tu decl def" id="boot_pageset" title='boot_pageset' data-type='typeof(struct per_cpu_pageset)' data-ref="boot_pageset">boot_pageset</dfn>);</td></tr>
<tr><th id="5161">5161</th><td><em>static</em> <a class="macro" href="../include/linux/percpu-defs.h.html#115" title=" __attribute__((section(&quot;.data..percpu&quot; &quot;&quot;))) __typeof__(struct per_cpu_nodestat) boot_nodestats" data-ref="_M/DEFINE_PER_CPU">DEFINE_PER_CPU</a>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_nodestat" title='per_cpu_nodestat' data-ref="per_cpu_nodestat">per_cpu_nodestat</a>, <dfn class="tu decl def" id="boot_nodestats" title='boot_nodestats' data-type='typeof(struct per_cpu_nodestat)' data-ref="boot_nodestats">boot_nodestats</dfn>);</td></tr>
<tr><th id="5162">5162</th><td></td></tr>
<tr><th id="5163">5163</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="__build_all_zonelists" title='__build_all_zonelists' data-type='void __build_all_zonelists(void * data)' data-ref="__build_all_zonelists">__build_all_zonelists</dfn>(<em>void</em> *<dfn class="local col6 decl" id="956data" title='data' data-type='void *' data-ref="956data">data</dfn>)</td></tr>
<tr><th id="5164">5164</th><td>{</td></tr>
<tr><th id="5165">5165</th><td>	<em>int</em> <dfn class="local col7 decl" id="957nid" title='nid' data-type='int' data-ref="957nid">nid</dfn>;</td></tr>
<tr><th id="5166">5166</th><td>	<em>int</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#147" title="__attribute__((unused))" data-ref="_M/__maybe_unused">__maybe_unused</a> <dfn class="local col8 decl" id="958cpu" title='cpu' data-type='int' data-ref="958cpu">cpu</dfn>;</td></tr>
<tr><th id="5167">5167</th><td>	<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col9 decl" id="959self" title='self' data-type='pg_data_t *' data-ref="959self">self</dfn> = <a class="local col6 ref" href="#956data" title='data' data-ref="956data">data</a>;</td></tr>
<tr><th id="5168">5168</th><td>	<em>static</em> <a class="macro" href="../include/linux/spinlock_types.h.html#84" title="spinlock_t lock = (spinlock_t ) { { .rlock = { .raw_lock = { { (0) } }, } } }" data-ref="_M/DEFINE_SPINLOCK">DEFINE_SPINLOCK</a>(<dfn class="local col0 decl" id="960lock" title='lock' data-type='spinlock_t' data-ref="960lock">lock</dfn>);</td></tr>
<tr><th id="5169">5169</th><td></td></tr>
<tr><th id="5170">5170</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="local col0 ref" href="#5168" title='lock' data-ref="960lock">lock</a>);</td></tr>
<tr><th id="5171">5171</th><td></td></tr>
<tr><th id="5172">5172</th><td><u>#<span data-ppcond="5172">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="5173">5173</th><td>	memset(node_load, <var>0</var>, <b>sizeof</b>(node_load));</td></tr>
<tr><th id="5174">5174</th><td><u>#<span data-ppcond="5172">endif</span></u></td></tr>
<tr><th id="5175">5175</th><td></td></tr>
<tr><th id="5176">5176</th><td>	<i>/*</i></td></tr>
<tr><th id="5177">5177</th><td><i>	 * This node is hotadded and no memory is yet present.   So just</i></td></tr>
<tr><th id="5178">5178</th><td><i>	 * building zonelists is fine - no need to touch other nodes.</i></td></tr>
<tr><th id="5179">5179</th><td><i>	 */</i></td></tr>
<tr><th id="5180">5180</th><td>	<b>if</b> (<a class="local col9 ref" href="#959self" title='self' data-ref="959self">self</a> &amp;&amp; !<a class="macro" href="../include/linux/nodemask.h.html#501" title="node_state((self-&gt;node_id), N_ONLINE)" data-ref="_M/node_online">node_online</a>(<a class="local col9 ref" href="#959self" title='self' data-ref="959self">self</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>)) {</td></tr>
<tr><th id="5181">5181</th><td>		<a class="tu ref fn" href="#build_zonelists" title='build_zonelists' data-use='c' data-ref="build_zonelists">build_zonelists</a>(<a class="local col9 ref" href="#959self" title='self' data-ref="959self">self</a>);</td></tr>
<tr><th id="5182">5182</th><td>	} <b>else</b> {</td></tr>
<tr><th id="5183">5183</th><td>		<a class="macro" href="../include/linux/nodemask.h.html#505" title="for ( (nid) = 0; (nid) == 0; (nid) = 1)" data-ref="_M/for_each_online_node">for_each_online_node</a>(<a class="local col7 ref" href="#957nid" title='nid' data-ref="957nid">nid</a>) {</td></tr>
<tr><th id="5184">5184</th><td>			<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col1 decl" id="961pgdat" title='pgdat' data-type='pg_data_t *' data-ref="961pgdat">pgdat</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#913" title="(&amp;contig_page_data)" data-ref="_M/NODE_DATA">NODE_DATA</a>(nid);</td></tr>
<tr><th id="5185">5185</th><td></td></tr>
<tr><th id="5186">5186</th><td>			<a class="tu ref fn" href="#build_zonelists" title='build_zonelists' data-use='c' data-ref="build_zonelists">build_zonelists</a>(<a class="local col1 ref" href="#961pgdat" title='pgdat' data-ref="961pgdat">pgdat</a>);</td></tr>
<tr><th id="5187">5187</th><td>		}</td></tr>
<tr><th id="5188">5188</th><td></td></tr>
<tr><th id="5189">5189</th><td><u>#<span data-ppcond="5189">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HAVE_MEMORYLESS_NODES">CONFIG_HAVE_MEMORYLESS_NODES</span></u></td></tr>
<tr><th id="5190">5190</th><td>		<i>/*</i></td></tr>
<tr><th id="5191">5191</th><td><i>		 * We now know the "local memory node" for each node--</i></td></tr>
<tr><th id="5192">5192</th><td><i>		 * i.e., the node of the first zone in the generic zonelist.</i></td></tr>
<tr><th id="5193">5193</th><td><i>		 * Set up numa_mem percpu variable for on-line cpus.  During</i></td></tr>
<tr><th id="5194">5194</th><td><i>		 * boot, only the boot cpu should be on-line;  we'll init the</i></td></tr>
<tr><th id="5195">5195</th><td><i>		 * secondary cpus' numa_mem as they come on-line.  During</i></td></tr>
<tr><th id="5196">5196</th><td><i>		 * node/memory hotplug, we'll fixup all on-line cpus.</i></td></tr>
<tr><th id="5197">5197</th><td><i>		 */</i></td></tr>
<tr><th id="5198">5198</th><td>		for_each_online_cpu(cpu)</td></tr>
<tr><th id="5199">5199</th><td>			set_cpu_numa_mem(cpu, local_memory_node(cpu_to_node(cpu)));</td></tr>
<tr><th id="5200">5200</th><td><u>#<span data-ppcond="5189">endif</span></u></td></tr>
<tr><th id="5201">5201</th><td>	}</td></tr>
<tr><th id="5202">5202</th><td></td></tr>
<tr><th id="5203">5203</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col0 ref" href="#5168" title='lock' data-ref="960lock">lock</a>);</td></tr>
<tr><th id="5204">5204</th><td>}</td></tr>
<tr><th id="5205">5205</th><td></td></tr>
<tr><th id="5206">5206</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#104" title="__attribute__((noinline))" data-ref="_M/noinline">noinline</a> <em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a></td></tr>
<tr><th id="5207">5207</th><td><dfn class="tu decl def fn" id="build_all_zonelists_init" title='build_all_zonelists_init' data-type='void build_all_zonelists_init()' data-ref="build_all_zonelists_init">build_all_zonelists_init</dfn>(<em>void</em>)</td></tr>
<tr><th id="5208">5208</th><td>{</td></tr>
<tr><th id="5209">5209</th><td>	<em>int</em> <dfn class="local col2 decl" id="962cpu" title='cpu' data-type='int' data-ref="962cpu">cpu</dfn>;</td></tr>
<tr><th id="5210">5210</th><td></td></tr>
<tr><th id="5211">5211</th><td>	<a class="tu ref fn" href="#__build_all_zonelists" title='__build_all_zonelists' data-use='c' data-ref="__build_all_zonelists">__build_all_zonelists</a>(<a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="5212">5212</th><td></td></tr>
<tr><th id="5213">5213</th><td>	<i>/*</i></td></tr>
<tr><th id="5214">5214</th><td><i>	 * Initialize the boot_pagesets that are going to be used</i></td></tr>
<tr><th id="5215">5215</th><td><i>	 * for bootstrapping processors. The real pagesets for</i></td></tr>
<tr><th id="5216">5216</th><td><i>	 * each zone will be allocated later when the per cpu</i></td></tr>
<tr><th id="5217">5217</th><td><i>	 * allocator is available.</i></td></tr>
<tr><th id="5218">5218</th><td><i>	 *</i></td></tr>
<tr><th id="5219">5219</th><td><i>	 * boot_pagesets are used also for bootstrapping offline</i></td></tr>
<tr><th id="5220">5220</th><td><i>	 * cpus if the system is already booted because the pagesets</i></td></tr>
<tr><th id="5221">5221</th><td><i>	 * are needed to initialize allocators on a specific cpu too.</i></td></tr>
<tr><th id="5222">5222</th><td><i>	 * F.e. the percpu allocator needs the page allocator which</i></td></tr>
<tr><th id="5223">5223</th><td><i>	 * needs the percpu allocator in order to allocate its pagesets</i></td></tr>
<tr><th id="5224">5224</th><td><i>	 * (a chicken-egg dilemma).</i></td></tr>
<tr><th id="5225">5225</th><td><i>	 */</i></td></tr>
<tr><th id="5226">5226</th><td>	<a class="macro" href="../include/linux/cpumask.h.html#749" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_possible_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_possible_cpu">for_each_possible_cpu</a>(<a class="local col2 ref" href="#962cpu" title='cpu' data-ref="962cpu">cpu</a>)</td></tr>
<tr><th id="5227">5227</th><td>		<a class="tu ref fn" href="#setup_pageset" title='setup_pageset' data-use='c' data-ref="setup_pageset">setup_pageset</a>(&amp;<a class="macro" href="../include/linux/percpu-defs.h.html#256" title="(*({ do { const void *__vpp_verify = (typeof((&amp;(boot_pageset)) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((&amp;(boot_pageset)))) *)((&amp;(boot_pageset))))); (typeof((typeof(*((&amp;(boot_pageset)))) *)((&amp;(boot_pageset))))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); }))" data-ref="_M/per_cpu">per_cpu</a>(<a class="tu ref" href="#5160" title='boot_pageset' data-use='a' data-ref="boot_pageset">boot_pageset</a>, <a class="local col2 ref" href="#962cpu" title='cpu' data-ref="962cpu">cpu</a>), <var>0</var>);</td></tr>
<tr><th id="5228">5228</th><td></td></tr>
<tr><th id="5229">5229</th><td>	<a class="ref fn" href="internal.h.html#mminit_verify_zonelist" title='mminit_verify_zonelist' data-ref="mminit_verify_zonelist">mminit_verify_zonelist</a>();</td></tr>
<tr><th id="5230">5230</th><td>	<a class="ref fn" href="../include/linux/cpuset.h.html#cpuset_init_current_mems_allowed" title='cpuset_init_current_mems_allowed' data-ref="cpuset_init_current_mems_allowed">cpuset_init_current_mems_allowed</a>();</td></tr>
<tr><th id="5231">5231</th><td>}</td></tr>
<tr><th id="5232">5232</th><td></td></tr>
<tr><th id="5233">5233</th><td><i>/*</i></td></tr>
<tr><th id="5234">5234</th><td><i> * unless system_state == SYSTEM_BOOTING.</i></td></tr>
<tr><th id="5235">5235</th><td><i> *</i></td></tr>
<tr><th id="5236">5236</th><td><i> * __ref due to call of __init annotated helper build_all_zonelists_init</i></td></tr>
<tr><th id="5237">5237</th><td><i> * [protected by SYSTEM_BOOTING].</i></td></tr>
<tr><th id="5238">5238</th><td><i> */</i></td></tr>
<tr><th id="5239">5239</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#73" title="__attribute__ ((__section__(&quot;.ref.text&quot;))) __attribute__((noinline))" data-ref="_M/__ref">__ref</a> <dfn class="decl def fn" id="build_all_zonelists" title='build_all_zonelists' data-ref="build_all_zonelists">build_all_zonelists</dfn>(<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col3 decl" id="963pgdat" title='pgdat' data-type='pg_data_t *' data-ref="963pgdat">pgdat</dfn>)</td></tr>
<tr><th id="5240">5240</th><td>{</td></tr>
<tr><th id="5241">5241</th><td>	<b>if</b> (<a class="ref" href="../include/linux/kernel.h.html#system_state" title='system_state' data-ref="system_state">system_state</a> == <a class="enum" href="../include/linux/kernel.h.html#SYSTEM_BOOTING" title='SYSTEM_BOOTING' data-ref="SYSTEM_BOOTING">SYSTEM_BOOTING</a>) {</td></tr>
<tr><th id="5242">5242</th><td>		<a class="tu ref fn" href="#build_all_zonelists_init" title='build_all_zonelists_init' data-use='c' data-ref="build_all_zonelists_init">build_all_zonelists_init</a>();</td></tr>
<tr><th id="5243">5243</th><td>	} <b>else</b> {</td></tr>
<tr><th id="5244">5244</th><td>		<a class="tu ref fn" href="#__build_all_zonelists" title='__build_all_zonelists' data-use='c' data-ref="__build_all_zonelists">__build_all_zonelists</a>(<a class="local col3 ref" href="#963pgdat" title='pgdat' data-ref="963pgdat">pgdat</a>);</td></tr>
<tr><th id="5245">5245</th><td>		<i>/* cpuset refresh routine should be here */</i></td></tr>
<tr><th id="5246">5246</th><td>	}</td></tr>
<tr><th id="5247">5247</th><td>	<a class="ref" href="../include/linux/swap.h.html#vm_total_pages" title='vm_total_pages' data-ref="vm_total_pages">vm_total_pages</a> = <a class="ref fn" href="#nr_free_pagecache_pages" title='nr_free_pagecache_pages' data-ref="nr_free_pagecache_pages">nr_free_pagecache_pages</a>();</td></tr>
<tr><th id="5248">5248</th><td>	<i>/*</i></td></tr>
<tr><th id="5249">5249</th><td><i>	 * Disable grouping by mobility if the number of pages in the</i></td></tr>
<tr><th id="5250">5250</th><td><i>	 * system is too low to allow the mechanism to work. It would be</i></td></tr>
<tr><th id="5251">5251</th><td><i>	 * more accurate, but expensive to check per-zone. This check is</i></td></tr>
<tr><th id="5252">5252</th><td><i>	 * made on memory-hotadd so a system can start with mobility</i></td></tr>
<tr><th id="5253">5253</th><td><i>	 * disabled and enable it later</i></td></tr>
<tr><th id="5254">5254</th><td><i>	 */</i></td></tr>
<tr><th id="5255">5255</th><td>	<b>if</b> (<a class="ref" href="../include/linux/swap.h.html#vm_total_pages" title='vm_total_pages' data-ref="vm_total_pages">vm_total_pages</a> &lt; (<a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a> * <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_TYPES" title='MIGRATE_TYPES' data-ref="MIGRATE_TYPES">MIGRATE_TYPES</a>))</td></tr>
<tr><th id="5256">5256</th><td>		<a class="ref" href="../include/linux/mmzone.h.html#page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</a> = <var>1</var>;</td></tr>
<tr><th id="5257">5257</th><td>	<b>else</b></td></tr>
<tr><th id="5258">5258</th><td>		<a class="ref" href="../include/linux/mmzone.h.html#page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</a> = <var>0</var>;</td></tr>
<tr><th id="5259">5259</th><td></td></tr>
<tr><th id="5260">5260</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Built %i zonelists, mobility grouping %s.  Total pages: %ld\n&quot;, 1, page_group_by_mobility_disabled ? &quot;off&quot; : &quot;on&quot;, vm_total_pages)" data-ref="_M/pr_info">pr_info</a>(<q>"Built %i zonelists, mobility grouping %s.  Total pages: %ld\n"</q>,</td></tr>
<tr><th id="5261">5261</th><td>		nr_online_nodes,</td></tr>
<tr><th id="5262">5262</th><td>		<a class="ref" href="../include/linux/mmzone.h.html#page_group_by_mobility_disabled" title='page_group_by_mobility_disabled' data-ref="page_group_by_mobility_disabled">page_group_by_mobility_disabled</a> ? <q>"off"</q> : <q>"on"</q>,</td></tr>
<tr><th id="5263">5263</th><td>		<a class="ref" href="../include/linux/swap.h.html#vm_total_pages" title='vm_total_pages' data-ref="vm_total_pages">vm_total_pages</a>);</td></tr>
<tr><th id="5264">5264</th><td><u>#<span data-ppcond="5264">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="5265">5265</th><td>	pr_info(<q>"Policy zone: %s\n"</q>, zone_names[policy_zone]);</td></tr>
<tr><th id="5266">5266</th><td><u>#<span data-ppcond="5264">endif</span></u></td></tr>
<tr><th id="5267">5267</th><td>}</td></tr>
<tr><th id="5268">5268</th><td></td></tr>
<tr><th id="5269">5269</th><td><i>/*</i></td></tr>
<tr><th id="5270">5270</th><td><i> * Initially all pages are reserved - free ones are freed</i></td></tr>
<tr><th id="5271">5271</th><td><i> * up by free_all_bootmem() once the early boot process is</i></td></tr>
<tr><th id="5272">5272</th><td><i> * done. Non-atomic initialization, single-pass.</i></td></tr>
<tr><th id="5273">5273</th><td><i> */</i></td></tr>
<tr><th id="5274">5274</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="memmap_init_zone" title='memmap_init_zone' data-ref="memmap_init_zone">memmap_init_zone</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="964size" title='size' data-type='unsigned long' data-ref="964size">size</dfn>, <em>int</em> <dfn class="local col5 decl" id="965nid" title='nid' data-type='int' data-ref="965nid">nid</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="966zone" title='zone' data-type='unsigned long' data-ref="966zone">zone</dfn>,</td></tr>
<tr><th id="5275">5275</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="967start_pfn" title='start_pfn' data-type='unsigned long' data-ref="967start_pfn">start_pfn</dfn>, <b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#memmap_context" title='memmap_context' data-ref="memmap_context">memmap_context</a> <dfn class="local col8 decl" id="968context" title='context' data-type='enum memmap_context' data-ref="968context">context</dfn>)</td></tr>
<tr><th id="5276">5276</th><td>{</td></tr>
<tr><th id="5277">5277</th><td>	<b>struct</b> <a class="type" href="../include/linux/memremap.h.html#vmem_altmap" title='vmem_altmap' data-ref="vmem_altmap">vmem_altmap</a> *<dfn class="local col9 decl" id="969altmap" title='altmap' data-type='struct vmem_altmap *' data-ref="969altmap">altmap</dfn> = <a class="ref fn" href="../include/linux/memremap.h.html#to_vmem_altmap" title='to_vmem_altmap' data-ref="to_vmem_altmap">to_vmem_altmap</a>(<a class="macro" href="../include/asm-generic/memory_model.h.html#79" title="((phys_addr_t)(start_pfn) &lt;&lt; 12)" data-ref="_M/__pfn_to_phys">__pfn_to_phys</a>(<a class="local col7 ref" href="#967start_pfn" title='start_pfn' data-ref="967start_pfn">start_pfn</a>));</td></tr>
<tr><th id="5278">5278</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="970end_pfn" title='end_pfn' data-type='unsigned long' data-ref="970end_pfn">end_pfn</dfn> = <a class="local col7 ref" href="#967start_pfn" title='start_pfn' data-ref="967start_pfn">start_pfn</a> + <a class="local col4 ref" href="#964size" title='size' data-ref="964size">size</a>;</td></tr>
<tr><th id="5279">5279</th><td>	<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col1 decl" id="971pgdat" title='pgdat' data-type='pg_data_t *' data-ref="971pgdat">pgdat</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#913" title="(&amp;contig_page_data)" data-ref="_M/NODE_DATA">NODE_DATA</a>(nid);</td></tr>
<tr><th id="5280">5280</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="972pfn" title='pfn' data-type='unsigned long' data-ref="972pfn">pfn</dfn>;</td></tr>
<tr><th id="5281">5281</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="973nr_initialised" title='nr_initialised' data-type='unsigned long' data-ref="973nr_initialised">nr_initialised</dfn> = <var>0</var>;</td></tr>
<tr><th id="5282">5282</th><td><u>#<span data-ppcond="5282">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a></u></td></tr>
<tr><th id="5283">5283</th><td>	<b>struct</b> <a class="type" href="../include/linux/memblock.h.html#memblock_region" title='memblock_region' data-ref="memblock_region">memblock_region</a> *<dfn class="local col4 decl" id="974r" title='r' data-type='struct memblock_region *' data-ref="974r">r</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, *<dfn class="local col5 decl" id="975tmp" title='tmp' data-type='struct memblock_region *' data-ref="975tmp">tmp</dfn>;</td></tr>
<tr><th id="5284">5284</th><td><u>#<span data-ppcond="5282">endif</span></u></td></tr>
<tr><th id="5285">5285</th><td></td></tr>
<tr><th id="5286">5286</th><td>	<b>if</b> (<a class="ref" href="internal.h.html#highest_memmap_pfn" title='highest_memmap_pfn' data-ref="highest_memmap_pfn">highest_memmap_pfn</a> &lt; <a class="local col0 ref" href="#970end_pfn" title='end_pfn' data-ref="970end_pfn">end_pfn</a> - <var>1</var>)</td></tr>
<tr><th id="5287">5287</th><td>		<a class="ref" href="internal.h.html#highest_memmap_pfn" title='highest_memmap_pfn' data-ref="highest_memmap_pfn">highest_memmap_pfn</a> = <a class="local col0 ref" href="#970end_pfn" title='end_pfn' data-ref="970end_pfn">end_pfn</a> - <var>1</var>;</td></tr>
<tr><th id="5288">5288</th><td></td></tr>
<tr><th id="5289">5289</th><td>	<i>/*</i></td></tr>
<tr><th id="5290">5290</th><td><i>	 * Honor reservation requested by the driver for this ZONE_DEVICE</i></td></tr>
<tr><th id="5291">5291</th><td><i>	 * memory</i></td></tr>
<tr><th id="5292">5292</th><td><i>	 */</i></td></tr>
<tr><th id="5293">5293</th><td>	<b>if</b> (<a class="local col9 ref" href="#969altmap" title='altmap' data-ref="969altmap">altmap</a> &amp;&amp; <a class="local col7 ref" href="#967start_pfn" title='start_pfn' data-ref="967start_pfn">start_pfn</a> == <a class="local col9 ref" href="#969altmap" title='altmap' data-ref="969altmap">altmap</a>-&gt;<a class="ref field" href="../include/linux/memremap.h.html#vmem_altmap::base_pfn" title='vmem_altmap::base_pfn' data-ref="vmem_altmap::base_pfn">base_pfn</a>)</td></tr>
<tr><th id="5294">5294</th><td>		<a class="local col7 ref" href="#967start_pfn" title='start_pfn' data-ref="967start_pfn">start_pfn</a> += <a class="local col9 ref" href="#969altmap" title='altmap' data-ref="969altmap">altmap</a>-&gt;<a class="ref field" href="../include/linux/memremap.h.html#vmem_altmap::reserve" title='vmem_altmap::reserve' data-ref="vmem_altmap::reserve">reserve</a>;</td></tr>
<tr><th id="5295">5295</th><td></td></tr>
<tr><th id="5296">5296</th><td>	<b>for</b> (<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> = <a class="local col7 ref" href="#967start_pfn" title='start_pfn' data-ref="967start_pfn">start_pfn</a>; <a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> &lt; <a class="local col0 ref" href="#970end_pfn" title='end_pfn' data-ref="970end_pfn">end_pfn</a>; <a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>++) {</td></tr>
<tr><th id="5297">5297</th><td>		<i>/*</i></td></tr>
<tr><th id="5298">5298</th><td><i>		 * There can be holes in boot-time mem_map[]s handed to this</i></td></tr>
<tr><th id="5299">5299</th><td><i>		 * function.  They do not exist on hotplugged memory.</i></td></tr>
<tr><th id="5300">5300</th><td><i>		 */</i></td></tr>
<tr><th id="5301">5301</th><td>		<b>if</b> (<a class="local col8 ref" href="#968context" title='context' data-ref="968context">context</a> != <a class="enum" href="../include/linux/mmzone.h.html#MEMMAP_EARLY" title='MEMMAP_EARLY' data-ref="MEMMAP_EARLY">MEMMAP_EARLY</a>)</td></tr>
<tr><th id="5302">5302</th><td>			<b>goto</b> <a class="lbl" href="#976not_early" data-ref="976not_early">not_early</a>;</td></tr>
<tr><th id="5303">5303</th><td></td></tr>
<tr><th id="5304">5304</th><td>		<b>if</b> (!<a class="macro" href="../include/linux/mmzone.h.html#1267" title="pfn_valid(pfn)" data-ref="_M/early_pfn_valid">early_pfn_valid</a>(<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>))</td></tr>
<tr><th id="5305">5305</th><td>			<b>continue</b>;</td></tr>
<tr><th id="5306">5306</th><td>		<b>if</b> (!<a class="tu ref fn" href="#early_pfn_in_nid" title='early_pfn_in_nid' data-use='c' data-ref="early_pfn_in_nid">early_pfn_in_nid</a>(<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>, <a class="local col5 ref" href="#965nid" title='nid' data-ref="965nid">nid</a>))</td></tr>
<tr><th id="5307">5307</th><td>			<b>continue</b>;</td></tr>
<tr><th id="5308">5308</th><td>		<b>if</b> (!<a class="tu ref fn" href="#update_defer_init" title='update_defer_init' data-use='c' data-ref="update_defer_init">update_defer_init</a>(<a class="local col1 ref" href="#971pgdat" title='pgdat' data-ref="971pgdat">pgdat</a>, <a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>, <a class="local col0 ref" href="#970end_pfn" title='end_pfn' data-ref="970end_pfn">end_pfn</a>, &amp;<a class="local col3 ref" href="#973nr_initialised" title='nr_initialised' data-ref="973nr_initialised">nr_initialised</a>))</td></tr>
<tr><th id="5309">5309</th><td>			<b>break</b>;</td></tr>
<tr><th id="5310">5310</th><td></td></tr>
<tr><th id="5311">5311</th><td><u>#<span data-ppcond="5311">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a></u></td></tr>
<tr><th id="5312">5312</th><td>		<i>/*</i></td></tr>
<tr><th id="5313">5313</th><td><i>		 * Check given memblock attribute by firmware which can affect</i></td></tr>
<tr><th id="5314">5314</th><td><i>		 * kernel memory layout.  If zone==ZONE_MOVABLE but memory is</i></td></tr>
<tr><th id="5315">5315</th><td><i>		 * mirrored, it's an overlapped memmap init. skip it.</i></td></tr>
<tr><th id="5316">5316</th><td><i>		 */</i></td></tr>
<tr><th id="5317">5317</th><td>		<b>if</b> (<a class="tu ref" href="#mirrored_kernelcore" title='mirrored_kernelcore' data-use='r' data-ref="mirrored_kernelcore">mirrored_kernelcore</a> &amp;&amp; <a class="local col6 ref" href="#966zone" title='zone' data-ref="966zone">zone</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a>) {</td></tr>
<tr><th id="5318">5318</th><td>			<b>if</b> (!<a class="local col4 ref" href="#974r" title='r' data-ref="974r">r</a> || <a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> &gt;= <a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_end_pfn" title='memblock_region_memory_end_pfn' data-ref="memblock_region_memory_end_pfn">memblock_region_memory_end_pfn</a>(<a class="local col4 ref" href="#974r" title='r' data-ref="974r">r</a>)) {</td></tr>
<tr><th id="5319">5319</th><td>				<a class="macro" href="../include/linux/memblock.h.html#386" title="for (tmp = memblock.memory.regions; tmp &lt; (memblock.memory.regions + memblock.memory.cnt); tmp++)" data-ref="_M/for_each_memblock">for_each_memblock</a>(<a class="ref field" href="../include/linux/memblock.h.html#memblock::memory" title='memblock::memory' data-ref="memblock::memory">memory</a>, <a class="local col5 ref" href="#975tmp" title='tmp' data-ref="975tmp">tmp</a>)</td></tr>
<tr><th id="5320">5320</th><td>					<b>if</b> (<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> &lt; <a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_end_pfn" title='memblock_region_memory_end_pfn' data-ref="memblock_region_memory_end_pfn">memblock_region_memory_end_pfn</a>(<a class="local col5 ref" href="#975tmp" title='tmp' data-ref="975tmp">tmp</a>))</td></tr>
<tr><th id="5321">5321</th><td>						<b>break</b>;</td></tr>
<tr><th id="5322">5322</th><td>				<a class="local col4 ref" href="#974r" title='r' data-ref="974r">r</a> = <a class="local col5 ref" href="#975tmp" title='tmp' data-ref="975tmp">tmp</a>;</td></tr>
<tr><th id="5323">5323</th><td>			}</td></tr>
<tr><th id="5324">5324</th><td>			<b>if</b> (<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> &gt;= <a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_base_pfn" title='memblock_region_memory_base_pfn' data-ref="memblock_region_memory_base_pfn">memblock_region_memory_base_pfn</a>(<a class="local col4 ref" href="#974r" title='r' data-ref="974r">r</a>) &amp;&amp;</td></tr>
<tr><th id="5325">5325</th><td>			    <a class="ref fn" href="../include/linux/memblock.h.html#memblock_is_mirror" title='memblock_is_mirror' data-ref="memblock_is_mirror">memblock_is_mirror</a>(<a class="local col4 ref" href="#974r" title='r' data-ref="974r">r</a>)) {</td></tr>
<tr><th id="5326">5326</th><td>				<i>/* already initialized as NORMAL */</i></td></tr>
<tr><th id="5327">5327</th><td>				<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> = <a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_end_pfn" title='memblock_region_memory_end_pfn' data-ref="memblock_region_memory_end_pfn">memblock_region_memory_end_pfn</a>(<a class="local col4 ref" href="#974r" title='r' data-ref="974r">r</a>);</td></tr>
<tr><th id="5328">5328</th><td>				<b>continue</b>;</td></tr>
<tr><th id="5329">5329</th><td>			}</td></tr>
<tr><th id="5330">5330</th><td>		}</td></tr>
<tr><th id="5331">5331</th><td><u>#<span data-ppcond="5311">endif</span></u></td></tr>
<tr><th id="5332">5332</th><td></td></tr>
<tr><th id="5333">5333</th><td><dfn class="lbl" id="976not_early" data-ref="976not_early">not_early</dfn>:</td></tr>
<tr><th id="5334">5334</th><td>		<i>/*</i></td></tr>
<tr><th id="5335">5335</th><td><i>		 * Mark the block movable so that blocks are reserved for</i></td></tr>
<tr><th id="5336">5336</th><td><i>		 * movable at startup. This will force kernel allocations</i></td></tr>
<tr><th id="5337">5337</th><td><i>		 * to reserve their blocks rather than leaking throughout</i></td></tr>
<tr><th id="5338">5338</th><td><i>		 * the address space during boot when many long-lived</i></td></tr>
<tr><th id="5339">5339</th><td><i>		 * kernel allocations are made.</i></td></tr>
<tr><th id="5340">5340</th><td><i>		 *</i></td></tr>
<tr><th id="5341">5341</th><td><i>		 * bitmap is created for zone's valid pfn range. but memmap</i></td></tr>
<tr><th id="5342">5342</th><td><i>		 * can be created for invalid pages (for alignment)</i></td></tr>
<tr><th id="5343">5343</th><td><i>		 * check here not to call set_pageblock_migratetype() against</i></td></tr>
<tr><th id="5344">5344</th><td><i>		 * pfn out of zone.</i></td></tr>
<tr><th id="5345">5345</th><td><i>		 */</i></td></tr>
<tr><th id="5346">5346</th><td>		<b>if</b> (!(<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a> &amp; (<a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a> - <var>1</var>))) {</td></tr>
<tr><th id="5347">5347</th><td>			<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col7 decl" id="977page" title='page' data-type='struct page *' data-ref="977page">page</dfn> = <a class="macro" href="../include/asm-generic/memory_model.h.html#82" title="__pfn_to_page" data-ref="_M/pfn_to_page">pfn_to_page</a>(<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>);</td></tr>
<tr><th id="5348">5348</th><td></td></tr>
<tr><th id="5349">5349</th><td>			<a class="tu ref fn" href="#__init_single_page" title='__init_single_page' data-use='c' data-ref="__init_single_page">__init_single_page</a>(<a class="local col7 ref" href="#977page" title='page' data-ref="977page">page</a>, <a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>, <a class="local col6 ref" href="#966zone" title='zone' data-ref="966zone">zone</a>, <a class="local col5 ref" href="#965nid" title='nid' data-ref="965nid">nid</a>);</td></tr>
<tr><th id="5350">5350</th><td>			<a class="ref fn" href="#set_pageblock_migratetype" title='set_pageblock_migratetype' data-ref="set_pageblock_migratetype">set_pageblock_migratetype</a>(<a class="local col7 ref" href="#977page" title='page' data-ref="977page">page</a>, <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a>);</td></tr>
<tr><th id="5351">5351</th><td>			<a class="macro" href="../include/linux/sched.h.html#1627" title="({ ___might_sleep(&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;, 5351, 0); _cond_resched(); })" data-ref="_M/cond_resched">cond_resched</a>();</td></tr>
<tr><th id="5352">5352</th><td>		} <b>else</b> {</td></tr>
<tr><th id="5353">5353</th><td>			<a class="tu ref fn" href="#__init_single_pfn" title='__init_single_pfn' data-use='c' data-ref="__init_single_pfn">__init_single_pfn</a>(<a class="local col2 ref" href="#972pfn" title='pfn' data-ref="972pfn">pfn</a>, <a class="local col6 ref" href="#966zone" title='zone' data-ref="966zone">zone</a>, <a class="local col5 ref" href="#965nid" title='nid' data-ref="965nid">nid</a>);</td></tr>
<tr><th id="5354">5354</th><td>		}</td></tr>
<tr><th id="5355">5355</th><td>	}</td></tr>
<tr><th id="5356">5356</th><td>}</td></tr>
<tr><th id="5357">5357</th><td></td></tr>
<tr><th id="5358">5358</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="zone_init_free_lists" title='zone_init_free_lists' data-type='void zone_init_free_lists(struct zone * zone)' data-ref="zone_init_free_lists">zone_init_free_lists</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col8 decl" id="978zone" title='zone' data-type='struct zone *' data-ref="978zone">zone</dfn>)</td></tr>
<tr><th id="5359">5359</th><td>{</td></tr>
<tr><th id="5360">5360</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="979order" title='order' data-type='unsigned int' data-ref="979order">order</dfn>, <dfn class="local col0 decl" id="980t" title='t' data-type='unsigned int' data-ref="980t">t</dfn>;</td></tr>
<tr><th id="5361">5361</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#83" title="for (order = 0; order &lt; 11; order++) for (t = 0; t &lt; MIGRATE_TYPES; t++)" data-ref="_M/for_each_migratetype_order">for_each_migratetype_order</a>(<a class="local col9 ref" href="#979order" title='order' data-ref="979order">order</a>, <a class="local col0 ref" href="#980t" title='t' data-ref="980t">t</a>) {</td></tr>
<tr><th id="5362">5362</th><td>		<a class="ref fn" href="../include/linux/list.h.html#INIT_LIST_HEAD" title='INIT_LIST_HEAD' data-ref="INIT_LIST_HEAD">INIT_LIST_HEAD</a>(&amp;<a class="local col8 ref" href="#978zone" title='zone' data-ref="978zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col9 ref" href="#979order" title='order' data-ref="979order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::free_list" title='free_area::free_list' data-ref="free_area::free_list">free_list</a>[<a class="local col0 ref" href="#980t" title='t' data-ref="980t">t</a>]);</td></tr>
<tr><th id="5363">5363</th><td>		<a class="local col8 ref" href="#978zone" title='zone' data-ref="978zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::free_area" title='zone::free_area' data-ref="zone::free_area">free_area</a>[<a class="local col9 ref" href="#979order" title='order' data-ref="979order">order</a>].<a class="ref field" href="../include/linux/mmzone.h.html#free_area::nr_free" title='free_area::nr_free' data-ref="free_area::nr_free">nr_free</a> = <var>0</var>;</td></tr>
<tr><th id="5364">5364</th><td>	}</td></tr>
<tr><th id="5365">5365</th><td>}</td></tr>
<tr><th id="5366">5366</th><td></td></tr>
<tr><th id="5367">5367</th><td><u>#<span data-ppcond="5367">ifndef</span> <span class="macro" data-ref="_M/__HAVE_ARCH_MEMMAP_INIT">__HAVE_ARCH_MEMMAP_INIT</span></u></td></tr>
<tr><th id="5368">5368</th><td><u>#define <dfn class="macro" id="_M/memmap_init" data-ref="_M/memmap_init">memmap_init</dfn>(size, nid, zone, start_pfn) \</u></td></tr>
<tr><th id="5369">5369</th><td><u>	<a class="ref fn" href="#memmap_init_zone" title='memmap_init_zone' data-ref="memmap_init_zone">memmap_init_zone</a>((size), (nid), (zone), (start_pfn), <a class="enum" href="../include/linux/mmzone.h.html#MEMMAP_EARLY" title='MEMMAP_EARLY' data-ref="MEMMAP_EARLY">MEMMAP_EARLY</a>)</u></td></tr>
<tr><th id="5370">5370</th><td><u>#<span data-ppcond="5367">endif</span></u></td></tr>
<tr><th id="5371">5371</th><td></td></tr>
<tr><th id="5372">5372</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="zone_batchsize" title='zone_batchsize' data-type='int zone_batchsize(struct zone * zone)' data-ref="zone_batchsize">zone_batchsize</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="981zone" title='zone' data-type='struct zone *' data-ref="981zone">zone</dfn>)</td></tr>
<tr><th id="5373">5373</th><td>{</td></tr>
<tr><th id="5374">5374</th><td><u>#<span data-ppcond="5374">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#1307" data-ref="_M/CONFIG_MMU">CONFIG_MMU</a></u></td></tr>
<tr><th id="5375">5375</th><td>	<em>int</em> <dfn class="local col2 decl" id="982batch" title='batch' data-type='int' data-ref="982batch">batch</dfn>;</td></tr>
<tr><th id="5376">5376</th><td></td></tr>
<tr><th id="5377">5377</th><td>	<i>/*</i></td></tr>
<tr><th id="5378">5378</th><td><i>	 * The per-cpu-pages pools are set to around 1000th of the</i></td></tr>
<tr><th id="5379">5379</th><td><i>	 * size of the zone.  But no more than 1/2 of a meg.</i></td></tr>
<tr><th id="5380">5380</th><td><i>	 *</i></td></tr>
<tr><th id="5381">5381</th><td><i>	 * OK, so we don't know how big the cache is.  So guess.</i></td></tr>
<tr><th id="5382">5382</th><td><i>	 */</i></td></tr>
<tr><th id="5383">5383</th><td>	<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> = <a class="local col1 ref" href="#981zone" title='zone' data-ref="981zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> / <var>1024</var>;</td></tr>
<tr><th id="5384">5384</th><td>	<b>if</b> (<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> * <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &gt; <var>512</var> * <var>1024</var>)</td></tr>
<tr><th id="5385">5385</th><td>		<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> = (<var>512</var> * <var>1024</var>) / <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>;</td></tr>
<tr><th id="5386">5386</th><td>	<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> /= <var>4</var>;		<i>/* We effectively *= 4 below */</i></td></tr>
<tr><th id="5387">5387</th><td>	<b>if</b> (<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> &lt; <var>1</var>)</td></tr>
<tr><th id="5388">5388</th><td>		<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> = <var>1</var>;</td></tr>
<tr><th id="5389">5389</th><td></td></tr>
<tr><th id="5390">5390</th><td>	<i>/*</i></td></tr>
<tr><th id="5391">5391</th><td><i>	 * Clamp the batch to a 2^n - 1 value. Having a power</i></td></tr>
<tr><th id="5392">5392</th><td><i>	 * of 2 value was found to be more likely to have</i></td></tr>
<tr><th id="5393">5393</th><td><i>	 * suboptimal cache aliasing properties in some cases.</i></td></tr>
<tr><th id="5394">5394</th><td><i>	 *</i></td></tr>
<tr><th id="5395">5395</th><td><i>	 * For example if 2 tasks are alternately allocating</i></td></tr>
<tr><th id="5396">5396</th><td><i>	 * batches of pages, one task can end up with a lot</i></td></tr>
<tr><th id="5397">5397</th><td><i>	 * of pages of one half of the possible page colors</i></td></tr>
<tr><th id="5398">5398</th><td><i>	 * and the other with pages of the other colors.</i></td></tr>
<tr><th id="5399">5399</th><td><i>	 */</i></td></tr>
<tr><th id="5400">5400</th><td>	<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> = <a class="macro" href="../include/linux/log2.h.html#176" title="( __builtin_constant_p(batch + batch/2) ? ( (1UL &lt;&lt; ( __builtin_constant_p(batch + batch/2) ? ( (batch + batch/2) &lt; 2 ? 0 : (batch + batch/2) &amp; (1ULL &lt;&lt; 63) ? 63 : (batch + batch/2) &amp; (1ULL &lt;&lt; 62) ? 62 : (batch + batch/2) &amp; (1ULL &lt;&lt; 61) ? 61 : (batch + batch/2) &amp; (1ULL &lt;&lt; 60) ? 60 : (batch + batch/2) &amp; (1ULL &lt;&lt; 59) ? 59 : (batch + batch/2) &amp; (1ULL &lt;&lt; 58) ? 58 : (batch + batch/2) &amp; (1ULL &lt;&lt; 57) ? 57 : (batch + batch/2) &amp; (1ULL &lt;&lt; 56) ? 56 : (batch + batch/2) &amp; (1ULL &lt;&lt; 55) ? 55 : (batch + batch/2) &amp; (1ULL &lt;&lt; 54) ? 54 : (batch + batch/2) &amp; (1ULL &lt;&lt; 53) ? 53 : (batch + batch/2) &amp; (1ULL &lt;&lt; 52) ? 52 : (batch + batch/2) &amp; (1ULL &lt;&lt; 51) ? 51 : (batch + batch/2) &amp; (1ULL &lt;&lt; 50) ? 50 : (batch + batch/2) &amp; (1ULL &lt;&lt; 49) ? 49 : (batch + batch/2) &amp; (1ULL &lt;&lt; 48) ? 48 : (batch + batch/2) &amp; (1ULL &lt;&lt; 47) ? 47 : (batch + batch/2) &amp; (1ULL &lt;&lt; 46) ? 46 : (batch + batch/2) &amp; (1ULL &lt;&lt; 45) ? 45 : (batch + batch/2) &amp; (1ULL &lt;&lt; 44) ? 44 : (batch + batch/2) &amp; (1ULL &lt;&lt; 43) ? 43 : (batch + batch/2) &amp; (1ULL &lt;&lt; 42) ? 42 : (batch + batch/2) &amp; (1ULL &lt;&lt; 41) ? 41 : (batch + batch/2) &amp; (1ULL &lt;&lt; 40) ? 40 : (batch + batch/2) &amp; (1ULL &lt;&lt; 39) ? 39 : (batch + batch/2) &amp; (1ULL &lt;&lt; 38) ? 38 : (batch + batch/2) &amp; (1ULL &lt;&lt; 37) ? 37 : (batch + batch/2) &amp; (1ULL &lt;&lt; 36) ? 36 : (batch + batch/2) &amp; (1ULL &lt;&lt; 35) ? 35 : (batch + batch/2) &amp; (1ULL &lt;&lt; 34) ? 34 : (batch + batch/2) &amp; (1ULL &lt;&lt; 33) ? 33 : (batch + batch/2) &amp; (1ULL &lt;&lt; 32) ? 32 : (batch + batch/2) &amp; (1ULL &lt;&lt; 31) ? 31 : (batch + batch/2) &amp; (1ULL &lt;&lt; 30) ? 30 : (batch + batch/2) &amp; (1ULL &lt;&lt; 29) ? 29 : (batch + batch/2) &amp; (1ULL &lt;&lt; 28) ? 28 : (batch + batch/2) &amp; (1ULL &lt;&lt; 27) ? 27 : (batch + batch/2) &amp; (1ULL &lt;&lt; 26) ? 26 : (batch + batch/2) &amp; (1ULL &lt;&lt; 25) ? 25 : (batch + batch/2) &amp; (1ULL &lt;&lt; 24) ? 24 : (batch + batch/2) &amp; (1ULL &lt;&lt; 23) ? 23 : (batch + batch/2) &amp; (1ULL &lt;&lt; 22) ? 22 : (batch + batch/2) &amp; (1ULL &lt;&lt; 21) ? 21 : (batch + batch/2) &amp; (1ULL &lt;&lt; 20) ? 20 : (batch + batch/2) &amp; (1ULL &lt;&lt; 19) ? 19 : (batch + batch/2) &amp; (1ULL &lt;&lt; 18) ? 18 : (batch + batch/2) &amp; (1ULL &lt;&lt; 17) ? 17 : (batch + batch/2) &amp; (1ULL &lt;&lt; 16) ? 16 : (batch + batch/2) &amp; (1ULL &lt;&lt; 15) ? 15 : (batch + batch/2) &amp; (1ULL &lt;&lt; 14) ? 14 : (batch + batch/2) &amp; (1ULL &lt;&lt; 13) ? 13 : (batch + batch/2) &amp; (1ULL &lt;&lt; 12) ? 12 : (batch + batch/2) &amp; (1ULL &lt;&lt; 11) ? 11 : (batch + batch/2) &amp; (1ULL &lt;&lt; 10) ? 10 : (batch + batch/2) &amp; (1ULL &lt;&lt; 9) ? 9 : (batch + batch/2) &amp; (1ULL &lt;&lt; 8) ? 8 : (batch + batch/2) &amp; (1ULL &lt;&lt; 7) ? 7 : (batch + batch/2) &amp; (1ULL &lt;&lt; 6) ? 6 : (batch + batch/2) &amp; (1ULL &lt;&lt; 5) ? 5 : (batch + batch/2) &amp; (1ULL &lt;&lt; 4) ? 4 : (batch + batch/2) &amp; (1ULL &lt;&lt; 3) ? 3 : (batch + batch/2) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof(batch + batch/2) &lt;= 4) ? __ilog2_u32(batch + batch/2) : __ilog2_u64(batch + batch/2) ))) : __rounddown_pow_of_two(batch + batch/2) )" data-ref="_M/rounddown_pow_of_two">rounddown_pow_of_two</a>(<a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a> + <a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a>/<var>2</var>) - <var>1</var>;</td></tr>
<tr><th id="5401">5401</th><td></td></tr>
<tr><th id="5402">5402</th><td>	<b>return</b> <a class="local col2 ref" href="#982batch" title='batch' data-ref="982batch">batch</a>;</td></tr>
<tr><th id="5403">5403</th><td></td></tr>
<tr><th id="5404">5404</th><td><u>#<span data-ppcond="5374">else</span></u></td></tr>
<tr><th id="5405">5405</th><td>	<i>/* The deferral and batching of frees should be suppressed under NOMMU</i></td></tr>
<tr><th id="5406">5406</th><td><i>	 * conditions.</i></td></tr>
<tr><th id="5407">5407</th><td><i>	 *</i></td></tr>
<tr><th id="5408">5408</th><td><i>	 * The problem is that NOMMU needs to be able to allocate large chunks</i></td></tr>
<tr><th id="5409">5409</th><td><i>	 * of contiguous memory as there's no hardware page translation to</i></td></tr>
<tr><th id="5410">5410</th><td><i>	 * assemble apparent contiguous memory from discontiguous pages.</i></td></tr>
<tr><th id="5411">5411</th><td><i>	 *</i></td></tr>
<tr><th id="5412">5412</th><td><i>	 * Queueing large contiguous runs of pages for batching, however,</i></td></tr>
<tr><th id="5413">5413</th><td><i>	 * causes the pages to actually be freed in smaller chunks.  As there</i></td></tr>
<tr><th id="5414">5414</th><td><i>	 * can be a significant delay between the individual batches being</i></td></tr>
<tr><th id="5415">5415</th><td><i>	 * recycled, this leads to the once large chunks of space being</i></td></tr>
<tr><th id="5416">5416</th><td><i>	 * fragmented and becoming unavailable for high-order allocations.</i></td></tr>
<tr><th id="5417">5417</th><td><i>	 */</i></td></tr>
<tr><th id="5418">5418</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5419">5419</th><td><u>#<span data-ppcond="5374">endif</span></u></td></tr>
<tr><th id="5420">5420</th><td>}</td></tr>
<tr><th id="5421">5421</th><td></td></tr>
<tr><th id="5422">5422</th><td><i  data-doc="pageset_update">/*</i></td></tr>
<tr><th id="5423">5423</th><td><i  data-doc="pageset_update"> * pcp-&gt;high and pcp-&gt;batch values are related and dependent on one another:</i></td></tr>
<tr><th id="5424">5424</th><td><i  data-doc="pageset_update"> * -&gt;batch must never be higher then -&gt;high.</i></td></tr>
<tr><th id="5425">5425</th><td><i  data-doc="pageset_update"> * The following function updates them in a safe manner without read side</i></td></tr>
<tr><th id="5426">5426</th><td><i  data-doc="pageset_update"> * locking.</i></td></tr>
<tr><th id="5427">5427</th><td><i  data-doc="pageset_update"> *</i></td></tr>
<tr><th id="5428">5428</th><td><i  data-doc="pageset_update"> * Any new users of pcp-&gt;batch and pcp-&gt;high should ensure they can cope with</i></td></tr>
<tr><th id="5429">5429</th><td><i  data-doc="pageset_update"> * those fields changing asynchronously (acording the the above rule).</i></td></tr>
<tr><th id="5430">5430</th><td><i  data-doc="pageset_update"> *</i></td></tr>
<tr><th id="5431">5431</th><td><i  data-doc="pageset_update"> * mutex_is_locked(&amp;pcp_batch_high_lock) required when calling this function</i></td></tr>
<tr><th id="5432">5432</th><td><i  data-doc="pageset_update"> * outside of boot time (or some other assurance that no concurrent updaters</i></td></tr>
<tr><th id="5433">5433</th><td><i  data-doc="pageset_update"> * exist).</i></td></tr>
<tr><th id="5434">5434</th><td><i  data-doc="pageset_update"> */</i></td></tr>
<tr><th id="5435">5435</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="pageset_update" title='pageset_update' data-type='void pageset_update(struct per_cpu_pages * pcp, unsigned long high, unsigned long batch)' data-ref="pageset_update">pageset_update</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col3 decl" id="983pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="983pcp">pcp</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="984high" title='high' data-type='unsigned long' data-ref="984high">high</dfn>,</td></tr>
<tr><th id="5436">5436</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="985batch" title='batch' data-type='unsigned long' data-ref="985batch">batch</dfn>)</td></tr>
<tr><th id="5437">5437</th><td>{</td></tr>
<tr><th id="5438">5438</th><td>       <i>/* start with a fail safe value for batch */</i></td></tr>
<tr><th id="5439">5439</th><td>	<a class="local col3 ref" href="#983pcp" title='pcp' data-ref="983pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::batch" title='per_cpu_pages::batch' data-ref="per_cpu_pages::batch">batch</a> = <var>1</var>;</td></tr>
<tr><th id="5440">5440</th><td>	<a class="macro" href="../include/asm-generic/barrier.h.html#84" title="__asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;)" data-ref="_M/smp_wmb">smp_wmb</a>();</td></tr>
<tr><th id="5441">5441</th><td></td></tr>
<tr><th id="5442">5442</th><td>       <i>/* Update high, then batch, in order */</i></td></tr>
<tr><th id="5443">5443</th><td>	<a class="local col3 ref" href="#983pcp" title='pcp' data-ref="983pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::high" title='per_cpu_pages::high' data-ref="per_cpu_pages::high">high</a> = <a class="local col4 ref" href="#984high" title='high' data-ref="984high">high</a>;</td></tr>
<tr><th id="5444">5444</th><td>	<a class="macro" href="../include/asm-generic/barrier.h.html#84" title="__asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;)" data-ref="_M/smp_wmb">smp_wmb</a>();</td></tr>
<tr><th id="5445">5445</th><td></td></tr>
<tr><th id="5446">5446</th><td>	<a class="local col3 ref" href="#983pcp" title='pcp' data-ref="983pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::batch" title='per_cpu_pages::batch' data-ref="per_cpu_pages::batch">batch</a> = <a class="local col5 ref" href="#985batch" title='batch' data-ref="985batch">batch</a>;</td></tr>
<tr><th id="5447">5447</th><td>}</td></tr>
<tr><th id="5448">5448</th><td></td></tr>
<tr><th id="5449">5449</th><td><i  data-doc="pageset_set_batch">/* a companion to pageset_set_high() */</i></td></tr>
<tr><th id="5450">5450</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="pageset_set_batch" title='pageset_set_batch' data-type='void pageset_set_batch(struct per_cpu_pageset * p, unsigned long batch)' data-ref="pageset_set_batch">pageset_set_batch</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col6 decl" id="986p" title='p' data-type='struct per_cpu_pageset *' data-ref="986p">p</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="987batch" title='batch' data-type='unsigned long' data-ref="987batch">batch</dfn>)</td></tr>
<tr><th id="5451">5451</th><td>{</td></tr>
<tr><th id="5452">5452</th><td>	<a class="tu ref fn" href="#pageset_update" title='pageset_update' data-use='c' data-ref="pageset_update">pageset_update</a>(&amp;<a class="local col6 ref" href="#986p" title='p' data-ref="986p">p</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>, <var>6</var> * <a class="local col7 ref" href="#987batch" title='batch' data-ref="987batch">batch</a>, <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(1UL) __UNIQUE_ID_max1_187 = (1UL); typeof(1 * batch) __UNIQUE_ID_max2_188 = (1 * batch); (void) (&amp;__UNIQUE_ID_max1_187 == &amp;__UNIQUE_ID_max2_188); __UNIQUE_ID_max1_187 &gt; __UNIQUE_ID_max2_188 ? __UNIQUE_ID_max1_187 : __UNIQUE_ID_max2_188; })" data-ref="_M/max">max</a>(<var>1UL</var>, <var>1</var> * <a class="local col7 ref" href="#987batch" title='batch' data-ref="987batch">batch</a>));</td></tr>
<tr><th id="5453">5453</th><td>}</td></tr>
<tr><th id="5454">5454</th><td></td></tr>
<tr><th id="5455">5455</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="pageset_init" title='pageset_init' data-type='void pageset_init(struct per_cpu_pageset * p)' data-ref="pageset_init">pageset_init</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col8 decl" id="988p" title='p' data-type='struct per_cpu_pageset *' data-ref="988p">p</dfn>)</td></tr>
<tr><th id="5456">5456</th><td>{</td></tr>
<tr><th id="5457">5457</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pages" title='per_cpu_pages' data-ref="per_cpu_pages">per_cpu_pages</a> *<dfn class="local col9 decl" id="989pcp" title='pcp' data-type='struct per_cpu_pages *' data-ref="989pcp">pcp</dfn>;</td></tr>
<tr><th id="5458">5458</th><td>	<em>int</em> <dfn class="local col0 decl" id="990migratetype" title='migratetype' data-type='int' data-ref="990migratetype">migratetype</dfn>;</td></tr>
<tr><th id="5459">5459</th><td></td></tr>
<tr><th id="5460">5460</th><td>	<a class="ref fn" href="../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col8 ref" href="#988p" title='p' data-ref="988p">p</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col8 ref" href="#988p" title='p' data-ref="988p">p</a>));</td></tr>
<tr><th id="5461">5461</th><td></td></tr>
<tr><th id="5462">5462</th><td>	<a class="local col9 ref" href="#989pcp" title='pcp' data-ref="989pcp">pcp</a> = &amp;<a class="local col8 ref" href="#988p" title='p' data-ref="988p">p</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>;</td></tr>
<tr><th id="5463">5463</th><td>	<a class="local col9 ref" href="#989pcp" title='pcp' data-ref="989pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::count" title='per_cpu_pages::count' data-ref="per_cpu_pages::count">count</a> = <var>0</var>;</td></tr>
<tr><th id="5464">5464</th><td>	<b>for</b> (<a class="local col0 ref" href="#990migratetype" title='migratetype' data-ref="990migratetype">migratetype</a> = <var>0</var>; <a class="local col0 ref" href="#990migratetype" title='migratetype' data-ref="990migratetype">migratetype</a> &lt; <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_PCPTYPES" title='MIGRATE_PCPTYPES' data-ref="MIGRATE_PCPTYPES">MIGRATE_PCPTYPES</a>; <a class="local col0 ref" href="#990migratetype" title='migratetype' data-ref="990migratetype">migratetype</a>++)</td></tr>
<tr><th id="5465">5465</th><td>		<a class="ref fn" href="../include/linux/list.h.html#INIT_LIST_HEAD" title='INIT_LIST_HEAD' data-ref="INIT_LIST_HEAD">INIT_LIST_HEAD</a>(&amp;<a class="local col9 ref" href="#989pcp" title='pcp' data-ref="989pcp">pcp</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pages::lists" title='per_cpu_pages::lists' data-ref="per_cpu_pages::lists">lists</a>[<a class="local col0 ref" href="#990migratetype" title='migratetype' data-ref="990migratetype">migratetype</a>]);</td></tr>
<tr><th id="5466">5466</th><td>}</td></tr>
<tr><th id="5467">5467</th><td></td></tr>
<tr><th id="5468">5468</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="setup_pageset" title='setup_pageset' data-type='void setup_pageset(struct per_cpu_pageset * p, unsigned long batch)' data-ref="setup_pageset">setup_pageset</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col1 decl" id="991p" title='p' data-type='struct per_cpu_pageset *' data-ref="991p">p</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="992batch" title='batch' data-type='unsigned long' data-ref="992batch">batch</dfn>)</td></tr>
<tr><th id="5469">5469</th><td>{</td></tr>
<tr><th id="5470">5470</th><td>	<a class="tu ref fn" href="#pageset_init" title='pageset_init' data-use='c' data-ref="pageset_init">pageset_init</a>(<a class="local col1 ref" href="#991p" title='p' data-ref="991p">p</a>);</td></tr>
<tr><th id="5471">5471</th><td>	<a class="tu ref fn" href="#pageset_set_batch" title='pageset_set_batch' data-use='c' data-ref="pageset_set_batch">pageset_set_batch</a>(<a class="local col1 ref" href="#991p" title='p' data-ref="991p">p</a>, <a class="local col2 ref" href="#992batch" title='batch' data-ref="992batch">batch</a>);</td></tr>
<tr><th id="5472">5472</th><td>}</td></tr>
<tr><th id="5473">5473</th><td></td></tr>
<tr><th id="5474">5474</th><td><i  data-doc="pageset_set_high">/*</i></td></tr>
<tr><th id="5475">5475</th><td><i  data-doc="pageset_set_high"> * pageset_set_high() sets the high water mark for hot per_cpu_pagelist</i></td></tr>
<tr><th id="5476">5476</th><td><i  data-doc="pageset_set_high"> * to the value high for the pageset p.</i></td></tr>
<tr><th id="5477">5477</th><td><i  data-doc="pageset_set_high"> */</i></td></tr>
<tr><th id="5478">5478</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="pageset_set_high" title='pageset_set_high' data-type='void pageset_set_high(struct per_cpu_pageset * p, unsigned long high)' data-ref="pageset_set_high">pageset_set_high</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col3 decl" id="993p" title='p' data-type='struct per_cpu_pageset *' data-ref="993p">p</dfn>,</td></tr>
<tr><th id="5479">5479</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="994high" title='high' data-type='unsigned long' data-ref="994high">high</dfn>)</td></tr>
<tr><th id="5480">5480</th><td>{</td></tr>
<tr><th id="5481">5481</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="995batch" title='batch' data-type='unsigned long' data-ref="995batch">batch</dfn> = <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(1UL) __UNIQUE_ID_max1_191 = (1UL); typeof(high / 4) __UNIQUE_ID_max2_192 = (high / 4); (void) (&amp;__UNIQUE_ID_max1_191 == &amp;__UNIQUE_ID_max2_192); __UNIQUE_ID_max1_191 &gt; __UNIQUE_ID_max2_192 ? __UNIQUE_ID_max1_191 : __UNIQUE_ID_max2_192; })" data-ref="_M/max">max</a>(<var>1UL</var>, <a class="local col4 ref" href="#994high" title='high' data-ref="994high">high</a> / <var>4</var>);</td></tr>
<tr><th id="5482">5482</th><td>	<b>if</b> ((<a class="local col4 ref" href="#994high" title='high' data-ref="994high">high</a> / <var>4</var>) &gt; (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a> * <var>8</var>))</td></tr>
<tr><th id="5483">5483</th><td>		<a class="local col5 ref" href="#995batch" title='batch' data-ref="995batch">batch</a> = <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a> * <var>8</var>;</td></tr>
<tr><th id="5484">5484</th><td></td></tr>
<tr><th id="5485">5485</th><td>	<a class="tu ref fn" href="#pageset_update" title='pageset_update' data-use='c' data-ref="pageset_update">pageset_update</a>(&amp;<a class="local col3 ref" href="#993p" title='p' data-ref="993p">p</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#per_cpu_pageset::pcp" title='per_cpu_pageset::pcp' data-ref="per_cpu_pageset::pcp">pcp</a>, <a class="local col4 ref" href="#994high" title='high' data-ref="994high">high</a>, <a class="local col5 ref" href="#995batch" title='batch' data-ref="995batch">batch</a>);</td></tr>
<tr><th id="5486">5486</th><td>}</td></tr>
<tr><th id="5487">5487</th><td></td></tr>
<tr><th id="5488">5488</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="pageset_set_high_and_batch" title='pageset_set_high_and_batch' data-type='void pageset_set_high_and_batch(struct zone * zone, struct per_cpu_pageset * pcp)' data-ref="pageset_set_high_and_batch">pageset_set_high_and_batch</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="996zone" title='zone' data-type='struct zone *' data-ref="996zone">zone</dfn>,</td></tr>
<tr><th id="5489">5489</th><td>				       <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col7 decl" id="997pcp" title='pcp' data-type='struct per_cpu_pageset *' data-ref="997pcp">pcp</dfn>)</td></tr>
<tr><th id="5490">5490</th><td>{</td></tr>
<tr><th id="5491">5491</th><td>	<b>if</b> (<a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a>)</td></tr>
<tr><th id="5492">5492</th><td>		<a class="tu ref fn" href="#pageset_set_high" title='pageset_set_high' data-use='c' data-ref="pageset_set_high">pageset_set_high</a>(<a class="local col7 ref" href="#997pcp" title='pcp' data-ref="997pcp">pcp</a>,</td></tr>
<tr><th id="5493">5493</th><td>			(<a class="local col6 ref" href="#996zone" title='zone' data-ref="996zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> /</td></tr>
<tr><th id="5494">5494</th><td>				<a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a>));</td></tr>
<tr><th id="5495">5495</th><td>	<b>else</b></td></tr>
<tr><th id="5496">5496</th><td>		<a class="tu ref fn" href="#pageset_set_batch" title='pageset_set_batch' data-use='c' data-ref="pageset_set_batch">pageset_set_batch</a>(<a class="local col7 ref" href="#997pcp" title='pcp' data-ref="997pcp">pcp</a>, <a class="tu ref fn" href="#zone_batchsize" title='zone_batchsize' data-use='c' data-ref="zone_batchsize">zone_batchsize</a>(<a class="local col6 ref" href="#996zone" title='zone' data-ref="996zone">zone</a>));</td></tr>
<tr><th id="5497">5497</th><td>}</td></tr>
<tr><th id="5498">5498</th><td></td></tr>
<tr><th id="5499">5499</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="zone_pageset_init" title='zone_pageset_init' data-type='void zone_pageset_init(struct zone * zone, int cpu)' data-ref="zone_pageset_init">zone_pageset_init</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col8 decl" id="998zone" title='zone' data-type='struct zone *' data-ref="998zone">zone</dfn>, <em>int</em> <dfn class="local col9 decl" id="999cpu" title='cpu' data-type='int' data-ref="999cpu">cpu</dfn>)</td></tr>
<tr><th id="5500">5500</th><td>{</td></tr>
<tr><th id="5501">5501</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col0 decl" id="1000pcp" title='pcp' data-type='struct per_cpu_pageset *' data-ref="1000pcp">pcp</dfn> = <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col8 ref" href="#998zone" title='zone' data-ref="998zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col9 ref" href="#999cpu" title='cpu' data-ref="999cpu">cpu</a>);</td></tr>
<tr><th id="5502">5502</th><td></td></tr>
<tr><th id="5503">5503</th><td>	<a class="tu ref fn" href="#pageset_init" title='pageset_init' data-use='c' data-ref="pageset_init">pageset_init</a>(<a class="local col0 ref" href="#1000pcp" title='pcp' data-ref="1000pcp">pcp</a>);</td></tr>
<tr><th id="5504">5504</th><td>	<a class="tu ref fn" href="#pageset_set_high_and_batch" title='pageset_set_high_and_batch' data-use='c' data-ref="pageset_set_high_and_batch">pageset_set_high_and_batch</a>(<a class="local col8 ref" href="#998zone" title='zone' data-ref="998zone">zone</a>, <a class="local col0 ref" href="#1000pcp" title='pcp' data-ref="1000pcp">pcp</a>);</td></tr>
<tr><th id="5505">5505</th><td>}</td></tr>
<tr><th id="5506">5506</th><td></td></tr>
<tr><th id="5507">5507</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="setup_zone_pageset" title='setup_zone_pageset' data-ref="setup_zone_pageset">setup_zone_pageset</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="1001zone" title='zone' data-type='struct zone *' data-ref="1001zone">zone</dfn>)</td></tr>
<tr><th id="5508">5508</th><td>{</td></tr>
<tr><th id="5509">5509</th><td>	<em>int</em> <dfn class="local col2 decl" id="1002cpu" title='cpu' data-type='int' data-ref="1002cpu">cpu</dfn>;</td></tr>
<tr><th id="5510">5510</th><td>	<a class="local col1 ref" href="#1001zone" title='zone' data-ref="1001zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a> = <a class="macro" href="../include/linux/percpu.h.html#148" title="(typeof(struct per_cpu_pageset) *)__alloc_percpu(sizeof(struct per_cpu_pageset), __alignof__(struct per_cpu_pageset))" data-ref="_M/alloc_percpu">alloc_percpu</a>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a>);</td></tr>
<tr><th id="5511">5511</th><td>	<a class="macro" href="../include/linux/cpumask.h.html#749" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_possible_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_possible_cpu">for_each_possible_cpu</a>(<a class="local col2 ref" href="#1002cpu" title='cpu' data-ref="1002cpu">cpu</a>)</td></tr>
<tr><th id="5512">5512</th><td>		<a class="tu ref fn" href="#zone_pageset_init" title='zone_pageset_init' data-use='c' data-ref="zone_pageset_init">zone_pageset_init</a>(<a class="local col1 ref" href="#1001zone" title='zone' data-ref="1001zone">zone</a>, <a class="local col2 ref" href="#1002cpu" title='cpu' data-ref="1002cpu">cpu</a>);</td></tr>
<tr><th id="5513">5513</th><td>}</td></tr>
<tr><th id="5514">5514</th><td></td></tr>
<tr><th id="5515">5515</th><td><i>/*</i></td></tr>
<tr><th id="5516">5516</th><td><i> * Allocate per cpu pagesets and initialize them.</i></td></tr>
<tr><th id="5517">5517</th><td><i> * Before this call only boot pagesets were available.</i></td></tr>
<tr><th id="5518">5518</th><td><i> */</i></td></tr>
<tr><th id="5519">5519</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="setup_per_cpu_pageset" title='setup_per_cpu_pageset' data-ref="setup_per_cpu_pageset">setup_per_cpu_pageset</dfn>(<em>void</em>)</td></tr>
<tr><th id="5520">5520</th><td>{</td></tr>
<tr><th id="5521">5521</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col3 decl" id="1003pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1003pgdat">pgdat</dfn>;</td></tr>
<tr><th id="5522">5522</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col4 decl" id="1004zone" title='zone' data-type='struct zone *' data-ref="1004zone">zone</dfn>;</td></tr>
<tr><th id="5523">5523</th><td></td></tr>
<tr><th id="5524">5524</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col4 ref" href="#1004zone" title='zone' data-ref="1004zone">zone</a>)</td></tr>
<tr><th id="5525">5525</th><td>		<a class="ref fn" href="#setup_zone_pageset" title='setup_zone_pageset' data-ref="setup_zone_pageset">setup_zone_pageset</a>(<a class="local col4 ref" href="#1004zone" title='zone' data-ref="1004zone">zone</a>);</td></tr>
<tr><th id="5526">5526</th><td></td></tr>
<tr><th id="5527">5527</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#930" title="for (pgdat = first_online_pgdat(); pgdat; pgdat = next_online_pgdat(pgdat))" data-ref="_M/for_each_online_pgdat">for_each_online_pgdat</a>(<a class="local col3 ref" href="#1003pgdat" title='pgdat' data-ref="1003pgdat">pgdat</a>)</td></tr>
<tr><th id="5528">5528</th><td>		<a class="local col3 ref" href="#1003pgdat" title='pgdat' data-ref="1003pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::per_cpu_nodestats" title='pglist_data::per_cpu_nodestats' data-ref="pglist_data::per_cpu_nodestats">per_cpu_nodestats</a> =</td></tr>
<tr><th id="5529">5529</th><td>			<a class="macro" href="../include/linux/percpu.h.html#148" title="(typeof(struct per_cpu_nodestat) *)__alloc_percpu(sizeof(struct per_cpu_nodestat), __alignof__(struct per_cpu_nodestat))" data-ref="_M/alloc_percpu">alloc_percpu</a>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_nodestat" title='per_cpu_nodestat' data-ref="per_cpu_nodestat">per_cpu_nodestat</a>);</td></tr>
<tr><th id="5530">5530</th><td>}</td></tr>
<tr><th id="5531">5531</th><td></td></tr>
<tr><th id="5532">5532</th><td><em>static</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <em>void</em> <dfn class="tu decl def fn" id="zone_pcp_init" title='zone_pcp_init' data-type='void zone_pcp_init(struct zone * zone)' data-ref="zone_pcp_init">zone_pcp_init</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col5 decl" id="1005zone" title='zone' data-type='struct zone *' data-ref="1005zone">zone</dfn>)</td></tr>
<tr><th id="5533">5533</th><td>{</td></tr>
<tr><th id="5534">5534</th><td>	<i>/*</i></td></tr>
<tr><th id="5535">5535</th><td><i>	 * per cpu subsystem is not up at this point. The following code</i></td></tr>
<tr><th id="5536">5536</th><td><i>	 * relies on the ability of the linker to provide the</i></td></tr>
<tr><th id="5537">5537</th><td><i>	 * offset of a (static) per cpu variable into the per cpu area.</i></td></tr>
<tr><th id="5538">5538</th><td><i>	 */</i></td></tr>
<tr><th id="5539">5539</th><td>	<a class="local col5 ref" href="#1005zone" title='zone' data-ref="1005zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a> = &amp;<a class="tu ref" href="#5160" title='boot_pageset' data-use='a' data-ref="boot_pageset">boot_pageset</a>;</td></tr>
<tr><th id="5540">5540</th><td></td></tr>
<tr><th id="5541">5541</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/mmzone.h.html#populated_zone" title='populated_zone' data-ref="populated_zone">populated_zone</a>(<a class="local col5 ref" href="#1005zone" title='zone' data-ref="1005zone">zone</a>))</td></tr>
<tr><th id="5542">5542</th><td>		<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#15" title="&quot;\001&quot; &quot;7&quot;" data-ref="_M/KERN_DEBUG">KERN_DEBUG</a> <q>"  %s zone: %lu pages, LIFO batch:%u\n"</q>,</td></tr>
<tr><th id="5543">5543</th><td>			<a class="local col5 ref" href="#1005zone" title='zone' data-ref="1005zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::name" title='zone::name' data-ref="zone::name">name</a>, <a class="local col5 ref" href="#1005zone" title='zone' data-ref="1005zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::present_pages" title='zone::present_pages' data-ref="zone::present_pages">present_pages</a>,</td></tr>
<tr><th id="5544">5544</th><td>					 <a class="tu ref fn" href="#zone_batchsize" title='zone_batchsize' data-use='c' data-ref="zone_batchsize">zone_batchsize</a>(<a class="local col5 ref" href="#1005zone" title='zone' data-ref="1005zone">zone</a>));</td></tr>
<tr><th id="5545">5545</th><td>}</td></tr>
<tr><th id="5546">5546</th><td></td></tr>
<tr><th id="5547">5547</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="init_currently_empty_zone" title='init_currently_empty_zone' data-ref="init_currently_empty_zone">init_currently_empty_zone</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="1006zone" title='zone' data-type='struct zone *' data-ref="1006zone">zone</dfn>,</td></tr>
<tr><th id="5548">5548</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1007zone_start_pfn" title='zone_start_pfn' data-type='unsigned long' data-ref="1007zone_start_pfn">zone_start_pfn</dfn>,</td></tr>
<tr><th id="5549">5549</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1008size" title='size' data-type='unsigned long' data-ref="1008size">size</dfn>)</td></tr>
<tr><th id="5550">5550</th><td>{</td></tr>
<tr><th id="5551">5551</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col9 decl" id="1009pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1009pgdat">pgdat</dfn> = <a class="local col6 ref" href="#1006zone" title='zone' data-ref="1006zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a>;</td></tr>
<tr><th id="5552">5552</th><td></td></tr>
<tr><th id="5553">5553</th><td>	<a class="local col9 ref" href="#1009pgdat" title='pgdat' data-ref="1009pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::nr_zones" title='pglist_data::nr_zones' data-ref="pglist_data::nr_zones">nr_zones</a> = <a class="macro" href="../include/linux/mmzone.h.html#832" title="((zone) - (zone)-&gt;zone_pgdat-&gt;node_zones)" data-ref="_M/zone_idx">zone_idx</a>(<a class="local col6 ref" href="#1006zone" title='zone' data-ref="1006zone">zone</a>) + <var>1</var>;</td></tr>
<tr><th id="5554">5554</th><td></td></tr>
<tr><th id="5555">5555</th><td>	<a class="local col6 ref" href="#1006zone" title='zone' data-ref="1006zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_start_pfn" title='zone::zone_start_pfn' data-ref="zone::zone_start_pfn">zone_start_pfn</a> = <a class="local col7 ref" href="#1007zone_start_pfn" title='zone_start_pfn' data-ref="1007zone_start_pfn">zone_start_pfn</a>;</td></tr>
<tr><th id="5556">5556</th><td></td></tr>
<tr><th id="5557">5557</th><td>	<a class="macro" href="internal.h.html#414" title="do { if (MMINIT_TRACE &lt; mminit_loglevel) { if (MMINIT_TRACE &lt;= MMINIT_WARNING) printk(&quot;\001&quot; &quot;4&quot; &quot;mminit::&quot; &quot;memmap_init&quot; &quot; &quot; &quot;Initialising map node %d zone %lu pfns %lu -&gt; %lu\n&quot;, pgdat-&gt;node_id, (unsigned long)((zone) - (zone)-&gt;zone_pgdat-&gt;node_zones), zone_start_pfn, (zone_start_pfn + size)); else printk(&quot;\001&quot; &quot;7&quot; &quot;mminit::&quot; &quot;memmap_init&quot; &quot; &quot; &quot;Initialising map node %d zone %lu pfns %lu -&gt; %lu\n&quot;, pgdat-&gt;node_id, (unsigned long)((zone) - (zone)-&gt;zone_pgdat-&gt;node_zones), zone_start_pfn, (zone_start_pfn + size)); } } while (0)" data-ref="_M/mminit_dprintk">mminit_dprintk</a>(<a class="enum" href="internal.h.html#MMINIT_TRACE" title='MMINIT_TRACE' data-ref="MMINIT_TRACE">MMINIT_TRACE</a>, <q>"memmap_init"</q>,</td></tr>
<tr><th id="5558">5558</th><td>			<q>"Initialising map node %d zone %lu pfns %lu -&gt; %lu\n"</q>,</td></tr>
<tr><th id="5559">5559</th><td>			<a class="local col9 ref" href="#1009pgdat" title='pgdat' data-ref="1009pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>,</td></tr>
<tr><th id="5560">5560</th><td>			(<em>unsigned</em> <em>long</em>)zone_idx(<a class="local col6 ref" href="#1006zone" title='zone' data-ref="1006zone">zone</a>),</td></tr>
<tr><th id="5561">5561</th><td>			<a class="local col7 ref" href="#1007zone_start_pfn" title='zone_start_pfn' data-ref="1007zone_start_pfn">zone_start_pfn</a>, (<a class="local col7 ref" href="#1007zone_start_pfn" title='zone_start_pfn' data-ref="1007zone_start_pfn">zone_start_pfn</a> + <a class="local col8 ref" href="#1008size" title='size' data-ref="1008size">size</a>));</td></tr>
<tr><th id="5562">5562</th><td></td></tr>
<tr><th id="5563">5563</th><td>	<a class="tu ref fn" href="#zone_init_free_lists" title='zone_init_free_lists' data-use='c' data-ref="zone_init_free_lists">zone_init_free_lists</a>(<a class="local col6 ref" href="#1006zone" title='zone' data-ref="1006zone">zone</a>);</td></tr>
<tr><th id="5564">5564</th><td>	<a class="local col6 ref" href="#1006zone" title='zone' data-ref="1006zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::initialized" title='zone::initialized' data-ref="zone::initialized">initialized</a> = <var>1</var>;</td></tr>
<tr><th id="5565">5565</th><td>}</td></tr>
<tr><th id="5566">5566</th><td></td></tr>
<tr><th id="5567">5567</th><td><u>#<span data-ppcond="5567">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a></u></td></tr>
<tr><th id="5568">5568</th><td><u>#<span data-ppcond="5568">ifndef</span> <span class="macro" data-ref="_M/CONFIG_HAVE_ARCH_EARLY_PFN_TO_NID">CONFIG_HAVE_ARCH_EARLY_PFN_TO_NID</span></u></td></tr>
<tr><th id="5569">5569</th><td></td></tr>
<tr><th id="5570">5570</th><td><i>/*</i></td></tr>
<tr><th id="5571">5571</th><td><i> * Required by SPARSEMEM. Given a PFN, return what node the PFN is on.</i></td></tr>
<tr><th id="5572">5572</th><td><i> */</i></td></tr>
<tr><th id="5573">5573</th><td><em>int</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="__early_pfn_to_nid" title='__early_pfn_to_nid' data-ref="__early_pfn_to_nid">__early_pfn_to_nid</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1010pfn" title='pfn' data-type='unsigned long' data-ref="1010pfn">pfn</dfn>,</td></tr>
<tr><th id="5574">5574</th><td>					<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache" title='mminit_pfnnid_cache' data-ref="mminit_pfnnid_cache">mminit_pfnnid_cache</a> *<dfn class="local col1 decl" id="1011state" title='state' data-type='struct mminit_pfnnid_cache *' data-ref="1011state">state</dfn>)</td></tr>
<tr><th id="5575">5575</th><td>{</td></tr>
<tr><th id="5576">5576</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1012start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1012start_pfn">start_pfn</dfn>, <dfn class="local col3 decl" id="1013end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1013end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="5577">5577</th><td>	<em>int</em> <dfn class="local col4 decl" id="1014nid" title='nid' data-type='int' data-ref="1014nid">nid</dfn>;</td></tr>
<tr><th id="5578">5578</th><td></td></tr>
<tr><th id="5579">5579</th><td>	<b>if</b> (<a class="local col1 ref" href="#1011state" title='state' data-ref="1011state">state</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache::last_start" title='mminit_pfnnid_cache::last_start' data-ref="mminit_pfnnid_cache::last_start">last_start</a> &lt;= <a class="local col0 ref" href="#1010pfn" title='pfn' data-ref="1010pfn">pfn</a> &amp;&amp; <a class="local col0 ref" href="#1010pfn" title='pfn' data-ref="1010pfn">pfn</a> &lt; <a class="local col1 ref" href="#1011state" title='state' data-ref="1011state">state</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache::last_end" title='mminit_pfnnid_cache::last_end' data-ref="mminit_pfnnid_cache::last_end">last_end</a>)</td></tr>
<tr><th id="5580">5580</th><td>		<b>return</b> <a class="local col1 ref" href="#1011state" title='state' data-ref="1011state">state</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache::last_nid" title='mminit_pfnnid_cache::last_nid' data-ref="mminit_pfnnid_cache::last_nid">last_nid</a>;</td></tr>
<tr><th id="5581">5581</th><td></td></tr>
<tr><th id="5582">5582</th><td>	<a class="local col4 ref" href="#1014nid" title='nid' data-ref="1014nid">nid</a> = <a class="ref fn" href="../include/linux/memblock.h.html#memblock_search_pfn_nid" title='memblock_search_pfn_nid' data-ref="memblock_search_pfn_nid">memblock_search_pfn_nid</a>(<a class="local col0 ref" href="#1010pfn" title='pfn' data-ref="1010pfn">pfn</a>, &amp;<a class="local col2 ref" href="#1012start_pfn" title='start_pfn' data-ref="1012start_pfn">start_pfn</a>, &amp;<a class="local col3 ref" href="#1013end_pfn" title='end_pfn' data-ref="1013end_pfn">end_pfn</a>);</td></tr>
<tr><th id="5583">5583</th><td>	<b>if</b> (<a class="local col4 ref" href="#1014nid" title='nid' data-ref="1014nid">nid</a> != -<var>1</var>) {</td></tr>
<tr><th id="5584">5584</th><td>		<a class="local col1 ref" href="#1011state" title='state' data-ref="1011state">state</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache::last_start" title='mminit_pfnnid_cache::last_start' data-ref="mminit_pfnnid_cache::last_start">last_start</a> = <a class="local col2 ref" href="#1012start_pfn" title='start_pfn' data-ref="1012start_pfn">start_pfn</a>;</td></tr>
<tr><th id="5585">5585</th><td>		<a class="local col1 ref" href="#1011state" title='state' data-ref="1011state">state</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache::last_end" title='mminit_pfnnid_cache::last_end' data-ref="mminit_pfnnid_cache::last_end">last_end</a> = <a class="local col3 ref" href="#1013end_pfn" title='end_pfn' data-ref="1013end_pfn">end_pfn</a>;</td></tr>
<tr><th id="5586">5586</th><td>		<a class="local col1 ref" href="#1011state" title='state' data-ref="1011state">state</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#mminit_pfnnid_cache::last_nid" title='mminit_pfnnid_cache::last_nid' data-ref="mminit_pfnnid_cache::last_nid">last_nid</a> = <a class="local col4 ref" href="#1014nid" title='nid' data-ref="1014nid">nid</a>;</td></tr>
<tr><th id="5587">5587</th><td>	}</td></tr>
<tr><th id="5588">5588</th><td></td></tr>
<tr><th id="5589">5589</th><td>	<b>return</b> <a class="local col4 ref" href="#1014nid" title='nid' data-ref="1014nid">nid</a>;</td></tr>
<tr><th id="5590">5590</th><td>}</td></tr>
<tr><th id="5591">5591</th><td><u>#<span data-ppcond="5568">endif</span> /* CONFIG_HAVE_ARCH_EARLY_PFN_TO_NID */</u></td></tr>
<tr><th id="5592">5592</th><td></td></tr>
<tr><th id="5593">5593</th><td><i class="doc">/**</i></td></tr>
<tr><th id="5594">5594</th><td><i class="doc"> * free_bootmem_with_active_regions - Call memblock_free_early_nid for each active range</i></td></tr>
<tr><th id="5595">5595</th><td><i class="doc"> *<span class="command"> @nid</span>: The node to free memory on. If MAX_NUMNODES, all nodes are freed.</i></td></tr>
<tr><th id="5596">5596</th><td><i class="doc"> *<span class="command"> @max</span>_low_pfn: The highest PFN that will be passed to memblock_free_early_nid</i></td></tr>
<tr><th id="5597">5597</th><td><i class="doc"> *</i></td></tr>
<tr><th id="5598">5598</th><td><i class="doc"> * If an architecture guarantees that all ranges registered contain no holes</i></td></tr>
<tr><th id="5599">5599</th><td><i class="doc"> * and may be freed, this this function may be used instead of calling</i></td></tr>
<tr><th id="5600">5600</th><td><i class="doc"> * memblock_free_early_nid() manually.</i></td></tr>
<tr><th id="5601">5601</th><td><i class="doc"> */</i></td></tr>
<tr><th id="5602">5602</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="free_bootmem_with_active_regions" title='free_bootmem_with_active_regions' data-ref="free_bootmem_with_active_regions">free_bootmem_with_active_regions</dfn>(<em>int</em> <dfn class="local col5 decl" id="1015nid" title='nid' data-type='int' data-ref="1015nid">nid</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1016max_low_pfn" title='max_low_pfn' data-type='unsigned long' data-ref="1016max_low_pfn">max_low_pfn</dfn>)</td></tr>
<tr><th id="5603">5603</th><td>{</td></tr>
<tr><th id="5604">5604</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1017start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1017start_pfn">start_pfn</dfn>, <dfn class="local col8 decl" id="1018end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1018end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="5605">5605</th><td>	<em>int</em> <dfn class="local col9 decl" id="1019i" title='i' data-type='int' data-ref="1019i">i</dfn>, <dfn class="local col0 decl" id="1020this_nid" title='this_nid' data-type='int' data-ref="1020this_nid">this_nid</dfn>;</td></tr>
<tr><th id="5606">5606</th><td></td></tr>
<tr><th id="5607">5607</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, &amp;this_nid); i &gt;= 0; __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, &amp;this_nid))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col9 ref" href="#1019i" title='i' data-ref="1019i">i</a>, <a class="local col5 ref" href="#1015nid" title='nid' data-ref="1015nid">nid</a>, &amp;<a class="local col7 ref" href="#1017start_pfn" title='start_pfn' data-ref="1017start_pfn">start_pfn</a>, &amp;<a class="local col8 ref" href="#1018end_pfn" title='end_pfn' data-ref="1018end_pfn">end_pfn</a>, &amp;<a class="local col0 ref" href="#1020this_nid" title='this_nid' data-ref="1020this_nid">this_nid</a>) {</td></tr>
<tr><th id="5608">5608</th><td>		<a class="local col7 ref" href="#1017start_pfn" title='start_pfn' data-ref="1017start_pfn">start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(start_pfn) __UNIQUE_ID_min1_195 = (start_pfn); typeof(max_low_pfn) __UNIQUE_ID_min2_196 = (max_low_pfn); (void) (&amp;__UNIQUE_ID_min1_195 == &amp;__UNIQUE_ID_min2_196); __UNIQUE_ID_min1_195 &lt; __UNIQUE_ID_min2_196 ? __UNIQUE_ID_min1_195 : __UNIQUE_ID_min2_196; })" data-ref="_M/min">min</a>(<a class="local col7 ref" href="#1017start_pfn" title='start_pfn' data-ref="1017start_pfn">start_pfn</a>, <a class="local col6 ref" href="#1016max_low_pfn" title='max_low_pfn' data-ref="1016max_low_pfn">max_low_pfn</a>);</td></tr>
<tr><th id="5609">5609</th><td>		<a class="local col8 ref" href="#1018end_pfn" title='end_pfn' data-ref="1018end_pfn">end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(end_pfn) __UNIQUE_ID_min1_199 = (end_pfn); typeof(max_low_pfn) __UNIQUE_ID_min2_200 = (max_low_pfn); (void) (&amp;__UNIQUE_ID_min1_199 == &amp;__UNIQUE_ID_min2_200); __UNIQUE_ID_min1_199 &lt; __UNIQUE_ID_min2_200 ? __UNIQUE_ID_min1_199 : __UNIQUE_ID_min2_200; })" data-ref="_M/min">min</a>(<a class="local col8 ref" href="#1018end_pfn" title='end_pfn' data-ref="1018end_pfn">end_pfn</a>, <a class="local col6 ref" href="#1016max_low_pfn" title='max_low_pfn' data-ref="1016max_low_pfn">max_low_pfn</a>);</td></tr>
<tr><th id="5610">5610</th><td></td></tr>
<tr><th id="5611">5611</th><td>		<b>if</b> (<a class="local col7 ref" href="#1017start_pfn" title='start_pfn' data-ref="1017start_pfn">start_pfn</a> &lt; <a class="local col8 ref" href="#1018end_pfn" title='end_pfn' data-ref="1018end_pfn">end_pfn</a>)</td></tr>
<tr><th id="5612">5612</th><td>			<a class="ref fn" href="../include/linux/bootmem.h.html#memblock_free_early_nid" title='memblock_free_early_nid' data-ref="memblock_free_early_nid">memblock_free_early_nid</a>(<a class="macro" href="../include/linux/pfn.h.html#21" title="((phys_addr_t)(start_pfn) &lt;&lt; 12)" data-ref="_M/PFN_PHYS">PFN_PHYS</a>(<a class="local col7 ref" href="#1017start_pfn" title='start_pfn' data-ref="1017start_pfn">start_pfn</a>),</td></tr>
<tr><th id="5613">5613</th><td>					(<a class="local col8 ref" href="#1018end_pfn" title='end_pfn' data-ref="1018end_pfn">end_pfn</a> - <a class="local col7 ref" href="#1017start_pfn" title='start_pfn' data-ref="1017start_pfn">start_pfn</a>) &lt;&lt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>,</td></tr>
<tr><th id="5614">5614</th><td>					<a class="local col0 ref" href="#1020this_nid" title='this_nid' data-ref="1020this_nid">this_nid</a>);</td></tr>
<tr><th id="5615">5615</th><td>	}</td></tr>
<tr><th id="5616">5616</th><td>}</td></tr>
<tr><th id="5617">5617</th><td></td></tr>
<tr><th id="5618">5618</th><td><i class="doc">/**</i></td></tr>
<tr><th id="5619">5619</th><td><i class="doc"> * sparse_memory_present_with_active_regions - Call memory_present for each active range</i></td></tr>
<tr><th id="5620">5620</th><td><i class="doc"> *<span class="command"> @nid</span>: The node to call memory_present for. If MAX_NUMNODES, all nodes will be used.</i></td></tr>
<tr><th id="5621">5621</th><td><i class="doc"> *</i></td></tr>
<tr><th id="5622">5622</th><td><i class="doc"> * If an architecture guarantees that all ranges registered contain no holes and may</i></td></tr>
<tr><th id="5623">5623</th><td><i class="doc"> * be freed, this function may be used instead of calling memory_present() manually.</i></td></tr>
<tr><th id="5624">5624</th><td><i class="doc"> */</i></td></tr>
<tr><th id="5625">5625</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="sparse_memory_present_with_active_regions" title='sparse_memory_present_with_active_regions' data-ref="sparse_memory_present_with_active_regions">sparse_memory_present_with_active_regions</dfn>(<em>int</em> <dfn class="local col1 decl" id="1021nid" title='nid' data-type='int' data-ref="1021nid">nid</dfn>)</td></tr>
<tr><th id="5626">5626</th><td>{</td></tr>
<tr><th id="5627">5627</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1022start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1022start_pfn">start_pfn</dfn>, <dfn class="local col3 decl" id="1023end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1023end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="5628">5628</th><td>	<em>int</em> <dfn class="local col4 decl" id="1024i" title='i' data-type='int' data-ref="1024i">i</dfn>, <dfn class="local col5 decl" id="1025this_nid" title='this_nid' data-type='int' data-ref="1025this_nid">this_nid</dfn>;</td></tr>
<tr><th id="5629">5629</th><td></td></tr>
<tr><th id="5630">5630</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, &amp;this_nid); i &gt;= 0; __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, &amp;this_nid))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col4 ref" href="#1024i" title='i' data-ref="1024i">i</a>, <a class="local col1 ref" href="#1021nid" title='nid' data-ref="1021nid">nid</a>, &amp;<a class="local col2 ref" href="#1022start_pfn" title='start_pfn' data-ref="1022start_pfn">start_pfn</a>, &amp;<a class="local col3 ref" href="#1023end_pfn" title='end_pfn' data-ref="1023end_pfn">end_pfn</a>, &amp;<a class="local col5 ref" href="#1025this_nid" title='this_nid' data-ref="1025this_nid">this_nid</a>)</td></tr>
<tr><th id="5631">5631</th><td>		<a class="ref fn" href="../include/linux/mmzone.h.html#memory_present" title='memory_present' data-ref="memory_present">memory_present</a>(<a class="local col5 ref" href="#1025this_nid" title='this_nid' data-ref="1025this_nid">this_nid</a>, <a class="local col2 ref" href="#1022start_pfn" title='start_pfn' data-ref="1022start_pfn">start_pfn</a>, <a class="local col3 ref" href="#1023end_pfn" title='end_pfn' data-ref="1023end_pfn">end_pfn</a>);</td></tr>
<tr><th id="5632">5632</th><td>}</td></tr>
<tr><th id="5633">5633</th><td></td></tr>
<tr><th id="5634">5634</th><td><i class="doc">/**</i></td></tr>
<tr><th id="5635">5635</th><td><i class="doc"> * get_pfn_range_for_nid - Return the start and end page frames for a node</i></td></tr>
<tr><th id="5636">5636</th><td><i class="doc"> *<span class="command"> @nid</span>: The nid to return the range for. If MAX_NUMNODES, the min and max PFN are returned.</i></td></tr>
<tr><th id="5637">5637</th><td><i class="doc"> *<span class="command"> @start</span>_pfn: Passed by reference. On return, it will have the node start_pfn.</i></td></tr>
<tr><th id="5638">5638</th><td><i class="doc"> *<span class="command"> @end</span>_pfn: Passed by reference. On return, it will have the node end_pfn.</i></td></tr>
<tr><th id="5639">5639</th><td><i class="doc"> *</i></td></tr>
<tr><th id="5640">5640</th><td><i class="doc"> * It returns the start and end page frame of a node based on information</i></td></tr>
<tr><th id="5641">5641</th><td><i class="doc"> * provided by memblock_set_node(). If called for a node</i></td></tr>
<tr><th id="5642">5642</th><td><i class="doc"> * with no available memory, a warning is printed and the start and end</i></td></tr>
<tr><th id="5643">5643</th><td><i class="doc"> * PFNs will be 0.</i></td></tr>
<tr><th id="5644">5644</th><td><i class="doc"> */</i></td></tr>
<tr><th id="5645">5645</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="get_pfn_range_for_nid" title='get_pfn_range_for_nid' data-ref="get_pfn_range_for_nid">get_pfn_range_for_nid</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="1026nid" title='nid' data-type='unsigned int' data-ref="1026nid">nid</dfn>,</td></tr>
<tr><th id="5646">5646</th><td>			<em>unsigned</em> <em>long</em> *<dfn class="local col7 decl" id="1027start_pfn" title='start_pfn' data-type='unsigned long *' data-ref="1027start_pfn">start_pfn</dfn>, <em>unsigned</em> <em>long</em> *<dfn class="local col8 decl" id="1028end_pfn" title='end_pfn' data-type='unsigned long *' data-ref="1028end_pfn">end_pfn</dfn>)</td></tr>
<tr><th id="5647">5647</th><td>{</td></tr>
<tr><th id="5648">5648</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1029this_start_pfn" title='this_start_pfn' data-type='unsigned long' data-ref="1029this_start_pfn">this_start_pfn</dfn>, <dfn class="local col0 decl" id="1030this_end_pfn" title='this_end_pfn' data-type='unsigned long' data-ref="1030this_end_pfn">this_end_pfn</dfn>;</td></tr>
<tr><th id="5649">5649</th><td>	<em>int</em> <dfn class="local col1 decl" id="1031i" title='i' data-type='int' data-ref="1031i">i</dfn>;</td></tr>
<tr><th id="5650">5650</th><td></td></tr>
<tr><th id="5651">5651</th><td>	*<a class="local col7 ref" href="#1027start_pfn" title='start_pfn' data-ref="1027start_pfn">start_pfn</a> = -<var>1UL</var>;</td></tr>
<tr><th id="5652">5652</th><td>	*<a class="local col8 ref" href="#1028end_pfn" title='end_pfn' data-ref="1028end_pfn">end_pfn</a> = <var>0</var>;</td></tr>
<tr><th id="5653">5653</th><td></td></tr>
<tr><th id="5654">5654</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, nid, &amp;this_start_pfn, &amp;this_end_pfn, ((void *)0)); i &gt;= 0; __next_mem_pfn_range(&amp;i, nid, &amp;this_start_pfn, &amp;this_end_pfn, ((void *)0)))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col1 ref" href="#1031i" title='i' data-ref="1031i">i</a>, <a class="local col6 ref" href="#1026nid" title='nid' data-ref="1026nid">nid</a>, &amp;<a class="local col9 ref" href="#1029this_start_pfn" title='this_start_pfn' data-ref="1029this_start_pfn">this_start_pfn</a>, &amp;<a class="local col0 ref" href="#1030this_end_pfn" title='this_end_pfn' data-ref="1030this_end_pfn">this_end_pfn</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="5655">5655</th><td>		*<a class="local col7 ref" href="#1027start_pfn" title='start_pfn' data-ref="1027start_pfn">start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(*start_pfn) __UNIQUE_ID_min1_203 = (*start_pfn); typeof(this_start_pfn) __UNIQUE_ID_min2_204 = (this_start_pfn); (void) (&amp;__UNIQUE_ID_min1_203 == &amp;__UNIQUE_ID_min2_204); __UNIQUE_ID_min1_203 &lt; __UNIQUE_ID_min2_204 ? __UNIQUE_ID_min1_203 : __UNIQUE_ID_min2_204; })" data-ref="_M/min">min</a>(*<a class="local col7 ref" href="#1027start_pfn" title='start_pfn' data-ref="1027start_pfn">start_pfn</a>, <a class="local col9 ref" href="#1029this_start_pfn" title='this_start_pfn' data-ref="1029this_start_pfn">this_start_pfn</a>);</td></tr>
<tr><th id="5656">5656</th><td>		*<a class="local col8 ref" href="#1028end_pfn" title='end_pfn' data-ref="1028end_pfn">end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(*end_pfn) __UNIQUE_ID_max1_207 = (*end_pfn); typeof(this_end_pfn) __UNIQUE_ID_max2_208 = (this_end_pfn); (void) (&amp;__UNIQUE_ID_max1_207 == &amp;__UNIQUE_ID_max2_208); __UNIQUE_ID_max1_207 &gt; __UNIQUE_ID_max2_208 ? __UNIQUE_ID_max1_207 : __UNIQUE_ID_max2_208; })" data-ref="_M/max">max</a>(*<a class="local col8 ref" href="#1028end_pfn" title='end_pfn' data-ref="1028end_pfn">end_pfn</a>, <a class="local col0 ref" href="#1030this_end_pfn" title='this_end_pfn' data-ref="1030this_end_pfn">this_end_pfn</a>);</td></tr>
<tr><th id="5657">5657</th><td>	}</td></tr>
<tr><th id="5658">5658</th><td></td></tr>
<tr><th id="5659">5659</th><td>	<b>if</b> (*<a class="local col7 ref" href="#1027start_pfn" title='start_pfn' data-ref="1027start_pfn">start_pfn</a> == -<var>1UL</var>)</td></tr>
<tr><th id="5660">5660</th><td>		*<a class="local col7 ref" href="#1027start_pfn" title='start_pfn' data-ref="1027start_pfn">start_pfn</a> = <var>0</var>;</td></tr>
<tr><th id="5661">5661</th><td>}</td></tr>
<tr><th id="5662">5662</th><td></td></tr>
<tr><th id="5663">5663</th><td><i  data-doc="find_usable_zone_for_movable">/*</i></td></tr>
<tr><th id="5664">5664</th><td><i  data-doc="find_usable_zone_for_movable"> * This finds a zone that can be used for ZONE_MOVABLE pages. The</i></td></tr>
<tr><th id="5665">5665</th><td><i  data-doc="find_usable_zone_for_movable"> * assumption is made that zones within a node are ordered in monotonic</i></td></tr>
<tr><th id="5666">5666</th><td><i  data-doc="find_usable_zone_for_movable"> * increasing memory addresses so that the "highest" populated zone is used</i></td></tr>
<tr><th id="5667">5667</th><td><i  data-doc="find_usable_zone_for_movable"> */</i></td></tr>
<tr><th id="5668">5668</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="find_usable_zone_for_movable" title='find_usable_zone_for_movable' data-type='void find_usable_zone_for_movable()' data-ref="find_usable_zone_for_movable">find_usable_zone_for_movable</dfn>(<em>void</em>)</td></tr>
<tr><th id="5669">5669</th><td>{</td></tr>
<tr><th id="5670">5670</th><td>	<em>int</em> <dfn class="local col2 decl" id="1032zone_index" title='zone_index' data-type='int' data-ref="1032zone_index">zone_index</dfn>;</td></tr>
<tr><th id="5671">5671</th><td>	<b>for</b> (<a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a> = <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a> - <var>1</var>; <a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a> &gt;= <var>0</var>; <a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a>--) {</td></tr>
<tr><th id="5672">5672</th><td>		<b>if</b> (<a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a>)</td></tr>
<tr><th id="5673">5673</th><td>			<b>continue</b>;</td></tr>
<tr><th id="5674">5674</th><td></td></tr>
<tr><th id="5675">5675</th><td>		<b>if</b> (<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>[<a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a>] &gt;</td></tr>
<tr><th id="5676">5676</th><td>				<a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a>])</td></tr>
<tr><th id="5677">5677</th><td>			<b>break</b>;</td></tr>
<tr><th id="5678">5678</th><td>	}</td></tr>
<tr><th id="5679">5679</th><td></td></tr>
<tr><th id="5680">5680</th><td>	<a class="macro" href="../include/linux/mmdebug.h.html#45" title="((void)(sizeof(( long)(zone_index == -1))))" data-ref="_M/VM_BUG_ON">VM_BUG_ON</a>(<a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a> == -<var>1</var>);</td></tr>
<tr><th id="5681">5681</th><td>	<a class="ref" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone">movable_zone</a> = <a class="local col2 ref" href="#1032zone_index" title='zone_index' data-ref="1032zone_index">zone_index</a>;</td></tr>
<tr><th id="5682">5682</th><td>}</td></tr>
<tr><th id="5683">5683</th><td></td></tr>
<tr><th id="5684">5684</th><td><i  data-doc="adjust_zone_range_for_zone_movable">/*</i></td></tr>
<tr><th id="5685">5685</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * The zone ranges provided by the architecture do not include ZONE_MOVABLE</i></td></tr>
<tr><th id="5686">5686</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * because it is sized independent of architecture. Unlike the other zones,</i></td></tr>
<tr><th id="5687">5687</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * the starting point for ZONE_MOVABLE is not fixed. It may be different</i></td></tr>
<tr><th id="5688">5688</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * in each node depending on the size of each node and how evenly kernelcore</i></td></tr>
<tr><th id="5689">5689</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * is distributed. This helper function adjusts the zone ranges</i></td></tr>
<tr><th id="5690">5690</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * provided by the architecture for a given node by using the end of the</i></td></tr>
<tr><th id="5691">5691</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * highest usable zone for ZONE_MOVABLE. This preserves the assumption that</i></td></tr>
<tr><th id="5692">5692</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> * zones within a node are in order of monotonic increases memory addresses</i></td></tr>
<tr><th id="5693">5693</th><td><i  data-doc="adjust_zone_range_for_zone_movable"> */</i></td></tr>
<tr><th id="5694">5694</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="adjust_zone_range_for_zone_movable" title='adjust_zone_range_for_zone_movable' data-type='void adjust_zone_range_for_zone_movable(int nid, unsigned long zone_type, unsigned long node_start_pfn, unsigned long node_end_pfn, unsigned long * zone_start_pfn, unsigned long * zone_end_pfn)' data-ref="adjust_zone_range_for_zone_movable">adjust_zone_range_for_zone_movable</dfn>(<em>int</em> <dfn class="local col3 decl" id="1033nid" title='nid' data-type='int' data-ref="1033nid">nid</dfn>,</td></tr>
<tr><th id="5695">5695</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1034zone_type" title='zone_type' data-type='unsigned long' data-ref="1034zone_type">zone_type</dfn>,</td></tr>
<tr><th id="5696">5696</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1035node_start_pfn" title='node_start_pfn' data-type='unsigned long' data-ref="1035node_start_pfn">node_start_pfn</dfn>,</td></tr>
<tr><th id="5697">5697</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1036node_end_pfn" title='node_end_pfn' data-type='unsigned long' data-ref="1036node_end_pfn">node_end_pfn</dfn>,</td></tr>
<tr><th id="5698">5698</th><td>					<em>unsigned</em> <em>long</em> *<dfn class="local col7 decl" id="1037zone_start_pfn" title='zone_start_pfn' data-type='unsigned long *' data-ref="1037zone_start_pfn">zone_start_pfn</dfn>,</td></tr>
<tr><th id="5699">5699</th><td>					<em>unsigned</em> <em>long</em> *<dfn class="local col8 decl" id="1038zone_end_pfn" title='zone_end_pfn' data-type='unsigned long *' data-ref="1038zone_end_pfn">zone_end_pfn</dfn>)</td></tr>
<tr><th id="5700">5700</th><td>{</td></tr>
<tr><th id="5701">5701</th><td>	<i>/* Only adjust if ZONE_MOVABLE is on this node */</i></td></tr>
<tr><th id="5702">5702</th><td>	<b>if</b> (<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col3 ref" href="#1033nid" title='nid' data-ref="1033nid">nid</a>]) {</td></tr>
<tr><th id="5703">5703</th><td>		<i>/* Size ZONE_MOVABLE */</i></td></tr>
<tr><th id="5704">5704</th><td>		<b>if</b> (<a class="local col4 ref" href="#1034zone_type" title='zone_type' data-ref="1034zone_type">zone_type</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a>) {</td></tr>
<tr><th id="5705">5705</th><td>			*<a class="local col7 ref" href="#1037zone_start_pfn" title='zone_start_pfn' data-ref="1037zone_start_pfn">zone_start_pfn</a> = <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col3 ref" href="#1033nid" title='nid' data-ref="1033nid">nid</a>];</td></tr>
<tr><th id="5706">5706</th><td>			*<a class="local col8 ref" href="#1038zone_end_pfn" title='zone_end_pfn' data-ref="1038zone_end_pfn">zone_end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(node_end_pfn) __UNIQUE_ID_min1_211 = (node_end_pfn); typeof(arch_zone_highest_possible_pfn[movable_zone]) __UNIQUE_ID_min2_212 = (arch_zone_highest_possible_pfn[movable_zone]); (void) (&amp;__UNIQUE_ID_min1_211 == &amp;__UNIQUE_ID_min2_212); __UNIQUE_ID_min1_211 &lt; __UNIQUE_ID_min2_212 ? __UNIQUE_ID_min1_211 : __UNIQUE_ID_min2_212; })" data-ref="_M/min">min</a>(<a class="local col6 ref" href="#1036node_end_pfn" title='node_end_pfn' data-ref="1036node_end_pfn">node_end_pfn</a>,</td></tr>
<tr><th id="5707">5707</th><td>				<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-ref="arch_zone_highest_possible_pfn"><a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a></a>[<a class="ref" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone">movable_zone</a>]);</td></tr>
<tr><th id="5708">5708</th><td></td></tr>
<tr><th id="5709">5709</th><td>		<i>/* Adjust for ZONE_MOVABLE starting within this range */</i></td></tr>
<tr><th id="5710">5710</th><td>		} <b>else</b> <b>if</b> (!<a class="tu ref" href="#mirrored_kernelcore" title='mirrored_kernelcore' data-use='r' data-ref="mirrored_kernelcore">mirrored_kernelcore</a> &amp;&amp;</td></tr>
<tr><th id="5711">5711</th><td>			*<a class="local col7 ref" href="#1037zone_start_pfn" title='zone_start_pfn' data-ref="1037zone_start_pfn">zone_start_pfn</a> &lt; <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col3 ref" href="#1033nid" title='nid' data-ref="1033nid">nid</a>] &amp;&amp;</td></tr>
<tr><th id="5712">5712</th><td>			*<a class="local col8 ref" href="#1038zone_end_pfn" title='zone_end_pfn' data-ref="1038zone_end_pfn">zone_end_pfn</a> &gt; <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col3 ref" href="#1033nid" title='nid' data-ref="1033nid">nid</a>]) {</td></tr>
<tr><th id="5713">5713</th><td>			*<a class="local col8 ref" href="#1038zone_end_pfn" title='zone_end_pfn' data-ref="1038zone_end_pfn">zone_end_pfn</a> = <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col3 ref" href="#1033nid" title='nid' data-ref="1033nid">nid</a>];</td></tr>
<tr><th id="5714">5714</th><td></td></tr>
<tr><th id="5715">5715</th><td>		<i>/* Check if this whole range is within ZONE_MOVABLE */</i></td></tr>
<tr><th id="5716">5716</th><td>		} <b>else</b> <b>if</b> (*<a class="local col7 ref" href="#1037zone_start_pfn" title='zone_start_pfn' data-ref="1037zone_start_pfn">zone_start_pfn</a> &gt;= <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col3 ref" href="#1033nid" title='nid' data-ref="1033nid">nid</a>])</td></tr>
<tr><th id="5717">5717</th><td>			*<a class="local col7 ref" href="#1037zone_start_pfn" title='zone_start_pfn' data-ref="1037zone_start_pfn">zone_start_pfn</a> = *<a class="local col8 ref" href="#1038zone_end_pfn" title='zone_end_pfn' data-ref="1038zone_end_pfn">zone_end_pfn</a>;</td></tr>
<tr><th id="5718">5718</th><td>	}</td></tr>
<tr><th id="5719">5719</th><td>}</td></tr>
<tr><th id="5720">5720</th><td></td></tr>
<tr><th id="5721">5721</th><td><i  data-doc="zone_spanned_pages_in_node">/*</i></td></tr>
<tr><th id="5722">5722</th><td><i  data-doc="zone_spanned_pages_in_node"> * Return the number of pages a zone spans in a node, including holes</i></td></tr>
<tr><th id="5723">5723</th><td><i  data-doc="zone_spanned_pages_in_node"> * present_pages = zone_spanned_pages_in_node() - zone_absent_pages_in_node()</i></td></tr>
<tr><th id="5724">5724</th><td><i  data-doc="zone_spanned_pages_in_node"> */</i></td></tr>
<tr><th id="5725">5725</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="zone_spanned_pages_in_node" title='zone_spanned_pages_in_node' data-type='unsigned long zone_spanned_pages_in_node(int nid, unsigned long zone_type, unsigned long node_start_pfn, unsigned long node_end_pfn, unsigned long * zone_start_pfn, unsigned long * zone_end_pfn, unsigned long * ignored)' data-ref="zone_spanned_pages_in_node">zone_spanned_pages_in_node</dfn>(<em>int</em> <dfn class="local col9 decl" id="1039nid" title='nid' data-type='int' data-ref="1039nid">nid</dfn>,</td></tr>
<tr><th id="5726">5726</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1040zone_type" title='zone_type' data-type='unsigned long' data-ref="1040zone_type">zone_type</dfn>,</td></tr>
<tr><th id="5727">5727</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="1041node_start_pfn" title='node_start_pfn' data-type='unsigned long' data-ref="1041node_start_pfn">node_start_pfn</dfn>,</td></tr>
<tr><th id="5728">5728</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1042node_end_pfn" title='node_end_pfn' data-type='unsigned long' data-ref="1042node_end_pfn">node_end_pfn</dfn>,</td></tr>
<tr><th id="5729">5729</th><td>					<em>unsigned</em> <em>long</em> *<dfn class="local col3 decl" id="1043zone_start_pfn" title='zone_start_pfn' data-type='unsigned long *' data-ref="1043zone_start_pfn">zone_start_pfn</dfn>,</td></tr>
<tr><th id="5730">5730</th><td>					<em>unsigned</em> <em>long</em> *<dfn class="local col4 decl" id="1044zone_end_pfn" title='zone_end_pfn' data-type='unsigned long *' data-ref="1044zone_end_pfn">zone_end_pfn</dfn>,</td></tr>
<tr><th id="5731">5731</th><td>					<em>unsigned</em> <em>long</em> *<dfn class="local col5 decl" id="1045ignored" title='ignored' data-type='unsigned long *' data-ref="1045ignored">ignored</dfn>)</td></tr>
<tr><th id="5732">5732</th><td>{</td></tr>
<tr><th id="5733">5733</th><td>	<i>/* When hotadd a new node from cpu_up(), the node should be empty */</i></td></tr>
<tr><th id="5734">5734</th><td>	<b>if</b> (!<a class="local col1 ref" href="#1041node_start_pfn" title='node_start_pfn' data-ref="1041node_start_pfn">node_start_pfn</a> &amp;&amp; !<a class="local col2 ref" href="#1042node_end_pfn" title='node_end_pfn' data-ref="1042node_end_pfn">node_end_pfn</a>)</td></tr>
<tr><th id="5735">5735</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5736">5736</th><td></td></tr>
<tr><th id="5737">5737</th><td>	<i>/* Get the start and end of the zone */</i></td></tr>
<tr><th id="5738">5738</th><td>	*<a class="local col3 ref" href="#1043zone_start_pfn" title='zone_start_pfn' data-ref="1043zone_start_pfn">zone_start_pfn</a> = <a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="local col0 ref" href="#1040zone_type" title='zone_type' data-ref="1040zone_type">zone_type</a>];</td></tr>
<tr><th id="5739">5739</th><td>	*<a class="local col4 ref" href="#1044zone_end_pfn" title='zone_end_pfn' data-ref="1044zone_end_pfn">zone_end_pfn</a> = <a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>[<a class="local col0 ref" href="#1040zone_type" title='zone_type' data-ref="1040zone_type">zone_type</a>];</td></tr>
<tr><th id="5740">5740</th><td>	<a class="tu ref fn" href="#adjust_zone_range_for_zone_movable" title='adjust_zone_range_for_zone_movable' data-use='c' data-ref="adjust_zone_range_for_zone_movable">adjust_zone_range_for_zone_movable</a>(<a class="local col9 ref" href="#1039nid" title='nid' data-ref="1039nid">nid</a>, <a class="local col0 ref" href="#1040zone_type" title='zone_type' data-ref="1040zone_type">zone_type</a>,</td></tr>
<tr><th id="5741">5741</th><td>				<a class="local col1 ref" href="#1041node_start_pfn" title='node_start_pfn' data-ref="1041node_start_pfn">node_start_pfn</a>, <a class="local col2 ref" href="#1042node_end_pfn" title='node_end_pfn' data-ref="1042node_end_pfn">node_end_pfn</a>,</td></tr>
<tr><th id="5742">5742</th><td>				<a class="local col3 ref" href="#1043zone_start_pfn" title='zone_start_pfn' data-ref="1043zone_start_pfn">zone_start_pfn</a>, <a class="local col4 ref" href="#1044zone_end_pfn" title='zone_end_pfn' data-ref="1044zone_end_pfn">zone_end_pfn</a>);</td></tr>
<tr><th id="5743">5743</th><td></td></tr>
<tr><th id="5744">5744</th><td>	<i>/* Check that this node has pages within the zone's required range */</i></td></tr>
<tr><th id="5745">5745</th><td>	<b>if</b> (*<a class="local col4 ref" href="#1044zone_end_pfn" title='zone_end_pfn' data-ref="1044zone_end_pfn">zone_end_pfn</a> &lt; <a class="local col1 ref" href="#1041node_start_pfn" title='node_start_pfn' data-ref="1041node_start_pfn">node_start_pfn</a> || *<a class="local col3 ref" href="#1043zone_start_pfn" title='zone_start_pfn' data-ref="1043zone_start_pfn">zone_start_pfn</a> &gt; <a class="local col2 ref" href="#1042node_end_pfn" title='node_end_pfn' data-ref="1042node_end_pfn">node_end_pfn</a>)</td></tr>
<tr><th id="5746">5746</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5747">5747</th><td></td></tr>
<tr><th id="5748">5748</th><td>	<i>/* Move the zone boundaries inside the node if necessary */</i></td></tr>
<tr><th id="5749">5749</th><td>	*<a class="local col4 ref" href="#1044zone_end_pfn" title='zone_end_pfn' data-ref="1044zone_end_pfn">zone_end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(*zone_end_pfn) __UNIQUE_ID_min1_215 = (*zone_end_pfn); typeof(node_end_pfn) __UNIQUE_ID_min2_216 = (node_end_pfn); (void) (&amp;__UNIQUE_ID_min1_215 == &amp;__UNIQUE_ID_min2_216); __UNIQUE_ID_min1_215 &lt; __UNIQUE_ID_min2_216 ? __UNIQUE_ID_min1_215 : __UNIQUE_ID_min2_216; })" data-ref="_M/min">min</a>(*<a class="local col4 ref" href="#1044zone_end_pfn" title='zone_end_pfn' data-ref="1044zone_end_pfn">zone_end_pfn</a>, <a class="local col2 ref" href="#1042node_end_pfn" title='node_end_pfn' data-ref="1042node_end_pfn">node_end_pfn</a>);</td></tr>
<tr><th id="5750">5750</th><td>	*<a class="local col3 ref" href="#1043zone_start_pfn" title='zone_start_pfn' data-ref="1043zone_start_pfn">zone_start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(*zone_start_pfn) __UNIQUE_ID_max1_219 = (*zone_start_pfn); typeof(node_start_pfn) __UNIQUE_ID_max2_220 = (node_start_pfn); (void) (&amp;__UNIQUE_ID_max1_219 == &amp;__UNIQUE_ID_max2_220); __UNIQUE_ID_max1_219 &gt; __UNIQUE_ID_max2_220 ? __UNIQUE_ID_max1_219 : __UNIQUE_ID_max2_220; })" data-ref="_M/max">max</a>(*<a class="local col3 ref" href="#1043zone_start_pfn" title='zone_start_pfn' data-ref="1043zone_start_pfn">zone_start_pfn</a>, <a class="local col1 ref" href="#1041node_start_pfn" title='node_start_pfn' data-ref="1041node_start_pfn">node_start_pfn</a>);</td></tr>
<tr><th id="5751">5751</th><td></td></tr>
<tr><th id="5752">5752</th><td>	<i>/* Return the spanned pages */</i></td></tr>
<tr><th id="5753">5753</th><td>	<b>return</b> *<a class="local col4 ref" href="#1044zone_end_pfn" title='zone_end_pfn' data-ref="1044zone_end_pfn">zone_end_pfn</a> - *<a class="local col3 ref" href="#1043zone_start_pfn" title='zone_start_pfn' data-ref="1043zone_start_pfn">zone_start_pfn</a>;</td></tr>
<tr><th id="5754">5754</th><td>}</td></tr>
<tr><th id="5755">5755</th><td></td></tr>
<tr><th id="5756">5756</th><td><i>/*</i></td></tr>
<tr><th id="5757">5757</th><td><i> * Return the number of holes in a range on a node. If nid is MAX_NUMNODES,</i></td></tr>
<tr><th id="5758">5758</th><td><i> * then all holes in the requested range will be accounted for.</i></td></tr>
<tr><th id="5759">5759</th><td><i> */</i></td></tr>
<tr><th id="5760">5760</th><td><em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="__absent_pages_in_range" title='__absent_pages_in_range' data-ref="__absent_pages_in_range">__absent_pages_in_range</dfn>(<em>int</em> <dfn class="local col6 decl" id="1046nid" title='nid' data-type='int' data-ref="1046nid">nid</dfn>,</td></tr>
<tr><th id="5761">5761</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1047range_start_pfn" title='range_start_pfn' data-type='unsigned long' data-ref="1047range_start_pfn">range_start_pfn</dfn>,</td></tr>
<tr><th id="5762">5762</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1048range_end_pfn" title='range_end_pfn' data-type='unsigned long' data-ref="1048range_end_pfn">range_end_pfn</dfn>)</td></tr>
<tr><th id="5763">5763</th><td>{</td></tr>
<tr><th id="5764">5764</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1049nr_absent" title='nr_absent' data-type='unsigned long' data-ref="1049nr_absent">nr_absent</dfn> = <a class="local col8 ref" href="#1048range_end_pfn" title='range_end_pfn' data-ref="1048range_end_pfn">range_end_pfn</a> - <a class="local col7 ref" href="#1047range_start_pfn" title='range_start_pfn' data-ref="1047range_start_pfn">range_start_pfn</a>;</td></tr>
<tr><th id="5765">5765</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1050start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1050start_pfn">start_pfn</dfn>, <dfn class="local col1 decl" id="1051end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1051end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="5766">5766</th><td>	<em>int</em> <dfn class="local col2 decl" id="1052i" title='i' data-type='int' data-ref="1052i">i</dfn>;</td></tr>
<tr><th id="5767">5767</th><td></td></tr>
<tr><th id="5768">5768</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, ((void *)0)); i &gt;= 0; __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, ((void *)0)))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col2 ref" href="#1052i" title='i' data-ref="1052i">i</a>, <a class="local col6 ref" href="#1046nid" title='nid' data-ref="1046nid">nid</a>, &amp;<a class="local col0 ref" href="#1050start_pfn" title='start_pfn' data-ref="1050start_pfn">start_pfn</a>, &amp;<a class="local col1 ref" href="#1051end_pfn" title='end_pfn' data-ref="1051end_pfn">end_pfn</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="5769">5769</th><td>		<a class="local col0 ref" href="#1050start_pfn" title='start_pfn' data-ref="1050start_pfn">start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(start_pfn))({ typeof(start_pfn) __UNIQUE_ID_max1_223 = (start_pfn); typeof(range_start_pfn) __UNIQUE_ID_max2_224 = (range_start_pfn); (void) (&amp;__UNIQUE_ID_max1_223 == &amp;__UNIQUE_ID_max2_224); __UNIQUE_ID_max1_223 &gt; __UNIQUE_ID_max2_224 ? __UNIQUE_ID_max1_223 : __UNIQUE_ID_max2_224; })) __UNIQUE_ID_min1_225 = ((typeof(start_pfn))({ typeof(start_pfn) __UNIQUE_ID_max1_223 = (start_pfn); typeof(range_start_pfn) __UNIQUE_ID_max2_224 = (range_start_pfn); (void) (&amp;__UNIQUE_ID_max1_223 == &amp;__UNIQUE_ID_max2_224); __UNIQUE_ID_max1_223 &gt; __UNIQUE_ID_max2_224 ? __UNIQUE_ID_max1_223 : __UNIQUE_ID_max2_224; })); typeof(range_end_pfn) __UNIQUE_ID_min2_226 = (range_end_pfn); (void) (&amp;__UNIQUE_ID_min1_225 == &amp;__UNIQUE_ID_min2_226); __UNIQUE_ID_min1_225 &lt; __UNIQUE_ID_min2_226 ? __UNIQUE_ID_min1_225 : __UNIQUE_ID_min2_226; })" data-ref="_M/clamp">clamp</a>(<a class="local col0 ref" href="#1050start_pfn" title='start_pfn' data-ref="1050start_pfn">start_pfn</a>, <a class="local col7 ref" href="#1047range_start_pfn" title='range_start_pfn' data-ref="1047range_start_pfn">range_start_pfn</a>, <a class="local col8 ref" href="#1048range_end_pfn" title='range_end_pfn' data-ref="1048range_end_pfn">range_end_pfn</a>);</td></tr>
<tr><th id="5770">5770</th><td>		<a class="local col1 ref" href="#1051end_pfn" title='end_pfn' data-ref="1051end_pfn">end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(end_pfn))({ typeof(end_pfn) __UNIQUE_ID_max1_231 = (end_pfn); typeof(range_start_pfn) __UNIQUE_ID_max2_232 = (range_start_pfn); (void) (&amp;__UNIQUE_ID_max1_231 == &amp;__UNIQUE_ID_max2_232); __UNIQUE_ID_max1_231 &gt; __UNIQUE_ID_max2_232 ? __UNIQUE_ID_max1_231 : __UNIQUE_ID_max2_232; })) __UNIQUE_ID_min1_233 = ((typeof(end_pfn))({ typeof(end_pfn) __UNIQUE_ID_max1_231 = (end_pfn); typeof(range_start_pfn) __UNIQUE_ID_max2_232 = (range_start_pfn); (void) (&amp;__UNIQUE_ID_max1_231 == &amp;__UNIQUE_ID_max2_232); __UNIQUE_ID_max1_231 &gt; __UNIQUE_ID_max2_232 ? __UNIQUE_ID_max1_231 : __UNIQUE_ID_max2_232; })); typeof(range_end_pfn) __UNIQUE_ID_min2_234 = (range_end_pfn); (void) (&amp;__UNIQUE_ID_min1_233 == &amp;__UNIQUE_ID_min2_234); __UNIQUE_ID_min1_233 &lt; __UNIQUE_ID_min2_234 ? __UNIQUE_ID_min1_233 : __UNIQUE_ID_min2_234; })" data-ref="_M/clamp">clamp</a>(<a class="local col1 ref" href="#1051end_pfn" title='end_pfn' data-ref="1051end_pfn">end_pfn</a>, <a class="local col7 ref" href="#1047range_start_pfn" title='range_start_pfn' data-ref="1047range_start_pfn">range_start_pfn</a>, <a class="local col8 ref" href="#1048range_end_pfn" title='range_end_pfn' data-ref="1048range_end_pfn">range_end_pfn</a>);</td></tr>
<tr><th id="5771">5771</th><td>		<a class="local col9 ref" href="#1049nr_absent" title='nr_absent' data-ref="1049nr_absent">nr_absent</a> -= <a class="local col1 ref" href="#1051end_pfn" title='end_pfn' data-ref="1051end_pfn">end_pfn</a> - <a class="local col0 ref" href="#1050start_pfn" title='start_pfn' data-ref="1050start_pfn">start_pfn</a>;</td></tr>
<tr><th id="5772">5772</th><td>	}</td></tr>
<tr><th id="5773">5773</th><td>	<b>return</b> <a class="local col9 ref" href="#1049nr_absent" title='nr_absent' data-ref="1049nr_absent">nr_absent</a>;</td></tr>
<tr><th id="5774">5774</th><td>}</td></tr>
<tr><th id="5775">5775</th><td></td></tr>
<tr><th id="5776">5776</th><td><i class="doc">/**</i></td></tr>
<tr><th id="5777">5777</th><td><i class="doc"> * absent_pages_in_range - Return number of page frames in holes within a range</i></td></tr>
<tr><th id="5778">5778</th><td><i class="doc"> *<span class="command"> @start</span>_pfn: The start PFN to start searching for holes</i></td></tr>
<tr><th id="5779">5779</th><td><i class="doc"> *<span class="command"> @end</span>_pfn: The end PFN to stop searching for holes</i></td></tr>
<tr><th id="5780">5780</th><td><i class="doc"> *</i></td></tr>
<tr><th id="5781">5781</th><td><i class="doc"> * It returns the number of pages frames in memory holes within a range.</i></td></tr>
<tr><th id="5782">5782</th><td><i class="doc"> */</i></td></tr>
<tr><th id="5783">5783</th><td><em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="absent_pages_in_range" title='absent_pages_in_range' data-ref="absent_pages_in_range">absent_pages_in_range</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="1053start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1053start_pfn">start_pfn</dfn>,</td></tr>
<tr><th id="5784">5784</th><td>							<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1054end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1054end_pfn">end_pfn</dfn>)</td></tr>
<tr><th id="5785">5785</th><td>{</td></tr>
<tr><th id="5786">5786</th><td>	<b>return</b> <a class="ref fn" href="#__absent_pages_in_range" title='__absent_pages_in_range' data-ref="__absent_pages_in_range">__absent_pages_in_range</a>(<a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>, <a class="local col3 ref" href="#1053start_pfn" title='start_pfn' data-ref="1053start_pfn">start_pfn</a>, <a class="local col4 ref" href="#1054end_pfn" title='end_pfn' data-ref="1054end_pfn">end_pfn</a>);</td></tr>
<tr><th id="5787">5787</th><td>}</td></tr>
<tr><th id="5788">5788</th><td></td></tr>
<tr><th id="5789">5789</th><td><i  data-doc="zone_absent_pages_in_node">/* Return the number of page frames in holes in a zone on a node */</i></td></tr>
<tr><th id="5790">5790</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="zone_absent_pages_in_node" title='zone_absent_pages_in_node' data-type='unsigned long zone_absent_pages_in_node(int nid, unsigned long zone_type, unsigned long node_start_pfn, unsigned long node_end_pfn, unsigned long * ignored)' data-ref="zone_absent_pages_in_node">zone_absent_pages_in_node</dfn>(<em>int</em> <dfn class="local col5 decl" id="1055nid" title='nid' data-type='int' data-ref="1055nid">nid</dfn>,</td></tr>
<tr><th id="5791">5791</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1056zone_type" title='zone_type' data-type='unsigned long' data-ref="1056zone_type">zone_type</dfn>,</td></tr>
<tr><th id="5792">5792</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1057node_start_pfn" title='node_start_pfn' data-type='unsigned long' data-ref="1057node_start_pfn">node_start_pfn</dfn>,</td></tr>
<tr><th id="5793">5793</th><td>					<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1058node_end_pfn" title='node_end_pfn' data-type='unsigned long' data-ref="1058node_end_pfn">node_end_pfn</dfn>,</td></tr>
<tr><th id="5794">5794</th><td>					<em>unsigned</em> <em>long</em> *<dfn class="local col9 decl" id="1059ignored" title='ignored' data-type='unsigned long *' data-ref="1059ignored">ignored</dfn>)</td></tr>
<tr><th id="5795">5795</th><td>{</td></tr>
<tr><th id="5796">5796</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1060zone_low" title='zone_low' data-type='unsigned long' data-ref="1060zone_low">zone_low</dfn> = <a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="local col6 ref" href="#1056zone_type" title='zone_type' data-ref="1056zone_type">zone_type</a>];</td></tr>
<tr><th id="5797">5797</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="1061zone_high" title='zone_high' data-type='unsigned long' data-ref="1061zone_high">zone_high</dfn> = <a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>[<a class="local col6 ref" href="#1056zone_type" title='zone_type' data-ref="1056zone_type">zone_type</a>];</td></tr>
<tr><th id="5798">5798</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1062zone_start_pfn" title='zone_start_pfn' data-type='unsigned long' data-ref="1062zone_start_pfn">zone_start_pfn</dfn>, <dfn class="local col3 decl" id="1063zone_end_pfn" title='zone_end_pfn' data-type='unsigned long' data-ref="1063zone_end_pfn">zone_end_pfn</dfn>;</td></tr>
<tr><th id="5799">5799</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1064nr_absent" title='nr_absent' data-type='unsigned long' data-ref="1064nr_absent">nr_absent</dfn>;</td></tr>
<tr><th id="5800">5800</th><td></td></tr>
<tr><th id="5801">5801</th><td>	<i>/* When hotadd a new node from cpu_up(), the node should be empty */</i></td></tr>
<tr><th id="5802">5802</th><td>	<b>if</b> (!<a class="local col7 ref" href="#1057node_start_pfn" title='node_start_pfn' data-ref="1057node_start_pfn">node_start_pfn</a> &amp;&amp; !<a class="local col8 ref" href="#1058node_end_pfn" title='node_end_pfn' data-ref="1058node_end_pfn">node_end_pfn</a>)</td></tr>
<tr><th id="5803">5803</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5804">5804</th><td></td></tr>
<tr><th id="5805">5805</th><td>	<a class="local col2 ref" href="#1062zone_start_pfn" title='zone_start_pfn' data-ref="1062zone_start_pfn">zone_start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(node_start_pfn))({ typeof(node_start_pfn) __UNIQUE_ID_max1_239 = (node_start_pfn); typeof(zone_low) __UNIQUE_ID_max2_240 = (zone_low); (void) (&amp;__UNIQUE_ID_max1_239 == &amp;__UNIQUE_ID_max2_240); __UNIQUE_ID_max1_239 &gt; __UNIQUE_ID_max2_240 ? __UNIQUE_ID_max1_239 : __UNIQUE_ID_max2_240; })) __UNIQUE_ID_min1_241 = ((typeof(node_start_pfn))({ typeof(node_start_pfn) __UNIQUE_ID_max1_239 = (node_start_pfn); typeof(zone_low) __UNIQUE_ID_max2_240 = (zone_low); (void) (&amp;__UNIQUE_ID_max1_239 == &amp;__UNIQUE_ID_max2_240); __UNIQUE_ID_max1_239 &gt; __UNIQUE_ID_max2_240 ? __UNIQUE_ID_max1_239 : __UNIQUE_ID_max2_240; })); typeof(zone_high) __UNIQUE_ID_min2_242 = (zone_high); (void) (&amp;__UNIQUE_ID_min1_241 == &amp;__UNIQUE_ID_min2_242); __UNIQUE_ID_min1_241 &lt; __UNIQUE_ID_min2_242 ? __UNIQUE_ID_min1_241 : __UNIQUE_ID_min2_242; })" data-ref="_M/clamp">clamp</a>(<a class="local col7 ref" href="#1057node_start_pfn" title='node_start_pfn' data-ref="1057node_start_pfn">node_start_pfn</a>, <a class="local col0 ref" href="#1060zone_low" title='zone_low' data-ref="1060zone_low">zone_low</a>, <a class="local col1 ref" href="#1061zone_high" title='zone_high' data-ref="1061zone_high">zone_high</a>);</td></tr>
<tr><th id="5806">5806</th><td>	<a class="local col3 ref" href="#1063zone_end_pfn" title='zone_end_pfn' data-ref="1063zone_end_pfn">zone_end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(node_end_pfn))({ typeof(node_end_pfn) __UNIQUE_ID_max1_247 = (node_end_pfn); typeof(zone_low) __UNIQUE_ID_max2_248 = (zone_low); (void) (&amp;__UNIQUE_ID_max1_247 == &amp;__UNIQUE_ID_max2_248); __UNIQUE_ID_max1_247 &gt; __UNIQUE_ID_max2_248 ? __UNIQUE_ID_max1_247 : __UNIQUE_ID_max2_248; })) __UNIQUE_ID_min1_249 = ((typeof(node_end_pfn))({ typeof(node_end_pfn) __UNIQUE_ID_max1_247 = (node_end_pfn); typeof(zone_low) __UNIQUE_ID_max2_248 = (zone_low); (void) (&amp;__UNIQUE_ID_max1_247 == &amp;__UNIQUE_ID_max2_248); __UNIQUE_ID_max1_247 &gt; __UNIQUE_ID_max2_248 ? __UNIQUE_ID_max1_247 : __UNIQUE_ID_max2_248; })); typeof(zone_high) __UNIQUE_ID_min2_250 = (zone_high); (void) (&amp;__UNIQUE_ID_min1_249 == &amp;__UNIQUE_ID_min2_250); __UNIQUE_ID_min1_249 &lt; __UNIQUE_ID_min2_250 ? __UNIQUE_ID_min1_249 : __UNIQUE_ID_min2_250; })" data-ref="_M/clamp">clamp</a>(<a class="local col8 ref" href="#1058node_end_pfn" title='node_end_pfn' data-ref="1058node_end_pfn">node_end_pfn</a>, <a class="local col0 ref" href="#1060zone_low" title='zone_low' data-ref="1060zone_low">zone_low</a>, <a class="local col1 ref" href="#1061zone_high" title='zone_high' data-ref="1061zone_high">zone_high</a>);</td></tr>
<tr><th id="5807">5807</th><td></td></tr>
<tr><th id="5808">5808</th><td>	<a class="tu ref fn" href="#adjust_zone_range_for_zone_movable" title='adjust_zone_range_for_zone_movable' data-use='c' data-ref="adjust_zone_range_for_zone_movable">adjust_zone_range_for_zone_movable</a>(<a class="local col5 ref" href="#1055nid" title='nid' data-ref="1055nid">nid</a>, <a class="local col6 ref" href="#1056zone_type" title='zone_type' data-ref="1056zone_type">zone_type</a>,</td></tr>
<tr><th id="5809">5809</th><td>			<a class="local col7 ref" href="#1057node_start_pfn" title='node_start_pfn' data-ref="1057node_start_pfn">node_start_pfn</a>, <a class="local col8 ref" href="#1058node_end_pfn" title='node_end_pfn' data-ref="1058node_end_pfn">node_end_pfn</a>,</td></tr>
<tr><th id="5810">5810</th><td>			&amp;<a class="local col2 ref" href="#1062zone_start_pfn" title='zone_start_pfn' data-ref="1062zone_start_pfn">zone_start_pfn</a>, &amp;<a class="local col3 ref" href="#1063zone_end_pfn" title='zone_end_pfn' data-ref="1063zone_end_pfn">zone_end_pfn</a>);</td></tr>
<tr><th id="5811">5811</th><td>	<a class="local col4 ref" href="#1064nr_absent" title='nr_absent' data-ref="1064nr_absent">nr_absent</a> = <a class="ref fn" href="#__absent_pages_in_range" title='__absent_pages_in_range' data-ref="__absent_pages_in_range">__absent_pages_in_range</a>(<a class="local col5 ref" href="#1055nid" title='nid' data-ref="1055nid">nid</a>, <a class="local col2 ref" href="#1062zone_start_pfn" title='zone_start_pfn' data-ref="1062zone_start_pfn">zone_start_pfn</a>, <a class="local col3 ref" href="#1063zone_end_pfn" title='zone_end_pfn' data-ref="1063zone_end_pfn">zone_end_pfn</a>);</td></tr>
<tr><th id="5812">5812</th><td></td></tr>
<tr><th id="5813">5813</th><td>	<i>/*</i></td></tr>
<tr><th id="5814">5814</th><td><i>	 * ZONE_MOVABLE handling.</i></td></tr>
<tr><th id="5815">5815</th><td><i>	 * Treat pages to be ZONE_MOVABLE in ZONE_NORMAL as absent pages</i></td></tr>
<tr><th id="5816">5816</th><td><i>	 * and vice versa.</i></td></tr>
<tr><th id="5817">5817</th><td><i>	 */</i></td></tr>
<tr><th id="5818">5818</th><td>	<b>if</b> (<a class="tu ref" href="#mirrored_kernelcore" title='mirrored_kernelcore' data-use='r' data-ref="mirrored_kernelcore">mirrored_kernelcore</a> &amp;&amp; <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col5 ref" href="#1055nid" title='nid' data-ref="1055nid">nid</a>]) {</td></tr>
<tr><th id="5819">5819</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1065start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1065start_pfn">start_pfn</dfn>, <dfn class="local col6 decl" id="1066end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1066end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="5820">5820</th><td>		<b>struct</b> <a class="type" href="../include/linux/memblock.h.html#memblock_region" title='memblock_region' data-ref="memblock_region">memblock_region</a> *<dfn class="local col7 decl" id="1067r" title='r' data-type='struct memblock_region *' data-ref="1067r">r</dfn>;</td></tr>
<tr><th id="5821">5821</th><td></td></tr>
<tr><th id="5822">5822</th><td>		<a class="macro" href="../include/linux/memblock.h.html#386" title="for (r = memblock.memory.regions; r &lt; (memblock.memory.regions + memblock.memory.cnt); r++)" data-ref="_M/for_each_memblock">for_each_memblock</a>(<a class="ref field" href="../include/linux/memblock.h.html#memblock::memory" title='memblock::memory' data-ref="memblock::memory">memory</a>, <a class="local col7 ref" href="#1067r" title='r' data-ref="1067r">r</a>) {</td></tr>
<tr><th id="5823">5823</th><td>			<a class="local col5 ref" href="#1065start_pfn" title='start_pfn' data-ref="1065start_pfn">start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(memblock_region_memory_base_pfn(r)))({ typeof(memblock_region_memory_base_pfn(r)) __UNIQUE_ID_max1_255 = (memblock_region_memory_base_pfn(r)); typeof(zone_start_pfn) __UNIQUE_ID_max2_256 = (zone_start_pfn); (void) (&amp;__UNIQUE_ID_max1_255 == &amp;__UNIQUE_ID_max2_256); __UNIQUE_ID_max1_255 &gt; __UNIQUE_ID_max2_256 ? __UNIQUE_ID_max1_255 : __UNIQUE_ID_max2_256; })) __UNIQUE_ID_min1_257 = ((typeof(memblock_region_memory_base_pfn(r)))({ typeof(memblock_region_memory_base_pfn(r)) __UNIQUE_ID_max1_255 = (memblock_region_memory_base_pfn(r)); typeof(zone_start_pfn) __UNIQUE_ID_max2_256 = (zone_start_pfn); (void) (&amp;__UNIQUE_ID_max1_255 == &amp;__UNIQUE_ID_max2_256); __UNIQUE_ID_max1_255 &gt; __UNIQUE_ID_max2_256 ? __UNIQUE_ID_max1_255 : __UNIQUE_ID_max2_256; })); typeof(zone_end_pfn) __UNIQUE_ID_min2_258 = (zone_end_pfn); (void) (&amp;__UNIQUE_ID_min1_257 == &amp;__UNIQUE_ID_min2_258); __UNIQUE_ID_min1_257 &lt; __UNIQUE_ID_min2_258 ? __UNIQUE_ID_min1_257 : __UNIQUE_ID_min2_258; })" data-ref="_M/clamp">clamp</a>(<a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_base_pfn" title='memblock_region_memory_base_pfn' data-ref="memblock_region_memory_base_pfn">memblock_region_memory_base_pfn</a>(<a class="local col7 ref" href="#1067r" title='r' data-ref="1067r">r</a>),</td></tr>
<tr><th id="5824">5824</th><td>					  <a class="local col2 ref" href="#1062zone_start_pfn" title='zone_start_pfn' data-ref="1062zone_start_pfn">zone_start_pfn</a>, <a class="local col3 ref" href="#1063zone_end_pfn" title='zone_end_pfn' data-ref="1063zone_end_pfn">zone_end_pfn</a>);</td></tr>
<tr><th id="5825">5825</th><td>			<a class="local col6 ref" href="#1066end_pfn" title='end_pfn' data-ref="1066end_pfn">end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(memblock_region_memory_end_pfn(r)))({ typeof(memblock_region_memory_end_pfn(r)) __UNIQUE_ID_max1_263 = (memblock_region_memory_end_pfn(r)); typeof(zone_start_pfn) __UNIQUE_ID_max2_264 = (zone_start_pfn); (void) (&amp;__UNIQUE_ID_max1_263 == &amp;__UNIQUE_ID_max2_264); __UNIQUE_ID_max1_263 &gt; __UNIQUE_ID_max2_264 ? __UNIQUE_ID_max1_263 : __UNIQUE_ID_max2_264; })) __UNIQUE_ID_min1_265 = ((typeof(memblock_region_memory_end_pfn(r)))({ typeof(memblock_region_memory_end_pfn(r)) __UNIQUE_ID_max1_263 = (memblock_region_memory_end_pfn(r)); typeof(zone_start_pfn) __UNIQUE_ID_max2_264 = (zone_start_pfn); (void) (&amp;__UNIQUE_ID_max1_263 == &amp;__UNIQUE_ID_max2_264); __UNIQUE_ID_max1_263 &gt; __UNIQUE_ID_max2_264 ? __UNIQUE_ID_max1_263 : __UNIQUE_ID_max2_264; })); typeof(zone_end_pfn) __UNIQUE_ID_min2_266 = (zone_end_pfn); (void) (&amp;__UNIQUE_ID_min1_265 == &amp;__UNIQUE_ID_min2_266); __UNIQUE_ID_min1_265 &lt; __UNIQUE_ID_min2_266 ? __UNIQUE_ID_min1_265 : __UNIQUE_ID_min2_266; })" data-ref="_M/clamp">clamp</a>(<a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_end_pfn" title='memblock_region_memory_end_pfn' data-ref="memblock_region_memory_end_pfn">memblock_region_memory_end_pfn</a>(<a class="local col7 ref" href="#1067r" title='r' data-ref="1067r">r</a>),</td></tr>
<tr><th id="5826">5826</th><td>					<a class="local col2 ref" href="#1062zone_start_pfn" title='zone_start_pfn' data-ref="1062zone_start_pfn">zone_start_pfn</a>, <a class="local col3 ref" href="#1063zone_end_pfn" title='zone_end_pfn' data-ref="1063zone_end_pfn">zone_end_pfn</a>);</td></tr>
<tr><th id="5827">5827</th><td></td></tr>
<tr><th id="5828">5828</th><td>			<b>if</b> (<a class="local col6 ref" href="#1056zone_type" title='zone_type' data-ref="1056zone_type">zone_type</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a> &amp;&amp;</td></tr>
<tr><th id="5829">5829</th><td>			    <a class="ref fn" href="../include/linux/memblock.h.html#memblock_is_mirror" title='memblock_is_mirror' data-ref="memblock_is_mirror">memblock_is_mirror</a>(<a class="local col7 ref" href="#1067r" title='r' data-ref="1067r">r</a>))</td></tr>
<tr><th id="5830">5830</th><td>				<a class="local col4 ref" href="#1064nr_absent" title='nr_absent' data-ref="1064nr_absent">nr_absent</a> += <a class="local col6 ref" href="#1066end_pfn" title='end_pfn' data-ref="1066end_pfn">end_pfn</a> - <a class="local col5 ref" href="#1065start_pfn" title='start_pfn' data-ref="1065start_pfn">start_pfn</a>;</td></tr>
<tr><th id="5831">5831</th><td></td></tr>
<tr><th id="5832">5832</th><td>			<b>if</b> (<a class="local col6 ref" href="#1056zone_type" title='zone_type' data-ref="1056zone_type">zone_type</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_NORMAL" title='ZONE_NORMAL' data-ref="ZONE_NORMAL">ZONE_NORMAL</a> &amp;&amp;</td></tr>
<tr><th id="5833">5833</th><td>			    !<a class="ref fn" href="../include/linux/memblock.h.html#memblock_is_mirror" title='memblock_is_mirror' data-ref="memblock_is_mirror">memblock_is_mirror</a>(<a class="local col7 ref" href="#1067r" title='r' data-ref="1067r">r</a>))</td></tr>
<tr><th id="5834">5834</th><td>				<a class="local col4 ref" href="#1064nr_absent" title='nr_absent' data-ref="1064nr_absent">nr_absent</a> += <a class="local col6 ref" href="#1066end_pfn" title='end_pfn' data-ref="1066end_pfn">end_pfn</a> - <a class="local col5 ref" href="#1065start_pfn" title='start_pfn' data-ref="1065start_pfn">start_pfn</a>;</td></tr>
<tr><th id="5835">5835</th><td>		}</td></tr>
<tr><th id="5836">5836</th><td>	}</td></tr>
<tr><th id="5837">5837</th><td></td></tr>
<tr><th id="5838">5838</th><td>	<b>return</b> <a class="local col4 ref" href="#1064nr_absent" title='nr_absent' data-ref="1064nr_absent">nr_absent</a>;</td></tr>
<tr><th id="5839">5839</th><td>}</td></tr>
<tr><th id="5840">5840</th><td></td></tr>
<tr><th id="5841">5841</th><td><u>#<span data-ppcond="5567">else</span> /* CONFIG_HAVE_MEMBLOCK_NODE_MAP */</u></td></tr>
<tr><th id="5842">5842</th><td><em>static</em> <b>inline</b> <em>unsigned</em> <em>long</em> __meminit zone_spanned_pages_in_node(<em>int</em> nid,</td></tr>
<tr><th id="5843">5843</th><td>					<em>unsigned</em> <em>long</em> zone_type,</td></tr>
<tr><th id="5844">5844</th><td>					<em>unsigned</em> <em>long</em> node_start_pfn,</td></tr>
<tr><th id="5845">5845</th><td>					<em>unsigned</em> <em>long</em> node_end_pfn,</td></tr>
<tr><th id="5846">5846</th><td>					<em>unsigned</em> <em>long</em> *zone_start_pfn,</td></tr>
<tr><th id="5847">5847</th><td>					<em>unsigned</em> <em>long</em> *zone_end_pfn,</td></tr>
<tr><th id="5848">5848</th><td>					<em>unsigned</em> <em>long</em> *zones_size)</td></tr>
<tr><th id="5849">5849</th><td>{</td></tr>
<tr><th id="5850">5850</th><td>	<em>unsigned</em> <em>int</em> zone;</td></tr>
<tr><th id="5851">5851</th><td></td></tr>
<tr><th id="5852">5852</th><td>	*zone_start_pfn = node_start_pfn;</td></tr>
<tr><th id="5853">5853</th><td>	<b>for</b> (zone = <var>0</var>; zone &lt; zone_type; zone++)</td></tr>
<tr><th id="5854">5854</th><td>		*zone_start_pfn += zones_size[zone];</td></tr>
<tr><th id="5855">5855</th><td></td></tr>
<tr><th id="5856">5856</th><td>	*zone_end_pfn = *zone_start_pfn + zones_size[zone_type];</td></tr>
<tr><th id="5857">5857</th><td></td></tr>
<tr><th id="5858">5858</th><td>	<b>return</b> zones_size[zone_type];</td></tr>
<tr><th id="5859">5859</th><td>}</td></tr>
<tr><th id="5860">5860</th><td></td></tr>
<tr><th id="5861">5861</th><td><em>static</em> <b>inline</b> <em>unsigned</em> <em>long</em> __meminit zone_absent_pages_in_node(<em>int</em> nid,</td></tr>
<tr><th id="5862">5862</th><td>						<em>unsigned</em> <em>long</em> zone_type,</td></tr>
<tr><th id="5863">5863</th><td>						<em>unsigned</em> <em>long</em> node_start_pfn,</td></tr>
<tr><th id="5864">5864</th><td>						<em>unsigned</em> <em>long</em> node_end_pfn,</td></tr>
<tr><th id="5865">5865</th><td>						<em>unsigned</em> <em>long</em> *zholes_size)</td></tr>
<tr><th id="5866">5866</th><td>{</td></tr>
<tr><th id="5867">5867</th><td>	<b>if</b> (!zholes_size)</td></tr>
<tr><th id="5868">5868</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5869">5869</th><td></td></tr>
<tr><th id="5870">5870</th><td>	<b>return</b> zholes_size[zone_type];</td></tr>
<tr><th id="5871">5871</th><td>}</td></tr>
<tr><th id="5872">5872</th><td></td></tr>
<tr><th id="5873">5873</th><td><u>#<span data-ppcond="5567">endif</span> /* CONFIG_HAVE_MEMBLOCK_NODE_MAP */</u></td></tr>
<tr><th id="5874">5874</th><td></td></tr>
<tr><th id="5875">5875</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="tu decl def fn" id="calculate_node_totalpages" title='calculate_node_totalpages' data-type='void calculate_node_totalpages(struct pglist_data * pgdat, unsigned long node_start_pfn, unsigned long node_end_pfn, unsigned long * zones_size, unsigned long * zholes_size)' data-ref="calculate_node_totalpages">calculate_node_totalpages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col8 decl" id="1068pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1068pgdat">pgdat</dfn>,</td></tr>
<tr><th id="5876">5876</th><td>						<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1069node_start_pfn" title='node_start_pfn' data-type='unsigned long' data-ref="1069node_start_pfn">node_start_pfn</dfn>,</td></tr>
<tr><th id="5877">5877</th><td>						<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1070node_end_pfn" title='node_end_pfn' data-type='unsigned long' data-ref="1070node_end_pfn">node_end_pfn</dfn>,</td></tr>
<tr><th id="5878">5878</th><td>						<em>unsigned</em> <em>long</em> *<dfn class="local col1 decl" id="1071zones_size" title='zones_size' data-type='unsigned long *' data-ref="1071zones_size">zones_size</dfn>,</td></tr>
<tr><th id="5879">5879</th><td>						<em>unsigned</em> <em>long</em> *<dfn class="local col2 decl" id="1072zholes_size" title='zholes_size' data-type='unsigned long *' data-ref="1072zholes_size">zholes_size</dfn>)</td></tr>
<tr><th id="5880">5880</th><td>{</td></tr>
<tr><th id="5881">5881</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="1073realtotalpages" title='realtotalpages' data-type='unsigned long' data-ref="1073realtotalpages">realtotalpages</dfn> = <var>0</var>, <dfn class="local col4 decl" id="1074totalpages" title='totalpages' data-type='unsigned long' data-ref="1074totalpages">totalpages</dfn> = <var>0</var>;</td></tr>
<tr><th id="5882">5882</th><td>	<b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#zone_type" title='zone_type' data-ref="zone_type">zone_type</a> <dfn class="local col5 decl" id="1075i" title='i' data-type='enum zone_type' data-ref="1075i">i</dfn>;</td></tr>
<tr><th id="5883">5883</th><td></td></tr>
<tr><th id="5884">5884</th><td>	<b>for</b> (<a class="local col5 ref" href="#1075i" title='i' data-ref="1075i">i</a> = <var>0</var>; <a class="local col5 ref" href="#1075i" title='i' data-ref="1075i">i</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col5 ref" href="#1075i" title='i' data-ref="1075i">i</a>++) {</td></tr>
<tr><th id="5885">5885</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="1076zone" title='zone' data-type='struct zone *' data-ref="1076zone">zone</dfn> = <a class="local col8 ref" href="#1068pgdat" title='pgdat' data-ref="1068pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a> + <a class="local col5 ref" href="#1075i" title='i' data-ref="1075i">i</a>;</td></tr>
<tr><th id="5886">5886</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1077zone_start_pfn" title='zone_start_pfn' data-type='unsigned long' data-ref="1077zone_start_pfn">zone_start_pfn</dfn>, <dfn class="local col8 decl" id="1078zone_end_pfn" title='zone_end_pfn' data-type='unsigned long' data-ref="1078zone_end_pfn">zone_end_pfn</dfn>;</td></tr>
<tr><th id="5887">5887</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1079size" title='size' data-type='unsigned long' data-ref="1079size">size</dfn>, <dfn class="local col0 decl" id="1080real_size" title='real_size' data-type='unsigned long' data-ref="1080real_size">real_size</dfn>;</td></tr>
<tr><th id="5888">5888</th><td></td></tr>
<tr><th id="5889">5889</th><td>		<a class="local col9 ref" href="#1079size" title='size' data-ref="1079size">size</a> = <a class="tu ref fn" href="#zone_spanned_pages_in_node" title='zone_spanned_pages_in_node' data-use='c' data-ref="zone_spanned_pages_in_node">zone_spanned_pages_in_node</a>(<a class="local col8 ref" href="#1068pgdat" title='pgdat' data-ref="1068pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>, <a class="local col5 ref" href="#1075i" title='i' data-ref="1075i">i</a>,</td></tr>
<tr><th id="5890">5890</th><td>						  <a class="local col9 ref" href="#1069node_start_pfn" title='node_start_pfn' data-ref="1069node_start_pfn">node_start_pfn</a>,</td></tr>
<tr><th id="5891">5891</th><td>						  <a class="local col0 ref" href="#1070node_end_pfn" title='node_end_pfn' data-ref="1070node_end_pfn">node_end_pfn</a>,</td></tr>
<tr><th id="5892">5892</th><td>						  &amp;<a class="local col7 ref" href="#1077zone_start_pfn" title='zone_start_pfn' data-ref="1077zone_start_pfn">zone_start_pfn</a>,</td></tr>
<tr><th id="5893">5893</th><td>						  &amp;<a class="local col8 ref" href="#1078zone_end_pfn" title='zone_end_pfn' data-ref="1078zone_end_pfn">zone_end_pfn</a>,</td></tr>
<tr><th id="5894">5894</th><td>						  <a class="local col1 ref" href="#1071zones_size" title='zones_size' data-ref="1071zones_size">zones_size</a>);</td></tr>
<tr><th id="5895">5895</th><td>		<a class="local col0 ref" href="#1080real_size" title='real_size' data-ref="1080real_size">real_size</a> = <a class="local col9 ref" href="#1079size" title='size' data-ref="1079size">size</a> - <a class="tu ref fn" href="#zone_absent_pages_in_node" title='zone_absent_pages_in_node' data-use='c' data-ref="zone_absent_pages_in_node">zone_absent_pages_in_node</a>(<a class="local col8 ref" href="#1068pgdat" title='pgdat' data-ref="1068pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>, <a class="local col5 ref" href="#1075i" title='i' data-ref="1075i">i</a>,</td></tr>
<tr><th id="5896">5896</th><td>						  <a class="local col9 ref" href="#1069node_start_pfn" title='node_start_pfn' data-ref="1069node_start_pfn">node_start_pfn</a>, <a class="local col0 ref" href="#1070node_end_pfn" title='node_end_pfn' data-ref="1070node_end_pfn">node_end_pfn</a>,</td></tr>
<tr><th id="5897">5897</th><td>						  <a class="local col2 ref" href="#1072zholes_size" title='zholes_size' data-ref="1072zholes_size">zholes_size</a>);</td></tr>
<tr><th id="5898">5898</th><td>		<b>if</b> (<a class="local col9 ref" href="#1079size" title='size' data-ref="1079size">size</a>)</td></tr>
<tr><th id="5899">5899</th><td>			<a class="local col6 ref" href="#1076zone" title='zone' data-ref="1076zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_start_pfn" title='zone::zone_start_pfn' data-ref="zone::zone_start_pfn">zone_start_pfn</a> = <a class="local col7 ref" href="#1077zone_start_pfn" title='zone_start_pfn' data-ref="1077zone_start_pfn">zone_start_pfn</a>;</td></tr>
<tr><th id="5900">5900</th><td>		<b>else</b></td></tr>
<tr><th id="5901">5901</th><td>			<a class="local col6 ref" href="#1076zone" title='zone' data-ref="1076zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_start_pfn" title='zone::zone_start_pfn' data-ref="zone::zone_start_pfn">zone_start_pfn</a> = <var>0</var>;</td></tr>
<tr><th id="5902">5902</th><td>		<a class="local col6 ref" href="#1076zone" title='zone' data-ref="1076zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::spanned_pages" title='zone::spanned_pages' data-ref="zone::spanned_pages">spanned_pages</a> = <a class="local col9 ref" href="#1079size" title='size' data-ref="1079size">size</a>;</td></tr>
<tr><th id="5903">5903</th><td>		<a class="local col6 ref" href="#1076zone" title='zone' data-ref="1076zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::present_pages" title='zone::present_pages' data-ref="zone::present_pages">present_pages</a> = <a class="local col0 ref" href="#1080real_size" title='real_size' data-ref="1080real_size">real_size</a>;</td></tr>
<tr><th id="5904">5904</th><td></td></tr>
<tr><th id="5905">5905</th><td>		<a class="local col4 ref" href="#1074totalpages" title='totalpages' data-ref="1074totalpages">totalpages</a> += <a class="local col9 ref" href="#1079size" title='size' data-ref="1079size">size</a>;</td></tr>
<tr><th id="5906">5906</th><td>		<a class="local col3 ref" href="#1073realtotalpages" title='realtotalpages' data-ref="1073realtotalpages">realtotalpages</a> += <a class="local col0 ref" href="#1080real_size" title='real_size' data-ref="1080real_size">real_size</a>;</td></tr>
<tr><th id="5907">5907</th><td>	}</td></tr>
<tr><th id="5908">5908</th><td></td></tr>
<tr><th id="5909">5909</th><td>	<a class="local col8 ref" href="#1068pgdat" title='pgdat' data-ref="1068pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_spanned_pages" title='pglist_data::node_spanned_pages' data-ref="pglist_data::node_spanned_pages">node_spanned_pages</a> = <a class="local col4 ref" href="#1074totalpages" title='totalpages' data-ref="1074totalpages">totalpages</a>;</td></tr>
<tr><th id="5910">5910</th><td>	<a class="local col8 ref" href="#1068pgdat" title='pgdat' data-ref="1068pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_present_pages" title='pglist_data::node_present_pages' data-ref="pglist_data::node_present_pages">node_present_pages</a> = <a class="local col3 ref" href="#1073realtotalpages" title='realtotalpages' data-ref="1073realtotalpages">realtotalpages</a>;</td></tr>
<tr><th id="5911">5911</th><td>	<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#15" title="&quot;\001&quot; &quot;7&quot;" data-ref="_M/KERN_DEBUG">KERN_DEBUG</a> <q>"On node %d totalpages: %lu\n"</q>, <a class="local col8 ref" href="#1068pgdat" title='pgdat' data-ref="1068pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>,</td></tr>
<tr><th id="5912">5912</th><td>							<a class="local col3 ref" href="#1073realtotalpages" title='realtotalpages' data-ref="1073realtotalpages">realtotalpages</a>);</td></tr>
<tr><th id="5913">5913</th><td>}</td></tr>
<tr><th id="5914">5914</th><td></td></tr>
<tr><th id="5915">5915</th><td><u>#<span data-ppcond="5915">ifndef</span> <a class="macro" href="../include/generated/autoconf.h.html#950" data-ref="_M/CONFIG_SPARSEMEM">CONFIG_SPARSEMEM</a></u></td></tr>
<tr><th id="5916">5916</th><td><i>/*</i></td></tr>
<tr><th id="5917">5917</th><td><i> * Calculate the size of the zone-&gt;blockflags rounded to an unsigned long</i></td></tr>
<tr><th id="5918">5918</th><td><i> * Start by making sure zonesize is a multiple of pageblock_order by rounding</i></td></tr>
<tr><th id="5919">5919</th><td><i> * up. Then use 1 NR_PAGEBLOCK_BITS worth of bits per pageblock, finally</i></td></tr>
<tr><th id="5920">5920</th><td><i> * round what is now in bits to nearest long in bits, then return it in</i></td></tr>
<tr><th id="5921">5921</th><td><i> * bytes.</i></td></tr>
<tr><th id="5922">5922</th><td><i> */</i></td></tr>
<tr><th id="5923">5923</th><td><em>static</em> <em>unsigned</em> <em>long</em> __init usemap_size(<em>unsigned</em> <em>long</em> zone_start_pfn, <em>unsigned</em> <em>long</em> zonesize)</td></tr>
<tr><th id="5924">5924</th><td>{</td></tr>
<tr><th id="5925">5925</th><td>	<em>unsigned</em> <em>long</em> usemapsize;</td></tr>
<tr><th id="5926">5926</th><td></td></tr>
<tr><th id="5927">5927</th><td>	zonesize += zone_start_pfn &amp; (pageblock_nr_pages-<var>1</var>);</td></tr>
<tr><th id="5928">5928</th><td>	usemapsize = roundup(zonesize, pageblock_nr_pages);</td></tr>
<tr><th id="5929">5929</th><td>	usemapsize = usemapsize &gt;&gt; pageblock_order;</td></tr>
<tr><th id="5930">5930</th><td>	usemapsize *= NR_PAGEBLOCK_BITS;</td></tr>
<tr><th id="5931">5931</th><td>	usemapsize = roundup(usemapsize, <var>8</var> * <b>sizeof</b>(<em>unsigned</em> <em>long</em>));</td></tr>
<tr><th id="5932">5932</th><td></td></tr>
<tr><th id="5933">5933</th><td>	<b>return</b> usemapsize / <var>8</var>;</td></tr>
<tr><th id="5934">5934</th><td>}</td></tr>
<tr><th id="5935">5935</th><td></td></tr>
<tr><th id="5936">5936</th><td><em>static</em> <em>void</em> __init setup_usemap(<b>struct</b> pglist_data *pgdat,</td></tr>
<tr><th id="5937">5937</th><td>				<b>struct</b> zone *zone,</td></tr>
<tr><th id="5938">5938</th><td>				<em>unsigned</em> <em>long</em> zone_start_pfn,</td></tr>
<tr><th id="5939">5939</th><td>				<em>unsigned</em> <em>long</em> zonesize)</td></tr>
<tr><th id="5940">5940</th><td>{</td></tr>
<tr><th id="5941">5941</th><td>	<em>unsigned</em> <em>long</em> usemapsize = usemap_size(zone_start_pfn, zonesize);</td></tr>
<tr><th id="5942">5942</th><td>	zone-&gt;pageblock_flags = NULL;</td></tr>
<tr><th id="5943">5943</th><td>	<b>if</b> (usemapsize)</td></tr>
<tr><th id="5944">5944</th><td>		zone-&gt;pageblock_flags =</td></tr>
<tr><th id="5945">5945</th><td>			memblock_virt_alloc_node_nopanic(usemapsize,</td></tr>
<tr><th id="5946">5946</th><td>							 pgdat-&gt;node_id);</td></tr>
<tr><th id="5947">5947</th><td>}</td></tr>
<tr><th id="5948">5948</th><td><u>#<span data-ppcond="5915">else</span></u></td></tr>
<tr><th id="5949">5949</th><td><em>static</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#95" title="inline __attribute__((always_inline, unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>void</em> <dfn class="tu decl def fn" id="setup_usemap" title='setup_usemap' data-type='void setup_usemap(struct pglist_data * pgdat, struct zone * zone, unsigned long zone_start_pfn, unsigned long zonesize)' data-ref="setup_usemap">setup_usemap</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col1 decl" id="1081pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1081pgdat">pgdat</dfn>, <b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="1082zone" title='zone' data-type='struct zone *' data-ref="1082zone">zone</dfn>,</td></tr>
<tr><th id="5950">5950</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="1083zone_start_pfn" title='zone_start_pfn' data-type='unsigned long' data-ref="1083zone_start_pfn">zone_start_pfn</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1084zonesize" title='zonesize' data-type='unsigned long' data-ref="1084zonesize">zonesize</dfn>) {}</td></tr>
<tr><th id="5951">5951</th><td><u>#<span data-ppcond="5915">endif</span> /* CONFIG_SPARSEMEM */</u></td></tr>
<tr><th id="5952">5952</th><td></td></tr>
<tr><th id="5953">5953</th><td><u>#<span data-ppcond="5953">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HUGETLB_PAGE_SIZE_VARIABLE">CONFIG_HUGETLB_PAGE_SIZE_VARIABLE</span></u></td></tr>
<tr><th id="5954">5954</th><td></td></tr>
<tr><th id="5955">5955</th><td><i>/* Initialise the number of pages represented by NR_PAGEBLOCK_BITS */</i></td></tr>
<tr><th id="5956">5956</th><td><em>void</em> __paginginit set_pageblock_order(<em>void</em>)</td></tr>
<tr><th id="5957">5957</th><td>{</td></tr>
<tr><th id="5958">5958</th><td>	<em>unsigned</em> <em>int</em> order;</td></tr>
<tr><th id="5959">5959</th><td></td></tr>
<tr><th id="5960">5960</th><td>	<i>/* Check that pageblock_nr_pages has not already been setup */</i></td></tr>
<tr><th id="5961">5961</th><td>	<b>if</b> (pageblock_order)</td></tr>
<tr><th id="5962">5962</th><td>		<b>return</b>;</td></tr>
<tr><th id="5963">5963</th><td></td></tr>
<tr><th id="5964">5964</th><td>	<b>if</b> (HPAGE_SHIFT &gt; PAGE_SHIFT)</td></tr>
<tr><th id="5965">5965</th><td>		order = HUGETLB_PAGE_ORDER;</td></tr>
<tr><th id="5966">5966</th><td>	<b>else</b></td></tr>
<tr><th id="5967">5967</th><td>		order = MAX_ORDER - <var>1</var>;</td></tr>
<tr><th id="5968">5968</th><td></td></tr>
<tr><th id="5969">5969</th><td>	<i>/*</i></td></tr>
<tr><th id="5970">5970</th><td><i>	 * Assume the largest contiguous order of interest is a huge page.</i></td></tr>
<tr><th id="5971">5971</th><td><i>	 * This value may be variable depending on boot parameters on IA64 and</i></td></tr>
<tr><th id="5972">5972</th><td><i>	 * powerpc.</i></td></tr>
<tr><th id="5973">5973</th><td><i>	 */</i></td></tr>
<tr><th id="5974">5974</th><td>	pageblock_order = order;</td></tr>
<tr><th id="5975">5975</th><td>}</td></tr>
<tr><th id="5976">5976</th><td><u>#<span data-ppcond="5953">else</span> /* CONFIG_HUGETLB_PAGE_SIZE_VARIABLE */</u></td></tr>
<tr><th id="5977">5977</th><td></td></tr>
<tr><th id="5978">5978</th><td><i>/*</i></td></tr>
<tr><th id="5979">5979</th><td><i> * When CONFIG_HUGETLB_PAGE_SIZE_VARIABLE is not set, set_pageblock_order()</i></td></tr>
<tr><th id="5980">5980</th><td><i> * is unused as pageblock_order is set at compile-time. See</i></td></tr>
<tr><th id="5981">5981</th><td><i> * include/linux/pageblock-flags.h for the values of pageblock_order based on</i></td></tr>
<tr><th id="5982">5982</th><td><i> * the kernel config</i></td></tr>
<tr><th id="5983">5983</th><td><i> */</i></td></tr>
<tr><th id="5984">5984</th><td><em>void</em> <a class="macro" href="internal.h.html#398" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__paginginit">__paginginit</a> <dfn class="decl def fn" id="set_pageblock_order" title='set_pageblock_order' data-ref="set_pageblock_order">set_pageblock_order</dfn>(<em>void</em>)</td></tr>
<tr><th id="5985">5985</th><td>{</td></tr>
<tr><th id="5986">5986</th><td>}</td></tr>
<tr><th id="5987">5987</th><td></td></tr>
<tr><th id="5988">5988</th><td><u>#<span data-ppcond="5953">endif</span> /* CONFIG_HUGETLB_PAGE_SIZE_VARIABLE */</u></td></tr>
<tr><th id="5989">5989</th><td></td></tr>
<tr><th id="5990">5990</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="internal.h.html#398" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__paginginit">__paginginit</a> <dfn class="tu decl def fn" id="calc_memmap_size" title='calc_memmap_size' data-type='unsigned long calc_memmap_size(unsigned long spanned_pages, unsigned long present_pages)' data-ref="calc_memmap_size">calc_memmap_size</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1085spanned_pages" title='spanned_pages' data-type='unsigned long' data-ref="1085spanned_pages">spanned_pages</dfn>,</td></tr>
<tr><th id="5991">5991</th><td>						   <em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1086present_pages" title='present_pages' data-type='unsigned long' data-ref="1086present_pages">present_pages</dfn>)</td></tr>
<tr><th id="5992">5992</th><td>{</td></tr>
<tr><th id="5993">5993</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1087pages" title='pages' data-type='unsigned long' data-ref="1087pages">pages</dfn> = <a class="local col5 ref" href="#1085spanned_pages" title='spanned_pages' data-ref="1085spanned_pages">spanned_pages</a>;</td></tr>
<tr><th id="5994">5994</th><td></td></tr>
<tr><th id="5995">5995</th><td>	<i>/*</i></td></tr>
<tr><th id="5996">5996</th><td><i>	 * Provide a more accurate estimation if there are holes within</i></td></tr>
<tr><th id="5997">5997</th><td><i>	 * the zone and SPARSEMEM is in use. If there are holes within the</i></td></tr>
<tr><th id="5998">5998</th><td><i>	 * zone, each populated memory region may cost us one or two extra</i></td></tr>
<tr><th id="5999">5999</th><td><i>	 * memmap pages due to alignment because memmap pages for each</i></td></tr>
<tr><th id="6000">6000</th><td><i>	 * populated regions may not be naturally aligned on page boundary.</i></td></tr>
<tr><th id="6001">6001</th><td><i>	 * So the (present_pages &gt;&gt; 4) heuristic is a tradeoff for that.</i></td></tr>
<tr><th id="6002">6002</th><td><i>	 */</i></td></tr>
<tr><th id="6003">6003</th><td>	<b>if</b> (<a class="local col5 ref" href="#1085spanned_pages" title='spanned_pages' data-ref="1085spanned_pages">spanned_pages</a> &gt; <a class="local col6 ref" href="#1086present_pages" title='present_pages' data-ref="1086present_pages">present_pages</a> + (<a class="local col6 ref" href="#1086present_pages" title='present_pages' data-ref="1086present_pages">present_pages</a> &gt;&gt; <var>4</var>) &amp;&amp;</td></tr>
<tr><th id="6004">6004</th><td>	    <a class="macro" href="../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../include/generated/autoconf.h.html#950" title="1" data-ref="_M/CONFIG_SPARSEMEM">CONFIG_SPARSEMEM</a>))</td></tr>
<tr><th id="6005">6005</th><td>		<a class="local col7 ref" href="#1087pages" title='pages' data-ref="1087pages">pages</a> = <a class="local col6 ref" href="#1086present_pages" title='present_pages' data-ref="1086present_pages">present_pages</a>;</td></tr>
<tr><th id="6006">6006</th><td></td></tr>
<tr><th id="6007">6007</th><td>	<b>return</b> <a class="macro" href="../include/linux/mm.h.html#134" title="((((pages * sizeof(struct page))) + ((typeof((pages * sizeof(struct page))))((((1UL) &lt;&lt; 12))) - 1)) &amp; ~((typeof((pages * sizeof(struct page))))((((1UL) &lt;&lt; 12))) - 1))" data-ref="_M/PAGE_ALIGN">PAGE_ALIGN</a>(<a class="local col7 ref" href="#1087pages" title='pages' data-ref="1087pages">pages</a> * <b>sizeof</b>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a>)) &gt;&gt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>;</td></tr>
<tr><th id="6008">6008</th><td>}</td></tr>
<tr><th id="6009">6009</th><td></td></tr>
<tr><th id="6010">6010</th><td><i  data-doc="free_area_init_core">/*</i></td></tr>
<tr><th id="6011">6011</th><td><i  data-doc="free_area_init_core"> * Set up the zone data structures:</i></td></tr>
<tr><th id="6012">6012</th><td><i  data-doc="free_area_init_core"> *   - mark all pages reserved</i></td></tr>
<tr><th id="6013">6013</th><td><i  data-doc="free_area_init_core"> *   - mark all memory queues empty</i></td></tr>
<tr><th id="6014">6014</th><td><i  data-doc="free_area_init_core"> *   - clear the memory bitmaps</i></td></tr>
<tr><th id="6015">6015</th><td><i  data-doc="free_area_init_core"> *</i></td></tr>
<tr><th id="6016">6016</th><td><i  data-doc="free_area_init_core"> * NOTE: pgdat should get zeroed by caller.</i></td></tr>
<tr><th id="6017">6017</th><td><i  data-doc="free_area_init_core"> */</i></td></tr>
<tr><th id="6018">6018</th><td><em>static</em> <em>void</em> <a class="macro" href="internal.h.html#398" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__paginginit">__paginginit</a> <dfn class="tu decl def fn" id="free_area_init_core" title='free_area_init_core' data-type='void free_area_init_core(struct pglist_data * pgdat)' data-ref="free_area_init_core">free_area_init_core</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col8 decl" id="1088pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1088pgdat">pgdat</dfn>)</td></tr>
<tr><th id="6019">6019</th><td>{</td></tr>
<tr><th id="6020">6020</th><td>	<b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#zone_type" title='zone_type' data-ref="zone_type">zone_type</a> <dfn class="local col9 decl" id="1089j" title='j' data-type='enum zone_type' data-ref="1089j">j</dfn>;</td></tr>
<tr><th id="6021">6021</th><td>	<em>int</em> <dfn class="local col0 decl" id="1090nid" title='nid' data-type='int' data-ref="1090nid">nid</dfn> = <a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a>;</td></tr>
<tr><th id="6022">6022</th><td></td></tr>
<tr><th id="6023">6023</th><td>	<a class="ref fn" href="../include/linux/memory_hotplug.h.html#pgdat_resize_init" title='pgdat_resize_init' data-ref="pgdat_resize_init">pgdat_resize_init</a>(<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>);</td></tr>
<tr><th id="6024">6024</th><td><u>#<span data-ppcond="6024">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA_BALANCING">CONFIG_NUMA_BALANCING</span></u></td></tr>
<tr><th id="6025">6025</th><td>	spin_lock_init(&amp;pgdat-&gt;numabalancing_migrate_lock);</td></tr>
<tr><th id="6026">6026</th><td>	pgdat-&gt;numabalancing_migrate_nr_pages = <var>0</var>;</td></tr>
<tr><th id="6027">6027</th><td>	pgdat-&gt;numabalancing_migrate_next_window = jiffies;</td></tr>
<tr><th id="6028">6028</th><td><u>#<span data-ppcond="6024">endif</span></u></td></tr>
<tr><th id="6029">6029</th><td><u>#<span data-ppcond="6029">ifdef</span> <span class="macro" data-ref="_M/CONFIG_TRANSPARENT_HUGEPAGE">CONFIG_TRANSPARENT_HUGEPAGE</span></u></td></tr>
<tr><th id="6030">6030</th><td>	spin_lock_init(&amp;pgdat-&gt;split_queue_lock);</td></tr>
<tr><th id="6031">6031</th><td>	INIT_LIST_HEAD(&amp;pgdat-&gt;split_queue);</td></tr>
<tr><th id="6032">6032</th><td>	pgdat-&gt;split_queue_len = <var>0</var>;</td></tr>
<tr><th id="6033">6033</th><td><u>#<span data-ppcond="6029">endif</span></u></td></tr>
<tr><th id="6034">6034</th><td>	<a class="macro" href="../include/linux/wait.h.html#63" title="do { static struct lock_class_key __key; __init_waitqueue_head((&amp;pgdat-&gt;kswapd_wait), &quot;&amp;pgdat-&gt;kswapd_wait&quot;, &amp;__key); } while (0)" data-ref="_M/init_waitqueue_head">init_waitqueue_head</a>(&amp;<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::kswapd_wait" title='pglist_data::kswapd_wait' data-ref="pglist_data::kswapd_wait">kswapd_wait</a>);</td></tr>
<tr><th id="6035">6035</th><td>	<a class="macro" href="../include/linux/wait.h.html#63" title="do { static struct lock_class_key __key; __init_waitqueue_head((&amp;pgdat-&gt;pfmemalloc_wait), &quot;&amp;pgdat-&gt;pfmemalloc_wait&quot;, &amp;__key); } while (0)" data-ref="_M/init_waitqueue_head">init_waitqueue_head</a>(&amp;<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::pfmemalloc_wait" title='pglist_data::pfmemalloc_wait' data-ref="pglist_data::pfmemalloc_wait">pfmemalloc_wait</a>);</td></tr>
<tr><th id="6036">6036</th><td><u>#<span data-ppcond="6036">ifdef</span> <span class="macro" data-ref="_M/CONFIG_COMPACTION">CONFIG_COMPACTION</span></u></td></tr>
<tr><th id="6037">6037</th><td>	init_waitqueue_head(&amp;pgdat-&gt;kcompactd_wait);</td></tr>
<tr><th id="6038">6038</th><td><u>#<span data-ppcond="6036">endif</span></u></td></tr>
<tr><th id="6039">6039</th><td>	<a class="ref fn" href="../include/linux/page_ext.h.html#pgdat_page_ext_init" title='pgdat_page_ext_init' data-ref="pgdat_page_ext_init">pgdat_page_ext_init</a>(<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>);</td></tr>
<tr><th id="6040">6040</th><td>	<a class="macro" href="../include/linux/spinlock.h.html#309" title="do { spinlock_check(&amp;pgdat-&gt;lru_lock); do { *(&amp;(&amp;pgdat-&gt;lru_lock)-&gt;rlock) = (raw_spinlock_t) { .raw_lock = { { (0) } }, }; } while (0); } while (0)" data-ref="_M/spin_lock_init">spin_lock_init</a>(&amp;<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::lru_lock" title='pglist_data::lru_lock' data-ref="pglist_data::lru_lock">lru_lock</a>);</td></tr>
<tr><th id="6041">6041</th><td>	<a class="ref fn" href="../include/linux/mmzone.h.html#lruvec_init" title='lruvec_init' data-ref="lruvec_init">lruvec_init</a>(<a class="ref fn" href="../include/linux/mmzone.h.html#node_lruvec" title='node_lruvec' data-ref="node_lruvec">node_lruvec</a>(<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>));</td></tr>
<tr><th id="6042">6042</th><td></td></tr>
<tr><th id="6043">6043</th><td>	<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::per_cpu_nodestats" title='pglist_data::per_cpu_nodestats' data-ref="pglist_data::per_cpu_nodestats">per_cpu_nodestats</a> = &amp;<a class="tu ref" href="#5161" title='boot_nodestats' data-use='a' data-ref="boot_nodestats">boot_nodestats</a>;</td></tr>
<tr><th id="6044">6044</th><td></td></tr>
<tr><th id="6045">6045</th><td>	<b>for</b> (<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a> = <var>0</var>; <a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>++) {</td></tr>
<tr><th id="6046">6046</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="1091zone" title='zone' data-type='struct zone *' data-ref="1091zone">zone</dfn> = <a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a> + <a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>;</td></tr>
<tr><th id="6047">6047</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1092size" title='size' data-type='unsigned long' data-ref="1092size">size</dfn>, <dfn class="local col3 decl" id="1093realsize" title='realsize' data-type='unsigned long' data-ref="1093realsize">realsize</dfn>, <dfn class="local col4 decl" id="1094freesize" title='freesize' data-type='unsigned long' data-ref="1094freesize">freesize</dfn>, <dfn class="local col5 decl" id="1095memmap_pages" title='memmap_pages' data-type='unsigned long' data-ref="1095memmap_pages">memmap_pages</dfn>;</td></tr>
<tr><th id="6048">6048</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1096zone_start_pfn" title='zone_start_pfn' data-type='unsigned long' data-ref="1096zone_start_pfn">zone_start_pfn</dfn> = <a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_start_pfn" title='zone::zone_start_pfn' data-ref="zone::zone_start_pfn">zone_start_pfn</a>;</td></tr>
<tr><th id="6049">6049</th><td></td></tr>
<tr><th id="6050">6050</th><td>		<a class="local col2 ref" href="#1092size" title='size' data-ref="1092size">size</a> = <a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::spanned_pages" title='zone::spanned_pages' data-ref="zone::spanned_pages">spanned_pages</a>;</td></tr>
<tr><th id="6051">6051</th><td>		<a class="local col3 ref" href="#1093realsize" title='realsize' data-ref="1093realsize">realsize</a> = <a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a> = <a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::present_pages" title='zone::present_pages' data-ref="zone::present_pages">present_pages</a>;</td></tr>
<tr><th id="6052">6052</th><td></td></tr>
<tr><th id="6053">6053</th><td>		<i>/*</i></td></tr>
<tr><th id="6054">6054</th><td><i>		 * Adjust freesize so that it accounts for how much memory</i></td></tr>
<tr><th id="6055">6055</th><td><i>		 * is used by this zone for memmap. This affects the watermark</i></td></tr>
<tr><th id="6056">6056</th><td><i>		 * and per-cpu initialisations</i></td></tr>
<tr><th id="6057">6057</th><td><i>		 */</i></td></tr>
<tr><th id="6058">6058</th><td>		<a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a> = <a class="tu ref fn" href="#calc_memmap_size" title='calc_memmap_size' data-use='c' data-ref="calc_memmap_size">calc_memmap_size</a>(<a class="local col2 ref" href="#1092size" title='size' data-ref="1092size">size</a>, <a class="local col3 ref" href="#1093realsize" title='realsize' data-ref="1093realsize">realsize</a>);</td></tr>
<tr><th id="6059">6059</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#is_highmem_idx" title='is_highmem_idx' data-ref="is_highmem_idx">is_highmem_idx</a>(<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>)) {</td></tr>
<tr><th id="6060">6060</th><td>			<b>if</b> (<a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a> &gt;= <a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a>) {</td></tr>
<tr><th id="6061">6061</th><td>				<a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a> -= <a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a>;</td></tr>
<tr><th id="6062">6062</th><td>				<b>if</b> (<a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a>)</td></tr>
<tr><th id="6063">6063</th><td>					<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#15" title="&quot;\001&quot; &quot;7&quot;" data-ref="_M/KERN_DEBUG">KERN_DEBUG</a></td></tr>
<tr><th id="6064">6064</th><td>					       <q>"  %s zone: %lu pages used for memmap\n"</q>,</td></tr>
<tr><th id="6065">6065</th><td>					       <a class="tu ref" href="#zone_names" title='zone_names' data-use='r' data-ref="zone_names">zone_names</a>[<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>], <a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a>);</td></tr>
<tr><th id="6066">6066</th><td>			} <b>else</b></td></tr>
<tr><th id="6067">6067</th><td>				<a class="macro" href="../include/linux/printk.h.html#305" title="pr_warning" data-ref="_M/pr_warn">pr_warn</a>(<q>"  %s zone: %lu pages exceeds freesize %lu\n"</q>,</td></tr>
<tr><th id="6068">6068</th><td>					<a class="tu ref" href="#zone_names" title='zone_names' data-use='r' data-ref="zone_names">zone_names</a>[<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>], <a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a>, <a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a>);</td></tr>
<tr><th id="6069">6069</th><td>		}</td></tr>
<tr><th id="6070">6070</th><td></td></tr>
<tr><th id="6071">6071</th><td>		<i>/* Account for reserved pages */</i></td></tr>
<tr><th id="6072">6072</th><td>		<b>if</b> (<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a> == <var>0</var> &amp;&amp; <a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a> &gt; <a class="tu ref" href="#dma_reserve" title='dma_reserve' data-use='r' data-ref="dma_reserve">dma_reserve</a>) {</td></tr>
<tr><th id="6073">6073</th><td>			<a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a> -= <a class="tu ref" href="#dma_reserve" title='dma_reserve' data-use='r' data-ref="dma_reserve">dma_reserve</a>;</td></tr>
<tr><th id="6074">6074</th><td>			<a class="ref fn" href="../include/linux/printk.h.html#printk" title='printk' data-ref="printk">printk</a>(<a class="macro" href="../include/linux/kern_levels.h.html#15" title="&quot;\001&quot; &quot;7&quot;" data-ref="_M/KERN_DEBUG">KERN_DEBUG</a> <q>"  %s zone: %lu pages reserved\n"</q>,</td></tr>
<tr><th id="6075">6075</th><td>					<a class="tu ref" href="#zone_names" title='zone_names' data-use='r' data-ref="zone_names">zone_names</a>[<var>0</var>], <a class="tu ref" href="#dma_reserve" title='dma_reserve' data-use='r' data-ref="dma_reserve">dma_reserve</a>);</td></tr>
<tr><th id="6076">6076</th><td>		}</td></tr>
<tr><th id="6077">6077</th><td></td></tr>
<tr><th id="6078">6078</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#is_highmem_idx" title='is_highmem_idx' data-ref="is_highmem_idx">is_highmem_idx</a>(<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>))</td></tr>
<tr><th id="6079">6079</th><td>			<a class="tu ref" href="#nr_kernel_pages" title='nr_kernel_pages' data-use='w' data-ref="nr_kernel_pages">nr_kernel_pages</a> += <a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a>;</td></tr>
<tr><th id="6080">6080</th><td>		<i>/* Charge for highmem memmap if there are enough kernel pages */</i></td></tr>
<tr><th id="6081">6081</th><td>		<b>else</b> <b>if</b> (<a class="tu ref" href="#nr_kernel_pages" title='nr_kernel_pages' data-use='r' data-ref="nr_kernel_pages">nr_kernel_pages</a> &gt; <a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a> * <var>2</var>)</td></tr>
<tr><th id="6082">6082</th><td>			<a class="tu ref" href="#nr_kernel_pages" title='nr_kernel_pages' data-use='w' data-ref="nr_kernel_pages">nr_kernel_pages</a> -= <a class="local col5 ref" href="#1095memmap_pages" title='memmap_pages' data-ref="1095memmap_pages">memmap_pages</a>;</td></tr>
<tr><th id="6083">6083</th><td>		<a class="tu ref" href="#nr_all_pages" title='nr_all_pages' data-use='w' data-ref="nr_all_pages">nr_all_pages</a> += <a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a>;</td></tr>
<tr><th id="6084">6084</th><td></td></tr>
<tr><th id="6085">6085</th><td>		<i>/*</i></td></tr>
<tr><th id="6086">6086</th><td><i>		 * Set an approximate value for lowmem here, it will be adjusted</i></td></tr>
<tr><th id="6087">6087</th><td><i>		 * when the bootmem allocator frees pages into the buddy system.</i></td></tr>
<tr><th id="6088">6088</th><td><i>		 * And all highmem pages will be managed by the buddy system.</i></td></tr>
<tr><th id="6089">6089</th><td><i>		 */</i></td></tr>
<tr><th id="6090">6090</th><td>		<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> = <a class="ref fn" href="../include/linux/mmzone.h.html#is_highmem_idx" title='is_highmem_idx' data-ref="is_highmem_idx">is_highmem_idx</a>(<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>) ? <a class="local col3 ref" href="#1093realsize" title='realsize' data-ref="1093realsize">realsize</a> : <a class="local col4 ref" href="#1094freesize" title='freesize' data-ref="1094freesize">freesize</a>;</td></tr>
<tr><th id="6091">6091</th><td><u>#<span data-ppcond="6091">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="6092">6092</th><td>		zone-&gt;node = nid;</td></tr>
<tr><th id="6093">6093</th><td><u>#<span data-ppcond="6091">endif</span></u></td></tr>
<tr><th id="6094">6094</th><td>		<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::name" title='zone::name' data-ref="zone::name">name</a> = <a class="tu ref" href="#zone_names" title='zone_names' data-use='r' data-ref="zone_names">zone_names</a>[<a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>];</td></tr>
<tr><th id="6095">6095</th><td>		<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::zone_pgdat" title='zone::zone_pgdat' data-ref="zone::zone_pgdat">zone_pgdat</a> = <a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>;</td></tr>
<tr><th id="6096">6096</th><td>		<a class="macro" href="../include/linux/spinlock.h.html#309" title="do { spinlock_check(&amp;zone-&gt;lock); do { *(&amp;(&amp;zone-&gt;lock)-&gt;rlock) = (raw_spinlock_t) { .raw_lock = { { (0) } }, }; } while (0); } while (0)" data-ref="_M/spin_lock_init">spin_lock_init</a>(&amp;<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>);</td></tr>
<tr><th id="6097">6097</th><td>		<a class="ref fn" href="../include/linux/memory_hotplug.h.html#zone_seqlock_init" title='zone_seqlock_init' data-ref="zone_seqlock_init">zone_seqlock_init</a>(<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>);</td></tr>
<tr><th id="6098">6098</th><td>		<a class="tu ref fn" href="#zone_pcp_init" title='zone_pcp_init' data-use='c' data-ref="zone_pcp_init">zone_pcp_init</a>(<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>);</td></tr>
<tr><th id="6099">6099</th><td></td></tr>
<tr><th id="6100">6100</th><td>		<b>if</b> (!<a class="local col2 ref" href="#1092size" title='size' data-ref="1092size">size</a>)</td></tr>
<tr><th id="6101">6101</th><td>			<b>continue</b>;</td></tr>
<tr><th id="6102">6102</th><td></td></tr>
<tr><th id="6103">6103</th><td>		<a class="ref fn" href="#set_pageblock_order" title='set_pageblock_order' data-ref="set_pageblock_order">set_pageblock_order</a>();</td></tr>
<tr><th id="6104">6104</th><td>		<a class="tu ref fn" href="#setup_usemap" title='setup_usemap' data-use='c' data-ref="setup_usemap">setup_usemap</a>(<a class="local col8 ref" href="#1088pgdat" title='pgdat' data-ref="1088pgdat">pgdat</a>, <a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>, <a class="local col6 ref" href="#1096zone_start_pfn" title='zone_start_pfn' data-ref="1096zone_start_pfn">zone_start_pfn</a>, <a class="local col2 ref" href="#1092size" title='size' data-ref="1092size">size</a>);</td></tr>
<tr><th id="6105">6105</th><td>		<a class="ref fn" href="#init_currently_empty_zone" title='init_currently_empty_zone' data-ref="init_currently_empty_zone">init_currently_empty_zone</a>(<a class="local col1 ref" href="#1091zone" title='zone' data-ref="1091zone">zone</a>, <a class="local col6 ref" href="#1096zone_start_pfn" title='zone_start_pfn' data-ref="1096zone_start_pfn">zone_start_pfn</a>, <a class="local col2 ref" href="#1092size" title='size' data-ref="1092size">size</a>);</td></tr>
<tr><th id="6106">6106</th><td>		<a class="macro" href="#5368" title="memmap_init_zone((size), (nid), (j), (zone_start_pfn), MEMMAP_EARLY)" data-ref="_M/memmap_init">memmap_init</a>(<a class="local col2 ref" href="#1092size" title='size' data-ref="1092size">size</a>, <a class="local col0 ref" href="#1090nid" title='nid' data-ref="1090nid">nid</a>, <a class="local col9 ref" href="#1089j" title='j' data-ref="1089j">j</a>, <a class="local col6 ref" href="#1096zone_start_pfn" title='zone_start_pfn' data-ref="1096zone_start_pfn">zone_start_pfn</a>);</td></tr>
<tr><th id="6107">6107</th><td>	}</td></tr>
<tr><th id="6108">6108</th><td>}</td></tr>
<tr><th id="6109">6109</th><td></td></tr>
<tr><th id="6110">6110</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#73" title="__attribute__ ((__section__(&quot;.ref.text&quot;))) __attribute__((noinline))" data-ref="_M/__ref">__ref</a> <dfn class="tu decl def fn" id="alloc_node_mem_map" title='alloc_node_mem_map' data-type='void alloc_node_mem_map(struct pglist_data * pgdat)' data-ref="alloc_node_mem_map">alloc_node_mem_map</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col7 decl" id="1097pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1097pgdat">pgdat</dfn>)</td></tr>
<tr><th id="6111">6111</th><td>{</td></tr>
<tr><th id="6112">6112</th><td>	<em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#147" title="__attribute__((unused))" data-ref="_M/__maybe_unused">__maybe_unused</a> <dfn class="local col8 decl" id="1098start" title='start' data-type='unsigned long' data-ref="1098start">start</dfn> = <var>0</var>;</td></tr>
<tr><th id="6113">6113</th><td>	<em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/compiler-gcc.h.html#147" title="__attribute__((unused))" data-ref="_M/__maybe_unused">__maybe_unused</a> <dfn class="local col9 decl" id="1099offset" title='offset' data-type='unsigned long' data-ref="1099offset">offset</dfn> = <var>0</var>;</td></tr>
<tr><th id="6114">6114</th><td></td></tr>
<tr><th id="6115">6115</th><td>	<i>/* Skip empty nodes */</i></td></tr>
<tr><th id="6116">6116</th><td>	<b>if</b> (!<a class="local col7 ref" href="#1097pgdat" title='pgdat' data-ref="1097pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_spanned_pages" title='pglist_data::node_spanned_pages' data-ref="pglist_data::node_spanned_pages">node_spanned_pages</a>)</td></tr>
<tr><th id="6117">6117</th><td>		<b>return</b>;</td></tr>
<tr><th id="6118">6118</th><td></td></tr>
<tr><th id="6119">6119</th><td><u>#<span data-ppcond="6119">ifdef</span> <span class="macro" data-ref="_M/CONFIG_FLAT_NODE_MEM_MAP">CONFIG_FLAT_NODE_MEM_MAP</span></u></td></tr>
<tr><th id="6120">6120</th><td>	start = pgdat-&gt;node_start_pfn &amp; ~(MAX_ORDER_NR_PAGES - <var>1</var>);</td></tr>
<tr><th id="6121">6121</th><td>	offset = pgdat-&gt;node_start_pfn - start;</td></tr>
<tr><th id="6122">6122</th><td>	<i>/* ia64 gets its own node_mem_map, before this, without bootmem */</i></td></tr>
<tr><th id="6123">6123</th><td>	<b>if</b> (!pgdat-&gt;node_mem_map) {</td></tr>
<tr><th id="6124">6124</th><td>		<em>unsigned</em> <em>long</em> size, end;</td></tr>
<tr><th id="6125">6125</th><td>		<b>struct</b> page *map;</td></tr>
<tr><th id="6126">6126</th><td></td></tr>
<tr><th id="6127">6127</th><td>		<i>/*</i></td></tr>
<tr><th id="6128">6128</th><td><i>		 * The zone's endpoints aren't required to be MAX_ORDER</i></td></tr>
<tr><th id="6129">6129</th><td><i>		 * aligned but the node_mem_map endpoints must be in order</i></td></tr>
<tr><th id="6130">6130</th><td><i>		 * for the buddy allocator to function correctly.</i></td></tr>
<tr><th id="6131">6131</th><td><i>		 */</i></td></tr>
<tr><th id="6132">6132</th><td>		end = pgdat_end_pfn(pgdat);</td></tr>
<tr><th id="6133">6133</th><td>		end = ALIGN(end, MAX_ORDER_NR_PAGES);</td></tr>
<tr><th id="6134">6134</th><td>		size =  (end - start) * <b>sizeof</b>(<b>struct</b> page);</td></tr>
<tr><th id="6135">6135</th><td>		map = alloc_remap(pgdat-&gt;node_id, size);</td></tr>
<tr><th id="6136">6136</th><td>		<b>if</b> (!map)</td></tr>
<tr><th id="6137">6137</th><td>			map = memblock_virt_alloc_node_nopanic(size,</td></tr>
<tr><th id="6138">6138</th><td>							       pgdat-&gt;node_id);</td></tr>
<tr><th id="6139">6139</th><td>		pgdat-&gt;node_mem_map = map + offset;</td></tr>
<tr><th id="6140">6140</th><td>	}</td></tr>
<tr><th id="6141">6141</th><td><u>#ifndef CONFIG_NEED_MULTIPLE_NODES</u></td></tr>
<tr><th id="6142">6142</th><td>	<i>/*</i></td></tr>
<tr><th id="6143">6143</th><td><i>	 * With no DISCONTIG, the global mem_map is just set as node 0's</i></td></tr>
<tr><th id="6144">6144</th><td><i>	 */</i></td></tr>
<tr><th id="6145">6145</th><td>	<b>if</b> (pgdat == NODE_DATA(<var>0</var>)) {</td></tr>
<tr><th id="6146">6146</th><td>		mem_map = NODE_DATA(<var>0</var>)-&gt;node_mem_map;</td></tr>
<tr><th id="6147">6147</th><td><u>#if defined(CONFIG_HAVE_MEMBLOCK_NODE_MAP) || defined(CONFIG_FLATMEM)</u></td></tr>
<tr><th id="6148">6148</th><td>		<b>if</b> (page_to_pfn(mem_map) != pgdat-&gt;node_start_pfn)</td></tr>
<tr><th id="6149">6149</th><td>			mem_map -= offset;</td></tr>
<tr><th id="6150">6150</th><td><u>#endif /* CONFIG_HAVE_MEMBLOCK_NODE_MAP */</u></td></tr>
<tr><th id="6151">6151</th><td>	}</td></tr>
<tr><th id="6152">6152</th><td><u>#endif</u></td></tr>
<tr><th id="6153">6153</th><td><u>#<span data-ppcond="6119">endif</span> /* CONFIG_FLAT_NODE_MEM_MAP */</u></td></tr>
<tr><th id="6154">6154</th><td>}</td></tr>
<tr><th id="6155">6155</th><td></td></tr>
<tr><th id="6156">6156</th><td><em>void</em> <a class="macro" href="internal.h.html#398" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__paginginit">__paginginit</a> <dfn class="decl def fn" id="free_area_init_node" title='free_area_init_node' data-ref="free_area_init_node">free_area_init_node</dfn>(<em>int</em> <dfn class="local col0 decl" id="1100nid" title='nid' data-type='int' data-ref="1100nid">nid</dfn>, <em>unsigned</em> <em>long</em> *<dfn class="local col1 decl" id="1101zones_size" title='zones_size' data-type='unsigned long *' data-ref="1101zones_size">zones_size</dfn>,</td></tr>
<tr><th id="6157">6157</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1102node_start_pfn" title='node_start_pfn' data-type='unsigned long' data-ref="1102node_start_pfn">node_start_pfn</dfn>, <em>unsigned</em> <em>long</em> *<dfn class="local col3 decl" id="1103zholes_size" title='zholes_size' data-type='unsigned long *' data-ref="1103zholes_size">zholes_size</dfn>)</td></tr>
<tr><th id="6158">6158</th><td>{</td></tr>
<tr><th id="6159">6159</th><td>	<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col4 decl" id="1104pgdat" title='pgdat' data-type='pg_data_t *' data-ref="1104pgdat">pgdat</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#913" title="(&amp;contig_page_data)" data-ref="_M/NODE_DATA">NODE_DATA</a>(nid);</td></tr>
<tr><th id="6160">6160</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1105start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1105start_pfn">start_pfn</dfn> = <var>0</var>;</td></tr>
<tr><th id="6161">6161</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1106end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1106end_pfn">end_pfn</dfn> = <var>0</var>;</td></tr>
<tr><th id="6162">6162</th><td></td></tr>
<tr><th id="6163">6163</th><td>	<i>/* pg_data_t should be reset to zero when it's allocated */</i></td></tr>
<tr><th id="6164">6164</th><td>	<a class="macro" href="../include/asm-generic/bug.h.html#108" title="({ int __ret_warn_on = !!(pgdat-&gt;nr_zones || pgdat-&gt;kswapd_classzone_idx); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (6164), &quot;i&quot; ((1 &lt;&lt; 0)|(((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (271)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON">WARN_ON</a>(<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::nr_zones" title='pglist_data::nr_zones' data-ref="pglist_data::nr_zones">nr_zones</a> || <a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::kswapd_classzone_idx" title='pglist_data::kswapd_classzone_idx' data-ref="pglist_data::kswapd_classzone_idx">kswapd_classzone_idx</a>);</td></tr>
<tr><th id="6165">6165</th><td></td></tr>
<tr><th id="6166">6166</th><td>	<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_id" title='pglist_data::node_id' data-ref="pglist_data::node_id">node_id</a> = <a class="local col0 ref" href="#1100nid" title='nid' data-ref="1100nid">nid</a>;</td></tr>
<tr><th id="6167">6167</th><td>	<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_start_pfn" title='pglist_data::node_start_pfn' data-ref="pglist_data::node_start_pfn">node_start_pfn</a> = <a class="local col2 ref" href="#1102node_start_pfn" title='node_start_pfn' data-ref="1102node_start_pfn">node_start_pfn</a>;</td></tr>
<tr><th id="6168">6168</th><td>	<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::per_cpu_nodestats" title='pglist_data::per_cpu_nodestats' data-ref="pglist_data::per_cpu_nodestats">per_cpu_nodestats</a> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="6169">6169</th><td><u>#<span data-ppcond="6169">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a></u></td></tr>
<tr><th id="6170">6170</th><td>	<a class="ref fn" href="#get_pfn_range_for_nid" title='get_pfn_range_for_nid' data-ref="get_pfn_range_for_nid">get_pfn_range_for_nid</a>(<a class="local col0 ref" href="#1100nid" title='nid' data-ref="1100nid">nid</a>, &amp;<a class="local col5 ref" href="#1105start_pfn" title='start_pfn' data-ref="1105start_pfn">start_pfn</a>, &amp;<a class="local col6 ref" href="#1106end_pfn" title='end_pfn' data-ref="1106end_pfn">end_pfn</a>);</td></tr>
<tr><th id="6171">6171</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Initmem setup node %d [mem %#018Lx-%#018Lx]\n&quot;, nid, (u64)start_pfn &lt;&lt; 12, end_pfn ? ((u64)end_pfn &lt;&lt; 12) - 1 : 0)" data-ref="_M/pr_info">pr_info</a>(<q>"Initmem setup node %d [mem %#018Lx-%#018Lx]\n"</q>, <a class="local col0 ref" href="#1100nid" title='nid' data-ref="1100nid">nid</a>,</td></tr>
<tr><th id="6172">6172</th><td>		(<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="local col5 ref" href="#1105start_pfn" title='start_pfn' data-ref="1105start_pfn">start_pfn</a> &lt;&lt; PAGE_SHIFT,</td></tr>
<tr><th id="6173">6173</th><td>		<a class="local col6 ref" href="#1106end_pfn" title='end_pfn' data-ref="1106end_pfn">end_pfn</a> ? ((<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="local col6 ref" href="#1106end_pfn" title='end_pfn' data-ref="1106end_pfn">end_pfn</a> &lt;&lt; PAGE_SHIFT) - <var>1</var> : <var>0</var>);</td></tr>
<tr><th id="6174">6174</th><td><u>#<span data-ppcond="6169">else</span></u></td></tr>
<tr><th id="6175">6175</th><td>	start_pfn = node_start_pfn;</td></tr>
<tr><th id="6176">6176</th><td><u>#<span data-ppcond="6169">endif</span></u></td></tr>
<tr><th id="6177">6177</th><td>	<a class="tu ref fn" href="#calculate_node_totalpages" title='calculate_node_totalpages' data-use='c' data-ref="calculate_node_totalpages">calculate_node_totalpages</a>(<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>, <a class="local col5 ref" href="#1105start_pfn" title='start_pfn' data-ref="1105start_pfn">start_pfn</a>, <a class="local col6 ref" href="#1106end_pfn" title='end_pfn' data-ref="1106end_pfn">end_pfn</a>,</td></tr>
<tr><th id="6178">6178</th><td>				  <a class="local col1 ref" href="#1101zones_size" title='zones_size' data-ref="1101zones_size">zones_size</a>, <a class="local col3 ref" href="#1103zholes_size" title='zholes_size' data-ref="1103zholes_size">zholes_size</a>);</td></tr>
<tr><th id="6179">6179</th><td></td></tr>
<tr><th id="6180">6180</th><td>	<a class="tu ref fn" href="#alloc_node_mem_map" title='alloc_node_mem_map' data-use='c' data-ref="alloc_node_mem_map">alloc_node_mem_map</a>(<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>);</td></tr>
<tr><th id="6181">6181</th><td><u>#<span data-ppcond="6181">ifdef</span> <span class="macro" data-ref="_M/CONFIG_FLAT_NODE_MEM_MAP">CONFIG_FLAT_NODE_MEM_MAP</span></u></td></tr>
<tr><th id="6182">6182</th><td>	printk(KERN_DEBUG <q>"free_area_init_node: node %d, pgdat %08lx, node_mem_map %08lx\n"</q>,</td></tr>
<tr><th id="6183">6183</th><td>		nid, (<em>unsigned</em> <em>long</em>)pgdat,</td></tr>
<tr><th id="6184">6184</th><td>		(<em>unsigned</em> <em>long</em>)pgdat-&gt;node_mem_map);</td></tr>
<tr><th id="6185">6185</th><td><u>#<span data-ppcond="6181">endif</span></u></td></tr>
<tr><th id="6186">6186</th><td></td></tr>
<tr><th id="6187">6187</th><td>	<a class="tu ref fn" href="#reset_deferred_meminit" title='reset_deferred_meminit' data-use='c' data-ref="reset_deferred_meminit">reset_deferred_meminit</a>(<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>);</td></tr>
<tr><th id="6188">6188</th><td>	<a class="tu ref fn" href="#free_area_init_core" title='free_area_init_core' data-use='c' data-ref="free_area_init_core">free_area_init_core</a>(<a class="local col4 ref" href="#1104pgdat" title='pgdat' data-ref="1104pgdat">pgdat</a>);</td></tr>
<tr><th id="6189">6189</th><td>}</td></tr>
<tr><th id="6190">6190</th><td></td></tr>
<tr><th id="6191">6191</th><td><u>#<span data-ppcond="6191">ifdef</span> <a class="macro" href="../include/generated/autoconf.h.html#545" data-ref="_M/CONFIG_HAVE_MEMBLOCK_NODE_MAP">CONFIG_HAVE_MEMBLOCK_NODE_MAP</a></u></td></tr>
<tr><th id="6192">6192</th><td></td></tr>
<tr><th id="6193">6193</th><td><u>#<span data-ppcond="6193">if</span> <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a> &gt; 1</u></td></tr>
<tr><th id="6194">6194</th><td><i>/*</i></td></tr>
<tr><th id="6195">6195</th><td><i> * Figure out the number of possible node ids.</i></td></tr>
<tr><th id="6196">6196</th><td><i> */</i></td></tr>
<tr><th id="6197">6197</th><td><em>void</em> __init setup_nr_node_ids(<em>void</em>)</td></tr>
<tr><th id="6198">6198</th><td>{</td></tr>
<tr><th id="6199">6199</th><td>	<em>unsigned</em> <em>int</em> highest;</td></tr>
<tr><th id="6200">6200</th><td></td></tr>
<tr><th id="6201">6201</th><td>	highest = find_last_bit(node_possible_map.bits, MAX_NUMNODES);</td></tr>
<tr><th id="6202">6202</th><td>	nr_node_ids = highest + <var>1</var>;</td></tr>
<tr><th id="6203">6203</th><td>}</td></tr>
<tr><th id="6204">6204</th><td><u>#<span data-ppcond="6193">endif</span></u></td></tr>
<tr><th id="6205">6205</th><td></td></tr>
<tr><th id="6206">6206</th><td><i class="doc">/**</i></td></tr>
<tr><th id="6207">6207</th><td><i class="doc"> * node_map_pfn_alignment - determine the maximum internode alignment</i></td></tr>
<tr><th id="6208">6208</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6209">6209</th><td><i class="doc"> * This function should be called after node map is populated and sorted.</i></td></tr>
<tr><th id="6210">6210</th><td><i class="doc"> * It calculates the maximum power of two alignment which can distinguish</i></td></tr>
<tr><th id="6211">6211</th><td><i class="doc"> * all the nodes.</i></td></tr>
<tr><th id="6212">6212</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6213">6213</th><td><i class="doc"> * For example, if all nodes are 1GiB and aligned to 1GiB, the return value</i></td></tr>
<tr><th id="6214">6214</th><td><i class="doc"> * would indicate 1GiB alignment with (1 &lt;&lt; (30 - PAGE_SHIFT)).  If the</i></td></tr>
<tr><th id="6215">6215</th><td><i class="doc"> * nodes are shifted by 256MiB, 256MiB.  Note that if only the last node is</i></td></tr>
<tr><th id="6216">6216</th><td><i class="doc"> * shifted, 1GiB is enough and this function will indicate so.</i></td></tr>
<tr><th id="6217">6217</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6218">6218</th><td><i class="doc"> * This is used to test whether pfn -&gt; nid mapping of the chosen memory</i></td></tr>
<tr><th id="6219">6219</th><td><i class="doc"> * model has fine enough granularity to avoid incorrect mapping for the</i></td></tr>
<tr><th id="6220">6220</th><td><i class="doc"> * populated node map.</i></td></tr>
<tr><th id="6221">6221</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6222">6222</th><td><i class="doc"> * Returns the determined alignment in pfn's.  0 if there is no alignment</i></td></tr>
<tr><th id="6223">6223</th><td><i class="doc"> * requirement (single node).</i></td></tr>
<tr><th id="6224">6224</th><td><i class="doc"> */</i></td></tr>
<tr><th id="6225">6225</th><td><em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="node_map_pfn_alignment" title='node_map_pfn_alignment' data-ref="node_map_pfn_alignment">node_map_pfn_alignment</dfn>(<em>void</em>)</td></tr>
<tr><th id="6226">6226</th><td>{</td></tr>
<tr><th id="6227">6227</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1107accl_mask" title='accl_mask' data-type='unsigned long' data-ref="1107accl_mask">accl_mask</dfn> = <var>0</var>, <dfn class="local col8 decl" id="1108last_end" title='last_end' data-type='unsigned long' data-ref="1108last_end">last_end</dfn> = <var>0</var>;</td></tr>
<tr><th id="6228">6228</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1109start" title='start' data-type='unsigned long' data-ref="1109start">start</dfn>, <dfn class="local col0 decl" id="1110end" title='end' data-type='unsigned long' data-ref="1110end">end</dfn>, <dfn class="local col1 decl" id="1111mask" title='mask' data-type='unsigned long' data-ref="1111mask">mask</dfn>;</td></tr>
<tr><th id="6229">6229</th><td>	<em>int</em> <dfn class="local col2 decl" id="1112last_nid" title='last_nid' data-type='int' data-ref="1112last_nid">last_nid</dfn> = -<var>1</var>;</td></tr>
<tr><th id="6230">6230</th><td>	<em>int</em> <dfn class="local col3 decl" id="1113i" title='i' data-type='int' data-ref="1113i">i</dfn>, <dfn class="local col4 decl" id="1114nid" title='nid' data-type='int' data-ref="1114nid">nid</dfn>;</td></tr>
<tr><th id="6231">6231</th><td></td></tr>
<tr><th id="6232">6232</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, (1 &lt;&lt; 0), &amp;start, &amp;end, &amp;nid); i &gt;= 0; __next_mem_pfn_range(&amp;i, (1 &lt;&lt; 0), &amp;start, &amp;end, &amp;nid))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col3 ref" href="#1113i" title='i' data-ref="1113i">i</a>, <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>, &amp;<a class="local col9 ref" href="#1109start" title='start' data-ref="1109start">start</a>, &amp;<a class="local col0 ref" href="#1110end" title='end' data-ref="1110end">end</a>, &amp;<a class="local col4 ref" href="#1114nid" title='nid' data-ref="1114nid">nid</a>) {</td></tr>
<tr><th id="6233">6233</th><td>		<b>if</b> (!<a class="local col9 ref" href="#1109start" title='start' data-ref="1109start">start</a> || <a class="local col2 ref" href="#1112last_nid" title='last_nid' data-ref="1112last_nid">last_nid</a> &lt; <var>0</var> || <a class="local col2 ref" href="#1112last_nid" title='last_nid' data-ref="1112last_nid">last_nid</a> == <a class="local col4 ref" href="#1114nid" title='nid' data-ref="1114nid">nid</a>) {</td></tr>
<tr><th id="6234">6234</th><td>			<a class="local col2 ref" href="#1112last_nid" title='last_nid' data-ref="1112last_nid">last_nid</a> = <a class="local col4 ref" href="#1114nid" title='nid' data-ref="1114nid">nid</a>;</td></tr>
<tr><th id="6235">6235</th><td>			<a class="local col8 ref" href="#1108last_end" title='last_end' data-ref="1108last_end">last_end</a> = <a class="local col0 ref" href="#1110end" title='end' data-ref="1110end">end</a>;</td></tr>
<tr><th id="6236">6236</th><td>			<b>continue</b>;</td></tr>
<tr><th id="6237">6237</th><td>		}</td></tr>
<tr><th id="6238">6238</th><td></td></tr>
<tr><th id="6239">6239</th><td>		<i>/*</i></td></tr>
<tr><th id="6240">6240</th><td><i>		 * Start with a mask granular enough to pin-point to the</i></td></tr>
<tr><th id="6241">6241</th><td><i>		 * start pfn and tick off bits one-by-one until it becomes</i></td></tr>
<tr><th id="6242">6242</th><td><i>		 * too coarse to separate the current node from the last.</i></td></tr>
<tr><th id="6243">6243</th><td><i>		 */</i></td></tr>
<tr><th id="6244">6244</th><td>		<a class="local col1 ref" href="#1111mask" title='mask' data-ref="1111mask">mask</a> = ~((<var>1</var> &lt;&lt; <a class="ref fn" href="../arch/x86/include/asm/bitops.h.html#__ffs" title='__ffs' data-ref="__ffs">__ffs</a>(<a class="local col9 ref" href="#1109start" title='start' data-ref="1109start">start</a>)) - <var>1</var>);</td></tr>
<tr><th id="6245">6245</th><td>		<b>while</b> (<a class="local col1 ref" href="#1111mask" title='mask' data-ref="1111mask">mask</a> &amp;&amp; <a class="local col8 ref" href="#1108last_end" title='last_end' data-ref="1108last_end">last_end</a> &lt;= (<a class="local col9 ref" href="#1109start" title='start' data-ref="1109start">start</a> &amp; (<a class="local col1 ref" href="#1111mask" title='mask' data-ref="1111mask">mask</a> &lt;&lt; <var>1</var>)))</td></tr>
<tr><th id="6246">6246</th><td>			<a class="local col1 ref" href="#1111mask" title='mask' data-ref="1111mask">mask</a> &lt;&lt;= <var>1</var>;</td></tr>
<tr><th id="6247">6247</th><td></td></tr>
<tr><th id="6248">6248</th><td>		<i>/* accumulate all internode masks */</i></td></tr>
<tr><th id="6249">6249</th><td>		<a class="local col7 ref" href="#1107accl_mask" title='accl_mask' data-ref="1107accl_mask">accl_mask</a> |= <a class="local col1 ref" href="#1111mask" title='mask' data-ref="1111mask">mask</a>;</td></tr>
<tr><th id="6250">6250</th><td>	}</td></tr>
<tr><th id="6251">6251</th><td></td></tr>
<tr><th id="6252">6252</th><td>	<i>/* convert mask to number of pages */</i></td></tr>
<tr><th id="6253">6253</th><td>	<b>return</b> ~<a class="local col7 ref" href="#1107accl_mask" title='accl_mask' data-ref="1107accl_mask">accl_mask</a> + <var>1</var>;</td></tr>
<tr><th id="6254">6254</th><td>}</td></tr>
<tr><th id="6255">6255</th><td></td></tr>
<tr><th id="6256">6256</th><td><i  data-doc="find_min_pfn_for_node">/* Find the lowest pfn for a node */</i></td></tr>
<tr><th id="6257">6257</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="find_min_pfn_for_node" title='find_min_pfn_for_node' data-type='unsigned long find_min_pfn_for_node(int nid)' data-ref="find_min_pfn_for_node">find_min_pfn_for_node</dfn>(<em>int</em> <dfn class="local col5 decl" id="1115nid" title='nid' data-type='int' data-ref="1115nid">nid</dfn>)</td></tr>
<tr><th id="6258">6258</th><td>{</td></tr>
<tr><th id="6259">6259</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1116min_pfn" title='min_pfn' data-type='unsigned long' data-ref="1116min_pfn">min_pfn</dfn> = <a class="macro" href="../include/linux/kernel.h.html#27" title="(~0UL)" data-ref="_M/ULONG_MAX">ULONG_MAX</a>;</td></tr>
<tr><th id="6260">6260</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1117start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1117start_pfn">start_pfn</dfn>;</td></tr>
<tr><th id="6261">6261</th><td>	<em>int</em> <dfn class="local col8 decl" id="1118i" title='i' data-type='int' data-ref="1118i">i</dfn>;</td></tr>
<tr><th id="6262">6262</th><td></td></tr>
<tr><th id="6263">6263</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, ((void *)0), ((void *)0)); i &gt;= 0; __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, ((void *)0), ((void *)0)))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col8 ref" href="#1118i" title='i' data-ref="1118i">i</a>, <a class="local col5 ref" href="#1115nid" title='nid' data-ref="1115nid">nid</a>, &amp;<a class="local col7 ref" href="#1117start_pfn" title='start_pfn' data-ref="1117start_pfn">start_pfn</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="6264">6264</th><td>		<a class="local col6 ref" href="#1116min_pfn" title='min_pfn' data-ref="1116min_pfn">min_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(min_pfn) __UNIQUE_ID_min1_273 = (min_pfn); typeof(start_pfn) __UNIQUE_ID_min2_274 = (start_pfn); (void) (&amp;__UNIQUE_ID_min1_273 == &amp;__UNIQUE_ID_min2_274); __UNIQUE_ID_min1_273 &lt; __UNIQUE_ID_min2_274 ? __UNIQUE_ID_min1_273 : __UNIQUE_ID_min2_274; })" data-ref="_M/min">min</a>(<a class="local col6 ref" href="#1116min_pfn" title='min_pfn' data-ref="1116min_pfn">min_pfn</a>, <a class="local col7 ref" href="#1117start_pfn" title='start_pfn' data-ref="1117start_pfn">start_pfn</a>);</td></tr>
<tr><th id="6265">6265</th><td></td></tr>
<tr><th id="6266">6266</th><td>	<b>if</b> (<a class="local col6 ref" href="#1116min_pfn" title='min_pfn' data-ref="1116min_pfn">min_pfn</a> == <a class="macro" href="../include/linux/kernel.h.html#27" title="(~0UL)" data-ref="_M/ULONG_MAX">ULONG_MAX</a>) {</td></tr>
<tr><th id="6267">6267</th><td>		<a class="macro" href="../include/linux/printk.h.html#305" title="pr_warning" data-ref="_M/pr_warn">pr_warn</a>(<q>"Could not find start_pfn for node %d\n"</q>, <a class="local col5 ref" href="#1115nid" title='nid' data-ref="1115nid">nid</a>);</td></tr>
<tr><th id="6268">6268</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6269">6269</th><td>	}</td></tr>
<tr><th id="6270">6270</th><td></td></tr>
<tr><th id="6271">6271</th><td>	<b>return</b> <a class="local col6 ref" href="#1116min_pfn" title='min_pfn' data-ref="1116min_pfn">min_pfn</a>;</td></tr>
<tr><th id="6272">6272</th><td>}</td></tr>
<tr><th id="6273">6273</th><td></td></tr>
<tr><th id="6274">6274</th><td><i class="doc">/**</i></td></tr>
<tr><th id="6275">6275</th><td><i class="doc"> * find_min_pfn_with_active_regions - Find the minimum PFN registered</i></td></tr>
<tr><th id="6276">6276</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6277">6277</th><td><i class="doc"> * It returns the minimum PFN based on information provided via</i></td></tr>
<tr><th id="6278">6278</th><td><i class="doc"> * memblock_set_node().</i></td></tr>
<tr><th id="6279">6279</th><td><i class="doc"> */</i></td></tr>
<tr><th id="6280">6280</th><td><em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="find_min_pfn_with_active_regions" title='find_min_pfn_with_active_regions' data-ref="find_min_pfn_with_active_regions">find_min_pfn_with_active_regions</dfn>(<em>void</em>)</td></tr>
<tr><th id="6281">6281</th><td>{</td></tr>
<tr><th id="6282">6282</th><td>	<b>return</b> <a class="tu ref fn" href="#find_min_pfn_for_node" title='find_min_pfn_for_node' data-use='c' data-ref="find_min_pfn_for_node">find_min_pfn_for_node</a>(<a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>);</td></tr>
<tr><th id="6283">6283</th><td>}</td></tr>
<tr><th id="6284">6284</th><td></td></tr>
<tr><th id="6285">6285</th><td><i  data-doc="early_calculate_totalpages">/*</i></td></tr>
<tr><th id="6286">6286</th><td><i  data-doc="early_calculate_totalpages"> * early_calculate_totalpages()</i></td></tr>
<tr><th id="6287">6287</th><td><i  data-doc="early_calculate_totalpages"> * Sum pages in active regions for movable zone.</i></td></tr>
<tr><th id="6288">6288</th><td><i  data-doc="early_calculate_totalpages"> * Populate N_MEMORY for calculating usable_nodes.</i></td></tr>
<tr><th id="6289">6289</th><td><i  data-doc="early_calculate_totalpages"> */</i></td></tr>
<tr><th id="6290">6290</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="early_calculate_totalpages" title='early_calculate_totalpages' data-type='unsigned long early_calculate_totalpages()' data-ref="early_calculate_totalpages">early_calculate_totalpages</dfn>(<em>void</em>)</td></tr>
<tr><th id="6291">6291</th><td>{</td></tr>
<tr><th id="6292">6292</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1119totalpages" title='totalpages' data-type='unsigned long' data-ref="1119totalpages">totalpages</dfn> = <var>0</var>;</td></tr>
<tr><th id="6293">6293</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1120start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1120start_pfn">start_pfn</dfn>, <dfn class="local col1 decl" id="1121end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1121end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="6294">6294</th><td>	<em>int</em> <dfn class="local col2 decl" id="1122i" title='i' data-type='int' data-ref="1122i">i</dfn>, <dfn class="local col3 decl" id="1123nid" title='nid' data-type='int' data-ref="1123nid">nid</dfn>;</td></tr>
<tr><th id="6295">6295</th><td></td></tr>
<tr><th id="6296">6296</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, (1 &lt;&lt; 0), &amp;start_pfn, &amp;end_pfn, &amp;nid); i &gt;= 0; __next_mem_pfn_range(&amp;i, (1 &lt;&lt; 0), &amp;start_pfn, &amp;end_pfn, &amp;nid))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col2 ref" href="#1122i" title='i' data-ref="1122i">i</a>, <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>, &amp;<a class="local col0 ref" href="#1120start_pfn" title='start_pfn' data-ref="1120start_pfn">start_pfn</a>, &amp;<a class="local col1 ref" href="#1121end_pfn" title='end_pfn' data-ref="1121end_pfn">end_pfn</a>, &amp;<a class="local col3 ref" href="#1123nid" title='nid' data-ref="1123nid">nid</a>) {</td></tr>
<tr><th id="6297">6297</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1124pages" title='pages' data-type='unsigned long' data-ref="1124pages">pages</dfn> = <a class="local col1 ref" href="#1121end_pfn" title='end_pfn' data-ref="1121end_pfn">end_pfn</a> - <a class="local col0 ref" href="#1120start_pfn" title='start_pfn' data-ref="1120start_pfn">start_pfn</a>;</td></tr>
<tr><th id="6298">6298</th><td></td></tr>
<tr><th id="6299">6299</th><td>		<a class="local col9 ref" href="#1119totalpages" title='totalpages' data-ref="1119totalpages">totalpages</a> += <a class="local col4 ref" href="#1124pages" title='pages' data-ref="1124pages">pages</a>;</td></tr>
<tr><th id="6300">6300</th><td>		<b>if</b> (<a class="local col4 ref" href="#1124pages" title='pages' data-ref="1124pages">pages</a>)</td></tr>
<tr><th id="6301">6301</th><td>			<a class="ref fn" href="../include/linux/nodemask.h.html#node_set_state" title='node_set_state' data-ref="node_set_state">node_set_state</a>(<a class="local col3 ref" href="#1123nid" title='nid' data-ref="1123nid">nid</a>, <a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a>);</td></tr>
<tr><th id="6302">6302</th><td>	}</td></tr>
<tr><th id="6303">6303</th><td>	<b>return</b> <a class="local col9 ref" href="#1119totalpages" title='totalpages' data-ref="1119totalpages">totalpages</a>;</td></tr>
<tr><th id="6304">6304</th><td>}</td></tr>
<tr><th id="6305">6305</th><td></td></tr>
<tr><th id="6306">6306</th><td><i  data-doc="find_zone_movable_pfns_for_nodes">/*</i></td></tr>
<tr><th id="6307">6307</th><td><i  data-doc="find_zone_movable_pfns_for_nodes"> * Find the PFN the Movable zone begins in each node. Kernel memory</i></td></tr>
<tr><th id="6308">6308</th><td><i  data-doc="find_zone_movable_pfns_for_nodes"> * is spread evenly between nodes as long as the nodes have enough</i></td></tr>
<tr><th id="6309">6309</th><td><i  data-doc="find_zone_movable_pfns_for_nodes"> * memory. When they don't, some nodes will have more kernelcore than</i></td></tr>
<tr><th id="6310">6310</th><td><i  data-doc="find_zone_movable_pfns_for_nodes"> * others</i></td></tr>
<tr><th id="6311">6311</th><td><i  data-doc="find_zone_movable_pfns_for_nodes"> */</i></td></tr>
<tr><th id="6312">6312</th><td><em>static</em> <em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="find_zone_movable_pfns_for_nodes" title='find_zone_movable_pfns_for_nodes' data-type='void find_zone_movable_pfns_for_nodes()' data-ref="find_zone_movable_pfns_for_nodes">find_zone_movable_pfns_for_nodes</dfn>(<em>void</em>)</td></tr>
<tr><th id="6313">6313</th><td>{</td></tr>
<tr><th id="6314">6314</th><td>	<em>int</em> <dfn class="local col5 decl" id="1125i" title='i' data-type='int' data-ref="1125i">i</dfn>, <dfn class="local col6 decl" id="1126nid" title='nid' data-type='int' data-ref="1126nid">nid</dfn>;</td></tr>
<tr><th id="6315">6315</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1127usable_startpfn" title='usable_startpfn' data-type='unsigned long' data-ref="1127usable_startpfn">usable_startpfn</dfn>;</td></tr>
<tr><th id="6316">6316</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1128kernelcore_node" title='kernelcore_node' data-type='unsigned long' data-ref="1128kernelcore_node">kernelcore_node</dfn>, <dfn class="local col9 decl" id="1129kernelcore_remaining" title='kernelcore_remaining' data-type='unsigned long' data-ref="1129kernelcore_remaining">kernelcore_remaining</dfn>;</td></tr>
<tr><th id="6317">6317</th><td>	<i>/* save the state before borrow the nodemask */</i></td></tr>
<tr><th id="6318">6318</th><td>	<a class="typedef" href="../include/linux/nodemask.h.html#nodemask_t" title='nodemask_t' data-type='struct nodemask_t' data-ref="nodemask_t">nodemask_t</a> <dfn class="local col0 decl" id="1130saved_node_state" title='saved_node_state' data-type='nodemask_t' data-ref="1130saved_node_state">saved_node_state</dfn> = <a class="ref" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states">node_states</a>[<a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a>];</td></tr>
<tr><th id="6319">6319</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="1131totalpages" title='totalpages' data-type='unsigned long' data-ref="1131totalpages">totalpages</dfn> = <a class="tu ref fn" href="#early_calculate_totalpages" title='early_calculate_totalpages' data-use='c' data-ref="early_calculate_totalpages">early_calculate_totalpages</a>();</td></tr>
<tr><th id="6320">6320</th><td>	<em>int</em> <dfn class="local col2 decl" id="1132usable_nodes" title='usable_nodes' data-type='int' data-ref="1132usable_nodes">usable_nodes</dfn> = <a class="macro" href="../include/linux/nodemask.h.html#228" title="__nodes_weight(&amp;(node_states[N_MEMORY]), (1 &lt;&lt; 0))" data-ref="_M/nodes_weight">nodes_weight</a>(<a class="ref" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states">node_states</a>[<a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a>]);</td></tr>
<tr><th id="6321">6321</th><td>	<b>struct</b> <a class="type" href="../include/linux/memblock.h.html#memblock_region" title='memblock_region' data-ref="memblock_region">memblock_region</a> *<dfn class="local col3 decl" id="1133r" title='r' data-type='struct memblock_region *' data-ref="1133r">r</dfn>;</td></tr>
<tr><th id="6322">6322</th><td></td></tr>
<tr><th id="6323">6323</th><td>	<i>/* Need to find movable_zone earlier when movable_node is specified. */</i></td></tr>
<tr><th id="6324">6324</th><td>	<a class="tu ref fn" href="#find_usable_zone_for_movable" title='find_usable_zone_for_movable' data-use='c' data-ref="find_usable_zone_for_movable">find_usable_zone_for_movable</a>();</td></tr>
<tr><th id="6325">6325</th><td></td></tr>
<tr><th id="6326">6326</th><td>	<i>/*</i></td></tr>
<tr><th id="6327">6327</th><td><i>	 * If movable_node is specified, ignore kernelcore and movablecore</i></td></tr>
<tr><th id="6328">6328</th><td><i>	 * options.</i></td></tr>
<tr><th id="6329">6329</th><td><i>	 */</i></td></tr>
<tr><th id="6330">6330</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/memory_hotplug.h.html#movable_node_is_enabled" title='movable_node_is_enabled' data-ref="movable_node_is_enabled">movable_node_is_enabled</a>()) {</td></tr>
<tr><th id="6331">6331</th><td>		<a class="macro" href="../include/linux/memblock.h.html#386" title="for (r = memblock.memory.regions; r &lt; (memblock.memory.regions + memblock.memory.cnt); r++)" data-ref="_M/for_each_memblock">for_each_memblock</a>(<a class="ref field" href="../include/linux/memblock.h.html#memblock::memory" title='memblock::memory' data-ref="memblock::memory">memory</a>, <a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>) {</td></tr>
<tr><th id="6332">6332</th><td>			<b>if</b> (!<a class="ref fn" href="../include/linux/memblock.h.html#memblock_is_hotpluggable" title='memblock_is_hotpluggable' data-ref="memblock_is_hotpluggable">memblock_is_hotpluggable</a>(<a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>))</td></tr>
<tr><th id="6333">6333</th><td>				<b>continue</b>;</td></tr>
<tr><th id="6334">6334</th><td></td></tr>
<tr><th id="6335">6335</th><td>			<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a> = <a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>-&gt;<a class="ref field" href="../include/linux/memblock.h.html#memblock_region::nid" title='memblock_region::nid' data-ref="memblock_region::nid">nid</a>;</td></tr>
<tr><th id="6336">6336</th><td></td></tr>
<tr><th id="6337">6337</th><td>			<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a> = <a class="macro" href="../include/linux/pfn.h.html#20" title="((r-&gt;base) &gt;&gt; 12)" data-ref="_M/PFN_DOWN">PFN_DOWN</a>(<a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>-&gt;<a class="ref field" href="../include/linux/memblock.h.html#memblock_region::base" title='memblock_region::base' data-ref="memblock_region::base">base</a>);</td></tr>
<tr><th id="6338">6338</th><td>			<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='w' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] = <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] ?</td></tr>
<tr><th id="6339">6339</th><td>				<a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(usable_startpfn) __UNIQUE_ID_min1_277 = (usable_startpfn); typeof(zone_movable_pfn[nid]) __UNIQUE_ID_min2_278 = (zone_movable_pfn[nid]); (void) (&amp;__UNIQUE_ID_min1_277 == &amp;__UNIQUE_ID_min2_278); __UNIQUE_ID_min1_277 &lt; __UNIQUE_ID_min2_278 ? __UNIQUE_ID_min1_277 : __UNIQUE_ID_min2_278; })" data-ref="_M/min">min</a>(<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>, <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-ref="zone_movable_pfn"><a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a></a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>]) :</td></tr>
<tr><th id="6340">6340</th><td>				<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>;</td></tr>
<tr><th id="6341">6341</th><td>		}</td></tr>
<tr><th id="6342">6342</th><td></td></tr>
<tr><th id="6343">6343</th><td>		<b>goto</b> <a class="lbl" href="#1134out2" data-ref="1134out2">out2</a>;</td></tr>
<tr><th id="6344">6344</th><td>	}</td></tr>
<tr><th id="6345">6345</th><td></td></tr>
<tr><th id="6346">6346</th><td>	<i>/*</i></td></tr>
<tr><th id="6347">6347</th><td><i>	 * If kernelcore=mirror is specified, ignore movablecore option</i></td></tr>
<tr><th id="6348">6348</th><td><i>	 */</i></td></tr>
<tr><th id="6349">6349</th><td>	<b>if</b> (<a class="tu ref" href="#mirrored_kernelcore" title='mirrored_kernelcore' data-use='r' data-ref="mirrored_kernelcore">mirrored_kernelcore</a>) {</td></tr>
<tr><th id="6350">6350</th><td>		<a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col5 decl" id="1135mem_below_4gb_not_mirrored" title='mem_below_4gb_not_mirrored' data-type='bool' data-ref="1135mem_below_4gb_not_mirrored">mem_below_4gb_not_mirrored</dfn> = <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="6351">6351</th><td></td></tr>
<tr><th id="6352">6352</th><td>		<a class="macro" href="../include/linux/memblock.h.html#386" title="for (r = memblock.memory.regions; r &lt; (memblock.memory.regions + memblock.memory.cnt); r++)" data-ref="_M/for_each_memblock">for_each_memblock</a>(<a class="ref field" href="../include/linux/memblock.h.html#memblock::memory" title='memblock::memory' data-ref="memblock::memory">memory</a>, <a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>) {</td></tr>
<tr><th id="6353">6353</th><td>			<b>if</b> (<a class="ref fn" href="../include/linux/memblock.h.html#memblock_is_mirror" title='memblock_is_mirror' data-ref="memblock_is_mirror">memblock_is_mirror</a>(<a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>))</td></tr>
<tr><th id="6354">6354</th><td>				<b>continue</b>;</td></tr>
<tr><th id="6355">6355</th><td></td></tr>
<tr><th id="6356">6356</th><td>			<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a> = <a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>-&gt;<a class="ref field" href="../include/linux/memblock.h.html#memblock_region::nid" title='memblock_region::nid' data-ref="memblock_region::nid">nid</a>;</td></tr>
<tr><th id="6357">6357</th><td></td></tr>
<tr><th id="6358">6358</th><td>			<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a> = <a class="ref fn" href="../include/linux/memblock.h.html#memblock_region_memory_base_pfn" title='memblock_region_memory_base_pfn' data-ref="memblock_region_memory_base_pfn">memblock_region_memory_base_pfn</a>(<a class="local col3 ref" href="#1133r" title='r' data-ref="1133r">r</a>);</td></tr>
<tr><th id="6359">6359</th><td></td></tr>
<tr><th id="6360">6360</th><td>			<b>if</b> (<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a> &lt; <var>0x100000</var>) {</td></tr>
<tr><th id="6361">6361</th><td>				<a class="local col5 ref" href="#1135mem_below_4gb_not_mirrored" title='mem_below_4gb_not_mirrored' data-ref="1135mem_below_4gb_not_mirrored">mem_below_4gb_not_mirrored</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="6362">6362</th><td>				<b>continue</b>;</td></tr>
<tr><th id="6363">6363</th><td>			}</td></tr>
<tr><th id="6364">6364</th><td></td></tr>
<tr><th id="6365">6365</th><td>			<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='w' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] = <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] ?</td></tr>
<tr><th id="6366">6366</th><td>				<a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(usable_startpfn) __UNIQUE_ID_min1_281 = (usable_startpfn); typeof(zone_movable_pfn[nid]) __UNIQUE_ID_min2_282 = (zone_movable_pfn[nid]); (void) (&amp;__UNIQUE_ID_min1_281 == &amp;__UNIQUE_ID_min2_282); __UNIQUE_ID_min1_281 &lt; __UNIQUE_ID_min2_282 ? __UNIQUE_ID_min1_281 : __UNIQUE_ID_min2_282; })" data-ref="_M/min">min</a>(<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>, <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-ref="zone_movable_pfn"><a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a></a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>]) :</td></tr>
<tr><th id="6367">6367</th><td>				<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>;</td></tr>
<tr><th id="6368">6368</th><td>		}</td></tr>
<tr><th id="6369">6369</th><td></td></tr>
<tr><th id="6370">6370</th><td>		<b>if</b> (<a class="local col5 ref" href="#1135mem_below_4gb_not_mirrored" title='mem_below_4gb_not_mirrored' data-ref="1135mem_below_4gb_not_mirrored">mem_below_4gb_not_mirrored</a>)</td></tr>
<tr><th id="6371">6371</th><td>			<a class="macro" href="../include/linux/printk.h.html#305" title="pr_warning" data-ref="_M/pr_warn">pr_warn</a>(<q>"This configuration results in unmirrored kernel memory."</q>);</td></tr>
<tr><th id="6372">6372</th><td></td></tr>
<tr><th id="6373">6373</th><td>		<b>goto</b> <a class="lbl" href="#1134out2" data-ref="1134out2">out2</a>;</td></tr>
<tr><th id="6374">6374</th><td>	}</td></tr>
<tr><th id="6375">6375</th><td></td></tr>
<tr><th id="6376">6376</th><td>	<i>/*</i></td></tr>
<tr><th id="6377">6377</th><td><i>	 * If movablecore=nn[KMG] was specified, calculate what size of</i></td></tr>
<tr><th id="6378">6378</th><td><i>	 * kernelcore that corresponds so that memory usable for</i></td></tr>
<tr><th id="6379">6379</th><td><i>	 * any allocation type is evenly spread. If both kernelcore</i></td></tr>
<tr><th id="6380">6380</th><td><i>	 * and movablecore are specified, then the value of kernelcore</i></td></tr>
<tr><th id="6381">6381</th><td><i>	 * will be used for required_kernelcore if it's greater than</i></td></tr>
<tr><th id="6382">6382</th><td><i>	 * what movablecore would have allowed.</i></td></tr>
<tr><th id="6383">6383</th><td><i>	 */</i></td></tr>
<tr><th id="6384">6384</th><td>	<b>if</b> (<a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='r' data-ref="required_movablecore">required_movablecore</a>) {</td></tr>
<tr><th id="6385">6385</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1136corepages" title='corepages' data-type='unsigned long' data-ref="1136corepages">corepages</dfn>;</td></tr>
<tr><th id="6386">6386</th><td></td></tr>
<tr><th id="6387">6387</th><td>		<i>/*</i></td></tr>
<tr><th id="6388">6388</th><td><i>		 * Round-up so that ZONE_MOVABLE is at least as large as what</i></td></tr>
<tr><th id="6389">6389</th><td><i>		 * was requested by the user</i></td></tr>
<tr><th id="6390">6390</th><td><i>		 */</i></td></tr>
<tr><th id="6391">6391</th><td>		<a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='w' data-ref="required_movablecore">required_movablecore</a> =</td></tr>
<tr><th id="6392">6392</th><td>			<a class="macro" href="../include/linux/kernel.h.html#113" title="( { const typeof((1 &lt;&lt; (11 - 1))) __y = (1 &lt;&lt; (11 - 1)); (((required_movablecore) + (__y - 1)) / __y) * __y; } )" data-ref="_M/roundup">roundup</a>(<a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='r' data-ref="required_movablecore">required_movablecore</a>, <a class="macro" href="../include/linux/mmzone.h.html#29" title="(1 &lt;&lt; (11 - 1))" data-ref="_M/MAX_ORDER_NR_PAGES">MAX_ORDER_NR_PAGES</a>);</td></tr>
<tr><th id="6393">6393</th><td>		<a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='w' data-ref="required_movablecore">required_movablecore</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(totalpages) __UNIQUE_ID_min1_285 = (totalpages); typeof(required_movablecore) __UNIQUE_ID_min2_286 = (required_movablecore); (void) (&amp;__UNIQUE_ID_min1_285 == &amp;__UNIQUE_ID_min2_286); __UNIQUE_ID_min1_285 &lt; __UNIQUE_ID_min2_286 ? __UNIQUE_ID_min1_285 : __UNIQUE_ID_min2_286; })" data-ref="_M/min">min</a>(<a class="local col1 ref" href="#1131totalpages" title='totalpages' data-ref="1131totalpages">totalpages</a>, <a class="tu ref" href="#required_movablecore" title='required_movablecore' data-ref="required_movablecore"><a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='r' data-ref="required_movablecore">required_movablecore</a></a>);</td></tr>
<tr><th id="6394">6394</th><td>		<a class="local col6 ref" href="#1136corepages" title='corepages' data-ref="1136corepages">corepages</a> = <a class="local col1 ref" href="#1131totalpages" title='totalpages' data-ref="1131totalpages">totalpages</a> - <a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='r' data-ref="required_movablecore">required_movablecore</a>;</td></tr>
<tr><th id="6395">6395</th><td></td></tr>
<tr><th id="6396">6396</th><td>		<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='w' data-ref="required_kernelcore">required_kernelcore</a> = <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(required_kernelcore) __UNIQUE_ID_max1_289 = (required_kernelcore); typeof(corepages) __UNIQUE_ID_max2_290 = (corepages); (void) (&amp;__UNIQUE_ID_max1_289 == &amp;__UNIQUE_ID_max2_290); __UNIQUE_ID_max1_289 &gt; __UNIQUE_ID_max2_290 ? __UNIQUE_ID_max1_289 : __UNIQUE_ID_max2_290; })" data-ref="_M/max">max</a>(<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-ref="required_kernelcore"><a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a></a>, <a class="local col6 ref" href="#1136corepages" title='corepages' data-ref="1136corepages">corepages</a>);</td></tr>
<tr><th id="6397">6397</th><td>	}</td></tr>
<tr><th id="6398">6398</th><td></td></tr>
<tr><th id="6399">6399</th><td>	<i>/*</i></td></tr>
<tr><th id="6400">6400</th><td><i>	 * If kernelcore was not specified or kernelcore size is larger</i></td></tr>
<tr><th id="6401">6401</th><td><i>	 * than totalpages, there is no ZONE_MOVABLE.</i></td></tr>
<tr><th id="6402">6402</th><td><i>	 */</i></td></tr>
<tr><th id="6403">6403</th><td>	<b>if</b> (!<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a> || <a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a> &gt;= <a class="local col1 ref" href="#1131totalpages" title='totalpages' data-ref="1131totalpages">totalpages</a>)</td></tr>
<tr><th id="6404">6404</th><td>		<b>goto</b> <a class="lbl" href="#1137out" data-ref="1137out">out</a>;</td></tr>
<tr><th id="6405">6405</th><td></td></tr>
<tr><th id="6406">6406</th><td>	<i>/* usable_startpfn is the lowest possible pfn ZONE_MOVABLE can be at */</i></td></tr>
<tr><th id="6407">6407</th><td>	<a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a> = <a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="ref" href="../include/linux/mmzone.h.html#movable_zone" title='movable_zone' data-ref="movable_zone">movable_zone</a>];</td></tr>
<tr><th id="6408">6408</th><td></td></tr>
<tr><th id="6409">6409</th><td><dfn class="lbl" id="1138restart" data-ref="1138restart">restart</dfn>:</td></tr>
<tr><th id="6410">6410</th><td>	<i>/* Spread kernelcore memory as evenly as possible throughout nodes */</i></td></tr>
<tr><th id="6411">6411</th><td>	<a class="local col8 ref" href="#1128kernelcore_node" title='kernelcore_node' data-ref="1128kernelcore_node">kernelcore_node</a> = <a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a> / <a class="local col2 ref" href="#1132usable_nodes" title='usable_nodes' data-ref="1132usable_nodes">usable_nodes</a>;</td></tr>
<tr><th id="6412">6412</th><td>	<a class="macro" href="../include/linux/nodemask.h.html#473" title="for ( (nid) = 0; (nid) == 0; (nid) = 1)" data-ref="_M/for_each_node_state">for_each_node_state</a>(<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>, N_MEMORY) {</td></tr>
<tr><th id="6413">6413</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1139start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1139start_pfn">start_pfn</dfn>, <dfn class="local col0 decl" id="1140end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1140end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="6414">6414</th><td></td></tr>
<tr><th id="6415">6415</th><td>		<i>/*</i></td></tr>
<tr><th id="6416">6416</th><td><i>		 * Recalculate kernelcore_node if the division per node</i></td></tr>
<tr><th id="6417">6417</th><td><i>		 * now exceeds what is necessary to satisfy the requested</i></td></tr>
<tr><th id="6418">6418</th><td><i>		 * amount of memory for the kernel</i></td></tr>
<tr><th id="6419">6419</th><td><i>		 */</i></td></tr>
<tr><th id="6420">6420</th><td>		<b>if</b> (<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a> &lt; <a class="local col8 ref" href="#1128kernelcore_node" title='kernelcore_node' data-ref="1128kernelcore_node">kernelcore_node</a>)</td></tr>
<tr><th id="6421">6421</th><td>			<a class="local col8 ref" href="#1128kernelcore_node" title='kernelcore_node' data-ref="1128kernelcore_node">kernelcore_node</a> = <a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a> / <a class="local col2 ref" href="#1132usable_nodes" title='usable_nodes' data-ref="1132usable_nodes">usable_nodes</a>;</td></tr>
<tr><th id="6422">6422</th><td></td></tr>
<tr><th id="6423">6423</th><td>		<i>/*</i></td></tr>
<tr><th id="6424">6424</th><td><i>		 * As the map is walked, we track how much memory is usable</i></td></tr>
<tr><th id="6425">6425</th><td><i>		 * by the kernel using kernelcore_remaining. When it is</i></td></tr>
<tr><th id="6426">6426</th><td><i>		 * 0, the rest of the node is usable by ZONE_MOVABLE</i></td></tr>
<tr><th id="6427">6427</th><td><i>		 */</i></td></tr>
<tr><th id="6428">6428</th><td>		<a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a> = <a class="local col8 ref" href="#1128kernelcore_node" title='kernelcore_node' data-ref="1128kernelcore_node">kernelcore_node</a>;</td></tr>
<tr><th id="6429">6429</th><td></td></tr>
<tr><th id="6430">6430</th><td>		<i>/* Go through each range of PFNs within this node */</i></td></tr>
<tr><th id="6431">6431</th><td>		<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, ((void *)0)); i &gt;= 0; __next_mem_pfn_range(&amp;i, nid, &amp;start_pfn, &amp;end_pfn, ((void *)0)))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col5 ref" href="#1125i" title='i' data-ref="1125i">i</a>, <a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>, &amp;<a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a>, &amp;<a class="local col0 ref" href="#1140end_pfn" title='end_pfn' data-ref="1140end_pfn">end_pfn</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="6432">6432</th><td>			<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="1141size_pages" title='size_pages' data-type='unsigned long' data-ref="1141size_pages">size_pages</dfn>;</td></tr>
<tr><th id="6433">6433</th><td></td></tr>
<tr><th id="6434">6434</th><td>			<a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(start_pfn) __UNIQUE_ID_max1_293 = (start_pfn); typeof(zone_movable_pfn[nid]) __UNIQUE_ID_max2_294 = (zone_movable_pfn[nid]); (void) (&amp;__UNIQUE_ID_max1_293 == &amp;__UNIQUE_ID_max2_294); __UNIQUE_ID_max1_293 &gt; __UNIQUE_ID_max2_294 ? __UNIQUE_ID_max1_293 : __UNIQUE_ID_max2_294; })" data-ref="_M/max">max</a>(<a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a>, <a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-ref="zone_movable_pfn"><a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a></a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>]);</td></tr>
<tr><th id="6435">6435</th><td>			<b>if</b> (<a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a> &gt;= <a class="local col0 ref" href="#1140end_pfn" title='end_pfn' data-ref="1140end_pfn">end_pfn</a>)</td></tr>
<tr><th id="6436">6436</th><td>				<b>continue</b>;</td></tr>
<tr><th id="6437">6437</th><td></td></tr>
<tr><th id="6438">6438</th><td>			<i>/* Account for what is only usable for kernelcore */</i></td></tr>
<tr><th id="6439">6439</th><td>			<b>if</b> (<a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a> &lt; <a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>) {</td></tr>
<tr><th id="6440">6440</th><td>				<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1142kernel_pages" title='kernel_pages' data-type='unsigned long' data-ref="1142kernel_pages">kernel_pages</dfn>;</td></tr>
<tr><th id="6441">6441</th><td>				<a class="local col2 ref" href="#1142kernel_pages" title='kernel_pages' data-ref="1142kernel_pages">kernel_pages</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(end_pfn) __UNIQUE_ID_min1_297 = (end_pfn); typeof(usable_startpfn) __UNIQUE_ID_min2_298 = (usable_startpfn); (void) (&amp;__UNIQUE_ID_min1_297 == &amp;__UNIQUE_ID_min2_298); __UNIQUE_ID_min1_297 &lt; __UNIQUE_ID_min2_298 ? __UNIQUE_ID_min1_297 : __UNIQUE_ID_min2_298; })" data-ref="_M/min">min</a>(<a class="local col0 ref" href="#1140end_pfn" title='end_pfn' data-ref="1140end_pfn">end_pfn</a>, <a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>)</td></tr>
<tr><th id="6442">6442</th><td>								- <a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a>;</td></tr>
<tr><th id="6443">6443</th><td></td></tr>
<tr><th id="6444">6444</th><td>				<a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a> -= <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(kernel_pages) __UNIQUE_ID_min1_301 = (kernel_pages); typeof(kernelcore_remaining) __UNIQUE_ID_min2_302 = (kernelcore_remaining); (void) (&amp;__UNIQUE_ID_min1_301 == &amp;__UNIQUE_ID_min2_302); __UNIQUE_ID_min1_301 &lt; __UNIQUE_ID_min2_302 ? __UNIQUE_ID_min1_301 : __UNIQUE_ID_min2_302; })" data-ref="_M/min">min</a>(<a class="local col2 ref" href="#1142kernel_pages" title='kernel_pages' data-ref="1142kernel_pages">kernel_pages</a>,</td></tr>
<tr><th id="6445">6445</th><td>							<a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a>);</td></tr>
<tr><th id="6446">6446</th><td>				<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='w' data-ref="required_kernelcore">required_kernelcore</a> -= <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(kernel_pages) __UNIQUE_ID_min1_305 = (kernel_pages); typeof(required_kernelcore) __UNIQUE_ID_min2_306 = (required_kernelcore); (void) (&amp;__UNIQUE_ID_min1_305 == &amp;__UNIQUE_ID_min2_306); __UNIQUE_ID_min1_305 &lt; __UNIQUE_ID_min2_306 ? __UNIQUE_ID_min1_305 : __UNIQUE_ID_min2_306; })" data-ref="_M/min">min</a>(<a class="local col2 ref" href="#1142kernel_pages" title='kernel_pages' data-ref="1142kernel_pages">kernel_pages</a>,</td></tr>
<tr><th id="6447">6447</th><td>							<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-ref="required_kernelcore"><a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a></a>);</td></tr>
<tr><th id="6448">6448</th><td></td></tr>
<tr><th id="6449">6449</th><td>				<i>/* Continue if range is now fully accounted */</i></td></tr>
<tr><th id="6450">6450</th><td>				<b>if</b> (<a class="local col0 ref" href="#1140end_pfn" title='end_pfn' data-ref="1140end_pfn">end_pfn</a> &lt;= <a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>) {</td></tr>
<tr><th id="6451">6451</th><td></td></tr>
<tr><th id="6452">6452</th><td>					<i>/*</i></td></tr>
<tr><th id="6453">6453</th><td><i>					 * Push zone_movable_pfn to the end so</i></td></tr>
<tr><th id="6454">6454</th><td><i>					 * that if we have to rebalance</i></td></tr>
<tr><th id="6455">6455</th><td><i>					 * kernelcore across nodes, we will</i></td></tr>
<tr><th id="6456">6456</th><td><i>					 * not double account here</i></td></tr>
<tr><th id="6457">6457</th><td><i>					 */</i></td></tr>
<tr><th id="6458">6458</th><td>					<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='w' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] = <a class="local col0 ref" href="#1140end_pfn" title='end_pfn' data-ref="1140end_pfn">end_pfn</a>;</td></tr>
<tr><th id="6459">6459</th><td>					<b>continue</b>;</td></tr>
<tr><th id="6460">6460</th><td>				}</td></tr>
<tr><th id="6461">6461</th><td>				<a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a> = <a class="local col7 ref" href="#1127usable_startpfn" title='usable_startpfn' data-ref="1127usable_startpfn">usable_startpfn</a>;</td></tr>
<tr><th id="6462">6462</th><td>			}</td></tr>
<tr><th id="6463">6463</th><td></td></tr>
<tr><th id="6464">6464</th><td>			<i>/*</i></td></tr>
<tr><th id="6465">6465</th><td><i>			 * The usable PFN range for ZONE_MOVABLE is from</i></td></tr>
<tr><th id="6466">6466</th><td><i>			 * start_pfn-&gt;end_pfn. Calculate size_pages as the</i></td></tr>
<tr><th id="6467">6467</th><td><i>			 * number of pages used as kernelcore</i></td></tr>
<tr><th id="6468">6468</th><td><i>			 */</i></td></tr>
<tr><th id="6469">6469</th><td>			<a class="local col1 ref" href="#1141size_pages" title='size_pages' data-ref="1141size_pages">size_pages</a> = <a class="local col0 ref" href="#1140end_pfn" title='end_pfn' data-ref="1140end_pfn">end_pfn</a> - <a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a>;</td></tr>
<tr><th id="6470">6470</th><td>			<b>if</b> (<a class="local col1 ref" href="#1141size_pages" title='size_pages' data-ref="1141size_pages">size_pages</a> &gt; <a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a>)</td></tr>
<tr><th id="6471">6471</th><td>				<a class="local col1 ref" href="#1141size_pages" title='size_pages' data-ref="1141size_pages">size_pages</a> = <a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a>;</td></tr>
<tr><th id="6472">6472</th><td>			<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='w' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] = <a class="local col9 ref" href="#1139start_pfn" title='start_pfn' data-ref="1139start_pfn">start_pfn</a> + <a class="local col1 ref" href="#1141size_pages" title='size_pages' data-ref="1141size_pages">size_pages</a>;</td></tr>
<tr><th id="6473">6473</th><td></td></tr>
<tr><th id="6474">6474</th><td>			<i>/*</i></td></tr>
<tr><th id="6475">6475</th><td><i>			 * Some kernelcore has been met, update counts and</i></td></tr>
<tr><th id="6476">6476</th><td><i>			 * break if the kernelcore for this node has been</i></td></tr>
<tr><th id="6477">6477</th><td><i>			 * satisfied</i></td></tr>
<tr><th id="6478">6478</th><td><i>			 */</i></td></tr>
<tr><th id="6479">6479</th><td>			<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='w' data-ref="required_kernelcore">required_kernelcore</a> -= <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(required_kernelcore) __UNIQUE_ID_min1_309 = (required_kernelcore); typeof(size_pages) __UNIQUE_ID_min2_310 = (size_pages); (void) (&amp;__UNIQUE_ID_min1_309 == &amp;__UNIQUE_ID_min2_310); __UNIQUE_ID_min1_309 &lt; __UNIQUE_ID_min2_310 ? __UNIQUE_ID_min1_309 : __UNIQUE_ID_min2_310; })" data-ref="_M/min">min</a>(<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-ref="required_kernelcore"><a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a></a>,</td></tr>
<tr><th id="6480">6480</th><td>								<a class="local col1 ref" href="#1141size_pages" title='size_pages' data-ref="1141size_pages">size_pages</a>);</td></tr>
<tr><th id="6481">6481</th><td>			<a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a> -= <a class="local col1 ref" href="#1141size_pages" title='size_pages' data-ref="1141size_pages">size_pages</a>;</td></tr>
<tr><th id="6482">6482</th><td>			<b>if</b> (!<a class="local col9 ref" href="#1129kernelcore_remaining" title='kernelcore_remaining' data-ref="1129kernelcore_remaining">kernelcore_remaining</a>)</td></tr>
<tr><th id="6483">6483</th><td>				<b>break</b>;</td></tr>
<tr><th id="6484">6484</th><td>		}</td></tr>
<tr><th id="6485">6485</th><td>	}</td></tr>
<tr><th id="6486">6486</th><td></td></tr>
<tr><th id="6487">6487</th><td>	<i>/*</i></td></tr>
<tr><th id="6488">6488</th><td><i>	 * If there is still required_kernelcore, we do another pass with one</i></td></tr>
<tr><th id="6489">6489</th><td><i>	 * less node in the count. This will push zone_movable_pfn[nid] further</i></td></tr>
<tr><th id="6490">6490</th><td><i>	 * along on the nodes that still have memory until kernelcore is</i></td></tr>
<tr><th id="6491">6491</th><td><i>	 * satisfied</i></td></tr>
<tr><th id="6492">6492</th><td><i>	 */</i></td></tr>
<tr><th id="6493">6493</th><td>	<a class="local col2 ref" href="#1132usable_nodes" title='usable_nodes' data-ref="1132usable_nodes">usable_nodes</a>--;</td></tr>
<tr><th id="6494">6494</th><td>	<b>if</b> (<a class="local col2 ref" href="#1132usable_nodes" title='usable_nodes' data-ref="1132usable_nodes">usable_nodes</a> &amp;&amp; <a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='r' data-ref="required_kernelcore">required_kernelcore</a> &gt; <a class="local col2 ref" href="#1132usable_nodes" title='usable_nodes' data-ref="1132usable_nodes">usable_nodes</a>)</td></tr>
<tr><th id="6495">6495</th><td>		<b>goto</b> <a class="lbl" href="#1138restart" data-ref="1138restart">restart</a>;</td></tr>
<tr><th id="6496">6496</th><td></td></tr>
<tr><th id="6497">6497</th><td><dfn class="lbl" id="1134out2" data-ref="1134out2">out2</dfn>:</td></tr>
<tr><th id="6498">6498</th><td>	<i>/* Align start of ZONE_MOVABLE on all nids to MAX_ORDER_NR_PAGES */</i></td></tr>
<tr><th id="6499">6499</th><td>	<b>for</b> (<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a> = <var>0</var>; <a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a> &lt; <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>; <a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>++)</td></tr>
<tr><th id="6500">6500</th><td>		<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='w' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>] =</td></tr>
<tr><th id="6501">6501</th><td>			<a class="macro" href="../include/linux/kernel.h.html#113" title="( { const typeof((1 &lt;&lt; (11 - 1))) __y = (1 &lt;&lt; (11 - 1)); (((zone_movable_pfn[nid]) + (__y - 1)) / __y) * __y; } )" data-ref="_M/roundup">roundup</a>(<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col6 ref" href="#1126nid" title='nid' data-ref="1126nid">nid</a>], <a class="macro" href="../include/linux/mmzone.h.html#29" title="(1 &lt;&lt; (11 - 1))" data-ref="_M/MAX_ORDER_NR_PAGES">MAX_ORDER_NR_PAGES</a>);</td></tr>
<tr><th id="6502">6502</th><td></td></tr>
<tr><th id="6503">6503</th><td><dfn class="lbl" id="1137out" data-ref="1137out">out</dfn>:</td></tr>
<tr><th id="6504">6504</th><td>	<i>/* restore the node_state */</i></td></tr>
<tr><th id="6505">6505</th><td>	<a class="ref" href="../include/linux/nodemask.h.html#node_states" title='node_states' data-ref="node_states">node_states</a>[<a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a>] = <a class="local col0 ref" href="#1130saved_node_state" title='saved_node_state' data-ref="1130saved_node_state">saved_node_state</a>;</td></tr>
<tr><th id="6506">6506</th><td>}</td></tr>
<tr><th id="6507">6507</th><td></td></tr>
<tr><th id="6508">6508</th><td><i  data-doc="check_for_memory">/* Any regular or high memory on that node ? */</i></td></tr>
<tr><th id="6509">6509</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="check_for_memory" title='check_for_memory' data-type='void check_for_memory(pg_data_t * pgdat, int nid)' data-ref="check_for_memory">check_for_memory</dfn>(<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col3 decl" id="1143pgdat" title='pgdat' data-type='pg_data_t *' data-ref="1143pgdat">pgdat</dfn>, <em>int</em> <dfn class="local col4 decl" id="1144nid" title='nid' data-type='int' data-ref="1144nid">nid</dfn>)</td></tr>
<tr><th id="6510">6510</th><td>{</td></tr>
<tr><th id="6511">6511</th><td>	<b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#zone_type" title='zone_type' data-ref="zone_type">zone_type</a> <dfn class="local col5 decl" id="1145zone_type" title='zone_type' data-type='enum zone_type' data-ref="1145zone_type">zone_type</dfn>;</td></tr>
<tr><th id="6512">6512</th><td></td></tr>
<tr><th id="6513">6513</th><td>	<b>if</b> (<a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a> == <a class="enum" href="../include/linux/nodemask.h.html#N_NORMAL_MEMORY" title='N_NORMAL_MEMORY' data-ref="N_NORMAL_MEMORY">N_NORMAL_MEMORY</a>)</td></tr>
<tr><th id="6514">6514</th><td>		<b>return</b>;</td></tr>
<tr><th id="6515">6515</th><td></td></tr>
<tr><th id="6516">6516</th><td>	<b>for</b> (<a class="local col5 ref" href="#1145zone_type" title='zone_type' data-ref="1145zone_type">zone_type</a> = <var>0</var>; <a class="local col5 ref" href="#1145zone_type" title='zone_type' data-ref="1145zone_type">zone_type</a> &lt;= <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a> - <var>1</var>; <a class="local col5 ref" href="#1145zone_type" title='zone_type' data-ref="1145zone_type">zone_type</a>++) {</td></tr>
<tr><th id="6517">6517</th><td>		<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col6 decl" id="1146zone" title='zone' data-type='struct zone *' data-ref="1146zone">zone</dfn> = &amp;<a class="local col3 ref" href="#1143pgdat" title='pgdat' data-ref="1143pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a>[<a class="local col5 ref" href="#1145zone_type" title='zone_type' data-ref="1145zone_type">zone_type</a>];</td></tr>
<tr><th id="6518">6518</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mmzone.h.html#populated_zone" title='populated_zone' data-ref="populated_zone">populated_zone</a>(<a class="local col6 ref" href="#1146zone" title='zone' data-ref="1146zone">zone</a>)) {</td></tr>
<tr><th id="6519">6519</th><td>			<a class="ref fn" href="../include/linux/nodemask.h.html#node_set_state" title='node_set_state' data-ref="node_set_state">node_set_state</a>(<a class="local col4 ref" href="#1144nid" title='nid' data-ref="1144nid">nid</a>, <a class="enum" href="../include/linux/nodemask.h.html#N_HIGH_MEMORY" title='N_HIGH_MEMORY' data-ref="N_HIGH_MEMORY">N_HIGH_MEMORY</a>);</td></tr>
<tr><th id="6520">6520</th><td>			<b>if</b> (<a class="enum" href="../include/linux/nodemask.h.html#N_NORMAL_MEMORY" title='N_NORMAL_MEMORY' data-ref="N_NORMAL_MEMORY">N_NORMAL_MEMORY</a> != <a class="enum" href="../include/linux/nodemask.h.html#N_HIGH_MEMORY" title='N_HIGH_MEMORY' data-ref="N_HIGH_MEMORY">N_HIGH_MEMORY</a> &amp;&amp;</td></tr>
<tr><th id="6521">6521</th><td>			    <a class="local col5 ref" href="#1145zone_type" title='zone_type' data-ref="1145zone_type">zone_type</a> &lt;= <a class="enum" href="../include/linux/mmzone.h.html#ZONE_NORMAL" title='ZONE_NORMAL' data-ref="ZONE_NORMAL">ZONE_NORMAL</a>)</td></tr>
<tr><th id="6522">6522</th><td>				<a class="ref fn" href="../include/linux/nodemask.h.html#node_set_state" title='node_set_state' data-ref="node_set_state">node_set_state</a>(<a class="local col4 ref" href="#1144nid" title='nid' data-ref="1144nid">nid</a>, <a class="enum" href="../include/linux/nodemask.h.html#N_NORMAL_MEMORY" title='N_NORMAL_MEMORY' data-ref="N_NORMAL_MEMORY">N_NORMAL_MEMORY</a>);</td></tr>
<tr><th id="6523">6523</th><td>			<b>break</b>;</td></tr>
<tr><th id="6524">6524</th><td>		}</td></tr>
<tr><th id="6525">6525</th><td>	}</td></tr>
<tr><th id="6526">6526</th><td>}</td></tr>
<tr><th id="6527">6527</th><td></td></tr>
<tr><th id="6528">6528</th><td><i class="doc">/**</i></td></tr>
<tr><th id="6529">6529</th><td><i class="doc"> * free_area_init_nodes - Initialise all pg_data_t and zone data</i></td></tr>
<tr><th id="6530">6530</th><td><i class="doc"> *<span class="command"> @max</span>_zone_pfn: an array of max PFNs for each zone</i></td></tr>
<tr><th id="6531">6531</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6532">6532</th><td><i class="doc"> * This will call free_area_init_node() for each active node in the system.</i></td></tr>
<tr><th id="6533">6533</th><td><i class="doc"> * Using the page ranges provided by memblock_set_node(), the size of each</i></td></tr>
<tr><th id="6534">6534</th><td><i class="doc"> * zone in each node and their holes is calculated. If the maximum PFN</i></td></tr>
<tr><th id="6535">6535</th><td><i class="doc"> * between two adjacent zones match, it is assumed that the zone is empty.</i></td></tr>
<tr><th id="6536">6536</th><td><i class="doc"> * For example, if arch_max_dma_pfn == arch_max_dma32_pfn, it is assumed</i></td></tr>
<tr><th id="6537">6537</th><td><i class="doc"> * that arch_max_dma32_pfn has no pages. It is also assumed that a zone</i></td></tr>
<tr><th id="6538">6538</th><td><i class="doc"> * starts where the previous one ended. For example, ZONE_DMA32 starts</i></td></tr>
<tr><th id="6539">6539</th><td><i class="doc"> * at arch_max_dma_pfn.</i></td></tr>
<tr><th id="6540">6540</th><td><i class="doc"> */</i></td></tr>
<tr><th id="6541">6541</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="free_area_init_nodes" title='free_area_init_nodes' data-ref="free_area_init_nodes">free_area_init_nodes</dfn>(<em>unsigned</em> <em>long</em> *<dfn class="local col7 decl" id="1147max_zone_pfn" title='max_zone_pfn' data-type='unsigned long *' data-ref="1147max_zone_pfn">max_zone_pfn</dfn>)</td></tr>
<tr><th id="6542">6542</th><td>{</td></tr>
<tr><th id="6543">6543</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1148start_pfn" title='start_pfn' data-type='unsigned long' data-ref="1148start_pfn">start_pfn</dfn>, <dfn class="local col9 decl" id="1149end_pfn" title='end_pfn' data-type='unsigned long' data-ref="1149end_pfn">end_pfn</dfn>;</td></tr>
<tr><th id="6544">6544</th><td>	<em>int</em> <dfn class="local col0 decl" id="1150i" title='i' data-type='int' data-ref="1150i">i</dfn>, <dfn class="local col1 decl" id="1151nid" title='nid' data-type='int' data-ref="1151nid">nid</dfn>;</td></tr>
<tr><th id="6545">6545</th><td></td></tr>
<tr><th id="6546">6546</th><td>	<i>/* Record where the zone boundaries are */</i></td></tr>
<tr><th id="6547">6547</th><td>	<a class="ref fn" href="../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>, <var>0</var>,</td></tr>
<tr><th id="6548">6548</th><td>				<b>sizeof</b>(<a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>));</td></tr>
<tr><th id="6549">6549</th><td>	<a class="ref fn" href="../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>, <var>0</var>,</td></tr>
<tr><th id="6550">6550</th><td>				<b>sizeof</b>(<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>));</td></tr>
<tr><th id="6551">6551</th><td></td></tr>
<tr><th id="6552">6552</th><td>	<a class="local col8 ref" href="#1148start_pfn" title='start_pfn' data-ref="1148start_pfn">start_pfn</a> = <a class="ref fn" href="#find_min_pfn_with_active_regions" title='find_min_pfn_with_active_regions' data-ref="find_min_pfn_with_active_regions">find_min_pfn_with_active_regions</a>();</td></tr>
<tr><th id="6553">6553</th><td></td></tr>
<tr><th id="6554">6554</th><td>	<b>for</b> (<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> = <var>0</var>; <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>++) {</td></tr>
<tr><th id="6555">6555</th><td>		<b>if</b> (<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a>)</td></tr>
<tr><th id="6556">6556</th><td>			<b>continue</b>;</td></tr>
<tr><th id="6557">6557</th><td></td></tr>
<tr><th id="6558">6558</th><td>		<a class="local col9 ref" href="#1149end_pfn" title='end_pfn' data-ref="1149end_pfn">end_pfn</a> = <a class="macro" href="../include/linux/kernel.h.html#815" title="({ typeof(max_zone_pfn[i]) __UNIQUE_ID_max1_313 = (max_zone_pfn[i]); typeof(start_pfn) __UNIQUE_ID_max2_314 = (start_pfn); (void) (&amp;__UNIQUE_ID_max1_313 == &amp;__UNIQUE_ID_max2_314); __UNIQUE_ID_max1_313 &gt; __UNIQUE_ID_max2_314 ? __UNIQUE_ID_max1_313 : __UNIQUE_ID_max2_314; })" data-ref="_M/max">max</a>(<a class="local col7 ref" href="#1147max_zone_pfn" title='max_zone_pfn' data-ref="1147max_zone_pfn">max_zone_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>], <a class="local col8 ref" href="#1148start_pfn" title='start_pfn' data-ref="1148start_pfn">start_pfn</a>);</td></tr>
<tr><th id="6559">6559</th><td>		<a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='w' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>] = <a class="local col8 ref" href="#1148start_pfn" title='start_pfn' data-ref="1148start_pfn">start_pfn</a>;</td></tr>
<tr><th id="6560">6560</th><td>		<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='w' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>] = <a class="local col9 ref" href="#1149end_pfn" title='end_pfn' data-ref="1149end_pfn">end_pfn</a>;</td></tr>
<tr><th id="6561">6561</th><td></td></tr>
<tr><th id="6562">6562</th><td>		<a class="local col8 ref" href="#1148start_pfn" title='start_pfn' data-ref="1148start_pfn">start_pfn</a> = <a class="local col9 ref" href="#1149end_pfn" title='end_pfn' data-ref="1149end_pfn">end_pfn</a>;</td></tr>
<tr><th id="6563">6563</th><td>	}</td></tr>
<tr><th id="6564">6564</th><td></td></tr>
<tr><th id="6565">6565</th><td>	<i>/* Find the PFNs that ZONE_MOVABLE begins at in each node */</i></td></tr>
<tr><th id="6566">6566</th><td>	<a class="ref fn" href="../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>, <var>0</var>, <b>sizeof</b>(<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>));</td></tr>
<tr><th id="6567">6567</th><td>	<a class="tu ref fn" href="#find_zone_movable_pfns_for_nodes" title='find_zone_movable_pfns_for_nodes' data-use='c' data-ref="find_zone_movable_pfns_for_nodes">find_zone_movable_pfns_for_nodes</a>();</td></tr>
<tr><th id="6568">6568</th><td></td></tr>
<tr><th id="6569">6569</th><td>	<i>/* Print out the zone ranges */</i></td></tr>
<tr><th id="6570">6570</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Zone ranges:\n&quot;)" data-ref="_M/pr_info">pr_info</a>(<q>"Zone ranges:\n"</q>);</td></tr>
<tr><th id="6571">6571</th><td>	<b>for</b> (<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> = <var>0</var>; <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>++) {</td></tr>
<tr><th id="6572">6572</th><td>		<b>if</b> (<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a>)</td></tr>
<tr><th id="6573">6573</th><td>			<b>continue</b>;</td></tr>
<tr><th id="6574">6574</th><td>		<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;  %-8s &quot;, zone_names[i])" data-ref="_M/pr_info">pr_info</a>(<q>"  %-8s "</q>, <a class="tu ref" href="#zone_names" title='zone_names' data-use='r' data-ref="zone_names">zone_names</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>]);</td></tr>
<tr><th id="6575">6575</th><td>		<b>if</b> (<a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>] ==</td></tr>
<tr><th id="6576">6576</th><td>				<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>])</td></tr>
<tr><th id="6577">6577</th><td>			<a class="macro" href="../include/linux/printk.h.html#315" title="printk(&quot;\001&quot; &quot;c&quot; &quot;empty\n&quot;)" data-ref="_M/pr_cont">pr_cont</a>(<q>"empty\n"</q>);</td></tr>
<tr><th id="6578">6578</th><td>		<b>else</b></td></tr>
<tr><th id="6579">6579</th><td>			<a class="macro" href="../include/linux/printk.h.html#315" title="printk(&quot;\001&quot; &quot;c&quot; &quot;[mem %#018Lx-%#018Lx]\n&quot;, (u64)arch_zone_lowest_possible_pfn[i] &lt;&lt; 12, ((u64)arch_zone_highest_possible_pfn[i] &lt;&lt; 12) - 1)" data-ref="_M/pr_cont">pr_cont</a>(<q>"[mem %#018Lx-%#018Lx]\n"</q>,</td></tr>
<tr><th id="6580">6580</th><td>				(<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="tu ref" href="#arch_zone_lowest_possible_pfn" title='arch_zone_lowest_possible_pfn' data-use='r' data-ref="arch_zone_lowest_possible_pfn">arch_zone_lowest_possible_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>]</td></tr>
<tr><th id="6581">6581</th><td>					&lt;&lt; PAGE_SHIFT,</td></tr>
<tr><th id="6582">6582</th><td>				((<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="tu ref" href="#arch_zone_highest_possible_pfn" title='arch_zone_highest_possible_pfn' data-use='r' data-ref="arch_zone_highest_possible_pfn">arch_zone_highest_possible_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>]</td></tr>
<tr><th id="6583">6583</th><td>					&lt;&lt; PAGE_SHIFT) - <var>1</var>);</td></tr>
<tr><th id="6584">6584</th><td>	}</td></tr>
<tr><th id="6585">6585</th><td></td></tr>
<tr><th id="6586">6586</th><td>	<i>/* Print out the PFNs ZONE_MOVABLE begins at in each node */</i></td></tr>
<tr><th id="6587">6587</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Movable zone start for each node\n&quot;)" data-ref="_M/pr_info">pr_info</a>(<q>"Movable zone start for each node\n"</q>);</td></tr>
<tr><th id="6588">6588</th><td>	<b>for</b> (<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> = <var>0</var>; <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a> &lt; <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>; <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>++) {</td></tr>
<tr><th id="6589">6589</th><td>		<b>if</b> (<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>])</td></tr>
<tr><th id="6590">6590</th><td>			<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;  Node %d: %#018Lx\n&quot;, i, (u64)zone_movable_pfn[i] &lt;&lt; 12)" data-ref="_M/pr_info">pr_info</a>(<q>"  Node %d: %#018Lx\n"</q>, <a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>,</td></tr>
<tr><th id="6591">6591</th><td>			       (<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="tu ref" href="#zone_movable_pfn" title='zone_movable_pfn' data-use='r' data-ref="zone_movable_pfn">zone_movable_pfn</a>[<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>] &lt;&lt; PAGE_SHIFT);</td></tr>
<tr><th id="6592">6592</th><td>	}</td></tr>
<tr><th id="6593">6593</th><td></td></tr>
<tr><th id="6594">6594</th><td>	<i>/* Print out the early node map */</i></td></tr>
<tr><th id="6595">6595</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Early memory node ranges\n&quot;)" data-ref="_M/pr_info">pr_info</a>(<q>"Early memory node ranges\n"</q>);</td></tr>
<tr><th id="6596">6596</th><td>	<a class="macro" href="../include/linux/memblock.h.html#201" title="for (i = -1, __next_mem_pfn_range(&amp;i, (1 &lt;&lt; 0), &amp;start_pfn, &amp;end_pfn, &amp;nid); i &gt;= 0; __next_mem_pfn_range(&amp;i, (1 &lt;&lt; 0), &amp;start_pfn, &amp;end_pfn, &amp;nid))" data-ref="_M/for_each_mem_pfn_range">for_each_mem_pfn_range</a>(<a class="local col0 ref" href="#1150i" title='i' data-ref="1150i">i</a>, <a class="macro" href="../include/linux/numa.h.html#12" title="(1 &lt;&lt; 0)" data-ref="_M/MAX_NUMNODES">MAX_NUMNODES</a>, &amp;<a class="local col8 ref" href="#1148start_pfn" title='start_pfn' data-ref="1148start_pfn">start_pfn</a>, &amp;<a class="local col9 ref" href="#1149end_pfn" title='end_pfn' data-ref="1149end_pfn">end_pfn</a>, &amp;<a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>)</td></tr>
<tr><th id="6597">6597</th><td>		<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;  node %3d: [mem %#018Lx-%#018Lx]\n&quot;, nid, (u64)start_pfn &lt;&lt; 12, ((u64)end_pfn &lt;&lt; 12) - 1)" data-ref="_M/pr_info">pr_info</a>(<q>"  node %3d: [mem %#018Lx-%#018Lx]\n"</q>, <a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>,</td></tr>
<tr><th id="6598">6598</th><td>			(<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="local col8 ref" href="#1148start_pfn" title='start_pfn' data-ref="1148start_pfn">start_pfn</a> &lt;&lt; PAGE_SHIFT,</td></tr>
<tr><th id="6599">6599</th><td>			((<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="local col9 ref" href="#1149end_pfn" title='end_pfn' data-ref="1149end_pfn">end_pfn</a> &lt;&lt; PAGE_SHIFT) - <var>1</var>);</td></tr>
<tr><th id="6600">6600</th><td></td></tr>
<tr><th id="6601">6601</th><td>	<i>/* Initialise every node */</i></td></tr>
<tr><th id="6602">6602</th><td>	<a class="ref fn" href="internal.h.html#mminit_verify_pageflags_layout" title='mminit_verify_pageflags_layout' data-ref="mminit_verify_pageflags_layout">mminit_verify_pageflags_layout</a>();</td></tr>
<tr><th id="6603">6603</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#setup_nr_node_ids" title='setup_nr_node_ids' data-ref="setup_nr_node_ids">setup_nr_node_ids</a>();</td></tr>
<tr><th id="6604">6604</th><td>	<a class="macro" href="../include/linux/nodemask.h.html#505" title="for ( (nid) = 0; (nid) == 0; (nid) = 1)" data-ref="_M/for_each_online_node">for_each_online_node</a>(<a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>) {</td></tr>
<tr><th id="6605">6605</th><td>		<a class="typedef" href="../include/linux/mmzone.h.html#pg_data_t" title='pg_data_t' data-type='struct pglist_data' data-ref="pg_data_t">pg_data_t</a> *<dfn class="local col2 decl" id="1152pgdat" title='pgdat' data-type='pg_data_t *' data-ref="1152pgdat">pgdat</dfn> = <a class="macro" href="../include/linux/mmzone.h.html#913" title="(&amp;contig_page_data)" data-ref="_M/NODE_DATA">NODE_DATA</a>(nid);</td></tr>
<tr><th id="6606">6606</th><td>		<a class="ref fn" href="#free_area_init_node" title='free_area_init_node' data-ref="free_area_init_node">free_area_init_node</a>(<a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="6607">6607</th><td>				<a class="tu ref fn" href="#find_min_pfn_for_node" title='find_min_pfn_for_node' data-use='c' data-ref="find_min_pfn_for_node">find_min_pfn_for_node</a>(<a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>), <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="6608">6608</th><td></td></tr>
<tr><th id="6609">6609</th><td>		<i>/* Any memory on that node */</i></td></tr>
<tr><th id="6610">6610</th><td>		<b>if</b> (<a class="local col2 ref" href="#1152pgdat" title='pgdat' data-ref="1152pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_present_pages" title='pglist_data::node_present_pages' data-ref="pglist_data::node_present_pages">node_present_pages</a>)</td></tr>
<tr><th id="6611">6611</th><td>			<a class="ref fn" href="../include/linux/nodemask.h.html#node_set_state" title='node_set_state' data-ref="node_set_state">node_set_state</a>(<a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>, <a class="enum" href="../include/linux/nodemask.h.html#N_MEMORY" title='N_MEMORY' data-ref="N_MEMORY">N_MEMORY</a>);</td></tr>
<tr><th id="6612">6612</th><td>		<a class="tu ref fn" href="#check_for_memory" title='check_for_memory' data-use='c' data-ref="check_for_memory">check_for_memory</a>(<a class="local col2 ref" href="#1152pgdat" title='pgdat' data-ref="1152pgdat">pgdat</a>, <a class="local col1 ref" href="#1151nid" title='nid' data-ref="1151nid">nid</a>);</td></tr>
<tr><th id="6613">6613</th><td>	}</td></tr>
<tr><th id="6614">6614</th><td>}</td></tr>
<tr><th id="6615">6615</th><td></td></tr>
<tr><th id="6616">6616</th><td><em>static</em> <em>int</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="cmdline_parse_core" title='cmdline_parse_core' data-type='int cmdline_parse_core(char * p, unsigned long * core)' data-ref="cmdline_parse_core">cmdline_parse_core</dfn>(<em>char</em> *<dfn class="local col3 decl" id="1153p" title='p' data-type='char *' data-ref="1153p">p</dfn>, <em>unsigned</em> <em>long</em> *<dfn class="local col4 decl" id="1154core" title='core' data-type='unsigned long *' data-ref="1154core">core</dfn>)</td></tr>
<tr><th id="6617">6617</th><td>{</td></tr>
<tr><th id="6618">6618</th><td>	<em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col5 decl" id="1155coremem" title='coremem' data-type='unsigned long long' data-ref="1155coremem">coremem</dfn>;</td></tr>
<tr><th id="6619">6619</th><td>	<b>if</b> (!<a class="local col3 ref" href="#1153p" title='p' data-ref="1153p">p</a>)</td></tr>
<tr><th id="6620">6620</th><td>		<b>return</b> -<a class="macro" href="../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="6621">6621</th><td></td></tr>
<tr><th id="6622">6622</th><td>	<a class="local col5 ref" href="#1155coremem" title='coremem' data-ref="1155coremem">coremem</a> = <a class="ref fn" href="../include/linux/kernel.h.html#memparse" title='memparse' data-ref="memparse">memparse</a>(<a class="local col3 ref" href="#1153p" title='p' data-ref="1153p">p</a>, &amp;<a class="local col3 ref" href="#1153p" title='p' data-ref="1153p">p</a>);</td></tr>
<tr><th id="6623">6623</th><td>	*<a class="local col4 ref" href="#1154core" title='core' data-ref="1154core">core</a> = <a class="local col5 ref" href="#1155coremem" title='coremem' data-ref="1155coremem">coremem</a> &gt;&gt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>;</td></tr>
<tr><th id="6624">6624</th><td></td></tr>
<tr><th id="6625">6625</th><td>	<i>/* Paranoid check that UL is enough for the coremem value */</i></td></tr>
<tr><th id="6626">6626</th><td>	<a class="macro" href="../include/asm-generic/bug.h.html#108" title="({ int __ret_warn_on = !!((coremem &gt;&gt; 12) &gt; (~0UL)); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (6626), &quot;i&quot; ((1 &lt;&lt; 0)|(((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (317)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON">WARN_ON</a>((<a class="local col5 ref" href="#1155coremem" title='coremem' data-ref="1155coremem">coremem</a> &gt;&gt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>) &gt; <a class="macro" href="../include/linux/kernel.h.html#27" title="(~0UL)" data-ref="_M/ULONG_MAX">ULONG_MAX</a>);</td></tr>
<tr><th id="6627">6627</th><td></td></tr>
<tr><th id="6628">6628</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6629">6629</th><td>}</td></tr>
<tr><th id="6630">6630</th><td></td></tr>
<tr><th id="6631">6631</th><td><i  data-doc="cmdline_parse_kernelcore">/*</i></td></tr>
<tr><th id="6632">6632</th><td><i  data-doc="cmdline_parse_kernelcore"> * kernelcore=size sets the amount of memory for use for allocations that</i></td></tr>
<tr><th id="6633">6633</th><td><i  data-doc="cmdline_parse_kernelcore"> * cannot be reclaimed or migrated.</i></td></tr>
<tr><th id="6634">6634</th><td><i  data-doc="cmdline_parse_kernelcore"> */</i></td></tr>
<tr><th id="6635">6635</th><td><em>static</em> <em>int</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="cmdline_parse_kernelcore" title='cmdline_parse_kernelcore' data-type='int cmdline_parse_kernelcore(char * p)' data-ref="cmdline_parse_kernelcore">cmdline_parse_kernelcore</dfn>(<em>char</em> *<dfn class="local col6 decl" id="1156p" title='p' data-type='char *' data-ref="1156p">p</dfn>)</td></tr>
<tr><th id="6636">6636</th><td>{</td></tr>
<tr><th id="6637">6637</th><td>	<i>/* parse kernelcore=mirror */</i></td></tr>
<tr><th id="6638">6638</th><td>	<b>if</b> (<a class="ref fn" href="../include/linux/kernel.h.html#parse_option_str" title='parse_option_str' data-ref="parse_option_str">parse_option_str</a>(<a class="local col6 ref" href="#1156p" title='p' data-ref="1156p">p</a>, <q>"mirror"</q>)) {</td></tr>
<tr><th id="6639">6639</th><td>		<a class="tu ref" href="#mirrored_kernelcore" title='mirrored_kernelcore' data-use='w' data-ref="mirrored_kernelcore">mirrored_kernelcore</a> = <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="6640">6640</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6641">6641</th><td>	}</td></tr>
<tr><th id="6642">6642</th><td></td></tr>
<tr><th id="6643">6643</th><td>	<b>return</b> <a class="tu ref fn" href="#cmdline_parse_core" title='cmdline_parse_core' data-use='c' data-ref="cmdline_parse_core">cmdline_parse_core</a>(<a class="local col6 ref" href="#1156p" title='p' data-ref="1156p">p</a>, &amp;<a class="tu ref" href="#required_kernelcore" title='required_kernelcore' data-use='a' data-ref="required_kernelcore">required_kernelcore</a>);</td></tr>
<tr><th id="6644">6644</th><td>}</td></tr>
<tr><th id="6645">6645</th><td></td></tr>
<tr><th id="6646">6646</th><td><i  data-doc="cmdline_parse_movablecore">/*</i></td></tr>
<tr><th id="6647">6647</th><td><i  data-doc="cmdline_parse_movablecore"> * movablecore=size sets the amount of memory for use for allocations that</i></td></tr>
<tr><th id="6648">6648</th><td><i  data-doc="cmdline_parse_movablecore"> * can be reclaimed or migrated.</i></td></tr>
<tr><th id="6649">6649</th><td><i  data-doc="cmdline_parse_movablecore"> */</i></td></tr>
<tr><th id="6650">6650</th><td><em>static</em> <em>int</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="cmdline_parse_movablecore" title='cmdline_parse_movablecore' data-type='int cmdline_parse_movablecore(char * p)' data-ref="cmdline_parse_movablecore">cmdline_parse_movablecore</dfn>(<em>char</em> *<dfn class="local col7 decl" id="1157p" title='p' data-type='char *' data-ref="1157p">p</dfn>)</td></tr>
<tr><th id="6651">6651</th><td>{</td></tr>
<tr><th id="6652">6652</th><td>	<b>return</b> <a class="tu ref fn" href="#cmdline_parse_core" title='cmdline_parse_core' data-use='c' data-ref="cmdline_parse_core">cmdline_parse_core</a>(<a class="local col7 ref" href="#1157p" title='p' data-ref="1157p">p</a>, &amp;<a class="tu ref" href="#required_movablecore" title='required_movablecore' data-use='a' data-ref="required_movablecore">required_movablecore</a>);</td></tr>
<tr><th id="6653">6653</th><td>}</td></tr>
<tr><th id="6654">6654</th><td></td></tr>
<tr><th id="6655">6655</th><td><a class="macro" href="../include/linux/init.h.html#248" title="static const char __setup_str_cmdline_parse_kernelcore[] __attribute__ ((__section__(&quot;.init.rodata&quot;))) __attribute__((aligned(1))) = &quot;kernelcore&quot;; static struct obs_kernel_param __setup_cmdline_parse_kernelcore __attribute__((__used__)) __attribute__ ((__section__(&quot;.init.setup&quot;))) __attribute__((aligned((sizeof(long))))) = { __setup_str_cmdline_parse_kernelcore, cmdline_parse_kernelcore, 1 }" data-ref="_M/early_param">early_param</a>(<q>"kernelcore"</q>, <a class="tu ref fn" href="#cmdline_parse_kernelcore" title='cmdline_parse_kernelcore' data-ref="cmdline_parse_kernelcore">cmdline_parse_kernelcore</a>);</td></tr>
<tr><th id="6656">6656</th><td><a class="macro" href="../include/linux/init.h.html#248" title="static const char __setup_str_cmdline_parse_movablecore[] __attribute__ ((__section__(&quot;.init.rodata&quot;))) __attribute__((aligned(1))) = &quot;movablecore&quot;; static struct obs_kernel_param __setup_cmdline_parse_movablecore __attribute__((__used__)) __attribute__ ((__section__(&quot;.init.setup&quot;))) __attribute__((aligned((sizeof(long))))) = { __setup_str_cmdline_parse_movablecore, cmdline_parse_movablecore, 1 }" data-ref="_M/early_param">early_param</a>(<q>"movablecore"</q>, <a class="tu ref fn" href="#cmdline_parse_movablecore" title='cmdline_parse_movablecore' data-ref="cmdline_parse_movablecore">cmdline_parse_movablecore</a>);</td></tr>
<tr><th id="6657">6657</th><td></td></tr>
<tr><th id="6658">6658</th><td><u>#<span data-ppcond="6191">endif</span> /* CONFIG_HAVE_MEMBLOCK_NODE_MAP */</u></td></tr>
<tr><th id="6659">6659</th><td></td></tr>
<tr><th id="6660">6660</th><td><em>void</em> <dfn class="decl def fn" id="adjust_managed_page_count" title='adjust_managed_page_count' data-ref="adjust_managed_page_count">adjust_managed_page_count</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col8 decl" id="1158page" title='page' data-type='struct page *' data-ref="1158page">page</dfn>, <em>long</em> <dfn class="local col9 decl" id="1159count" title='count' data-type='long' data-ref="1159count">count</dfn>)</td></tr>
<tr><th id="6661">6661</th><td>{</td></tr>
<tr><th id="6662">6662</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="tu ref" href="#124" title='managed_page_count_lock' data-use='a' data-ref="managed_page_count_lock">managed_page_count_lock</a>);</td></tr>
<tr><th id="6663">6663</th><td>	<a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col8 ref" href="#1158page" title='page' data-ref="1158page">page</a>)-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> += <a class="local col9 ref" href="#1159count" title='count' data-ref="1159count">count</a>;</td></tr>
<tr><th id="6664">6664</th><td>	<a class="ref" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages">totalram_pages</a> += <a class="local col9 ref" href="#1159count" title='count' data-ref="1159count">count</a>;</td></tr>
<tr><th id="6665">6665</th><td><u>#<span data-ppcond="6665">ifdef</span> <span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="6666">6666</th><td>	<b>if</b> (PageHighMem(page))</td></tr>
<tr><th id="6667">6667</th><td>		totalhigh_pages += count;</td></tr>
<tr><th id="6668">6668</th><td><u>#<span data-ppcond="6665">endif</span></u></td></tr>
<tr><th id="6669">6669</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="tu ref" href="#124" title='managed_page_count_lock' data-use='a' data-ref="managed_page_count_lock">managed_page_count_lock</a>);</td></tr>
<tr><th id="6670">6670</th><td>}</td></tr>
<tr><th id="6671">6671</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(adjust_managed_page_count) adjust_managed_page_count; static const char __kstrtab_adjust_managed_page_count[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;adjust_managed_page_count&quot;; static const struct kernel_symbol __ksymtab_adjust_managed_page_count __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;adjust_managed_page_count&quot;), used)) = { (unsigned long)&amp;adjust_managed_page_count, __kstrtab_adjust_managed_page_count }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#adjust_managed_page_count" title='adjust_managed_page_count' data-ref="adjust_managed_page_count"><a class="ref fn" href="#adjust_managed_page_count" title='adjust_managed_page_count' data-ref="adjust_managed_page_count"><a class="ref fn" href="#adjust_managed_page_count" title='adjust_managed_page_count' data-ref="adjust_managed_page_count"><a class="ref fn" href="#adjust_managed_page_count" title='adjust_managed_page_count' data-ref="adjust_managed_page_count">adjust_managed_page_count</a></a></a></a>);</td></tr>
<tr><th id="6672">6672</th><td></td></tr>
<tr><th id="6673">6673</th><td><em>unsigned</em> <em>long</em> <dfn class="decl def fn" id="free_reserved_area" title='free_reserved_area' data-ref="free_reserved_area">free_reserved_area</dfn>(<em>void</em> *<dfn class="local col0 decl" id="1160start" title='start' data-type='void *' data-ref="1160start">start</dfn>, <em>void</em> *<dfn class="local col1 decl" id="1161end" title='end' data-type='void *' data-ref="1161end">end</dfn>, <em>int</em> <dfn class="local col2 decl" id="1162poison" title='poison' data-type='int' data-ref="1162poison">poison</dfn>, <em>char</em> *<dfn class="local col3 decl" id="1163s" title='s' data-type='char *' data-ref="1163s">s</dfn>)</td></tr>
<tr><th id="6674">6674</th><td>{</td></tr>
<tr><th id="6675">6675</th><td>	<em>void</em> *<dfn class="local col4 decl" id="1164pos" title='pos' data-type='void *' data-ref="1164pos">pos</dfn>;</td></tr>
<tr><th id="6676">6676</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1165pages" title='pages' data-type='unsigned long' data-ref="1165pages">pages</dfn> = <var>0</var>;</td></tr>
<tr><th id="6677">6677</th><td></td></tr>
<tr><th id="6678">6678</th><td>	<a class="local col0 ref" href="#1160start" title='start' data-ref="1160start">start</a> = (<em>void</em> *)<a class="macro" href="../include/linux/mm.h.html#134" title="(((((unsigned long)start)) + ((typeof(((unsigned long)start)))((((1UL) &lt;&lt; 12))) - 1)) &amp; ~((typeof(((unsigned long)start)))((((1UL) &lt;&lt; 12))) - 1))" data-ref="_M/PAGE_ALIGN">PAGE_ALIGN</a>((<em>unsigned</em> <em>long</em>)<a class="local col0 ref" href="#1160start" title='start' data-ref="1160start">start</a>);</td></tr>
<tr><th id="6679">6679</th><td>	<a class="local col1 ref" href="#1161end" title='end' data-ref="1161end">end</a> = (<em>void</em> *)((<em>unsigned</em> <em>long</em>)<a class="local col1 ref" href="#1161end" title='end' data-ref="1161end">end</a> &amp; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#12" title="(~(((1UL) &lt;&lt; 12)-1))" data-ref="_M/PAGE_MASK">PAGE_MASK</a>);</td></tr>
<tr><th id="6680">6680</th><td>	<b>for</b> (<a class="local col4 ref" href="#1164pos" title='pos' data-ref="1164pos">pos</a> = <a class="local col0 ref" href="#1160start" title='start' data-ref="1160start">start</a>; <a class="local col4 ref" href="#1164pos" title='pos' data-ref="1164pos">pos</a> &lt; <a class="local col1 ref" href="#1161end" title='end' data-ref="1161end">end</a>; <a class="local col4 ref" href="#1164pos" title='pos' data-ref="1164pos">pos</a> += <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>, <a class="local col5 ref" href="#1165pages" title='pages' data-ref="1165pages">pages</a>++) {</td></tr>
<tr><th id="6681">6681</th><td>		<b>if</b> ((<em>unsigned</em> <em>int</em>)<a class="local col2 ref" href="#1162poison" title='poison' data-ref="1162poison">poison</a> &lt;= <var>0xFF</var>)</td></tr>
<tr><th id="6682">6682</th><td>			<a class="ref fn" href="../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col4 ref" href="#1164pos" title='pos' data-ref="1164pos">pos</a>, <a class="local col2 ref" href="#1162poison" title='poison' data-ref="1162poison">poison</a>, <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>);</td></tr>
<tr><th id="6683">6683</th><td>		<a class="ref fn" href="../include/linux/mm.h.html#free_reserved_page" title='free_reserved_page' data-ref="free_reserved_page">free_reserved_page</a>(<a class="macro" href="../arch/x86/include/asm/page.h.html#69" title="(((struct page *)vmemmap_base) + (__phys_addr_nodebug((unsigned long)(pos)) &gt;&gt; 12))" data-ref="_M/virt_to_page">virt_to_page</a>(<a class="local col4 ref" href="#1164pos" title='pos' data-ref="1164pos">pos</a>));</td></tr>
<tr><th id="6684">6684</th><td>	}</td></tr>
<tr><th id="6685">6685</th><td></td></tr>
<tr><th id="6686">6686</th><td>	<b>if</b> (<a class="local col5 ref" href="#1165pages" title='pages' data-ref="1165pages">pages</a> &amp;&amp; <a class="local col3 ref" href="#1163s" title='s' data-ref="1163s">s</a>)</td></tr>
<tr><th id="6687">6687</th><td>		<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Freeing %s memory: %ldK\n&quot;, s, pages &lt;&lt; (12 - 10))" data-ref="_M/pr_info">pr_info</a>(<q>"Freeing %s memory: %ldK\n"</q>,</td></tr>
<tr><th id="6688">6688</th><td>			<a class="local col3 ref" href="#1163s" title='s' data-ref="1163s">s</a>, <a class="local col5 ref" href="#1165pages" title='pages' data-ref="1165pages">pages</a> &lt;&lt; (PAGE_SHIFT - <var>10</var>));</td></tr>
<tr><th id="6689">6689</th><td></td></tr>
<tr><th id="6690">6690</th><td>	<b>return</b> <a class="local col5 ref" href="#1165pages" title='pages' data-ref="1165pages">pages</a>;</td></tr>
<tr><th id="6691">6691</th><td>}</td></tr>
<tr><th id="6692">6692</th><td><a class="macro" href="../include/linux/export.h.html#103" title="extern typeof(free_reserved_area) free_reserved_area; static const char __kstrtab_free_reserved_area[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;free_reserved_area&quot;; static const struct kernel_symbol __ksymtab_free_reserved_area __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;free_reserved_area&quot;), used)) = { (unsigned long)&amp;free_reserved_area, __kstrtab_free_reserved_area }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#free_reserved_area" title='free_reserved_area' data-ref="free_reserved_area"><a class="ref fn" href="#free_reserved_area" title='free_reserved_area' data-ref="free_reserved_area"><a class="ref fn" href="#free_reserved_area" title='free_reserved_area' data-ref="free_reserved_area"><a class="ref fn" href="#free_reserved_area" title='free_reserved_area' data-ref="free_reserved_area">free_reserved_area</a></a></a></a>);</td></tr>
<tr><th id="6693">6693</th><td></td></tr>
<tr><th id="6694">6694</th><td><u>#<span data-ppcond="6694">ifdef</span>	<span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="6695">6695</th><td><em>void</em> free_highmem_page(<b>struct</b> page *page)</td></tr>
<tr><th id="6696">6696</th><td>{</td></tr>
<tr><th id="6697">6697</th><td>	__free_reserved_page(page);</td></tr>
<tr><th id="6698">6698</th><td>	totalram_pages++;</td></tr>
<tr><th id="6699">6699</th><td>	page_zone(page)-&gt;managed_pages++;</td></tr>
<tr><th id="6700">6700</th><td>	totalhigh_pages++;</td></tr>
<tr><th id="6701">6701</th><td>}</td></tr>
<tr><th id="6702">6702</th><td><u>#<span data-ppcond="6694">endif</span></u></td></tr>
<tr><th id="6703">6703</th><td></td></tr>
<tr><th id="6704">6704</th><td></td></tr>
<tr><th id="6705">6705</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="mem_init_print_info" title='mem_init_print_info' data-ref="mem_init_print_info">mem_init_print_info</dfn>(<em>const</em> <em>char</em> *<dfn class="local col6 decl" id="1166str" title='str' data-type='const char *' data-ref="1166str">str</dfn>)</td></tr>
<tr><th id="6706">6706</th><td>{</td></tr>
<tr><th id="6707">6707</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1167physpages" title='physpages' data-type='unsigned long' data-ref="1167physpages">physpages</dfn>, <dfn class="local col8 decl" id="1168codesize" title='codesize' data-type='unsigned long' data-ref="1168codesize">codesize</dfn>, <dfn class="local col9 decl" id="1169datasize" title='datasize' data-type='unsigned long' data-ref="1169datasize">datasize</dfn>, <dfn class="local col0 decl" id="1170rosize" title='rosize' data-type='unsigned long' data-ref="1170rosize">rosize</dfn>, <dfn class="local col1 decl" id="1171bss_size" title='bss_size' data-type='unsigned long' data-ref="1171bss_size">bss_size</dfn>;</td></tr>
<tr><th id="6708">6708</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1172init_code_size" title='init_code_size' data-type='unsigned long' data-ref="1172init_code_size">init_code_size</dfn>, <dfn class="local col3 decl" id="1173init_data_size" title='init_data_size' data-type='unsigned long' data-ref="1173init_data_size">init_data_size</dfn>;</td></tr>
<tr><th id="6709">6709</th><td></td></tr>
<tr><th id="6710">6710</th><td>	<a class="local col7 ref" href="#1167physpages" title='physpages' data-ref="1167physpages">physpages</a> = <a class="ref fn" href="../include/linux/mm.h.html#get_num_physpages" title='get_num_physpages' data-ref="get_num_physpages">get_num_physpages</a>();</td></tr>
<tr><th id="6711">6711</th><td>	<a class="local col8 ref" href="#1168codesize" title='codesize' data-ref="1168codesize">codesize</a> = <a class="ref" href="../include/asm-generic/sections.h.html#_etext" title='_etext' data-ref="_etext">_etext</a> - <a class="ref" href="../include/asm-generic/sections.h.html#_stext" title='_stext' data-ref="_stext">_stext</a>;</td></tr>
<tr><th id="6712">6712</th><td>	<a class="local col9 ref" href="#1169datasize" title='datasize' data-ref="1169datasize">datasize</a> = <a class="ref" href="../include/asm-generic/sections.h.html#_edata" title='_edata' data-ref="_edata">_edata</a> - <a class="ref" href="../include/asm-generic/sections.h.html#_sdata" title='_sdata' data-ref="_sdata">_sdata</a>;</td></tr>
<tr><th id="6713">6713</th><td>	<a class="local col0 ref" href="#1170rosize" title='rosize' data-ref="1170rosize">rosize</a> = <a class="ref" href="../include/asm-generic/sections.h.html#__end_rodata" title='__end_rodata' data-ref="__end_rodata">__end_rodata</a> - <a class="ref" href="../include/asm-generic/sections.h.html#__start_rodata" title='__start_rodata' data-ref="__start_rodata">__start_rodata</a>;</td></tr>
<tr><th id="6714">6714</th><td>	<a class="local col1 ref" href="#1171bss_size" title='bss_size' data-ref="1171bss_size">bss_size</a> = <a class="ref" href="../include/asm-generic/sections.h.html#__bss_stop" title='__bss_stop' data-ref="__bss_stop">__bss_stop</a> - <a class="ref" href="../include/asm-generic/sections.h.html#__bss_start" title='__bss_start' data-ref="__bss_start">__bss_start</a>;</td></tr>
<tr><th id="6715">6715</th><td>	<a class="local col3 ref" href="#1173init_data_size" title='init_data_size' data-ref="1173init_data_size">init_data_size</a> = <a class="ref" href="../include/asm-generic/sections.h.html#__init_end" title='__init_end' data-ref="__init_end">__init_end</a> - <a class="ref" href="../include/asm-generic/sections.h.html#__init_begin" title='__init_begin' data-ref="__init_begin">__init_begin</a>;</td></tr>
<tr><th id="6716">6716</th><td>	<a class="local col2 ref" href="#1172init_code_size" title='init_code_size' data-ref="1172init_code_size">init_code_size</a> = <a class="ref" href="../include/asm-generic/sections.h.html#_einittext" title='_einittext' data-ref="_einittext">_einittext</a> - <a class="ref" href="../include/asm-generic/sections.h.html#_sinittext" title='_sinittext' data-ref="_sinittext">_sinittext</a>;</td></tr>
<tr><th id="6717">6717</th><td></td></tr>
<tr><th id="6718">6718</th><td>	<i>/*</i></td></tr>
<tr><th id="6719">6719</th><td><i>	 * Detect special cases and adjust section sizes accordingly:</i></td></tr>
<tr><th id="6720">6720</th><td><i>	 * 1) .init.* may be embedded into .data sections</i></td></tr>
<tr><th id="6721">6721</th><td><i>	 * 2) .init.text.* may be out of [__init_begin, __init_end],</i></td></tr>
<tr><th id="6722">6722</th><td><i>	 *    please refer to arch/tile/kernel/vmlinux.lds.S.</i></td></tr>
<tr><th id="6723">6723</th><td><i>	 * 3) .rodata.* may be embedded into .text or .data sections.</i></td></tr>
<tr><th id="6724">6724</th><td><i>	 */</i></td></tr>
<tr><th id="6725">6725</th><td><u>#define <dfn class="macro" id="_M/adj_init_size" data-ref="_M/adj_init_size">adj_init_size</dfn>(start, end, size, pos, adj) \</u></td></tr>
<tr><th id="6726">6726</th><td><u>	do { \</u></td></tr>
<tr><th id="6727">6727</th><td><u>		if (start &lt;= pos &amp;&amp; pos &lt; end &amp;&amp; size &gt; adj) \</u></td></tr>
<tr><th id="6728">6728</th><td><u>			size -= adj; \</u></td></tr>
<tr><th id="6729">6729</th><td><u>	} while (0)</u></td></tr>
<tr><th id="6730">6730</th><td></td></tr>
<tr><th id="6731">6731</th><td>	<a class="macro" href="#6725" title="do { if (__init_begin &lt;= _sinittext &amp;&amp; _sinittext &lt; __init_end &amp;&amp; init_data_size &gt; init_code_size) init_data_size -= init_code_size; } while (0)" data-ref="_M/adj_init_size">adj_init_size</a>(<a class="ref" href="../include/asm-generic/sections.h.html#__init_begin" title='__init_begin' data-ref="__init_begin">__init_begin</a>, <a class="ref" href="../include/asm-generic/sections.h.html#__init_end" title='__init_end' data-ref="__init_end">__init_end</a>, <a class="local col3 ref" href="#1173init_data_size" title='init_data_size' data-ref="1173init_data_size">init_data_size</a>,</td></tr>
<tr><th id="6732">6732</th><td>		     <a class="ref" href="../include/asm-generic/sections.h.html#_sinittext" title='_sinittext' data-ref="_sinittext">_sinittext</a>, <a class="local col2 ref" href="#1172init_code_size" title='init_code_size' data-ref="1172init_code_size">init_code_size</a>);</td></tr>
<tr><th id="6733">6733</th><td>	<a class="macro" href="#6725" title="do { if (_stext &lt;= _sinittext &amp;&amp; _sinittext &lt; _etext &amp;&amp; codesize &gt; init_code_size) codesize -= init_code_size; } while (0)" data-ref="_M/adj_init_size">adj_init_size</a>(<a class="ref" href="../include/asm-generic/sections.h.html#_stext" title='_stext' data-ref="_stext">_stext</a>, <a class="ref" href="../include/asm-generic/sections.h.html#_etext" title='_etext' data-ref="_etext">_etext</a>, <a class="local col8 ref" href="#1168codesize" title='codesize' data-ref="1168codesize">codesize</a>, <a class="ref" href="../include/asm-generic/sections.h.html#_sinittext" title='_sinittext' data-ref="_sinittext">_sinittext</a>, <a class="local col2 ref" href="#1172init_code_size" title='init_code_size' data-ref="1172init_code_size">init_code_size</a>);</td></tr>
<tr><th id="6734">6734</th><td>	<a class="macro" href="#6725" title="do { if (_sdata &lt;= __init_begin &amp;&amp; __init_begin &lt; _edata &amp;&amp; datasize &gt; init_data_size) datasize -= init_data_size; } while (0)" data-ref="_M/adj_init_size">adj_init_size</a>(<a class="ref" href="../include/asm-generic/sections.h.html#_sdata" title='_sdata' data-ref="_sdata">_sdata</a>, <a class="ref" href="../include/asm-generic/sections.h.html#_edata" title='_edata' data-ref="_edata">_edata</a>, <a class="local col9 ref" href="#1169datasize" title='datasize' data-ref="1169datasize">datasize</a>, <a class="ref" href="../include/asm-generic/sections.h.html#__init_begin" title='__init_begin' data-ref="__init_begin">__init_begin</a>, <a class="local col3 ref" href="#1173init_data_size" title='init_data_size' data-ref="1173init_data_size">init_data_size</a>);</td></tr>
<tr><th id="6735">6735</th><td>	<a class="macro" href="#6725" title="do { if (_stext &lt;= __start_rodata &amp;&amp; __start_rodata &lt; _etext &amp;&amp; codesize &gt; rosize) codesize -= rosize; } while (0)" data-ref="_M/adj_init_size">adj_init_size</a>(<a class="ref" href="../include/asm-generic/sections.h.html#_stext" title='_stext' data-ref="_stext">_stext</a>, <a class="ref" href="../include/asm-generic/sections.h.html#_etext" title='_etext' data-ref="_etext">_etext</a>, <a class="local col8 ref" href="#1168codesize" title='codesize' data-ref="1168codesize">codesize</a>, <a class="ref" href="../include/asm-generic/sections.h.html#__start_rodata" title='__start_rodata' data-ref="__start_rodata">__start_rodata</a>, <a class="local col0 ref" href="#1170rosize" title='rosize' data-ref="1170rosize">rosize</a>);</td></tr>
<tr><th id="6736">6736</th><td>	<a class="macro" href="#6725" title="do { if (_sdata &lt;= __start_rodata &amp;&amp; __start_rodata &lt; _edata &amp;&amp; datasize &gt; rosize) datasize -= rosize; } while (0)" data-ref="_M/adj_init_size">adj_init_size</a>(<a class="ref" href="../include/asm-generic/sections.h.html#_sdata" title='_sdata' data-ref="_sdata">_sdata</a>, <a class="ref" href="../include/asm-generic/sections.h.html#_edata" title='_edata' data-ref="_edata">_edata</a>, <a class="local col9 ref" href="#1169datasize" title='datasize' data-ref="1169datasize">datasize</a>, <a class="ref" href="../include/asm-generic/sections.h.html#__start_rodata" title='__start_rodata' data-ref="__start_rodata">__start_rodata</a>, <a class="local col0 ref" href="#1170rosize" title='rosize' data-ref="1170rosize">rosize</a>);</td></tr>
<tr><th id="6737">6737</th><td></td></tr>
<tr><th id="6738">6738</th><td><u>#undef	<a class="macro" href="#6725" data-ref="_M/adj_init_size">adj_init_size</a></u></td></tr>
<tr><th id="6739">6739</th><td></td></tr>
<tr><th id="6740">6740</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;Memory: %luK/%luK available (%luK kernel code, %luK rwdata, %luK rodata, %luK init, %luK bss, %luK reserved, %luK cma-reserved&quot;ifdef CONFIG_HIGHMEM &quot;, %luK highmem&quot;endif &quot;%s%s)\n&quot;, global_zone_page_state(NR_FREE_PAGES) &lt;&lt; (12 - 10), physpages &lt;&lt; (12 - 10), codesize &gt;&gt; 10, datasize &gt;&gt; 10, rosize &gt;&gt; 10, (init_data_size + init_code_size) &gt;&gt; 10, bss_size &gt;&gt; 10, (physpages - totalram_pages - totalcma_pages) &lt;&lt; (12 - 10), totalcma_pages &lt;&lt; (12 - 10),ifdef CONFIG_HIGHMEM 0UL &lt;&lt; (12 - 10),endif str ? &quot;, &quot; : &quot;&quot;, str ? str : &quot;&quot;)" data-ref="_M/pr_info">pr_info</a>(<q>"Memory: %luK/%luK available (%luK kernel code, %luK rwdata, %luK rodata, %luK init, %luK bss, %luK reserved, %luK cma-reserved"</q></td></tr>
<tr><th id="6741">6741</th><td><u>#<span data-ppcond="6741">ifdef</span>	<span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="6742">6742</th><td>		<q>", %luK highmem"</q></td></tr>
<tr><th id="6743">6743</th><td><u>#<span data-ppcond="6741">endif</span></u></td></tr>
<tr><th id="6744">6744</th><td>		<q>"%s%s)\n"</q>,</td></tr>
<tr><th id="6745">6745</th><td>		nr_free_pages() &lt;&lt; (PAGE_SHIFT - <var>10</var>),</td></tr>
<tr><th id="6746">6746</th><td>		<a class="local col7 ref" href="#1167physpages" title='physpages' data-ref="1167physpages">physpages</a> &lt;&lt; (PAGE_SHIFT - <var>10</var>),</td></tr>
<tr><th id="6747">6747</th><td>		<a class="local col8 ref" href="#1168codesize" title='codesize' data-ref="1168codesize">codesize</a> &gt;&gt; <var>10</var>, <a class="local col9 ref" href="#1169datasize" title='datasize' data-ref="1169datasize">datasize</a> &gt;&gt; <var>10</var>, <a class="local col0 ref" href="#1170rosize" title='rosize' data-ref="1170rosize">rosize</a> &gt;&gt; <var>10</var>,</td></tr>
<tr><th id="6748">6748</th><td>		(<a class="local col3 ref" href="#1173init_data_size" title='init_data_size' data-ref="1173init_data_size">init_data_size</a> + <a class="local col2 ref" href="#1172init_code_size" title='init_code_size' data-ref="1172init_code_size">init_code_size</a>) &gt;&gt; <var>10</var>, <a class="local col1 ref" href="#1171bss_size" title='bss_size' data-ref="1171bss_size">bss_size</a> &gt;&gt; <var>10</var>,</td></tr>
<tr><th id="6749">6749</th><td>		(<a class="local col7 ref" href="#1167physpages" title='physpages' data-ref="1167physpages">physpages</a> - <a class="ref" href="../include/linux/mm.h.html#totalram_pages" title='totalram_pages' data-ref="totalram_pages">totalram_pages</a> - <a class="ref" href="#totalcma_pages" title='totalcma_pages' data-ref="totalcma_pages">totalcma_pages</a>) &lt;&lt; (PAGE_SHIFT - <var>10</var>),</td></tr>
<tr><th id="6750">6750</th><td>		<a class="ref" href="#totalcma_pages" title='totalcma_pages' data-ref="totalcma_pages">totalcma_pages</a> &lt;&lt; (PAGE_SHIFT - <var>10</var>),</td></tr>
<tr><th id="6751">6751</th><td><u>#<span data-ppcond="6751">ifdef</span>	<span class="macro" data-ref="_M/CONFIG_HIGHMEM">CONFIG_HIGHMEM</span></u></td></tr>
<tr><th id="6752">6752</th><td>		totalhigh_pages &lt;&lt; (PAGE_SHIFT - <var>10</var>),</td></tr>
<tr><th id="6753">6753</th><td><u>#<span data-ppcond="6751">endif</span></u></td></tr>
<tr><th id="6754">6754</th><td>		<a class="local col6 ref" href="#1166str" title='str' data-ref="1166str">str</a> ? <q>", "</q> : <q>""</q>, <a class="local col6 ref" href="#1166str" title='str' data-ref="1166str">str</a> ? <a class="local col6 ref" href="#1166str" title='str' data-ref="1166str">str</a> : <q>""</q>);</td></tr>
<tr><th id="6755">6755</th><td>}</td></tr>
<tr><th id="6756">6756</th><td></td></tr>
<tr><th id="6757">6757</th><td><i class="doc">/**</i></td></tr>
<tr><th id="6758">6758</th><td><i class="doc"> * set_dma_reserve - set the specified number of pages reserved in the first zone</i></td></tr>
<tr><th id="6759">6759</th><td><i class="doc"> *<span class="command"> @new</span>_dma_reserve: The number of pages to mark reserved</i></td></tr>
<tr><th id="6760">6760</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6761">6761</th><td><i class="doc"> * The per-cpu batchsize and zone watermarks are determined by managed_pages.</i></td></tr>
<tr><th id="6762">6762</th><td><i class="doc"> * In the DMA zone, a significant percentage may be consumed by kernel image</i></td></tr>
<tr><th id="6763">6763</th><td><i class="doc"> * and other unfreeable allocations which can skew the watermarks badly. This</i></td></tr>
<tr><th id="6764">6764</th><td><i class="doc"> * function may optionally be used to account for unfreeable pages in the</i></td></tr>
<tr><th id="6765">6765</th><td><i class="doc"> * first zone (e.g., ZONE_DMA). The effect will be lower watermarks and</i></td></tr>
<tr><th id="6766">6766</th><td><i class="doc"> * smaller per-cpu batchsize.</i></td></tr>
<tr><th id="6767">6767</th><td><i class="doc"> */</i></td></tr>
<tr><th id="6768">6768</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="set_dma_reserve" title='set_dma_reserve' data-ref="set_dma_reserve">set_dma_reserve</dfn>(<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1174new_dma_reserve" title='new_dma_reserve' data-type='unsigned long' data-ref="1174new_dma_reserve">new_dma_reserve</dfn>)</td></tr>
<tr><th id="6769">6769</th><td>{</td></tr>
<tr><th id="6770">6770</th><td>	<a class="tu ref" href="#dma_reserve" title='dma_reserve' data-use='w' data-ref="dma_reserve">dma_reserve</a> = <a class="local col4 ref" href="#1174new_dma_reserve" title='new_dma_reserve' data-ref="1174new_dma_reserve">new_dma_reserve</a>;</td></tr>
<tr><th id="6771">6771</th><td>}</td></tr>
<tr><th id="6772">6772</th><td></td></tr>
<tr><th id="6773">6773</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="free_area_init" title='free_area_init' data-ref="free_area_init">free_area_init</dfn>(<em>unsigned</em> <em>long</em> *<dfn class="local col5 decl" id="1175zones_size" title='zones_size' data-type='unsigned long *' data-ref="1175zones_size">zones_size</dfn>)</td></tr>
<tr><th id="6774">6774</th><td>{</td></tr>
<tr><th id="6775">6775</th><td>	<a class="ref fn" href="#free_area_init_node" title='free_area_init_node' data-ref="free_area_init_node">free_area_init_node</a>(<var>0</var>, <a class="local col5 ref" href="#1175zones_size" title='zones_size' data-ref="1175zones_size">zones_size</a>,</td></tr>
<tr><th id="6776">6776</th><td>			<a class="macro" href="../arch/x86/include/asm/page.h.html#42" title="__phys_addr_nodebug((unsigned long)(((unsigned long)page_offset_base)))" data-ref="_M/__pa">__pa</a>(<a class="macro" href="../arch/x86/include/asm/page_types.h.html#37" title="((unsigned long)page_offset_base)" data-ref="_M/PAGE_OFFSET">PAGE_OFFSET</a>) &gt;&gt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="6777">6777</th><td>}</td></tr>
<tr><th id="6778">6778</th><td></td></tr>
<tr><th id="6779">6779</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="page_alloc_cpu_dead" title='page_alloc_cpu_dead' data-type='int page_alloc_cpu_dead(unsigned int cpu)' data-ref="page_alloc_cpu_dead">page_alloc_cpu_dead</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="1176cpu" title='cpu' data-type='unsigned int' data-ref="1176cpu">cpu</dfn>)</td></tr>
<tr><th id="6780">6780</th><td>{</td></tr>
<tr><th id="6781">6781</th><td></td></tr>
<tr><th id="6782">6782</th><td>	<a class="ref fn" href="../include/linux/swap.h.html#lru_add_drain_cpu" title='lru_add_drain_cpu' data-ref="lru_add_drain_cpu">lru_add_drain_cpu</a>(<a class="local col6 ref" href="#1176cpu" title='cpu' data-ref="1176cpu">cpu</a>);</td></tr>
<tr><th id="6783">6783</th><td>	<a class="tu ref fn" href="#drain_pages" title='drain_pages' data-use='c' data-ref="drain_pages">drain_pages</a>(<a class="local col6 ref" href="#1176cpu" title='cpu' data-ref="1176cpu">cpu</a>);</td></tr>
<tr><th id="6784">6784</th><td></td></tr>
<tr><th id="6785">6785</th><td>	<i>/*</i></td></tr>
<tr><th id="6786">6786</th><td><i>	 * Spill the event counters of the dead processor</i></td></tr>
<tr><th id="6787">6787</th><td><i>	 * into the current processors event counters.</i></td></tr>
<tr><th id="6788">6788</th><td><i>	 * This artificially elevates the count of the current</i></td></tr>
<tr><th id="6789">6789</th><td><i>	 * processor.</i></td></tr>
<tr><th id="6790">6790</th><td><i>	 */</i></td></tr>
<tr><th id="6791">6791</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#vm_events_fold_cpu" title='vm_events_fold_cpu' data-ref="vm_events_fold_cpu">vm_events_fold_cpu</a>(<a class="local col6 ref" href="#1176cpu" title='cpu' data-ref="1176cpu">cpu</a>);</td></tr>
<tr><th id="6792">6792</th><td></td></tr>
<tr><th id="6793">6793</th><td>	<i>/*</i></td></tr>
<tr><th id="6794">6794</th><td><i>	 * Zero the differential counters of the dead processor</i></td></tr>
<tr><th id="6795">6795</th><td><i>	 * so that the vm statistics are consistent.</i></td></tr>
<tr><th id="6796">6796</th><td><i>	 *</i></td></tr>
<tr><th id="6797">6797</th><td><i>	 * This is only okay since the processor is dead and cannot</i></td></tr>
<tr><th id="6798">6798</th><td><i>	 * race with what we are doing.</i></td></tr>
<tr><th id="6799">6799</th><td><i>	 */</i></td></tr>
<tr><th id="6800">6800</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#cpu_vm_stats_fold" title='cpu_vm_stats_fold' data-ref="cpu_vm_stats_fold">cpu_vm_stats_fold</a>(<a class="local col6 ref" href="#1176cpu" title='cpu' data-ref="1176cpu">cpu</a>);</td></tr>
<tr><th id="6801">6801</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6802">6802</th><td>}</td></tr>
<tr><th id="6803">6803</th><td></td></tr>
<tr><th id="6804">6804</th><td><em>void</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="page_alloc_init" title='page_alloc_init' data-ref="page_alloc_init">page_alloc_init</dfn>(<em>void</em>)</td></tr>
<tr><th id="6805">6805</th><td>{</td></tr>
<tr><th id="6806">6806</th><td>	<em>int</em> <dfn class="local col7 decl" id="1177ret" title='ret' data-type='int' data-ref="1177ret">ret</dfn>;</td></tr>
<tr><th id="6807">6807</th><td></td></tr>
<tr><th id="6808">6808</th><td>	<a class="local col7 ref" href="#1177ret" title='ret' data-ref="1177ret">ret</a> = <a class="ref fn" href="../include/linux/cpuhotplug.h.html#cpuhp_setup_state_nocalls" title='cpuhp_setup_state_nocalls' data-ref="cpuhp_setup_state_nocalls">cpuhp_setup_state_nocalls</a>(<a class="enum" href="../include/linux/cpuhotplug.h.html#CPUHP_PAGE_ALLOC_DEAD" title='CPUHP_PAGE_ALLOC_DEAD' data-ref="CPUHP_PAGE_ALLOC_DEAD">CPUHP_PAGE_ALLOC_DEAD</a>,</td></tr>
<tr><th id="6809">6809</th><td>					<q>"mm/page_alloc:dead"</q>, <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="6810">6810</th><td>					<a class="tu ref fn" href="#page_alloc_cpu_dead" title='page_alloc_cpu_dead' data-use='r' data-ref="page_alloc_cpu_dead">page_alloc_cpu_dead</a>);</td></tr>
<tr><th id="6811">6811</th><td>	<a class="macro" href="../include/asm-generic/bug.h.html#108" title="({ int __ret_warn_on = !!(ret &lt; 0); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (6811), &quot;i&quot; ((1 &lt;&lt; 0)|(((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (319)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON">WARN_ON</a>(<a class="local col7 ref" href="#1177ret" title='ret' data-ref="1177ret">ret</a> &lt; <var>0</var>);</td></tr>
<tr><th id="6812">6812</th><td>}</td></tr>
<tr><th id="6813">6813</th><td></td></tr>
<tr><th id="6814">6814</th><td><i  data-doc="calculate_totalreserve_pages">/*</i></td></tr>
<tr><th id="6815">6815</th><td><i  data-doc="calculate_totalreserve_pages"> * calculate_totalreserve_pages - called when sysctl_lowmem_reserve_ratio</i></td></tr>
<tr><th id="6816">6816</th><td><i  data-doc="calculate_totalreserve_pages"> *	or min_free_kbytes changes.</i></td></tr>
<tr><th id="6817">6817</th><td><i  data-doc="calculate_totalreserve_pages"> */</i></td></tr>
<tr><th id="6818">6818</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="calculate_totalreserve_pages" title='calculate_totalreserve_pages' data-type='void calculate_totalreserve_pages()' data-ref="calculate_totalreserve_pages">calculate_totalreserve_pages</dfn>(<em>void</em>)</td></tr>
<tr><th id="6819">6819</th><td>{</td></tr>
<tr><th id="6820">6820</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col8 decl" id="1178pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1178pgdat">pgdat</dfn>;</td></tr>
<tr><th id="6821">6821</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1179reserve_pages" title='reserve_pages' data-type='unsigned long' data-ref="1179reserve_pages">reserve_pages</dfn> = <var>0</var>;</td></tr>
<tr><th id="6822">6822</th><td>	<b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#zone_type" title='zone_type' data-ref="zone_type">zone_type</a> <dfn class="local col0 decl" id="1180i" title='i' data-type='enum zone_type' data-ref="1180i">i</dfn>, <dfn class="local col1 decl" id="1181j" title='j' data-type='enum zone_type' data-ref="1181j">j</dfn>;</td></tr>
<tr><th id="6823">6823</th><td></td></tr>
<tr><th id="6824">6824</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#930" title="for (pgdat = first_online_pgdat(); pgdat; pgdat = next_online_pgdat(pgdat))" data-ref="_M/for_each_online_pgdat">for_each_online_pgdat</a>(<a class="local col8 ref" href="#1178pgdat" title='pgdat' data-ref="1178pgdat">pgdat</a>) {</td></tr>
<tr><th id="6825">6825</th><td></td></tr>
<tr><th id="6826">6826</th><td>		<a class="local col8 ref" href="#1178pgdat" title='pgdat' data-ref="1178pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::totalreserve_pages" title='pglist_data::totalreserve_pages' data-ref="pglist_data::totalreserve_pages">totalreserve_pages</a> = <var>0</var>;</td></tr>
<tr><th id="6827">6827</th><td></td></tr>
<tr><th id="6828">6828</th><td>		<b>for</b> (<a class="local col0 ref" href="#1180i" title='i' data-ref="1180i">i</a> = <var>0</var>; <a class="local col0 ref" href="#1180i" title='i' data-ref="1180i">i</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col0 ref" href="#1180i" title='i' data-ref="1180i">i</a>++) {</td></tr>
<tr><th id="6829">6829</th><td>			<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="1182zone" title='zone' data-type='struct zone *' data-ref="1182zone">zone</dfn> = <a class="local col8 ref" href="#1178pgdat" title='pgdat' data-ref="1178pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a> + <a class="local col0 ref" href="#1180i" title='i' data-ref="1180i">i</a>;</td></tr>
<tr><th id="6830">6830</th><td>			<em>long</em> <dfn class="local col3 decl" id="1183max" title='max' data-type='long' data-ref="1183max">max</dfn> = <var>0</var>;</td></tr>
<tr><th id="6831">6831</th><td></td></tr>
<tr><th id="6832">6832</th><td>			<i>/* Find valid and maximum lowmem_reserve in the zone */</i></td></tr>
<tr><th id="6833">6833</th><td>			<b>for</b> (<a class="local col1 ref" href="#1181j" title='j' data-ref="1181j">j</a> = <a class="local col0 ref" href="#1180i" title='i' data-ref="1180i">i</a>; <a class="local col1 ref" href="#1181j" title='j' data-ref="1181j">j</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col1 ref" href="#1181j" title='j' data-ref="1181j">j</a>++) {</td></tr>
<tr><th id="6834">6834</th><td>				<b>if</b> (<a class="local col2 ref" href="#1182zone" title='zone' data-ref="1182zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col1 ref" href="#1181j" title='j' data-ref="1181j">j</a>] &gt; <a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a>)</td></tr>
<tr><th id="6835">6835</th><td>					<a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a> = <a class="local col2 ref" href="#1182zone" title='zone' data-ref="1182zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col1 ref" href="#1181j" title='j' data-ref="1181j">j</a>];</td></tr>
<tr><th id="6836">6836</th><td>			}</td></tr>
<tr><th id="6837">6837</th><td></td></tr>
<tr><th id="6838">6838</th><td>			<i>/* we treat the high watermark as reserved pages. */</i></td></tr>
<tr><th id="6839">6839</th><td>			<a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a> += <a class="macro" href="../include/linux/mmzone.h.html#271" title="(zone-&gt;watermark[WMARK_HIGH])" data-ref="_M/high_wmark_pages">high_wmark_pages</a>(<a class="local col2 ref" href="#1182zone" title='zone' data-ref="1182zone">zone</a>);</td></tr>
<tr><th id="6840">6840</th><td></td></tr>
<tr><th id="6841">6841</th><td>			<b>if</b> (<a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a> &gt; <a class="local col2 ref" href="#1182zone" title='zone' data-ref="1182zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>)</td></tr>
<tr><th id="6842">6842</th><td>				<a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a> = <a class="local col2 ref" href="#1182zone" title='zone' data-ref="1182zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>;</td></tr>
<tr><th id="6843">6843</th><td></td></tr>
<tr><th id="6844">6844</th><td>			<a class="local col8 ref" href="#1178pgdat" title='pgdat' data-ref="1178pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::totalreserve_pages" title='pglist_data::totalreserve_pages' data-ref="pglist_data::totalreserve_pages">totalreserve_pages</a> += <a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a>;</td></tr>
<tr><th id="6845">6845</th><td></td></tr>
<tr><th id="6846">6846</th><td>			<a class="local col9 ref" href="#1179reserve_pages" title='reserve_pages' data-ref="1179reserve_pages">reserve_pages</a> += <a class="local col3 ref" href="#1183max" title='max' data-ref="1183max">max</a>;</td></tr>
<tr><th id="6847">6847</th><td>		}</td></tr>
<tr><th id="6848">6848</th><td>	}</td></tr>
<tr><th id="6849">6849</th><td>	<a class="ref" href="../include/linux/swap.h.html#totalreserve_pages" title='totalreserve_pages' data-ref="totalreserve_pages">totalreserve_pages</a> = <a class="local col9 ref" href="#1179reserve_pages" title='reserve_pages' data-ref="1179reserve_pages">reserve_pages</a>;</td></tr>
<tr><th id="6850">6850</th><td>}</td></tr>
<tr><th id="6851">6851</th><td></td></tr>
<tr><th id="6852">6852</th><td><i  data-doc="setup_per_zone_lowmem_reserve">/*</i></td></tr>
<tr><th id="6853">6853</th><td><i  data-doc="setup_per_zone_lowmem_reserve"> * setup_per_zone_lowmem_reserve - called whenever</i></td></tr>
<tr><th id="6854">6854</th><td><i  data-doc="setup_per_zone_lowmem_reserve"> *	sysctl_lowmem_reserve_ratio changes.  Ensures that each zone</i></td></tr>
<tr><th id="6855">6855</th><td><i  data-doc="setup_per_zone_lowmem_reserve"> *	has a correct pages reserved value, so an adequate number of</i></td></tr>
<tr><th id="6856">6856</th><td><i  data-doc="setup_per_zone_lowmem_reserve"> *	pages are left in the zone after a successful __alloc_pages().</i></td></tr>
<tr><th id="6857">6857</th><td><i  data-doc="setup_per_zone_lowmem_reserve"> */</i></td></tr>
<tr><th id="6858">6858</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="setup_per_zone_lowmem_reserve" title='setup_per_zone_lowmem_reserve' data-type='void setup_per_zone_lowmem_reserve()' data-ref="setup_per_zone_lowmem_reserve">setup_per_zone_lowmem_reserve</dfn>(<em>void</em>)</td></tr>
<tr><th id="6859">6859</th><td>{</td></tr>
<tr><th id="6860">6860</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#pglist_data" title='pglist_data' data-ref="pglist_data">pglist_data</a> *<dfn class="local col4 decl" id="1184pgdat" title='pgdat' data-type='struct pglist_data *' data-ref="1184pgdat">pgdat</dfn>;</td></tr>
<tr><th id="6861">6861</th><td>	<b>enum</b> <a class="type" href="../include/linux/mmzone.h.html#zone_type" title='zone_type' data-ref="zone_type">zone_type</a> <dfn class="local col5 decl" id="1185j" title='j' data-type='enum zone_type' data-ref="1185j">j</dfn>, <dfn class="local col6 decl" id="1186idx" title='idx' data-type='enum zone_type' data-ref="1186idx">idx</dfn>;</td></tr>
<tr><th id="6862">6862</th><td></td></tr>
<tr><th id="6863">6863</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#930" title="for (pgdat = first_online_pgdat(); pgdat; pgdat = next_online_pgdat(pgdat))" data-ref="_M/for_each_online_pgdat">for_each_online_pgdat</a>(<a class="local col4 ref" href="#1184pgdat" title='pgdat' data-ref="1184pgdat">pgdat</a>) {</td></tr>
<tr><th id="6864">6864</th><td>		<b>for</b> (<a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a> = <var>0</var>; <a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a> &lt; <a class="macro" href="../include/generated/bounds.h.html#10" title="4" data-ref="_M/MAX_NR_ZONES">MAX_NR_ZONES</a>; <a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a>++) {</td></tr>
<tr><th id="6865">6865</th><td>			<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col7 decl" id="1187zone" title='zone' data-type='struct zone *' data-ref="1187zone">zone</dfn> = <a class="local col4 ref" href="#1184pgdat" title='pgdat' data-ref="1184pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a> + <a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a>;</td></tr>
<tr><th id="6866">6866</th><td>			<em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1188managed_pages" title='managed_pages' data-type='unsigned long' data-ref="1188managed_pages">managed_pages</dfn> = <a class="local col7 ref" href="#1187zone" title='zone' data-ref="1187zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>;</td></tr>
<tr><th id="6867">6867</th><td></td></tr>
<tr><th id="6868">6868</th><td>			<a class="local col7 ref" href="#1187zone" title='zone' data-ref="1187zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a>] = <var>0</var>;</td></tr>
<tr><th id="6869">6869</th><td></td></tr>
<tr><th id="6870">6870</th><td>			<a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a> = <a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a>;</td></tr>
<tr><th id="6871">6871</th><td>			<b>while</b> (<a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a>) {</td></tr>
<tr><th id="6872">6872</th><td>				<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col9 decl" id="1189lower_zone" title='lower_zone' data-type='struct zone *' data-ref="1189lower_zone">lower_zone</dfn>;</td></tr>
<tr><th id="6873">6873</th><td></td></tr>
<tr><th id="6874">6874</th><td>				<a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a>--;</td></tr>
<tr><th id="6875">6875</th><td></td></tr>
<tr><th id="6876">6876</th><td>				<b>if</b> (<a class="ref" href="../include/linux/mmzone.h.html#sysctl_lowmem_reserve_ratio" title='sysctl_lowmem_reserve_ratio' data-ref="sysctl_lowmem_reserve_ratio">sysctl_lowmem_reserve_ratio</a>[<a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a>] &lt; <var>1</var>)</td></tr>
<tr><th id="6877">6877</th><td>					<a class="ref" href="../include/linux/mmzone.h.html#sysctl_lowmem_reserve_ratio" title='sysctl_lowmem_reserve_ratio' data-ref="sysctl_lowmem_reserve_ratio">sysctl_lowmem_reserve_ratio</a>[<a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a>] = <var>1</var>;</td></tr>
<tr><th id="6878">6878</th><td></td></tr>
<tr><th id="6879">6879</th><td>				<a class="local col9 ref" href="#1189lower_zone" title='lower_zone' data-ref="1189lower_zone">lower_zone</a> = <a class="local col4 ref" href="#1184pgdat" title='pgdat' data-ref="1184pgdat">pgdat</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#pglist_data::node_zones" title='pglist_data::node_zones' data-ref="pglist_data::node_zones">node_zones</a> + <a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a>;</td></tr>
<tr><th id="6880">6880</th><td>				<a class="local col9 ref" href="#1189lower_zone" title='lower_zone' data-ref="1189lower_zone">lower_zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lowmem_reserve" title='zone::lowmem_reserve' data-ref="zone::lowmem_reserve">lowmem_reserve</a>[<a class="local col5 ref" href="#1185j" title='j' data-ref="1185j">j</a>] = <a class="local col8 ref" href="#1188managed_pages" title='managed_pages' data-ref="1188managed_pages">managed_pages</a> /</td></tr>
<tr><th id="6881">6881</th><td>					<a class="ref" href="../include/linux/mmzone.h.html#sysctl_lowmem_reserve_ratio" title='sysctl_lowmem_reserve_ratio' data-ref="sysctl_lowmem_reserve_ratio">sysctl_lowmem_reserve_ratio</a>[<a class="local col6 ref" href="#1186idx" title='idx' data-ref="1186idx">idx</a>];</td></tr>
<tr><th id="6882">6882</th><td>				<a class="local col8 ref" href="#1188managed_pages" title='managed_pages' data-ref="1188managed_pages">managed_pages</a> += <a class="local col9 ref" href="#1189lower_zone" title='lower_zone' data-ref="1189lower_zone">lower_zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>;</td></tr>
<tr><th id="6883">6883</th><td>			}</td></tr>
<tr><th id="6884">6884</th><td>		}</td></tr>
<tr><th id="6885">6885</th><td>	}</td></tr>
<tr><th id="6886">6886</th><td></td></tr>
<tr><th id="6887">6887</th><td>	<i>/* update totalreserve_pages */</i></td></tr>
<tr><th id="6888">6888</th><td>	<a class="tu ref fn" href="#calculate_totalreserve_pages" title='calculate_totalreserve_pages' data-use='c' data-ref="calculate_totalreserve_pages">calculate_totalreserve_pages</a>();</td></tr>
<tr><th id="6889">6889</th><td>}</td></tr>
<tr><th id="6890">6890</th><td></td></tr>
<tr><th id="6891">6891</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="__setup_per_zone_wmarks" title='__setup_per_zone_wmarks' data-type='void __setup_per_zone_wmarks()' data-ref="__setup_per_zone_wmarks">__setup_per_zone_wmarks</dfn>(<em>void</em>)</td></tr>
<tr><th id="6892">6892</th><td>{</td></tr>
<tr><th id="6893">6893</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1190pages_min" title='pages_min' data-type='unsigned long' data-ref="1190pages_min">pages_min</dfn> = <a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a> &gt;&gt; (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a> - <var>10</var>);</td></tr>
<tr><th id="6894">6894</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col1 decl" id="1191lowmem_pages" title='lowmem_pages' data-type='unsigned long' data-ref="1191lowmem_pages">lowmem_pages</dfn> = <var>0</var>;</td></tr>
<tr><th id="6895">6895</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col2 decl" id="1192zone" title='zone' data-type='struct zone *' data-ref="1192zone">zone</dfn>;</td></tr>
<tr><th id="6896">6896</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="1193flags" title='flags' data-type='unsigned long' data-ref="1193flags">flags</dfn>;</td></tr>
<tr><th id="6897">6897</th><td></td></tr>
<tr><th id="6898">6898</th><td>	<i>/* Calculate total number of !ZONE_HIGHMEM pages */</i></td></tr>
<tr><th id="6899">6899</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#941" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone))" data-ref="_M/for_each_zone">for_each_zone</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>) {</td></tr>
<tr><th id="6900">6900</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#is_highmem" title='is_highmem' data-ref="is_highmem">is_highmem</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>))</td></tr>
<tr><th id="6901">6901</th><td>			<a class="local col1 ref" href="#1191lowmem_pages" title='lowmem_pages' data-ref="1191lowmem_pages">lowmem_pages</a> += <a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>;</td></tr>
<tr><th id="6902">6902</th><td>	}</td></tr>
<tr><th id="6903">6903</th><td></td></tr>
<tr><th id="6904">6904</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#941" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone))" data-ref="_M/for_each_zone">for_each_zone</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>) {</td></tr>
<tr><th id="6905">6905</th><td>		<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a> <dfn class="local col4 decl" id="1194tmp" title='tmp' data-type='u64' data-ref="1194tmp">tmp</dfn>;</td></tr>
<tr><th id="6906">6906</th><td></td></tr>
<tr><th id="6907">6907</th><td>		<a class="macro" href="../include/linux/spinlock.h.html#345" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = _raw_spin_lock_irqsave(spinlock_check(&amp;zone-&gt;lock)); } while (0); } while (0)" data-ref="_M/spin_lock_irqsave">spin_lock_irqsave</a>(&amp;<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col3 ref" href="#1193flags" title='flags' data-ref="1193flags">flags</a>);</td></tr>
<tr><th id="6908">6908</th><td>		<a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a> = (<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>)<a class="local col0 ref" href="#1190pages_min" title='pages_min' data-ref="1190pages_min">pages_min</a> * <a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>;</td></tr>
<tr><th id="6909">6909</th><td>		<a class="macro" href="../include/asm-generic/div64.h.html#29" title="({ uint32_t __base = (lowmem_pages); uint32_t __rem; __rem = ((uint64_t)(tmp)) % __base; (tmp) = ((uint64_t)(tmp)) / __base; __rem; })" data-ref="_M/do_div">do_div</a>(<a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a>, <a class="local col1 ref" href="#1191lowmem_pages" title='lowmem_pages' data-ref="1191lowmem_pages">lowmem_pages</a>);</td></tr>
<tr><th id="6910">6910</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/mmzone.h.html#is_highmem" title='is_highmem' data-ref="is_highmem">is_highmem</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>)) {</td></tr>
<tr><th id="6911">6911</th><td>			<i>/*</i></td></tr>
<tr><th id="6912">6912</th><td><i>			 * __GFP_HIGH and PF_MEMALLOC allocations usually don't</i></td></tr>
<tr><th id="6913">6913</th><td><i>			 * need highmem pages, so cap pages_min to a small</i></td></tr>
<tr><th id="6914">6914</th><td><i>			 * value here.</i></td></tr>
<tr><th id="6915">6915</th><td><i>			 *</i></td></tr>
<tr><th id="6916">6916</th><td><i>			 * The WMARK_HIGH-WMARK_LOW and (WMARK_LOW-WMARK_MIN)</i></td></tr>
<tr><th id="6917">6917</th><td><i>			 * deltas control asynch page reclaim, and so should</i></td></tr>
<tr><th id="6918">6918</th><td><i>			 * not be capped for highmem.</i></td></tr>
<tr><th id="6919">6919</th><td><i>			 */</i></td></tr>
<tr><th id="6920">6920</th><td>			<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1195min_pages" title='min_pages' data-type='unsigned long' data-ref="1195min_pages">min_pages</dfn>;</td></tr>
<tr><th id="6921">6921</th><td></td></tr>
<tr><th id="6922">6922</th><td>			<a class="local col5 ref" href="#1195min_pages" title='min_pages' data-ref="1195min_pages">min_pages</a> = <a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a> / <var>1024</var>;</td></tr>
<tr><th id="6923">6923</th><td>			<a class="local col5 ref" href="#1195min_pages" title='min_pages' data-ref="1195min_pages">min_pages</a> = <a class="macro" href="../include/linux/kernel.h.html#855" title="({ typeof((typeof(min_pages))({ typeof(min_pages) __UNIQUE_ID_max1_321 = (min_pages); typeof(32UL) __UNIQUE_ID_max2_322 = (32UL); (void) (&amp;__UNIQUE_ID_max1_321 == &amp;__UNIQUE_ID_max2_322); __UNIQUE_ID_max1_321 &gt; __UNIQUE_ID_max2_322 ? __UNIQUE_ID_max1_321 : __UNIQUE_ID_max2_322; })) __UNIQUE_ID_min1_323 = ((typeof(min_pages))({ typeof(min_pages) __UNIQUE_ID_max1_321 = (min_pages); typeof(32UL) __UNIQUE_ID_max2_322 = (32UL); (void) (&amp;__UNIQUE_ID_max1_321 == &amp;__UNIQUE_ID_max2_322); __UNIQUE_ID_max1_321 &gt; __UNIQUE_ID_max2_322 ? __UNIQUE_ID_max1_321 : __UNIQUE_ID_max2_322; })); typeof(128UL) __UNIQUE_ID_min2_324 = (128UL); (void) (&amp;__UNIQUE_ID_min1_323 == &amp;__UNIQUE_ID_min2_324); __UNIQUE_ID_min1_323 &lt; __UNIQUE_ID_min2_324 ? __UNIQUE_ID_min1_323 : __UNIQUE_ID_min2_324; })" data-ref="_M/clamp">clamp</a>(<a class="local col5 ref" href="#1195min_pages" title='min_pages' data-ref="1195min_pages">min_pages</a>, <a class="macro" href="../include/linux/swap.h.html#178" title="32UL" data-ref="_M/SWAP_CLUSTER_MAX">SWAP_CLUSTER_MAX</a>, <var>128UL</var>);</td></tr>
<tr><th id="6924">6924</th><td>			<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::watermark" title='zone::watermark' data-ref="zone::watermark">watermark</a>[<a class="enum" href="../include/linux/mmzone.h.html#WMARK_MIN" title='WMARK_MIN' data-ref="WMARK_MIN">WMARK_MIN</a>] = <a class="local col5 ref" href="#1195min_pages" title='min_pages' data-ref="1195min_pages">min_pages</a>;</td></tr>
<tr><th id="6925">6925</th><td>		} <b>else</b> {</td></tr>
<tr><th id="6926">6926</th><td>			<i>/*</i></td></tr>
<tr><th id="6927">6927</th><td><i>			 * If it's a lowmem zone, reserve a number of pages</i></td></tr>
<tr><th id="6928">6928</th><td><i>			 * proportionate to the zone's size.</i></td></tr>
<tr><th id="6929">6929</th><td><i>			 */</i></td></tr>
<tr><th id="6930">6930</th><td>			<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::watermark" title='zone::watermark' data-ref="zone::watermark">watermark</a>[<a class="enum" href="../include/linux/mmzone.h.html#WMARK_MIN" title='WMARK_MIN' data-ref="WMARK_MIN">WMARK_MIN</a>] = <a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a>;</td></tr>
<tr><th id="6931">6931</th><td>		}</td></tr>
<tr><th id="6932">6932</th><td></td></tr>
<tr><th id="6933">6933</th><td>		<i>/*</i></td></tr>
<tr><th id="6934">6934</th><td><i>		 * Set the kswapd watermarks distance according to the</i></td></tr>
<tr><th id="6935">6935</th><td><i>		 * scale factor in proportion to available memory, but</i></td></tr>
<tr><th id="6936">6936</th><td><i>		 * ensure a minimum size on small systems.</i></td></tr>
<tr><th id="6937">6937</th><td><i>		 */</i></td></tr>
<tr><th id="6938">6938</th><td>		<a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a> = <a class="macro" href="../include/linux/kernel.h.html#881" title="({ u64 __UNIQUE_ID_min1_329 = (tmp &gt;&gt; 2); u64 __UNIQUE_ID_min2_330 = (( { typeof(zone-&gt;managed_pages) quot = (zone-&gt;managed_pages) / (10000); typeof(zone-&gt;managed_pages) rem = (zone-&gt;managed_pages) % (10000); (quot * (watermark_scale_factor)) + ((rem * (watermark_scale_factor)) / (10000)); } )); (void) (&amp;__UNIQUE_ID_min1_329 == &amp;__UNIQUE_ID_min2_330); __UNIQUE_ID_min1_329 &gt; __UNIQUE_ID_min2_330 ? __UNIQUE_ID_min1_329 : __UNIQUE_ID_min2_330; })" data-ref="_M/max_t">max_t</a>(<a class="typedef" href="../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64">u64</a>, <a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a> &gt;&gt; <var>2</var>,</td></tr>
<tr><th id="6939">6939</th><td>			    <a class="macro" href="../include/linux/kernel.h.html#160" title="( { typeof(zone-&gt;managed_pages) quot = (zone-&gt;managed_pages) / (10000); typeof(zone-&gt;managed_pages) rem = (zone-&gt;managed_pages) % (10000); (quot * (watermark_scale_factor)) + ((rem * (watermark_scale_factor)) / (10000)); } )" data-ref="_M/mult_frac">mult_frac</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::managed_pages" title='zone::managed_pages' data-ref="zone::managed_pages">managed_pages</a>,</td></tr>
<tr><th id="6940">6940</th><td>				      <a class="ref" href="../include/linux/mm.h.html#watermark_scale_factor" title='watermark_scale_factor' data-ref="watermark_scale_factor">watermark_scale_factor</a>, <var>10000</var>));</td></tr>
<tr><th id="6941">6941</th><td></td></tr>
<tr><th id="6942">6942</th><td>		<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::watermark" title='zone::watermark' data-ref="zone::watermark">watermark</a>[<a class="enum" href="../include/linux/mmzone.h.html#WMARK_LOW" title='WMARK_LOW' data-ref="WMARK_LOW">WMARK_LOW</a>]  = <a class="macro" href="../include/linux/mmzone.h.html#269" title="(zone-&gt;watermark[WMARK_MIN])" data-ref="_M/min_wmark_pages">min_wmark_pages</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>) + <a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a>;</td></tr>
<tr><th id="6943">6943</th><td>		<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::watermark" title='zone::watermark' data-ref="zone::watermark">watermark</a>[<a class="enum" href="../include/linux/mmzone.h.html#WMARK_HIGH" title='WMARK_HIGH' data-ref="WMARK_HIGH">WMARK_HIGH</a>] = <a class="macro" href="../include/linux/mmzone.h.html#269" title="(zone-&gt;watermark[WMARK_MIN])" data-ref="_M/min_wmark_pages">min_wmark_pages</a>(<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>) + <a class="local col4 ref" href="#1194tmp" title='tmp' data-ref="1194tmp">tmp</a> * <var>2</var>;</td></tr>
<tr><th id="6944">6944</th><td></td></tr>
<tr><th id="6945">6945</th><td>		<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock_irqrestore" title='spin_unlock_irqrestore' data-ref="spin_unlock_irqrestore">spin_unlock_irqrestore</a>(&amp;<a class="local col2 ref" href="#1192zone" title='zone' data-ref="1192zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col3 ref" href="#1193flags" title='flags' data-ref="1193flags">flags</a>);</td></tr>
<tr><th id="6946">6946</th><td>	}</td></tr>
<tr><th id="6947">6947</th><td></td></tr>
<tr><th id="6948">6948</th><td>	<i>/* update totalreserve_pages */</i></td></tr>
<tr><th id="6949">6949</th><td>	<a class="tu ref fn" href="#calculate_totalreserve_pages" title='calculate_totalreserve_pages' data-use='c' data-ref="calculate_totalreserve_pages">calculate_totalreserve_pages</a>();</td></tr>
<tr><th id="6950">6950</th><td>}</td></tr>
<tr><th id="6951">6951</th><td></td></tr>
<tr><th id="6952">6952</th><td><i class="doc">/**</i></td></tr>
<tr><th id="6953">6953</th><td><i class="doc"> * setup_per_zone_wmarks - called when min_free_kbytes changes</i></td></tr>
<tr><th id="6954">6954</th><td><i class="doc"> * or when memory is hot-{added|removed}</i></td></tr>
<tr><th id="6955">6955</th><td><i class="doc"> *</i></td></tr>
<tr><th id="6956">6956</th><td><i class="doc"> * Ensures that the watermark[min,low,high] values for each zone are set</i></td></tr>
<tr><th id="6957">6957</th><td><i class="doc"> * correctly with respect to min_free_kbytes.</i></td></tr>
<tr><th id="6958">6958</th><td><i class="doc"> */</i></td></tr>
<tr><th id="6959">6959</th><td><em>void</em> <dfn class="decl def fn" id="setup_per_zone_wmarks" title='setup_per_zone_wmarks' data-ref="setup_per_zone_wmarks">setup_per_zone_wmarks</dfn>(<em>void</em>)</td></tr>
<tr><th id="6960">6960</th><td>{</td></tr>
<tr><th id="6961">6961</th><td>	<em>static</em> <a class="macro" href="../include/linux/spinlock_types.h.html#84" title="spinlock_t lock = (spinlock_t ) { { .rlock = { .raw_lock = { { (0) } }, } } }" data-ref="_M/DEFINE_SPINLOCK">DEFINE_SPINLOCK</a>(<dfn class="local col6 decl" id="1196lock" title='lock' data-type='spinlock_t' data-ref="1196lock">lock</dfn>);</td></tr>
<tr><th id="6962">6962</th><td></td></tr>
<tr><th id="6963">6963</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_lock" title='spin_lock' data-ref="spin_lock">spin_lock</a>(&amp;<a class="local col6 ref" href="#6961" title='lock' data-ref="1196lock">lock</a>);</td></tr>
<tr><th id="6964">6964</th><td>	<a class="tu ref fn" href="#__setup_per_zone_wmarks" title='__setup_per_zone_wmarks' data-use='c' data-ref="__setup_per_zone_wmarks">__setup_per_zone_wmarks</a>();</td></tr>
<tr><th id="6965">6965</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock" title='spin_unlock' data-ref="spin_unlock">spin_unlock</a>(&amp;<a class="local col6 ref" href="#6961" title='lock' data-ref="1196lock">lock</a>);</td></tr>
<tr><th id="6966">6966</th><td>}</td></tr>
<tr><th id="6967">6967</th><td></td></tr>
<tr><th id="6968">6968</th><td><i>/*</i></td></tr>
<tr><th id="6969">6969</th><td><i> * Initialise min_free_kbytes.</i></td></tr>
<tr><th id="6970">6970</th><td><i> *</i></td></tr>
<tr><th id="6971">6971</th><td><i> * For small machines we want it small (128k min).  For large machines</i></td></tr>
<tr><th id="6972">6972</th><td><i> * we want it large (64MB max).  But it is not linear, because network</i></td></tr>
<tr><th id="6973">6973</th><td><i> * bandwidth does not increase linearly with machine size.  We use</i></td></tr>
<tr><th id="6974">6974</th><td><i> *</i></td></tr>
<tr><th id="6975">6975</th><td><i> *	min_free_kbytes = 4 * sqrt(lowmem_kbytes), for better accuracy:</i></td></tr>
<tr><th id="6976">6976</th><td><i> *	min_free_kbytes = sqrt(lowmem_kbytes * 16)</i></td></tr>
<tr><th id="6977">6977</th><td><i> *</i></td></tr>
<tr><th id="6978">6978</th><td><i> * which yields</i></td></tr>
<tr><th id="6979">6979</th><td><i> *</i></td></tr>
<tr><th id="6980">6980</th><td><i> * 16MB:	512k</i></td></tr>
<tr><th id="6981">6981</th><td><i> * 32MB:	724k</i></td></tr>
<tr><th id="6982">6982</th><td><i> * 64MB:	1024k</i></td></tr>
<tr><th id="6983">6983</th><td><i> * 128MB:	1448k</i></td></tr>
<tr><th id="6984">6984</th><td><i> * 256MB:	2048k</i></td></tr>
<tr><th id="6985">6985</th><td><i> * 512MB:	2896k</i></td></tr>
<tr><th id="6986">6986</th><td><i> * 1024MB:	4096k</i></td></tr>
<tr><th id="6987">6987</th><td><i> * 2048MB:	5792k</i></td></tr>
<tr><th id="6988">6988</th><td><i> * 4096MB:	8192k</i></td></tr>
<tr><th id="6989">6989</th><td><i> * 8192MB:	11584k</i></td></tr>
<tr><th id="6990">6990</th><td><i> * 16384MB:	16384k</i></td></tr>
<tr><th id="6991">6991</th><td><i> */</i></td></tr>
<tr><th id="6992">6992</th><td><em>int</em> <a class="macro" href="../include/linux/init.h.html#88" title="__attribute__ ((__section__(&quot;.meminit.text&quot;))) __attribute__((no_instrument_function))" data-ref="_M/__meminit">__meminit</a> <dfn class="decl def fn" id="init_per_zone_wmark_min" title='init_per_zone_wmark_min' data-ref="init_per_zone_wmark_min">init_per_zone_wmark_min</dfn>(<em>void</em>)</td></tr>
<tr><th id="6993">6993</th><td>{</td></tr>
<tr><th id="6994">6994</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1197lowmem_kbytes" title='lowmem_kbytes' data-type='unsigned long' data-ref="1197lowmem_kbytes">lowmem_kbytes</dfn>;</td></tr>
<tr><th id="6995">6995</th><td>	<em>int</em> <dfn class="local col8 decl" id="1198new_min_free_kbytes" title='new_min_free_kbytes' data-type='int' data-ref="1198new_min_free_kbytes">new_min_free_kbytes</dfn>;</td></tr>
<tr><th id="6996">6996</th><td></td></tr>
<tr><th id="6997">6997</th><td>	<a class="local col7 ref" href="#1197lowmem_kbytes" title='lowmem_kbytes' data-ref="1197lowmem_kbytes">lowmem_kbytes</a> = <a class="ref fn" href="#nr_free_buffer_pages" title='nr_free_buffer_pages' data-ref="nr_free_buffer_pages">nr_free_buffer_pages</a>() * (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &gt;&gt; <var>10</var>);</td></tr>
<tr><th id="6998">6998</th><td>	<a class="local col8 ref" href="#1198new_min_free_kbytes" title='new_min_free_kbytes' data-ref="1198new_min_free_kbytes">new_min_free_kbytes</a> = <a class="ref fn" href="../include/linux/kernel.h.html#int_sqrt" title='int_sqrt' data-ref="int_sqrt">int_sqrt</a>(<a class="local col7 ref" href="#1197lowmem_kbytes" title='lowmem_kbytes' data-ref="1197lowmem_kbytes">lowmem_kbytes</a> * <var>16</var>);</td></tr>
<tr><th id="6999">6999</th><td></td></tr>
<tr><th id="7000">7000</th><td>	<b>if</b> (<a class="local col8 ref" href="#1198new_min_free_kbytes" title='new_min_free_kbytes' data-ref="1198new_min_free_kbytes">new_min_free_kbytes</a> &gt; <a class="ref" href="internal.h.html#user_min_free_kbytes" title='user_min_free_kbytes' data-ref="user_min_free_kbytes">user_min_free_kbytes</a>) {</td></tr>
<tr><th id="7001">7001</th><td>		<a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a> = <a class="local col8 ref" href="#1198new_min_free_kbytes" title='new_min_free_kbytes' data-ref="1198new_min_free_kbytes">new_min_free_kbytes</a>;</td></tr>
<tr><th id="7002">7002</th><td>		<b>if</b> (<a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a> &lt; <var>128</var>)</td></tr>
<tr><th id="7003">7003</th><td>			<a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a> = <var>128</var>;</td></tr>
<tr><th id="7004">7004</th><td>		<b>if</b> (<a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a> &gt; <var>65536</var>)</td></tr>
<tr><th id="7005">7005</th><td>			<a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a> = <var>65536</var>;</td></tr>
<tr><th id="7006">7006</th><td>	} <b>else</b> {</td></tr>
<tr><th id="7007">7007</th><td>		<a class="macro" href="../include/linux/printk.h.html#305" title="pr_warning" data-ref="_M/pr_warn">pr_warn</a>(<q>"min_free_kbytes is not updated to %d because user defined value %d is preferred\n"</q>,</td></tr>
<tr><th id="7008">7008</th><td>				<a class="local col8 ref" href="#1198new_min_free_kbytes" title='new_min_free_kbytes' data-ref="1198new_min_free_kbytes">new_min_free_kbytes</a>, <a class="ref" href="internal.h.html#user_min_free_kbytes" title='user_min_free_kbytes' data-ref="user_min_free_kbytes">user_min_free_kbytes</a>);</td></tr>
<tr><th id="7009">7009</th><td>	}</td></tr>
<tr><th id="7010">7010</th><td>	<a class="ref fn" href="#setup_per_zone_wmarks" title='setup_per_zone_wmarks' data-ref="setup_per_zone_wmarks">setup_per_zone_wmarks</a>();</td></tr>
<tr><th id="7011">7011</th><td>	<a class="ref fn" href="../include/linux/vmstat.h.html#refresh_zone_stat_thresholds" title='refresh_zone_stat_thresholds' data-ref="refresh_zone_stat_thresholds">refresh_zone_stat_thresholds</a>();</td></tr>
<tr><th id="7012">7012</th><td>	<a class="tu ref fn" href="#setup_per_zone_lowmem_reserve" title='setup_per_zone_lowmem_reserve' data-use='c' data-ref="setup_per_zone_lowmem_reserve">setup_per_zone_lowmem_reserve</a>();</td></tr>
<tr><th id="7013">7013</th><td></td></tr>
<tr><th id="7014">7014</th><td><u>#<span data-ppcond="7014">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="7015">7015</th><td>	setup_min_unmapped_ratio();</td></tr>
<tr><th id="7016">7016</th><td>	setup_min_slab_ratio();</td></tr>
<tr><th id="7017">7017</th><td><u>#<span data-ppcond="7014">endif</span></u></td></tr>
<tr><th id="7018">7018</th><td></td></tr>
<tr><th id="7019">7019</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7020">7020</th><td>}</td></tr>
<tr><th id="7021">7021</th><td><a class="macro" href="../include/linux/init.h.html#192" title="static initcall_t __initcall_init_per_zone_wmark_min1 __attribute__((__used__)) __attribute__((__section__(&quot;.initcall&quot; &quot;1&quot; &quot;.init&quot;))) = init_per_zone_wmark_min;" data-ref="_M/core_initcall">core_initcall</a>(<a class="ref fn" href="#init_per_zone_wmark_min" title='init_per_zone_wmark_min' data-ref="init_per_zone_wmark_min">init_per_zone_wmark_min</a>)</td></tr>
<tr><th id="7022">7022</th><td></td></tr>
<tr><th id="7023">7023</th><td><i>/*</i></td></tr>
<tr><th id="7024">7024</th><td><i> * min_free_kbytes_sysctl_handler - just a wrapper around proc_dointvec() so</i></td></tr>
<tr><th id="7025">7025</th><td><i> *	that we can call two helper functions whenever min_free_kbytes</i></td></tr>
<tr><th id="7026">7026</th><td><i> *	changes.</i></td></tr>
<tr><th id="7027">7027</th><td><i> */</i></td></tr>
<tr><th id="7028">7028</th><td><em>int</em> <dfn class="decl def fn" id="min_free_kbytes_sysctl_handler" title='min_free_kbytes_sysctl_handler' data-ref="min_free_kbytes_sysctl_handler">min_free_kbytes_sysctl_handler</dfn>(<b>struct</b> <a class="type" href="../include/linux/sysctl.h.html#ctl_table" title='ctl_table' data-ref="ctl_table">ctl_table</a> *<dfn class="local col9 decl" id="1199table" title='table' data-type='struct ctl_table *' data-ref="1199table">table</dfn>, <em>int</em> <dfn class="local col0 decl" id="1200write" title='write' data-type='int' data-ref="1200write">write</dfn>,</td></tr>
<tr><th id="7029">7029</th><td>	<em>void</em> <a class="macro" href="../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col1 decl" id="1201buffer" title='buffer' data-type='void *' data-ref="1201buffer">buffer</dfn>, <a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> *<dfn class="local col2 decl" id="1202length" title='length' data-type='size_t *' data-ref="1202length">length</dfn>, <a class="typedef" href="../include/linux/types.h.html#loff_t" title='loff_t' data-type='__kernel_loff_t' data-ref="loff_t">loff_t</a> *<dfn class="local col3 decl" id="1203ppos" title='ppos' data-type='loff_t *' data-ref="1203ppos">ppos</dfn>)</td></tr>
<tr><th id="7030">7030</th><td>{</td></tr>
<tr><th id="7031">7031</th><td>	<em>int</em> <dfn class="local col4 decl" id="1204rc" title='rc' data-type='int' data-ref="1204rc">rc</dfn>;</td></tr>
<tr><th id="7032">7032</th><td></td></tr>
<tr><th id="7033">7033</th><td>	<a class="local col4 ref" href="#1204rc" title='rc' data-ref="1204rc">rc</a> = <a class="ref fn" href="../include/linux/sysctl.h.html#proc_dointvec_minmax" title='proc_dointvec_minmax' data-ref="proc_dointvec_minmax">proc_dointvec_minmax</a>(<a class="local col9 ref" href="#1199table" title='table' data-ref="1199table">table</a>, <a class="local col0 ref" href="#1200write" title='write' data-ref="1200write">write</a>, <a class="local col1 ref" href="#1201buffer" title='buffer' data-ref="1201buffer">buffer</a>, <a class="local col2 ref" href="#1202length" title='length' data-ref="1202length">length</a>, <a class="local col3 ref" href="#1203ppos" title='ppos' data-ref="1203ppos">ppos</a>);</td></tr>
<tr><th id="7034">7034</th><td>	<b>if</b> (<a class="local col4 ref" href="#1204rc" title='rc' data-ref="1204rc">rc</a>)</td></tr>
<tr><th id="7035">7035</th><td>		<b>return</b> <a class="local col4 ref" href="#1204rc" title='rc' data-ref="1204rc">rc</a>;</td></tr>
<tr><th id="7036">7036</th><td></td></tr>
<tr><th id="7037">7037</th><td>	<b>if</b> (<a class="local col0 ref" href="#1200write" title='write' data-ref="1200write">write</a>) {</td></tr>
<tr><th id="7038">7038</th><td>		<a class="ref" href="internal.h.html#user_min_free_kbytes" title='user_min_free_kbytes' data-ref="user_min_free_kbytes">user_min_free_kbytes</a> = <a class="ref" href="../include/linux/mm.h.html#min_free_kbytes" title='min_free_kbytes' data-ref="min_free_kbytes">min_free_kbytes</a>;</td></tr>
<tr><th id="7039">7039</th><td>		<a class="ref fn" href="#setup_per_zone_wmarks" title='setup_per_zone_wmarks' data-ref="setup_per_zone_wmarks">setup_per_zone_wmarks</a>();</td></tr>
<tr><th id="7040">7040</th><td>	}</td></tr>
<tr><th id="7041">7041</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7042">7042</th><td>}</td></tr>
<tr><th id="7043">7043</th><td></td></tr>
<tr><th id="7044">7044</th><td><em>int</em> <dfn class="decl def fn" id="watermark_scale_factor_sysctl_handler" title='watermark_scale_factor_sysctl_handler' data-ref="watermark_scale_factor_sysctl_handler">watermark_scale_factor_sysctl_handler</dfn>(<b>struct</b> <a class="type" href="../include/linux/sysctl.h.html#ctl_table" title='ctl_table' data-ref="ctl_table">ctl_table</a> *<dfn class="local col5 decl" id="1205table" title='table' data-type='struct ctl_table *' data-ref="1205table">table</dfn>, <em>int</em> <dfn class="local col6 decl" id="1206write" title='write' data-type='int' data-ref="1206write">write</dfn>,</td></tr>
<tr><th id="7045">7045</th><td>	<em>void</em> <a class="macro" href="../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col7 decl" id="1207buffer" title='buffer' data-type='void *' data-ref="1207buffer">buffer</dfn>, <a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> *<dfn class="local col8 decl" id="1208length" title='length' data-type='size_t *' data-ref="1208length">length</dfn>, <a class="typedef" href="../include/linux/types.h.html#loff_t" title='loff_t' data-type='__kernel_loff_t' data-ref="loff_t">loff_t</a> *<dfn class="local col9 decl" id="1209ppos" title='ppos' data-type='loff_t *' data-ref="1209ppos">ppos</dfn>)</td></tr>
<tr><th id="7046">7046</th><td>{</td></tr>
<tr><th id="7047">7047</th><td>	<em>int</em> <dfn class="local col0 decl" id="1210rc" title='rc' data-type='int' data-ref="1210rc">rc</dfn>;</td></tr>
<tr><th id="7048">7048</th><td></td></tr>
<tr><th id="7049">7049</th><td>	<a class="local col0 ref" href="#1210rc" title='rc' data-ref="1210rc">rc</a> = <a class="ref fn" href="../include/linux/sysctl.h.html#proc_dointvec_minmax" title='proc_dointvec_minmax' data-ref="proc_dointvec_minmax">proc_dointvec_minmax</a>(<a class="local col5 ref" href="#1205table" title='table' data-ref="1205table">table</a>, <a class="local col6 ref" href="#1206write" title='write' data-ref="1206write">write</a>, <a class="local col7 ref" href="#1207buffer" title='buffer' data-ref="1207buffer">buffer</a>, <a class="local col8 ref" href="#1208length" title='length' data-ref="1208length">length</a>, <a class="local col9 ref" href="#1209ppos" title='ppos' data-ref="1209ppos">ppos</a>);</td></tr>
<tr><th id="7050">7050</th><td>	<b>if</b> (<a class="local col0 ref" href="#1210rc" title='rc' data-ref="1210rc">rc</a>)</td></tr>
<tr><th id="7051">7051</th><td>		<b>return</b> <a class="local col0 ref" href="#1210rc" title='rc' data-ref="1210rc">rc</a>;</td></tr>
<tr><th id="7052">7052</th><td></td></tr>
<tr><th id="7053">7053</th><td>	<b>if</b> (<a class="local col6 ref" href="#1206write" title='write' data-ref="1206write">write</a>)</td></tr>
<tr><th id="7054">7054</th><td>		<a class="ref fn" href="#setup_per_zone_wmarks" title='setup_per_zone_wmarks' data-ref="setup_per_zone_wmarks">setup_per_zone_wmarks</a>();</td></tr>
<tr><th id="7055">7055</th><td></td></tr>
<tr><th id="7056">7056</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7057">7057</th><td>}</td></tr>
<tr><th id="7058">7058</th><td></td></tr>
<tr><th id="7059">7059</th><td><u>#<span data-ppcond="7059">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="7060">7060</th><td><em>static</em> <em>void</em> setup_min_unmapped_ratio(<em>void</em>)</td></tr>
<tr><th id="7061">7061</th><td>{</td></tr>
<tr><th id="7062">7062</th><td>	pg_data_t *pgdat;</td></tr>
<tr><th id="7063">7063</th><td>	<b>struct</b> zone *zone;</td></tr>
<tr><th id="7064">7064</th><td></td></tr>
<tr><th id="7065">7065</th><td>	for_each_online_pgdat(pgdat)</td></tr>
<tr><th id="7066">7066</th><td>		pgdat-&gt;min_unmapped_pages = <var>0</var>;</td></tr>
<tr><th id="7067">7067</th><td></td></tr>
<tr><th id="7068">7068</th><td>	for_each_zone(zone)</td></tr>
<tr><th id="7069">7069</th><td>		zone-&gt;zone_pgdat-&gt;min_unmapped_pages += (zone-&gt;managed_pages *</td></tr>
<tr><th id="7070">7070</th><td>				sysctl_min_unmapped_ratio) / <var>100</var>;</td></tr>
<tr><th id="7071">7071</th><td>}</td></tr>
<tr><th id="7072">7072</th><td></td></tr>
<tr><th id="7073">7073</th><td></td></tr>
<tr><th id="7074">7074</th><td><em>int</em> sysctl_min_unmapped_ratio_sysctl_handler(<b>struct</b> ctl_table *table, <em>int</em> write,</td></tr>
<tr><th id="7075">7075</th><td>	<em>void</em> __user *buffer, size_t *length, loff_t *ppos)</td></tr>
<tr><th id="7076">7076</th><td>{</td></tr>
<tr><th id="7077">7077</th><td>	<em>int</em> rc;</td></tr>
<tr><th id="7078">7078</th><td></td></tr>
<tr><th id="7079">7079</th><td>	rc = proc_dointvec_minmax(table, write, buffer, length, ppos);</td></tr>
<tr><th id="7080">7080</th><td>	<b>if</b> (rc)</td></tr>
<tr><th id="7081">7081</th><td>		<b>return</b> rc;</td></tr>
<tr><th id="7082">7082</th><td></td></tr>
<tr><th id="7083">7083</th><td>	setup_min_unmapped_ratio();</td></tr>
<tr><th id="7084">7084</th><td></td></tr>
<tr><th id="7085">7085</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7086">7086</th><td>}</td></tr>
<tr><th id="7087">7087</th><td></td></tr>
<tr><th id="7088">7088</th><td><em>static</em> <em>void</em> setup_min_slab_ratio(<em>void</em>)</td></tr>
<tr><th id="7089">7089</th><td>{</td></tr>
<tr><th id="7090">7090</th><td>	pg_data_t *pgdat;</td></tr>
<tr><th id="7091">7091</th><td>	<b>struct</b> zone *zone;</td></tr>
<tr><th id="7092">7092</th><td></td></tr>
<tr><th id="7093">7093</th><td>	for_each_online_pgdat(pgdat)</td></tr>
<tr><th id="7094">7094</th><td>		pgdat-&gt;min_slab_pages = <var>0</var>;</td></tr>
<tr><th id="7095">7095</th><td></td></tr>
<tr><th id="7096">7096</th><td>	for_each_zone(zone)</td></tr>
<tr><th id="7097">7097</th><td>		zone-&gt;zone_pgdat-&gt;min_slab_pages += (zone-&gt;managed_pages *</td></tr>
<tr><th id="7098">7098</th><td>				sysctl_min_slab_ratio) / <var>100</var>;</td></tr>
<tr><th id="7099">7099</th><td>}</td></tr>
<tr><th id="7100">7100</th><td></td></tr>
<tr><th id="7101">7101</th><td><em>int</em> sysctl_min_slab_ratio_sysctl_handler(<b>struct</b> ctl_table *table, <em>int</em> write,</td></tr>
<tr><th id="7102">7102</th><td>	<em>void</em> __user *buffer, size_t *length, loff_t *ppos)</td></tr>
<tr><th id="7103">7103</th><td>{</td></tr>
<tr><th id="7104">7104</th><td>	<em>int</em> rc;</td></tr>
<tr><th id="7105">7105</th><td></td></tr>
<tr><th id="7106">7106</th><td>	rc = proc_dointvec_minmax(table, write, buffer, length, ppos);</td></tr>
<tr><th id="7107">7107</th><td>	<b>if</b> (rc)</td></tr>
<tr><th id="7108">7108</th><td>		<b>return</b> rc;</td></tr>
<tr><th id="7109">7109</th><td></td></tr>
<tr><th id="7110">7110</th><td>	setup_min_slab_ratio();</td></tr>
<tr><th id="7111">7111</th><td></td></tr>
<tr><th id="7112">7112</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7113">7113</th><td>}</td></tr>
<tr><th id="7114">7114</th><td><u>#<span data-ppcond="7059">endif</span></u></td></tr>
<tr><th id="7115">7115</th><td></td></tr>
<tr><th id="7116">7116</th><td><i>/*</i></td></tr>
<tr><th id="7117">7117</th><td><i> * lowmem_reserve_ratio_sysctl_handler - just a wrapper around</i></td></tr>
<tr><th id="7118">7118</th><td><i> *	proc_dointvec() so that we can call setup_per_zone_lowmem_reserve()</i></td></tr>
<tr><th id="7119">7119</th><td><i> *	whenever sysctl_lowmem_reserve_ratio changes.</i></td></tr>
<tr><th id="7120">7120</th><td><i> *</i></td></tr>
<tr><th id="7121">7121</th><td><i> * The reserve ratio obviously has absolutely no relation with the</i></td></tr>
<tr><th id="7122">7122</th><td><i> * minimum watermarks. The lowmem reserve ratio can only make sense</i></td></tr>
<tr><th id="7123">7123</th><td><i> * if in function of the boot time zone sizes.</i></td></tr>
<tr><th id="7124">7124</th><td><i> */</i></td></tr>
<tr><th id="7125">7125</th><td><em>int</em> <dfn class="decl def fn" id="lowmem_reserve_ratio_sysctl_handler" title='lowmem_reserve_ratio_sysctl_handler' data-ref="lowmem_reserve_ratio_sysctl_handler">lowmem_reserve_ratio_sysctl_handler</dfn>(<b>struct</b> <a class="type" href="../include/linux/sysctl.h.html#ctl_table" title='ctl_table' data-ref="ctl_table">ctl_table</a> *<dfn class="local col1 decl" id="1211table" title='table' data-type='struct ctl_table *' data-ref="1211table">table</dfn>, <em>int</em> <dfn class="local col2 decl" id="1212write" title='write' data-type='int' data-ref="1212write">write</dfn>,</td></tr>
<tr><th id="7126">7126</th><td>	<em>void</em> <a class="macro" href="../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col3 decl" id="1213buffer" title='buffer' data-type='void *' data-ref="1213buffer">buffer</dfn>, <a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> *<dfn class="local col4 decl" id="1214length" title='length' data-type='size_t *' data-ref="1214length">length</dfn>, <a class="typedef" href="../include/linux/types.h.html#loff_t" title='loff_t' data-type='__kernel_loff_t' data-ref="loff_t">loff_t</a> *<dfn class="local col5 decl" id="1215ppos" title='ppos' data-type='loff_t *' data-ref="1215ppos">ppos</dfn>)</td></tr>
<tr><th id="7127">7127</th><td>{</td></tr>
<tr><th id="7128">7128</th><td>	<a class="ref fn" href="../include/linux/sysctl.h.html#proc_dointvec_minmax" title='proc_dointvec_minmax' data-ref="proc_dointvec_minmax">proc_dointvec_minmax</a>(<a class="local col1 ref" href="#1211table" title='table' data-ref="1211table">table</a>, <a class="local col2 ref" href="#1212write" title='write' data-ref="1212write">write</a>, <a class="local col3 ref" href="#1213buffer" title='buffer' data-ref="1213buffer">buffer</a>, <a class="local col4 ref" href="#1214length" title='length' data-ref="1214length">length</a>, <a class="local col5 ref" href="#1215ppos" title='ppos' data-ref="1215ppos">ppos</a>);</td></tr>
<tr><th id="7129">7129</th><td>	<a class="tu ref fn" href="#setup_per_zone_lowmem_reserve" title='setup_per_zone_lowmem_reserve' data-use='c' data-ref="setup_per_zone_lowmem_reserve">setup_per_zone_lowmem_reserve</a>();</td></tr>
<tr><th id="7130">7130</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7131">7131</th><td>}</td></tr>
<tr><th id="7132">7132</th><td></td></tr>
<tr><th id="7133">7133</th><td><i>/*</i></td></tr>
<tr><th id="7134">7134</th><td><i> * percpu_pagelist_fraction - changes the pcp-&gt;high for each zone on each</i></td></tr>
<tr><th id="7135">7135</th><td><i> * cpu.  It is the fraction of total pages in each zone that a hot per cpu</i></td></tr>
<tr><th id="7136">7136</th><td><i> * pagelist can have before it gets flushed back to buddy allocator.</i></td></tr>
<tr><th id="7137">7137</th><td><i> */</i></td></tr>
<tr><th id="7138">7138</th><td><em>int</em> <dfn class="decl def fn" id="percpu_pagelist_fraction_sysctl_handler" title='percpu_pagelist_fraction_sysctl_handler' data-ref="percpu_pagelist_fraction_sysctl_handler">percpu_pagelist_fraction_sysctl_handler</dfn>(<b>struct</b> <a class="type" href="../include/linux/sysctl.h.html#ctl_table" title='ctl_table' data-ref="ctl_table">ctl_table</a> *<dfn class="local col6 decl" id="1216table" title='table' data-type='struct ctl_table *' data-ref="1216table">table</dfn>, <em>int</em> <dfn class="local col7 decl" id="1217write" title='write' data-type='int' data-ref="1217write">write</dfn>,</td></tr>
<tr><th id="7139">7139</th><td>	<em>void</em> <a class="macro" href="../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col8 decl" id="1218buffer" title='buffer' data-type='void *' data-ref="1218buffer">buffer</dfn>, <a class="typedef" href="../include/linux/types.h.html#size_t" title='size_t' data-type='__kernel_size_t' data-ref="size_t">size_t</a> *<dfn class="local col9 decl" id="1219length" title='length' data-type='size_t *' data-ref="1219length">length</dfn>, <a class="typedef" href="../include/linux/types.h.html#loff_t" title='loff_t' data-type='__kernel_loff_t' data-ref="loff_t">loff_t</a> *<dfn class="local col0 decl" id="1220ppos" title='ppos' data-type='loff_t *' data-ref="1220ppos">ppos</dfn>)</td></tr>
<tr><th id="7140">7140</th><td>{</td></tr>
<tr><th id="7141">7141</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="1221zone" title='zone' data-type='struct zone *' data-ref="1221zone">zone</dfn>;</td></tr>
<tr><th id="7142">7142</th><td>	<em>int</em> <dfn class="local col2 decl" id="1222old_percpu_pagelist_fraction" title='old_percpu_pagelist_fraction' data-type='int' data-ref="1222old_percpu_pagelist_fraction">old_percpu_pagelist_fraction</dfn>;</td></tr>
<tr><th id="7143">7143</th><td>	<em>int</em> <dfn class="local col3 decl" id="1223ret" title='ret' data-type='int' data-ref="1223ret">ret</dfn>;</td></tr>
<tr><th id="7144">7144</th><td></td></tr>
<tr><th id="7145">7145</th><td>	<a class="ref fn" href="../include/linux/mutex.h.html#mutex_lock" title='mutex_lock' data-ref="mutex_lock">mutex_lock</a>(&amp;<a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='a' data-ref="pcp_batch_high_lock">pcp_batch_high_lock</a>);</td></tr>
<tr><th id="7146">7146</th><td>	<a class="local col2 ref" href="#1222old_percpu_pagelist_fraction" title='old_percpu_pagelist_fraction' data-ref="1222old_percpu_pagelist_fraction">old_percpu_pagelist_fraction</a> = <a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a>;</td></tr>
<tr><th id="7147">7147</th><td></td></tr>
<tr><th id="7148">7148</th><td>	<a class="local col3 ref" href="#1223ret" title='ret' data-ref="1223ret">ret</a> = <a class="ref fn" href="../include/linux/sysctl.h.html#proc_dointvec_minmax" title='proc_dointvec_minmax' data-ref="proc_dointvec_minmax">proc_dointvec_minmax</a>(<a class="local col6 ref" href="#1216table" title='table' data-ref="1216table">table</a>, <a class="local col7 ref" href="#1217write" title='write' data-ref="1217write">write</a>, <a class="local col8 ref" href="#1218buffer" title='buffer' data-ref="1218buffer">buffer</a>, <a class="local col9 ref" href="#1219length" title='length' data-ref="1219length">length</a>, <a class="local col0 ref" href="#1220ppos" title='ppos' data-ref="1220ppos">ppos</a>);</td></tr>
<tr><th id="7149">7149</th><td>	<b>if</b> (!<a class="local col7 ref" href="#1217write" title='write' data-ref="1217write">write</a> || <a class="local col3 ref" href="#1223ret" title='ret' data-ref="1223ret">ret</a> &lt; <var>0</var>)</td></tr>
<tr><th id="7150">7150</th><td>		<b>goto</b> <a class="lbl" href="#1224out" data-ref="1224out">out</a>;</td></tr>
<tr><th id="7151">7151</th><td></td></tr>
<tr><th id="7152">7152</th><td>	<i>/* Sanity checking to avoid pcp imbalance */</i></td></tr>
<tr><th id="7153">7153</th><td>	<b>if</b> (<a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a> &amp;&amp;</td></tr>
<tr><th id="7154">7154</th><td>	    <a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a> &lt; <a class="macro" href="#78" title="(8)" data-ref="_M/MIN_PERCPU_PAGELIST_FRACTION">MIN_PERCPU_PAGELIST_FRACTION</a>) {</td></tr>
<tr><th id="7155">7155</th><td>		<a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a> = <a class="local col2 ref" href="#1222old_percpu_pagelist_fraction" title='old_percpu_pagelist_fraction' data-ref="1222old_percpu_pagelist_fraction">old_percpu_pagelist_fraction</a>;</td></tr>
<tr><th id="7156">7156</th><td>		<a class="local col3 ref" href="#1223ret" title='ret' data-ref="1223ret">ret</a> = -<a class="macro" href="../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="7157">7157</th><td>		<b>goto</b> <a class="lbl" href="#1224out" data-ref="1224out">out</a>;</td></tr>
<tr><th id="7158">7158</th><td>	}</td></tr>
<tr><th id="7159">7159</th><td></td></tr>
<tr><th id="7160">7160</th><td>	<i>/* No change? */</i></td></tr>
<tr><th id="7161">7161</th><td>	<b>if</b> (<a class="ref" href="#percpu_pagelist_fraction" title='percpu_pagelist_fraction' data-ref="percpu_pagelist_fraction">percpu_pagelist_fraction</a> == <a class="local col2 ref" href="#1222old_percpu_pagelist_fraction" title='old_percpu_pagelist_fraction' data-ref="1222old_percpu_pagelist_fraction">old_percpu_pagelist_fraction</a>)</td></tr>
<tr><th id="7162">7162</th><td>		<b>goto</b> <a class="lbl" href="#1224out" data-ref="1224out">out</a>;</td></tr>
<tr><th id="7163">7163</th><td></td></tr>
<tr><th id="7164">7164</th><td>	<a class="macro" href="../include/linux/mmzone.h.html#946" title="for (zone = (first_online_pgdat())-&gt;node_zones; zone; zone = next_zone(zone)) if (!populated_zone(zone)) ; else" data-ref="_M/for_each_populated_zone">for_each_populated_zone</a>(<a class="local col1 ref" href="#1221zone" title='zone' data-ref="1221zone">zone</a>) {</td></tr>
<tr><th id="7165">7165</th><td>		<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="1225cpu" title='cpu' data-type='unsigned int' data-ref="1225cpu">cpu</dfn>;</td></tr>
<tr><th id="7166">7166</th><td></td></tr>
<tr><th id="7167">7167</th><td>		<a class="macro" href="../include/linux/cpumask.h.html#749" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_possible_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_possible_cpu">for_each_possible_cpu</a>(<a class="local col5 ref" href="#1225cpu" title='cpu' data-ref="1225cpu">cpu</a>)</td></tr>
<tr><th id="7168">7168</th><td>			<a class="tu ref fn" href="#pageset_set_high_and_batch" title='pageset_set_high_and_batch' data-use='c' data-ref="pageset_set_high_and_batch">pageset_set_high_and_batch</a>(<a class="local col1 ref" href="#1221zone" title='zone' data-ref="1221zone">zone</a>,</td></tr>
<tr><th id="7169">7169</th><td>					<a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col1 ref" href="#1221zone" title='zone' data-ref="1221zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col5 ref" href="#1225cpu" title='cpu' data-ref="1225cpu">cpu</a>));</td></tr>
<tr><th id="7170">7170</th><td>	}</td></tr>
<tr><th id="7171">7171</th><td><dfn class="lbl" id="1224out" data-ref="1224out">out</dfn>:</td></tr>
<tr><th id="7172">7172</th><td>	<a class="ref fn" href="../include/linux/mutex.h.html#mutex_unlock" title='mutex_unlock' data-ref="mutex_unlock">mutex_unlock</a>(&amp;<a class="tu ref" href="#77" title='pcp_batch_high_lock' data-use='a' data-ref="pcp_batch_high_lock">pcp_batch_high_lock</a>);</td></tr>
<tr><th id="7173">7173</th><td>	<b>return</b> <a class="local col3 ref" href="#1223ret" title='ret' data-ref="1223ret">ret</a>;</td></tr>
<tr><th id="7174">7174</th><td>}</td></tr>
<tr><th id="7175">7175</th><td></td></tr>
<tr><th id="7176">7176</th><td><u>#<span data-ppcond="7176">ifdef</span> <span class="macro" data-ref="_M/CONFIG_NUMA">CONFIG_NUMA</span></u></td></tr>
<tr><th id="7177">7177</th><td><em>int</em> hashdist = HASHDIST_DEFAULT;</td></tr>
<tr><th id="7178">7178</th><td></td></tr>
<tr><th id="7179">7179</th><td><em>static</em> <em>int</em> __init set_hashdist(<em>char</em> *str)</td></tr>
<tr><th id="7180">7180</th><td>{</td></tr>
<tr><th id="7181">7181</th><td>	<b>if</b> (!str)</td></tr>
<tr><th id="7182">7182</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7183">7183</th><td>	hashdist = simple_strtoul(str, &amp;str, <var>0</var>);</td></tr>
<tr><th id="7184">7184</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="7185">7185</th><td>}</td></tr>
<tr><th id="7186">7186</th><td>__setup(<q>"hashdist="</q>, set_hashdist);</td></tr>
<tr><th id="7187">7187</th><td><u>#<span data-ppcond="7176">endif</span></u></td></tr>
<tr><th id="7188">7188</th><td></td></tr>
<tr><th id="7189">7189</th><td><u>#<span data-ppcond="7189">ifndef</span> <span class="macro" data-ref="_M/__HAVE_ARCH_RESERVED_KERNEL_PAGES">__HAVE_ARCH_RESERVED_KERNEL_PAGES</span></u></td></tr>
<tr><th id="7190">7190</th><td><i  data-doc="arch_reserved_kernel_pages">/*</i></td></tr>
<tr><th id="7191">7191</th><td><i  data-doc="arch_reserved_kernel_pages"> * Returns the number of pages that arch has reserved but</i></td></tr>
<tr><th id="7192">7192</th><td><i  data-doc="arch_reserved_kernel_pages"> * is not known to alloc_large_system_hash().</i></td></tr>
<tr><th id="7193">7193</th><td><i  data-doc="arch_reserved_kernel_pages"> */</i></td></tr>
<tr><th id="7194">7194</th><td><em>static</em> <em>unsigned</em> <em>long</em> <a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="arch_reserved_kernel_pages" title='arch_reserved_kernel_pages' data-type='unsigned long arch_reserved_kernel_pages()' data-ref="arch_reserved_kernel_pages">arch_reserved_kernel_pages</dfn>(<em>void</em>)</td></tr>
<tr><th id="7195">7195</th><td>{</td></tr>
<tr><th id="7196">7196</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7197">7197</th><td>}</td></tr>
<tr><th id="7198">7198</th><td><u>#<span data-ppcond="7189">endif</span></u></td></tr>
<tr><th id="7199">7199</th><td></td></tr>
<tr><th id="7200">7200</th><td><i>/*</i></td></tr>
<tr><th id="7201">7201</th><td><i> * Adaptive scale is meant to reduce sizes of hash tables on large memory</i></td></tr>
<tr><th id="7202">7202</th><td><i> * machines. As memory size is increased the scale is also increased but at</i></td></tr>
<tr><th id="7203">7203</th><td><i> * slower pace.  Starting from ADAPT_SCALE_BASE (64G), every time memory</i></td></tr>
<tr><th id="7204">7204</th><td><i> * quadruples the scale is increased by one, which means the size of hash table</i></td></tr>
<tr><th id="7205">7205</th><td><i> * only doubles, instead of quadrupling as well.</i></td></tr>
<tr><th id="7206">7206</th><td><i> * Because 32-bit systems cannot have large physical memory, where this scaling</i></td></tr>
<tr><th id="7207">7207</th><td><i> * makes sense, it is disabled on such platforms.</i></td></tr>
<tr><th id="7208">7208</th><td><i> */</i></td></tr>
<tr><th id="7209">7209</th><td><u>#<span data-ppcond="7209">if</span> <a class="macro" href="../arch/x86/include/uapi/asm/bitsperlong.h.html#6" title="64" data-ref="_M/__BITS_PER_LONG">__BITS_PER_LONG</a> &gt; 32</u></td></tr>
<tr><th id="7210">7210</th><td><u>#define <dfn class="macro" id="_M/ADAPT_SCALE_BASE" data-ref="_M/ADAPT_SCALE_BASE">ADAPT_SCALE_BASE</dfn>	(64ul &lt;&lt; 30)</u></td></tr>
<tr><th id="7211">7211</th><td><u>#define <dfn class="macro" id="_M/ADAPT_SCALE_SHIFT" data-ref="_M/ADAPT_SCALE_SHIFT">ADAPT_SCALE_SHIFT</dfn>	2</u></td></tr>
<tr><th id="7212">7212</th><td><u>#define <dfn class="macro" id="_M/ADAPT_SCALE_NPAGES" data-ref="_M/ADAPT_SCALE_NPAGES">ADAPT_SCALE_NPAGES</dfn>	(ADAPT_SCALE_BASE &gt;&gt; PAGE_SHIFT)</u></td></tr>
<tr><th id="7213">7213</th><td><u>#<span data-ppcond="7209">endif</span></u></td></tr>
<tr><th id="7214">7214</th><td></td></tr>
<tr><th id="7215">7215</th><td><i>/*</i></td></tr>
<tr><th id="7216">7216</th><td><i> * allocate a large system hash table from bootmem</i></td></tr>
<tr><th id="7217">7217</th><td><i> * - it is assumed that the hash table must contain an exact power-of-2</i></td></tr>
<tr><th id="7218">7218</th><td><i> *   quantity of entries</i></td></tr>
<tr><th id="7219">7219</th><td><i> * - limit is the number of hash buckets, not the total allocation size</i></td></tr>
<tr><th id="7220">7220</th><td><i> */</i></td></tr>
<tr><th id="7221">7221</th><td><em>void</em> *<a class="macro" href="../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="alloc_large_system_hash" title='alloc_large_system_hash' data-ref="alloc_large_system_hash">alloc_large_system_hash</dfn>(<em>const</em> <em>char</em> *<dfn class="local col6 decl" id="1226tablename" title='tablename' data-type='const char *' data-ref="1226tablename">tablename</dfn>,</td></tr>
<tr><th id="7222">7222</th><td>				     <em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="1227bucketsize" title='bucketsize' data-type='unsigned long' data-ref="1227bucketsize">bucketsize</dfn>,</td></tr>
<tr><th id="7223">7223</th><td>				     <em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="1228numentries" title='numentries' data-type='unsigned long' data-ref="1228numentries">numentries</dfn>,</td></tr>
<tr><th id="7224">7224</th><td>				     <em>int</em> <dfn class="local col9 decl" id="1229scale" title='scale' data-type='int' data-ref="1229scale">scale</dfn>,</td></tr>
<tr><th id="7225">7225</th><td>				     <em>int</em> <dfn class="local col0 decl" id="1230flags" title='flags' data-type='int' data-ref="1230flags">flags</dfn>,</td></tr>
<tr><th id="7226">7226</th><td>				     <em>unsigned</em> <em>int</em> *<dfn class="local col1 decl" id="1231_hash_shift" title='_hash_shift' data-type='unsigned int *' data-ref="1231_hash_shift">_hash_shift</dfn>,</td></tr>
<tr><th id="7227">7227</th><td>				     <em>unsigned</em> <em>int</em> *<dfn class="local col2 decl" id="1232_hash_mask" title='_hash_mask' data-type='unsigned int *' data-ref="1232_hash_mask">_hash_mask</dfn>,</td></tr>
<tr><th id="7228">7228</th><td>				     <em>unsigned</em> <em>long</em> <dfn class="local col3 decl" id="1233low_limit" title='low_limit' data-type='unsigned long' data-ref="1233low_limit">low_limit</dfn>,</td></tr>
<tr><th id="7229">7229</th><td>				     <em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1234high_limit" title='high_limit' data-type='unsigned long' data-ref="1234high_limit">high_limit</dfn>)</td></tr>
<tr><th id="7230">7230</th><td>{</td></tr>
<tr><th id="7231">7231</th><td>	<em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col5 decl" id="1235max" title='max' data-type='unsigned long long' data-ref="1235max">max</dfn> = <a class="local col4 ref" href="#1234high_limit" title='high_limit' data-ref="1234high_limit">high_limit</a>;</td></tr>
<tr><th id="7232">7232</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="1236log2qty" title='log2qty' data-type='unsigned long' data-ref="1236log2qty">log2qty</dfn>, <dfn class="local col7 decl" id="1237size" title='size' data-type='unsigned long' data-ref="1237size">size</dfn>;</td></tr>
<tr><th id="7233">7233</th><td>	<em>void</em> *<dfn class="local col8 decl" id="1238table" title='table' data-type='void *' data-ref="1238table">table</dfn> = <a class="macro" href="../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="7234">7234</th><td>	<a class="typedef" href="../include/linux/types.h.html#gfp_t" title='gfp_t' data-type='unsigned int' data-ref="gfp_t">gfp_t</a> <dfn class="local col9 decl" id="1239gfp_flags" title='gfp_flags' data-type='gfp_t' data-ref="1239gfp_flags">gfp_flags</dfn>;</td></tr>
<tr><th id="7235">7235</th><td></td></tr>
<tr><th id="7236">7236</th><td>	<i>/* allow the kernel cmdline to have a say */</i></td></tr>
<tr><th id="7237">7237</th><td>	<b>if</b> (!<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a>) {</td></tr>
<tr><th id="7238">7238</th><td>		<i>/* round applicable memory size up to nearest megabyte */</i></td></tr>
<tr><th id="7239">7239</th><td>		<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <a class="tu ref" href="#nr_kernel_pages" title='nr_kernel_pages' data-use='r' data-ref="nr_kernel_pages">nr_kernel_pages</a>;</td></tr>
<tr><th id="7240">7240</th><td>		<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> -= <a class="tu ref fn" href="#arch_reserved_kernel_pages" title='arch_reserved_kernel_pages' data-use='c' data-ref="arch_reserved_kernel_pages">arch_reserved_kernel_pages</a>();</td></tr>
<tr><th id="7241">7241</th><td></td></tr>
<tr><th id="7242">7242</th><td>		<i>/* It isn't necessary when PAGE_SIZE &gt;= 1MB */</i></td></tr>
<tr><th id="7243">7243</th><td>		<b>if</b> (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a> &lt; <var>20</var>)</td></tr>
<tr><th id="7244">7244</th><td>			<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <a class="macro" href="../include/linux/kernel.h.html#87" title="((((numentries)-1) | ((__typeof__(numentries))(((1&lt;&lt;20)/((1UL) &lt;&lt; 12))-1)))+1)" data-ref="_M/round_up">round_up</a>(<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a>, (<var>1</var>&lt;&lt;<var>20</var>)/<a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>);</td></tr>
<tr><th id="7245">7245</th><td></td></tr>
<tr><th id="7246">7246</th><td><u>#<span data-ppcond="7246">if</span> <a class="macro" href="../arch/x86/include/uapi/asm/bitsperlong.h.html#6" title="64" data-ref="_M/__BITS_PER_LONG">__BITS_PER_LONG</a> &gt; 32</u></td></tr>
<tr><th id="7247">7247</th><td>		<b>if</b> (!<a class="local col4 ref" href="#1234high_limit" title='high_limit' data-ref="1234high_limit">high_limit</a>) {</td></tr>
<tr><th id="7248">7248</th><td>			<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1240adapt" title='adapt' data-type='unsigned long' data-ref="1240adapt">adapt</dfn>;</td></tr>
<tr><th id="7249">7249</th><td></td></tr>
<tr><th id="7250">7250</th><td>			<b>for</b> (<a class="local col0 ref" href="#1240adapt" title='adapt' data-ref="1240adapt">adapt</a> = <a class="macro" href="#7212" title="((64ul &lt;&lt; 30) &gt;&gt; 12)" data-ref="_M/ADAPT_SCALE_NPAGES">ADAPT_SCALE_NPAGES</a>; <a class="local col0 ref" href="#1240adapt" title='adapt' data-ref="1240adapt">adapt</a> &lt; <a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a>;</td></tr>
<tr><th id="7251">7251</th><td>			     <a class="local col0 ref" href="#1240adapt" title='adapt' data-ref="1240adapt">adapt</a> &lt;&lt;= <a class="macro" href="#7211" title="2" data-ref="_M/ADAPT_SCALE_SHIFT">ADAPT_SCALE_SHIFT</a>)</td></tr>
<tr><th id="7252">7252</th><td>				<a class="local col9 ref" href="#1229scale" title='scale' data-ref="1229scale">scale</a>++;</td></tr>
<tr><th id="7253">7253</th><td>		}</td></tr>
<tr><th id="7254">7254</th><td><u>#<span data-ppcond="7246">endif</span></u></td></tr>
<tr><th id="7255">7255</th><td></td></tr>
<tr><th id="7256">7256</th><td>		<i>/* limit to 1 bucket per 2^scale bytes of low memory */</i></td></tr>
<tr><th id="7257">7257</th><td>		<b>if</b> (<a class="local col9 ref" href="#1229scale" title='scale' data-ref="1229scale">scale</a> &gt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>)</td></tr>
<tr><th id="7258">7258</th><td>			<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> &gt;&gt;= (<a class="local col9 ref" href="#1229scale" title='scale' data-ref="1229scale">scale</a> - <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>);</td></tr>
<tr><th id="7259">7259</th><td>		<b>else</b></td></tr>
<tr><th id="7260">7260</th><td>			<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> &lt;&lt;= (<a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a> - <a class="local col9 ref" href="#1229scale" title='scale' data-ref="1229scale">scale</a>);</td></tr>
<tr><th id="7261">7261</th><td></td></tr>
<tr><th id="7262">7262</th><td>		<i>/* Make sure we've got at least a 0-order allocation.. */</i></td></tr>
<tr><th id="7263">7263</th><td>		<b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!(flags &amp; 0x00000002), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col0 ref" href="#1230flags" title='flags' data-ref="1230flags">flags</a> &amp; <a class="macro" href="../include/linux/bootmem.h.html#360" title="0x00000002" data-ref="_M/HASH_SMALL">HASH_SMALL</a>)) {</td></tr>
<tr><th id="7264">7264</th><td>			<i>/* Makes no sense without HASH_EARLY */</i></td></tr>
<tr><th id="7265">7265</th><td>			<a class="macro" href="../include/asm-generic/bug.h.html#108" title="({ int __ret_warn_on = !!(!(flags &amp; 0x00000001)); if (__builtin_expect(!!(__ret_warn_on), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (7265), &quot;i&quot; ((1 &lt;&lt; 0)|(((9) &lt;&lt; 8))), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (333)); }); } while (0); __builtin_expect(!!(__ret_warn_on), 0); })" data-ref="_M/WARN_ON">WARN_ON</a>(!(<a class="local col0 ref" href="#1230flags" title='flags' data-ref="1230flags">flags</a> &amp; <a class="macro" href="../include/linux/bootmem.h.html#359" title="0x00000001" data-ref="_M/HASH_EARLY">HASH_EARLY</a>));</td></tr>
<tr><th id="7266">7266</th><td>			<b>if</b> (!(<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> &gt;&gt; *<a class="local col1 ref" href="#1231_hash_shift" title='_hash_shift' data-ref="1231_hash_shift">_hash_shift</a>)) {</td></tr>
<tr><th id="7267">7267</th><td>				<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <var>1UL</var> &lt;&lt; *<a class="local col1 ref" href="#1231_hash_shift" title='_hash_shift' data-ref="1231_hash_shift">_hash_shift</a>;</td></tr>
<tr><th id="7268">7268</th><td>				<a class="macro" href="../include/asm-generic/bug.h.html#59" title="do { if (__builtin_expect(!!(!numentries), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/mm/page_alloc.c&quot;), &quot;i&quot; (7268), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (335)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(!<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a>);</td></tr>
<tr><th id="7269">7269</th><td>			}</td></tr>
<tr><th id="7270">7270</th><td>		} <b>else</b> <b>if</b> (<a class="macro" href="../include/linux/compiler.h.html#77" title="__builtin_expect(!!((numentries * bucketsize) &lt; ((1UL) &lt;&lt; 12)), 0)" data-ref="_M/unlikely">unlikely</a>((<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> * <a class="local col7 ref" href="#1227bucketsize" title='bucketsize' data-ref="1227bucketsize">bucketsize</a>) &lt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>))</td></tr>
<tr><th id="7271">7271</th><td>			<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> / <a class="local col7 ref" href="#1227bucketsize" title='bucketsize' data-ref="1227bucketsize">bucketsize</a>;</td></tr>
<tr><th id="7272">7272</th><td>	}</td></tr>
<tr><th id="7273">7273</th><td>	<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <a class="macro" href="../include/linux/log2.h.html#159" title="( __builtin_constant_p(numentries) ? ( (numentries == 1) ? 1 : (1UL &lt;&lt; (( __builtin_constant_p((numentries) - 1) ? ( ((numentries) - 1) &lt; 2 ? 0 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 63) ? 63 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 62) ? 62 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 61) ? 61 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 60) ? 60 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 59) ? 59 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 58) ? 58 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 57) ? 57 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 56) ? 56 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 55) ? 55 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 54) ? 54 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 53) ? 53 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 52) ? 52 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 51) ? 51 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 50) ? 50 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 49) ? 49 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 48) ? 48 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 47) ? 47 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 46) ? 46 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 45) ? 45 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 44) ? 44 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 43) ? 43 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 42) ? 42 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 41) ? 41 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 40) ? 40 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 39) ? 39 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 38) ? 38 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 37) ? 37 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 36) ? 36 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 35) ? 35 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 34) ? 34 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 33) ? 33 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 32) ? 32 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 31) ? 31 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 30) ? 30 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 29) ? 29 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 28) ? 28 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 27) ? 27 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 26) ? 26 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 25) ? 25 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 24) ? 24 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 23) ? 23 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 22) ? 22 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 21) ? 21 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 20) ? 20 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 19) ? 19 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 18) ? 18 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 17) ? 17 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 16) ? 16 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 15) ? 15 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 14) ? 14 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 13) ? 13 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 12) ? 12 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 11) ? 11 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 10) ? 10 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 9) ? 9 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 8) ? 8 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 7) ? 7 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 6) ? 6 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 5) ? 5 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 4) ? 4 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 3) ? 3 : ((numentries) - 1) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof((numentries) - 1) &lt;= 4) ? __ilog2_u32((numentries) - 1) : __ilog2_u64((numentries) - 1) ) + 1)) ) : __roundup_pow_of_two(numentries) )" data-ref="_M/roundup_pow_of_two">roundup_pow_of_two</a>(<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a>);</td></tr>
<tr><th id="7274">7274</th><td></td></tr>
<tr><th id="7275">7275</th><td>	<i>/* limit allocation size to 1/16 total memory by default */</i></td></tr>
<tr><th id="7276">7276</th><td>	<b>if</b> (<a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a> == <var>0</var>) {</td></tr>
<tr><th id="7277">7277</th><td>		<a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a> = ((<em>unsigned</em> <em>long</em> <em>long</em>)<a class="tu ref" href="#nr_all_pages" title='nr_all_pages' data-use='r' data-ref="nr_all_pages">nr_all_pages</a> &lt;&lt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#10" title="12" data-ref="_M/PAGE_SHIFT">PAGE_SHIFT</a>) &gt;&gt; <var>4</var>;</td></tr>
<tr><th id="7278">7278</th><td>		<a class="macro" href="../include/asm-generic/div64.h.html#29" title="({ uint32_t __base = (bucketsize); uint32_t __rem; __rem = ((uint64_t)(max)) % __base; (max) = ((uint64_t)(max)) / __base; __rem; })" data-ref="_M/do_div">do_div</a>(<a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a>, <a class="local col7 ref" href="#1227bucketsize" title='bucketsize' data-ref="1227bucketsize">bucketsize</a>);</td></tr>
<tr><th id="7279">7279</th><td>	}</td></tr>
<tr><th id="7280">7280</th><td>	<a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a> = <a class="macro" href="../include/linux/kernel.h.html#799" title="({ typeof(max) __UNIQUE_ID_min1_337 = (max); typeof(0x80000000ULL) __UNIQUE_ID_min2_338 = (0x80000000ULL); (void) (&amp;__UNIQUE_ID_min1_337 == &amp;__UNIQUE_ID_min2_338); __UNIQUE_ID_min1_337 &lt; __UNIQUE_ID_min2_338 ? __UNIQUE_ID_min1_337 : __UNIQUE_ID_min2_338; })" data-ref="_M/min">min</a>(<a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a>, <var>0x80000000ULL</var>);</td></tr>
<tr><th id="7281">7281</th><td></td></tr>
<tr><th id="7282">7282</th><td>	<b>if</b> (<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> &lt; <a class="local col3 ref" href="#1233low_limit" title='low_limit' data-ref="1233low_limit">low_limit</a>)</td></tr>
<tr><th id="7283">7283</th><td>		<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <a class="local col3 ref" href="#1233low_limit" title='low_limit' data-ref="1233low_limit">low_limit</a>;</td></tr>
<tr><th id="7284">7284</th><td>	<b>if</b> (<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> &gt; <a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a>)</td></tr>
<tr><th id="7285">7285</th><td>		<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a> = <a class="local col5 ref" href="#1235max" title='max' data-ref="1235max">max</a>;</td></tr>
<tr><th id="7286">7286</th><td></td></tr>
<tr><th id="7287">7287</th><td>	<a class="local col6 ref" href="#1236log2qty" title='log2qty' data-ref="1236log2qty">log2qty</a> = <a class="macro" href="../include/linux/log2.h.html#79" title="( __builtin_constant_p(numentries) ? ( (numentries) &lt; 2 ? 0 : (numentries) &amp; (1ULL &lt;&lt; 63) ? 63 : (numentries) &amp; (1ULL &lt;&lt; 62) ? 62 : (numentries) &amp; (1ULL &lt;&lt; 61) ? 61 : (numentries) &amp; (1ULL &lt;&lt; 60) ? 60 : (numentries) &amp; (1ULL &lt;&lt; 59) ? 59 : (numentries) &amp; (1ULL &lt;&lt; 58) ? 58 : (numentries) &amp; (1ULL &lt;&lt; 57) ? 57 : (numentries) &amp; (1ULL &lt;&lt; 56) ? 56 : (numentries) &amp; (1ULL &lt;&lt; 55) ? 55 : (numentries) &amp; (1ULL &lt;&lt; 54) ? 54 : (numentries) &amp; (1ULL &lt;&lt; 53) ? 53 : (numentries) &amp; (1ULL &lt;&lt; 52) ? 52 : (numentries) &amp; (1ULL &lt;&lt; 51) ? 51 : (numentries) &amp; (1ULL &lt;&lt; 50) ? 50 : (numentries) &amp; (1ULL &lt;&lt; 49) ? 49 : (numentries) &amp; (1ULL &lt;&lt; 48) ? 48 : (numentries) &amp; (1ULL &lt;&lt; 47) ? 47 : (numentries) &amp; (1ULL &lt;&lt; 46) ? 46 : (numentries) &amp; (1ULL &lt;&lt; 45) ? 45 : (numentries) &amp; (1ULL &lt;&lt; 44) ? 44 : (numentries) &amp; (1ULL &lt;&lt; 43) ? 43 : (numentries) &amp; (1ULL &lt;&lt; 42) ? 42 : (numentries) &amp; (1ULL &lt;&lt; 41) ? 41 : (numentries) &amp; (1ULL &lt;&lt; 40) ? 40 : (numentries) &amp; (1ULL &lt;&lt; 39) ? 39 : (numentries) &amp; (1ULL &lt;&lt; 38) ? 38 : (numentries) &amp; (1ULL &lt;&lt; 37) ? 37 : (numentries) &amp; (1ULL &lt;&lt; 36) ? 36 : (numentries) &amp; (1ULL &lt;&lt; 35) ? 35 : (numentries) &amp; (1ULL &lt;&lt; 34) ? 34 : (numentries) &amp; (1ULL &lt;&lt; 33) ? 33 : (numentries) &amp; (1ULL &lt;&lt; 32) ? 32 : (numentries) &amp; (1ULL &lt;&lt; 31) ? 31 : (numentries) &amp; (1ULL &lt;&lt; 30) ? 30 : (numentries) &amp; (1ULL &lt;&lt; 29) ? 29 : (numentries) &amp; (1ULL &lt;&lt; 28) ? 28 : (numentries) &amp; (1ULL &lt;&lt; 27) ? 27 : (numentries) &amp; (1ULL &lt;&lt; 26) ? 26 : (numentries) &amp; (1ULL &lt;&lt; 25) ? 25 : (numentries) &amp; (1ULL &lt;&lt; 24) ? 24 : (numentries) &amp; (1ULL &lt;&lt; 23) ? 23 : (numentries) &amp; (1ULL &lt;&lt; 22) ? 22 : (numentries) &amp; (1ULL &lt;&lt; 21) ? 21 : (numentries) &amp; (1ULL &lt;&lt; 20) ? 20 : (numentries) &amp; (1ULL &lt;&lt; 19) ? 19 : (numentries) &amp; (1ULL &lt;&lt; 18) ? 18 : (numentries) &amp; (1ULL &lt;&lt; 17) ? 17 : (numentries) &amp; (1ULL &lt;&lt; 16) ? 16 : (numentries) &amp; (1ULL &lt;&lt; 15) ? 15 : (numentries) &amp; (1ULL &lt;&lt; 14) ? 14 : (numentries) &amp; (1ULL &lt;&lt; 13) ? 13 : (numentries) &amp; (1ULL &lt;&lt; 12) ? 12 : (numentries) &amp; (1ULL &lt;&lt; 11) ? 11 : (numentries) &amp; (1ULL &lt;&lt; 10) ? 10 : (numentries) &amp; (1ULL &lt;&lt; 9) ? 9 : (numentries) &amp; (1ULL &lt;&lt; 8) ? 8 : (numentries) &amp; (1ULL &lt;&lt; 7) ? 7 : (numentries) &amp; (1ULL &lt;&lt; 6) ? 6 : (numentries) &amp; (1ULL &lt;&lt; 5) ? 5 : (numentries) &amp; (1ULL &lt;&lt; 4) ? 4 : (numentries) &amp; (1ULL &lt;&lt; 3) ? 3 : (numentries) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof(numentries) &lt;= 4) ? __ilog2_u32(numentries) : __ilog2_u64(numentries) )" data-ref="_M/ilog2">ilog2</a>(<a class="local col8 ref" href="#1228numentries" title='numentries' data-ref="1228numentries">numentries</a>);</td></tr>
<tr><th id="7288">7288</th><td></td></tr>
<tr><th id="7289">7289</th><td>	<i>/*</i></td></tr>
<tr><th id="7290">7290</th><td><i>	 * memblock allocator returns zeroed memory already, so HASH_ZERO is</i></td></tr>
<tr><th id="7291">7291</th><td><i>	 * currently not used when HASH_EARLY is specified.</i></td></tr>
<tr><th id="7292">7292</th><td><i>	 */</i></td></tr>
<tr><th id="7293">7293</th><td>	<a class="local col9 ref" href="#1239gfp_flags" title='gfp_flags' data-ref="1239gfp_flags">gfp_flags</a> = (<a class="local col0 ref" href="#1230flags" title='flags' data-ref="1230flags">flags</a> &amp; <a class="macro" href="../include/linux/bootmem.h.html#362" title="0x00000004" data-ref="_M/HASH_ZERO">HASH_ZERO</a>) ? <a class="macro" href="../include/linux/gfp.h.html#277" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a> | <a class="macro" href="../include/linux/gfp.h.html#207" title="(( gfp_t)0x8000u)" data-ref="_M/__GFP_ZERO">__GFP_ZERO</a> : <a class="macro" href="../include/linux/gfp.h.html#277" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>;</td></tr>
<tr><th id="7294">7294</th><td>	<b>do</b> {</td></tr>
<tr><th id="7295">7295</th><td>		<a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a> = <a class="local col7 ref" href="#1227bucketsize" title='bucketsize' data-ref="1227bucketsize">bucketsize</a> &lt;&lt; <a class="local col6 ref" href="#1236log2qty" title='log2qty' data-ref="1236log2qty">log2qty</a>;</td></tr>
<tr><th id="7296">7296</th><td>		<b>if</b> (<a class="local col0 ref" href="#1230flags" title='flags' data-ref="1230flags">flags</a> &amp; <a class="macro" href="../include/linux/bootmem.h.html#359" title="0x00000001" data-ref="_M/HASH_EARLY">HASH_EARLY</a>)</td></tr>
<tr><th id="7297">7297</th><td>			<a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a> = <a class="ref fn" href="../include/linux/bootmem.h.html#memblock_virt_alloc_nopanic" title='memblock_virt_alloc_nopanic' data-ref="memblock_virt_alloc_nopanic">memblock_virt_alloc_nopanic</a>(<a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>, <var>0</var>);</td></tr>
<tr><th id="7298">7298</th><td>		<b>else</b> <b>if</b> (<a class="macro" href="../include/linux/bootmem.h.html#371" title="(0)" data-ref="_M/hashdist">hashdist</a>)</td></tr>
<tr><th id="7299">7299</th><td>			<a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a> = <a class="ref fn" href="../include/linux/vmalloc.h.html#__vmalloc" title='__vmalloc' data-ref="__vmalloc">__vmalloc</a>(<a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>, <a class="local col9 ref" href="#1239gfp_flags" title='gfp_flags' data-ref="1239gfp_flags">gfp_flags</a>, <a class="macro" href="../arch/x86/include/asm/pgtable_types.h.html#200" title="((pgprot_t) { ((((((pteval_t)(1)) &lt;&lt; 0) | (((pteval_t)(1)) &lt;&lt; 1) | (((pteval_t)(1)) &lt;&lt; 6) | (((pteval_t)(1)) &lt;&lt; 5) | (((pteval_t)(1)) &lt;&lt; 8)) | (((pteval_t)(1)) &lt;&lt; 63)) | (((pteval_t)(0ULL)))) } )" data-ref="_M/PAGE_KERNEL">PAGE_KERNEL</a>);</td></tr>
<tr><th id="7300">7300</th><td>		<b>else</b> {</td></tr>
<tr><th id="7301">7301</th><td>			<i>/*</i></td></tr>
<tr><th id="7302">7302</th><td><i>			 * If bucketsize is not a power-of-two, we may free</i></td></tr>
<tr><th id="7303">7303</th><td><i>			 * some pages at the end of hash table which</i></td></tr>
<tr><th id="7304">7304</th><td><i>			 * alloc_pages_exact() automatically does</i></td></tr>
<tr><th id="7305">7305</th><td><i>			 */</i></td></tr>
<tr><th id="7306">7306</th><td>			<b>if</b> (<a class="macro" href="../include/asm-generic/getorder.h.html#50" title="( __builtin_constant_p(size) ? ( ((size) == 0UL) ? 64 - 12 : (((size) &lt; (1UL &lt;&lt; 12)) ? 0 : ( __builtin_constant_p((size) - 1) ? ( ((size) - 1) &lt; 2 ? 0 : ((size) - 1) &amp; (1ULL &lt;&lt; 63) ? 63 : ((size) - 1) &amp; (1ULL &lt;&lt; 62) ? 62 : ((size) - 1) &amp; (1ULL &lt;&lt; 61) ? 61 : ((size) - 1) &amp; (1ULL &lt;&lt; 60) ? 60 : ((size) - 1) &amp; (1ULL &lt;&lt; 59) ? 59 : ((size) - 1) &amp; (1ULL &lt;&lt; 58) ? 58 : ((size) - 1) &amp; (1ULL &lt;&lt; 57) ? 57 : ((size) - 1) &amp; (1ULL &lt;&lt; 56) ? 56 : ((size) - 1) &amp; (1ULL &lt;&lt; 55) ? 55 : ((size) - 1) &amp; (1ULL &lt;&lt; 54) ? 54 : ((size) - 1) &amp; (1ULL &lt;&lt; 53) ? 53 : ((size) - 1) &amp; (1ULL &lt;&lt; 52) ? 52 : ((size) - 1) &amp; (1ULL &lt;&lt; 51) ? 51 : ((size) - 1) &amp; (1ULL &lt;&lt; 50) ? 50 : ((size) - 1) &amp; (1ULL &lt;&lt; 49) ? 49 : ((size) - 1) &amp; (1ULL &lt;&lt; 48) ? 48 : ((size) - 1) &amp; (1ULL &lt;&lt; 47) ? 47 : ((size) - 1) &amp; (1ULL &lt;&lt; 46) ? 46 : ((size) - 1) &amp; (1ULL &lt;&lt; 45) ? 45 : ((size) - 1) &amp; (1ULL &lt;&lt; 44) ? 44 : ((size) - 1) &amp; (1ULL &lt;&lt; 43) ? 43 : ((size) - 1) &amp; (1ULL &lt;&lt; 42) ? 42 : ((size) - 1) &amp; (1ULL &lt;&lt; 41) ? 41 : ((size) - 1) &amp; (1ULL &lt;&lt; 40) ? 40 : ((size) - 1) &amp; (1ULL &lt;&lt; 39) ? 39 : ((size) - 1) &amp; (1ULL &lt;&lt; 38) ? 38 : ((size) - 1) &amp; (1ULL &lt;&lt; 37) ? 37 : ((size) - 1) &amp; (1ULL &lt;&lt; 36) ? 36 : ((size) - 1) &amp; (1ULL &lt;&lt; 35) ? 35 : ((size) - 1) &amp; (1ULL &lt;&lt; 34) ? 34 : ((size) - 1) &amp; (1ULL &lt;&lt; 33) ? 33 : ((size) - 1) &amp; (1ULL &lt;&lt; 32) ? 32 : ((size) - 1) &amp; (1ULL &lt;&lt; 31) ? 31 : ((size) - 1) &amp; (1ULL &lt;&lt; 30) ? 30 : ((size) - 1) &amp; (1ULL &lt;&lt; 29) ? 29 : ((size) - 1) &amp; (1ULL &lt;&lt; 28) ? 28 : ((size) - 1) &amp; (1ULL &lt;&lt; 27) ? 27 : ((size) - 1) &amp; (1ULL &lt;&lt; 26) ? 26 : ((size) - 1) &amp; (1ULL &lt;&lt; 25) ? 25 : ((size) - 1) &amp; (1ULL &lt;&lt; 24) ? 24 : ((size) - 1) &amp; (1ULL &lt;&lt; 23) ? 23 : ((size) - 1) &amp; (1ULL &lt;&lt; 22) ? 22 : ((size) - 1) &amp; (1ULL &lt;&lt; 21) ? 21 : ((size) - 1) &amp; (1ULL &lt;&lt; 20) ? 20 : ((size) - 1) &amp; (1ULL &lt;&lt; 19) ? 19 : ((size) - 1) &amp; (1ULL &lt;&lt; 18) ? 18 : ((size) - 1) &amp; (1ULL &lt;&lt; 17) ? 17 : ((size) - 1) &amp; (1ULL &lt;&lt; 16) ? 16 : ((size) - 1) &amp; (1ULL &lt;&lt; 15) ? 15 : ((size) - 1) &amp; (1ULL &lt;&lt; 14) ? 14 : ((size) - 1) &amp; (1ULL &lt;&lt; 13) ? 13 : ((size) - 1) &amp; (1ULL &lt;&lt; 12) ? 12 : ((size) - 1) &amp; (1ULL &lt;&lt; 11) ? 11 : ((size) - 1) &amp; (1ULL &lt;&lt; 10) ? 10 : ((size) - 1) &amp; (1ULL &lt;&lt; 9) ? 9 : ((size) - 1) &amp; (1ULL &lt;&lt; 8) ? 8 : ((size) - 1) &amp; (1ULL &lt;&lt; 7) ? 7 : ((size) - 1) &amp; (1ULL &lt;&lt; 6) ? 6 : ((size) - 1) &amp; (1ULL &lt;&lt; 5) ? 5 : ((size) - 1) &amp; (1ULL &lt;&lt; 4) ? 4 : ((size) - 1) &amp; (1ULL &lt;&lt; 3) ? 3 : ((size) - 1) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof((size) - 1) &lt;= 4) ? __ilog2_u32((size) - 1) : __ilog2_u64((size) - 1) ) - 12 + 1) ) : __get_order(size) )" data-ref="_M/get_order">get_order</a>(<a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>) &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>) {</td></tr>
<tr><th id="7307">7307</th><td>				<a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a> = <a class="ref fn" href="#alloc_pages_exact" title='alloc_pages_exact' data-ref="alloc_pages_exact">alloc_pages_exact</a>(<a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>, <a class="local col9 ref" href="#1239gfp_flags" title='gfp_flags' data-ref="1239gfp_flags">gfp_flags</a>);</td></tr>
<tr><th id="7308">7308</th><td>				<a class="ref fn" href="../include/linux/kmemleak.h.html#kmemleak_alloc" title='kmemleak_alloc' data-ref="kmemleak_alloc">kmemleak_alloc</a>(<a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a>, <a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>, <var>1</var>, <a class="local col9 ref" href="#1239gfp_flags" title='gfp_flags' data-ref="1239gfp_flags">gfp_flags</a>);</td></tr>
<tr><th id="7309">7309</th><td>			}</td></tr>
<tr><th id="7310">7310</th><td>		}</td></tr>
<tr><th id="7311">7311</th><td>	} <b>while</b> (!<a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a> &amp;&amp; <a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a> &gt; <a class="macro" href="../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> &amp;&amp; --<a class="local col6 ref" href="#1236log2qty" title='log2qty' data-ref="1236log2qty">log2qty</a>);</td></tr>
<tr><th id="7312">7312</th><td></td></tr>
<tr><th id="7313">7313</th><td>	<b>if</b> (!<a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a>)</td></tr>
<tr><th id="7314">7314</th><td>		<a class="ref fn" href="../include/linux/kernel.h.html#panic" title='panic' data-ref="panic">panic</a>(<q>"Failed to allocate %s hash table\n"</q>, <a class="local col6 ref" href="#1226tablename" title='tablename' data-ref="1226tablename">tablename</a>);</td></tr>
<tr><th id="7315">7315</th><td></td></tr>
<tr><th id="7316">7316</th><td>	<a class="macro" href="../include/linux/printk.h.html#308" title="printk(&quot;\001&quot; &quot;6&quot; &quot;%s hash table entries: %ld (order: %d, %lu bytes)\n&quot;, tablename, 1UL &lt;&lt; log2qty, ( __builtin_constant_p(size) ? ( (size) &lt; 2 ? 0 : (size) &amp; (1ULL &lt;&lt; 63) ? 63 : (size) &amp; (1ULL &lt;&lt; 62) ? 62 : (size) &amp; (1ULL &lt;&lt; 61) ? 61 : (size) &amp; (1ULL &lt;&lt; 60) ? 60 : (size) &amp; (1ULL &lt;&lt; 59) ? 59 : (size) &amp; (1ULL &lt;&lt; 58) ? 58 : (size) &amp; (1ULL &lt;&lt; 57) ? 57 : (size) &amp; (1ULL &lt;&lt; 56) ? 56 : (size) &amp; (1ULL &lt;&lt; 55) ? 55 : (size) &amp; (1ULL &lt;&lt; 54) ? 54 : (size) &amp; (1ULL &lt;&lt; 53) ? 53 : (size) &amp; (1ULL &lt;&lt; 52) ? 52 : (size) &amp; (1ULL &lt;&lt; 51) ? 51 : (size) &amp; (1ULL &lt;&lt; 50) ? 50 : (size) &amp; (1ULL &lt;&lt; 49) ? 49 : (size) &amp; (1ULL &lt;&lt; 48) ? 48 : (size) &amp; (1ULL &lt;&lt; 47) ? 47 : (size) &amp; (1ULL &lt;&lt; 46) ? 46 : (size) &amp; (1ULL &lt;&lt; 45) ? 45 : (size) &amp; (1ULL &lt;&lt; 44) ? 44 : (size) &amp; (1ULL &lt;&lt; 43) ? 43 : (size) &amp; (1ULL &lt;&lt; 42) ? 42 : (size) &amp; (1ULL &lt;&lt; 41) ? 41 : (size) &amp; (1ULL &lt;&lt; 40) ? 40 : (size) &amp; (1ULL &lt;&lt; 39) ? 39 : (size) &amp; (1ULL &lt;&lt; 38) ? 38 : (size) &amp; (1ULL &lt;&lt; 37) ? 37 : (size) &amp; (1ULL &lt;&lt; 36) ? 36 : (size) &amp; (1ULL &lt;&lt; 35) ? 35 : (size) &amp; (1ULL &lt;&lt; 34) ? 34 : (size) &amp; (1ULL &lt;&lt; 33) ? 33 : (size) &amp; (1ULL &lt;&lt; 32) ? 32 : (size) &amp; (1ULL &lt;&lt; 31) ? 31 : (size) &amp; (1ULL &lt;&lt; 30) ? 30 : (size) &amp; (1ULL &lt;&lt; 29) ? 29 : (size) &amp; (1ULL &lt;&lt; 28) ? 28 : (size) &amp; (1ULL &lt;&lt; 27) ? 27 : (size) &amp; (1ULL &lt;&lt; 26) ? 26 : (size) &amp; (1ULL &lt;&lt; 25) ? 25 : (size) &amp; (1ULL &lt;&lt; 24) ? 24 : (size) &amp; (1ULL &lt;&lt; 23) ? 23 : (size) &amp; (1ULL &lt;&lt; 22) ? 22 : (size) &amp; (1ULL &lt;&lt; 21) ? 21 : (size) &amp; (1ULL &lt;&lt; 20) ? 20 : (size) &amp; (1ULL &lt;&lt; 19) ? 19 : (size) &amp; (1ULL &lt;&lt; 18) ? 18 : (size) &amp; (1ULL &lt;&lt; 17) ? 17 : (size) &amp; (1ULL &lt;&lt; 16) ? 16 : (size) &amp; (1ULL &lt;&lt; 15) ? 15 : (size) &amp; (1ULL &lt;&lt; 14) ? 14 : (size) &amp; (1ULL &lt;&lt; 13) ? 13 : (size) &amp; (1ULL &lt;&lt; 12) ? 12 : (size) &amp; (1ULL &lt;&lt; 11) ? 11 : (size) &amp; (1ULL &lt;&lt; 10) ? 10 : (size) &amp; (1ULL &lt;&lt; 9) ? 9 : (size) &amp; (1ULL &lt;&lt; 8) ? 8 : (size) &amp; (1ULL &lt;&lt; 7) ? 7 : (size) &amp; (1ULL &lt;&lt; 6) ? 6 : (size) &amp; (1ULL &lt;&lt; 5) ? 5 : (size) &amp; (1ULL &lt;&lt; 4) ? 4 : (size) &amp; (1ULL &lt;&lt; 3) ? 3 : (size) &amp; (1ULL &lt;&lt; 2) ? 2 : 1 ) : (sizeof(size) &lt;= 4) ? __ilog2_u32(size) : __ilog2_u64(size) ) - 12, size)" data-ref="_M/pr_info">pr_info</a>(<q>"%s hash table entries: %ld (order: %d, %lu bytes)\n"</q>,</td></tr>
<tr><th id="7317">7317</th><td>		<a class="local col6 ref" href="#1226tablename" title='tablename' data-ref="1226tablename">tablename</a>, <var>1UL</var> &lt;&lt; <a class="local col6 ref" href="#1236log2qty" title='log2qty' data-ref="1236log2qty">log2qty</a>, ilog2(<a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>) - PAGE_SHIFT, <a class="local col7 ref" href="#1237size" title='size' data-ref="1237size">size</a>);</td></tr>
<tr><th id="7318">7318</th><td></td></tr>
<tr><th id="7319">7319</th><td>	<b>if</b> (<a class="local col1 ref" href="#1231_hash_shift" title='_hash_shift' data-ref="1231_hash_shift">_hash_shift</a>)</td></tr>
<tr><th id="7320">7320</th><td>		*<a class="local col1 ref" href="#1231_hash_shift" title='_hash_shift' data-ref="1231_hash_shift">_hash_shift</a> = <a class="local col6 ref" href="#1236log2qty" title='log2qty' data-ref="1236log2qty">log2qty</a>;</td></tr>
<tr><th id="7321">7321</th><td>	<b>if</b> (<a class="local col2 ref" href="#1232_hash_mask" title='_hash_mask' data-ref="1232_hash_mask">_hash_mask</a>)</td></tr>
<tr><th id="7322">7322</th><td>		*<a class="local col2 ref" href="#1232_hash_mask" title='_hash_mask' data-ref="1232_hash_mask">_hash_mask</a> = (<var>1</var> &lt;&lt; <a class="local col6 ref" href="#1236log2qty" title='log2qty' data-ref="1236log2qty">log2qty</a>) - <var>1</var>;</td></tr>
<tr><th id="7323">7323</th><td></td></tr>
<tr><th id="7324">7324</th><td>	<b>return</b> <a class="local col8 ref" href="#1238table" title='table' data-ref="1238table">table</a>;</td></tr>
<tr><th id="7325">7325</th><td>}</td></tr>
<tr><th id="7326">7326</th><td></td></tr>
<tr><th id="7327">7327</th><td><i>/*</i></td></tr>
<tr><th id="7328">7328</th><td><i> * This function checks whether pageblock includes unmovable pages or not.</i></td></tr>
<tr><th id="7329">7329</th><td><i> * If @count is not zero, it is okay to include less @count unmovable pages</i></td></tr>
<tr><th id="7330">7330</th><td><i> *</i></td></tr>
<tr><th id="7331">7331</th><td><i> * PageLRU check without isolation or lru_lock could race so that</i></td></tr>
<tr><th id="7332">7332</th><td><i> * MIGRATE_MOVABLE block might include unmovable pages. And __PageMovable</i></td></tr>
<tr><th id="7333">7333</th><td><i> * check without lock_page also may miss some movable non-lru pages at</i></td></tr>
<tr><th id="7334">7334</th><td><i> * race condition. So you can't expect this function should be exact.</i></td></tr>
<tr><th id="7335">7335</th><td><i> */</i></td></tr>
<tr><th id="7336">7336</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="has_unmovable_pages" title='has_unmovable_pages' data-ref="has_unmovable_pages">has_unmovable_pages</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="1241zone" title='zone' data-type='struct zone *' data-ref="1241zone">zone</dfn>, <b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="1242page" title='page' data-type='struct page *' data-ref="1242page">page</dfn>, <em>int</em> <dfn class="local col3 decl" id="1243count" title='count' data-type='int' data-ref="1243count">count</dfn>,</td></tr>
<tr><th id="7337">7337</th><td>			 <a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col4 decl" id="1244skip_hwpoisoned_pages" title='skip_hwpoisoned_pages' data-type='bool' data-ref="1244skip_hwpoisoned_pages">skip_hwpoisoned_pages</dfn>)</td></tr>
<tr><th id="7338">7338</th><td>{</td></tr>
<tr><th id="7339">7339</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col5 decl" id="1245pfn" title='pfn' data-type='unsigned long' data-ref="1245pfn">pfn</dfn>, <dfn class="local col6 decl" id="1246iter" title='iter' data-type='unsigned long' data-ref="1246iter">iter</dfn>, <dfn class="local col7 decl" id="1247found" title='found' data-type='unsigned long' data-ref="1247found">found</dfn>;</td></tr>
<tr><th id="7340">7340</th><td>	<em>int</em> <dfn class="local col8 decl" id="1248mt" title='mt' data-type='int' data-ref="1248mt">mt</dfn>;</td></tr>
<tr><th id="7341">7341</th><td></td></tr>
<tr><th id="7342">7342</th><td>	<i>/*</i></td></tr>
<tr><th id="7343">7343</th><td><i>	 * For avoiding noise data, lru_add_drain_all() should be called</i></td></tr>
<tr><th id="7344">7344</th><td><i>	 * If ZONE_MOVABLE, the zone never contains unmovable pages</i></td></tr>
<tr><th id="7345">7345</th><td><i>	 */</i></td></tr>
<tr><th id="7346">7346</th><td>	<b>if</b> (<a class="macro" href="../include/linux/mmzone.h.html#832" title="((zone) - (zone)-&gt;zone_pgdat-&gt;node_zones)" data-ref="_M/zone_idx">zone_idx</a>(<a class="local col1 ref" href="#1241zone" title='zone' data-ref="1241zone">zone</a>) == <a class="enum" href="../include/linux/mmzone.h.html#ZONE_MOVABLE" title='ZONE_MOVABLE' data-ref="ZONE_MOVABLE">ZONE_MOVABLE</a>)</td></tr>
<tr><th id="7347">7347</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="7348">7348</th><td>	<a class="local col8 ref" href="#1248mt" title='mt' data-ref="1248mt">mt</a> = <a class="macro" href="../include/linux/mmzone.h.html#92" title="get_pfnblock_flags_mask(page, (unsigned long)((page) - ((struct page *)vmemmap_base)), PB_migrate_end, ((1UL &lt;&lt; (PB_migrate_end - PB_migrate + 1)) - 1))" data-ref="_M/get_pageblock_migratetype">get_pageblock_migratetype</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>);</td></tr>
<tr><th id="7349">7349</th><td>	<b>if</b> (<a class="local col8 ref" href="#1248mt" title='mt' data-ref="1248mt">mt</a> == <a class="enum" href="../include/linux/mmzone.h.html#MIGRATE_MOVABLE" title='MIGRATE_MOVABLE' data-ref="MIGRATE_MOVABLE">MIGRATE_MOVABLE</a> || <a class="macro" href="../include/linux/mmzone.h.html#74" title="false" data-ref="_M/is_migrate_cma">is_migrate_cma</a>(mt))</td></tr>
<tr><th id="7350">7350</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="7351">7351</th><td></td></tr>
<tr><th id="7352">7352</th><td>	<a class="local col5 ref" href="#1245pfn" title='pfn' data-ref="1245pfn">pfn</a> = <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>);</td></tr>
<tr><th id="7353">7353</th><td>	<b>for</b> (<a class="local col7 ref" href="#1247found" title='found' data-ref="1247found">found</a> = <var>0</var>, <a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a> = <var>0</var>; <a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a> &lt; <a class="macro" href="../include/linux/pageblock-flags.h.html#63" title="(1UL &lt;&lt; (21 - 12))" data-ref="_M/pageblock_nr_pages">pageblock_nr_pages</a>; <a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a>++) {</td></tr>
<tr><th id="7354">7354</th><td>		<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1249check" title='check' data-type='unsigned long' data-ref="1249check">check</dfn> = <a class="local col5 ref" href="#1245pfn" title='pfn' data-ref="1245pfn">pfn</a> + <a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a>;</td></tr>
<tr><th id="7355">7355</th><td></td></tr>
<tr><th id="7356">7356</th><td>		<b>if</b> (!<a class="macro" href="../include/linux/mmzone.h.html#1301" title="(1)" data-ref="_M/pfn_valid_within">pfn_valid_within</a>(check))</td></tr>
<tr><th id="7357">7357</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7358">7358</th><td></td></tr>
<tr><th id="7359">7359</th><td>		<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a> = <a class="macro" href="../include/asm-generic/memory_model.h.html#82" title="__pfn_to_page" data-ref="_M/pfn_to_page">pfn_to_page</a>(<a class="local col9 ref" href="#1249check" title='check' data-ref="1249check">check</a>);</td></tr>
<tr><th id="7360">7360</th><td></td></tr>
<tr><th id="7361">7361</th><td>		<i>/*</i></td></tr>
<tr><th id="7362">7362</th><td><i>		 * Hugepages are not in LRU lists, but they're movable.</i></td></tr>
<tr><th id="7363">7363</th><td><i>		 * We need not scan over tail pages bacause we don't</i></td></tr>
<tr><th id="7364">7364</th><td><i>		 * handle each tail page individually in migration.</i></td></tr>
<tr><th id="7365">7365</th><td><i>		 */</i></td></tr>
<tr><th id="7366">7366</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/page-flags.h.html#PageHuge" title='PageHuge' data-ref="PageHuge">PageHuge</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>)) {</td></tr>
<tr><th id="7367">7367</th><td>			<a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a> = <a class="macro" href="../include/linux/kernel.h.html#87" title="((((iter + 1)-1) | ((__typeof__(iter + 1))((1&lt;&lt;compound_order(page))-1)))+1)" data-ref="_M/round_up">round_up</a>(<a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a> + <var>1</var>, <var>1</var>&lt;&lt;<a class="ref fn" href="../include/linux/mm.h.html#compound_order" title='compound_order' data-ref="compound_order">compound_order</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>)) - <var>1</var>;</td></tr>
<tr><th id="7368">7368</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7369">7369</th><td>		}</td></tr>
<tr><th id="7370">7370</th><td></td></tr>
<tr><th id="7371">7371</th><td>		<i>/*</i></td></tr>
<tr><th id="7372">7372</th><td><i>		 * We can't use page_count without pin a page</i></td></tr>
<tr><th id="7373">7373</th><td><i>		 * because another CPU can free compound page.</i></td></tr>
<tr><th id="7374">7374</th><td><i>		 * This check already skips compound tails of THP</i></td></tr>
<tr><th id="7375">7375</th><td><i>		 * because their page-&gt;_refcount is zero at all time.</i></td></tr>
<tr><th id="7376">7376</th><td><i>		 */</i></td></tr>
<tr><th id="7377">7377</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/page_ref.h.html#page_ref_count" title='page_ref_count' data-ref="page_ref_count">page_ref_count</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>)) {</td></tr>
<tr><th id="7378">7378</th><td>			<b>if</b> (<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='PageBuddy' data-ref="PageBuddy">PageBuddy</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>))</td></tr>
<tr><th id="7379">7379</th><td>				<a class="local col6 ref" href="#1246iter" title='iter' data-ref="1246iter">iter</a> += (<var>1</var> &lt;&lt; <a class="ref fn" href="internal.h.html#page_order" title='page_order' data-ref="page_order">page_order</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>)) - <var>1</var>;</td></tr>
<tr><th id="7380">7380</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7381">7381</th><td>		}</td></tr>
<tr><th id="7382">7382</th><td></td></tr>
<tr><th id="7383">7383</th><td>		<i>/*</i></td></tr>
<tr><th id="7384">7384</th><td><i>		 * The HWPoisoned page may be not in buddy system, and</i></td></tr>
<tr><th id="7385">7385</th><td><i>		 * page_count() is not 0.</i></td></tr>
<tr><th id="7386">7386</th><td><i>		 */</i></td></tr>
<tr><th id="7387">7387</th><td>		<b>if</b> (<a class="local col4 ref" href="#1244skip_hwpoisoned_pages" title='skip_hwpoisoned_pages' data-ref="1244skip_hwpoisoned_pages">skip_hwpoisoned_pages</a> &amp;&amp; <a class="ref fn" href="../include/linux/page-flags.h.html#366" title='PageHWPoison' data-ref="PageHWPoison">PageHWPoison</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>))</td></tr>
<tr><th id="7388">7388</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7389">7389</th><td></td></tr>
<tr><th id="7390">7390</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/page-flags.h.html#__PageMovable" title='__PageMovable' data-ref="__PageMovable">__PageMovable</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>))</td></tr>
<tr><th id="7391">7391</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7392">7392</th><td></td></tr>
<tr><th id="7393">7393</th><td>		<b>if</b> (!<a class="ref fn" href="../include/linux/page-flags.h.html#273" title='PageLRU' data-ref="PageLRU">PageLRU</a>(<a class="local col2 ref" href="#1242page" title='page' data-ref="1242page">page</a>))</td></tr>
<tr><th id="7394">7394</th><td>			<a class="local col7 ref" href="#1247found" title='found' data-ref="1247found">found</a>++;</td></tr>
<tr><th id="7395">7395</th><td>		<i>/*</i></td></tr>
<tr><th id="7396">7396</th><td><i>		 * If there are RECLAIMABLE pages, we need to check</i></td></tr>
<tr><th id="7397">7397</th><td><i>		 * it.  But now, memory offline itself doesn't call</i></td></tr>
<tr><th id="7398">7398</th><td><i>		 * shrink_node_slabs() and it still to be fixed.</i></td></tr>
<tr><th id="7399">7399</th><td><i>		 */</i></td></tr>
<tr><th id="7400">7400</th><td>		<i>/*</i></td></tr>
<tr><th id="7401">7401</th><td><i>		 * If the page is not RAM, page_count()should be 0.</i></td></tr>
<tr><th id="7402">7402</th><td><i>		 * we don't need more check. This is an _used_ not-movable page.</i></td></tr>
<tr><th id="7403">7403</th><td><i>		 *</i></td></tr>
<tr><th id="7404">7404</th><td><i>		 * The problematic thing here is PG_reserved pages. PG_reserved</i></td></tr>
<tr><th id="7405">7405</th><td><i>		 * is set to both of a memory hole page and a _used_ kernel</i></td></tr>
<tr><th id="7406">7406</th><td><i>		 * page at boot.</i></td></tr>
<tr><th id="7407">7407</th><td><i>		 */</i></td></tr>
<tr><th id="7408">7408</th><td>		<b>if</b> (<a class="local col7 ref" href="#1247found" title='found' data-ref="1247found">found</a> &gt; <a class="local col3 ref" href="#1243count" title='count' data-ref="1243count">count</a>)</td></tr>
<tr><th id="7409">7409</th><td>			<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>;</td></tr>
<tr><th id="7410">7410</th><td>	}</td></tr>
<tr><th id="7411">7411</th><td>	<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="7412">7412</th><td>}</td></tr>
<tr><th id="7413">7413</th><td></td></tr>
<tr><th id="7414">7414</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="is_pageblock_removable_nolock" title='is_pageblock_removable_nolock' data-ref="is_pageblock_removable_nolock">is_pageblock_removable_nolock</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col0 decl" id="1250page" title='page' data-type='struct page *' data-ref="1250page">page</dfn>)</td></tr>
<tr><th id="7415">7415</th><td>{</td></tr>
<tr><th id="7416">7416</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col1 decl" id="1251zone" title='zone' data-type='struct zone *' data-ref="1251zone">zone</dfn>;</td></tr>
<tr><th id="7417">7417</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col2 decl" id="1252pfn" title='pfn' data-type='unsigned long' data-ref="1252pfn">pfn</dfn>;</td></tr>
<tr><th id="7418">7418</th><td></td></tr>
<tr><th id="7419">7419</th><td>	<i>/*</i></td></tr>
<tr><th id="7420">7420</th><td><i>	 * We have to be careful here because we are iterating over memory</i></td></tr>
<tr><th id="7421">7421</th><td><i>	 * sections which are not zone aware so we might end up outside of</i></td></tr>
<tr><th id="7422">7422</th><td><i>	 * the zone but still within the section.</i></td></tr>
<tr><th id="7423">7423</th><td><i>	 * We have to take care about the node as well. If the node is offline</i></td></tr>
<tr><th id="7424">7424</th><td><i>	 * its NODE_DATA will be NULL - see page_zone.</i></td></tr>
<tr><th id="7425">7425</th><td><i>	 */</i></td></tr>
<tr><th id="7426">7426</th><td>	<b>if</b> (!<a class="macro" href="../include/linux/nodemask.h.html#501" title="node_state((page_to_nid(page)), N_ONLINE)" data-ref="_M/node_online">node_online</a>(<a class="ref fn" href="../include/linux/mm.h.html#page_to_nid" title='page_to_nid' data-ref="page_to_nid">page_to_nid</a>(<a class="local col0 ref" href="#1250page" title='page' data-ref="1250page">page</a>)))</td></tr>
<tr><th id="7427">7427</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="7428">7428</th><td></td></tr>
<tr><th id="7429">7429</th><td>	<a class="local col1 ref" href="#1251zone" title='zone' data-ref="1251zone">zone</a> = <a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col0 ref" href="#1250page" title='page' data-ref="1250page">page</a>);</td></tr>
<tr><th id="7430">7430</th><td>	<a class="local col2 ref" href="#1252pfn" title='pfn' data-ref="1252pfn">pfn</a> = <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col0 ref" href="#1250page" title='page' data-ref="1250page">page</a>);</td></tr>
<tr><th id="7431">7431</th><td>	<b>if</b> (!<a class="ref fn" href="../include/linux/mmzone.h.html#zone_spans_pfn" title='zone_spans_pfn' data-ref="zone_spans_pfn">zone_spans_pfn</a>(<a class="local col1 ref" href="#1251zone" title='zone' data-ref="1251zone">zone</a>, <a class="local col2 ref" href="#1252pfn" title='pfn' data-ref="1252pfn">pfn</a>))</td></tr>
<tr><th id="7432">7432</th><td>		<b>return</b> <a class="enum" href="../include/linux/stddef.h.html#false" title='false' data-ref="false">false</a>;</td></tr>
<tr><th id="7433">7433</th><td></td></tr>
<tr><th id="7434">7434</th><td>	<b>return</b> !<a class="ref fn" href="#has_unmovable_pages" title='has_unmovable_pages' data-ref="has_unmovable_pages">has_unmovable_pages</a>(<a class="local col1 ref" href="#1251zone" title='zone' data-ref="1251zone">zone</a>, <a class="local col0 ref" href="#1250page" title='page' data-ref="1250page">page</a>, <var>0</var>, <a class="enum" href="../include/linux/stddef.h.html#true" title='true' data-ref="true">true</a>);</td></tr>
<tr><th id="7435">7435</th><td>}</td></tr>
<tr><th id="7436">7436</th><td></td></tr>
<tr><th id="7437">7437</th><td><u>#<span data-ppcond="7437">if</span> (defined(<span class="macro" data-ref="_M/CONFIG_MEMORY_ISOLATION">CONFIG_MEMORY_ISOLATION</span>) &amp;&amp; defined(<span class="macro" data-ref="_M/CONFIG_COMPACTION">CONFIG_COMPACTION</span>)) || defined(<span class="macro" data-ref="_M/CONFIG_CMA">CONFIG_CMA</span>)</u></td></tr>
<tr><th id="7438">7438</th><td></td></tr>
<tr><th id="7439">7439</th><td><em>static</em> <em>unsigned</em> <em>long</em> pfn_max_align_down(<em>unsigned</em> <em>long</em> pfn)</td></tr>
<tr><th id="7440">7440</th><td>{</td></tr>
<tr><th id="7441">7441</th><td>	<b>return</b> pfn &amp; ~(max_t(<em>unsigned</em> <em>long</em>, MAX_ORDER_NR_PAGES,</td></tr>
<tr><th id="7442">7442</th><td>			     pageblock_nr_pages) - <var>1</var>);</td></tr>
<tr><th id="7443">7443</th><td>}</td></tr>
<tr><th id="7444">7444</th><td></td></tr>
<tr><th id="7445">7445</th><td><em>static</em> <em>unsigned</em> <em>long</em> pfn_max_align_up(<em>unsigned</em> <em>long</em> pfn)</td></tr>
<tr><th id="7446">7446</th><td>{</td></tr>
<tr><th id="7447">7447</th><td>	<b>return</b> ALIGN(pfn, max_t(<em>unsigned</em> <em>long</em>, MAX_ORDER_NR_PAGES,</td></tr>
<tr><th id="7448">7448</th><td>				pageblock_nr_pages));</td></tr>
<tr><th id="7449">7449</th><td>}</td></tr>
<tr><th id="7450">7450</th><td></td></tr>
<tr><th id="7451">7451</th><td><i>/* [start, end) must belong to a single zone. */</i></td></tr>
<tr><th id="7452">7452</th><td><em>static</em> <em>int</em> __alloc_contig_migrate_range(<b>struct</b> compact_control *cc,</td></tr>
<tr><th id="7453">7453</th><td>					<em>unsigned</em> <em>long</em> start, <em>unsigned</em> <em>long</em> end)</td></tr>
<tr><th id="7454">7454</th><td>{</td></tr>
<tr><th id="7455">7455</th><td>	<i>/* This function is based on compact_zone() from compaction.c. */</i></td></tr>
<tr><th id="7456">7456</th><td>	<em>unsigned</em> <em>long</em> nr_reclaimed;</td></tr>
<tr><th id="7457">7457</th><td>	<em>unsigned</em> <em>long</em> pfn = start;</td></tr>
<tr><th id="7458">7458</th><td>	<em>unsigned</em> <em>int</em> tries = <var>0</var>;</td></tr>
<tr><th id="7459">7459</th><td>	<em>int</em> ret = <var>0</var>;</td></tr>
<tr><th id="7460">7460</th><td></td></tr>
<tr><th id="7461">7461</th><td>	migrate_prep();</td></tr>
<tr><th id="7462">7462</th><td></td></tr>
<tr><th id="7463">7463</th><td>	<b>while</b> (pfn &lt; end || !list_empty(&amp;cc-&gt;migratepages)) {</td></tr>
<tr><th id="7464">7464</th><td>		<b>if</b> (fatal_signal_pending(current)) {</td></tr>
<tr><th id="7465">7465</th><td>			ret = -EINTR;</td></tr>
<tr><th id="7466">7466</th><td>			<b>break</b>;</td></tr>
<tr><th id="7467">7467</th><td>		}</td></tr>
<tr><th id="7468">7468</th><td></td></tr>
<tr><th id="7469">7469</th><td>		<b>if</b> (list_empty(&amp;cc-&gt;migratepages)) {</td></tr>
<tr><th id="7470">7470</th><td>			cc-&gt;nr_migratepages = <var>0</var>;</td></tr>
<tr><th id="7471">7471</th><td>			pfn = isolate_migratepages_range(cc, pfn, end);</td></tr>
<tr><th id="7472">7472</th><td>			<b>if</b> (!pfn) {</td></tr>
<tr><th id="7473">7473</th><td>				ret = -EINTR;</td></tr>
<tr><th id="7474">7474</th><td>				<b>break</b>;</td></tr>
<tr><th id="7475">7475</th><td>			}</td></tr>
<tr><th id="7476">7476</th><td>			tries = <var>0</var>;</td></tr>
<tr><th id="7477">7477</th><td>		} <b>else</b> <b>if</b> (++tries == <var>5</var>) {</td></tr>
<tr><th id="7478">7478</th><td>			ret = ret &lt; <var>0</var> ? ret : -EBUSY;</td></tr>
<tr><th id="7479">7479</th><td>			<b>break</b>;</td></tr>
<tr><th id="7480">7480</th><td>		}</td></tr>
<tr><th id="7481">7481</th><td></td></tr>
<tr><th id="7482">7482</th><td>		nr_reclaimed = reclaim_clean_pages_from_list(cc-&gt;zone,</td></tr>
<tr><th id="7483">7483</th><td>							&amp;cc-&gt;migratepages);</td></tr>
<tr><th id="7484">7484</th><td>		cc-&gt;nr_migratepages -= nr_reclaimed;</td></tr>
<tr><th id="7485">7485</th><td></td></tr>
<tr><th id="7486">7486</th><td>		ret = migrate_pages(&amp;cc-&gt;migratepages, alloc_migrate_target,</td></tr>
<tr><th id="7487">7487</th><td>				    NULL, <var>0</var>, cc-&gt;mode, MR_CMA);</td></tr>
<tr><th id="7488">7488</th><td>	}</td></tr>
<tr><th id="7489">7489</th><td>	<b>if</b> (ret &lt; <var>0</var>) {</td></tr>
<tr><th id="7490">7490</th><td>		putback_movable_pages(&amp;cc-&gt;migratepages);</td></tr>
<tr><th id="7491">7491</th><td>		<b>return</b> ret;</td></tr>
<tr><th id="7492">7492</th><td>	}</td></tr>
<tr><th id="7493">7493</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="7494">7494</th><td>}</td></tr>
<tr><th id="7495">7495</th><td></td></tr>
<tr><th id="7496">7496</th><td><i class="doc">/**</i></td></tr>
<tr><th id="7497">7497</th><td><i class="doc"> * alloc_contig_range() -- tries to allocate given range of pages</i></td></tr>
<tr><th id="7498">7498</th><td><i class="doc"> *<span class="command"> @start</span>:	start PFN to allocate</i></td></tr>
<tr><th id="7499">7499</th><td><i class="doc"> *<span class="command"> @end</span>:	one-past-the-last PFN to allocate</i></td></tr>
<tr><th id="7500">7500</th><td><i class="doc"> *<span class="command"> @migratetype</span>:	migratetype of the underlaying pageblocks (either</i></td></tr>
<tr><th id="7501">7501</th><td><i class="doc"> *			#MIGRATE_MOVABLE or #MIGRATE_CMA).  All pageblocks</i></td></tr>
<tr><th id="7502">7502</th><td><i class="doc"> *			in range must have the same migratetype and it must</i></td></tr>
<tr><th id="7503">7503</th><td><i class="doc"> *			be either of the two.</i></td></tr>
<tr><th id="7504">7504</th><td><i class="doc"> *<span class="command"> @gfp</span>_mask:	GFP mask to use during compaction</i></td></tr>
<tr><th id="7505">7505</th><td><i class="doc"> *</i></td></tr>
<tr><th id="7506">7506</th><td><i class="doc"> * The PFN range does not have to be pageblock or MAX_ORDER_NR_PAGES</i></td></tr>
<tr><th id="7507">7507</th><td><i class="doc"> * aligned, however it's the caller's responsibility to guarantee that</i></td></tr>
<tr><th id="7508">7508</th><td><i class="doc"> * we are the only thread that changes migrate type of pageblocks the</i></td></tr>
<tr><th id="7509">7509</th><td><i class="doc"> * pages fall in.</i></td></tr>
<tr><th id="7510">7510</th><td><i class="doc"> *</i></td></tr>
<tr><th id="7511">7511</th><td><i class="doc"> * The PFN range must belong to a single zone.</i></td></tr>
<tr><th id="7512">7512</th><td><i class="doc"> *</i></td></tr>
<tr><th id="7513">7513</th><td><i class="doc"> * Returns zero on success or negative error code.  On success all</i></td></tr>
<tr><th id="7514">7514</th><td><i class="doc"> * pages which PFN is in [start, end) are allocated for the caller and</i></td></tr>
<tr><th id="7515">7515</th><td><i class="doc"> * need to be freed with free_contig_range().</i></td></tr>
<tr><th id="7516">7516</th><td><i class="doc"> */</i></td></tr>
<tr><th id="7517">7517</th><td><em>int</em> alloc_contig_range(<em>unsigned</em> <em>long</em> start, <em>unsigned</em> <em>long</em> end,</td></tr>
<tr><th id="7518">7518</th><td>		       <em>unsigned</em> migratetype, gfp_t gfp_mask)</td></tr>
<tr><th id="7519">7519</th><td>{</td></tr>
<tr><th id="7520">7520</th><td>	<em>unsigned</em> <em>long</em> outer_start, outer_end;</td></tr>
<tr><th id="7521">7521</th><td>	<em>unsigned</em> <em>int</em> order;</td></tr>
<tr><th id="7522">7522</th><td>	<em>int</em> ret = <var>0</var>;</td></tr>
<tr><th id="7523">7523</th><td></td></tr>
<tr><th id="7524">7524</th><td>	<b>struct</b> compact_control cc = {</td></tr>
<tr><th id="7525">7525</th><td>		.nr_migratepages = <var>0</var>,</td></tr>
<tr><th id="7526">7526</th><td>		.order = -<var>1</var>,</td></tr>
<tr><th id="7527">7527</th><td>		.zone = page_zone(pfn_to_page(start)),</td></tr>
<tr><th id="7528">7528</th><td>		.mode = MIGRATE_SYNC,</td></tr>
<tr><th id="7529">7529</th><td>		.ignore_skip_hint = true,</td></tr>
<tr><th id="7530">7530</th><td>		.gfp_mask = current_gfp_context(gfp_mask),</td></tr>
<tr><th id="7531">7531</th><td>	};</td></tr>
<tr><th id="7532">7532</th><td>	INIT_LIST_HEAD(&amp;cc.migratepages);</td></tr>
<tr><th id="7533">7533</th><td></td></tr>
<tr><th id="7534">7534</th><td>	<i>/*</i></td></tr>
<tr><th id="7535">7535</th><td><i>	 * What we do here is we mark all pageblocks in range as</i></td></tr>
<tr><th id="7536">7536</th><td><i>	 * MIGRATE_ISOLATE.  Because pageblock and max order pages may</i></td></tr>
<tr><th id="7537">7537</th><td><i>	 * have different sizes, and due to the way page allocator</i></td></tr>
<tr><th id="7538">7538</th><td><i>	 * work, we align the range to biggest of the two pages so</i></td></tr>
<tr><th id="7539">7539</th><td><i>	 * that page allocator won't try to merge buddies from</i></td></tr>
<tr><th id="7540">7540</th><td><i>	 * different pageblocks and change MIGRATE_ISOLATE to some</i></td></tr>
<tr><th id="7541">7541</th><td><i>	 * other migration type.</i></td></tr>
<tr><th id="7542">7542</th><td><i>	 *</i></td></tr>
<tr><th id="7543">7543</th><td><i>	 * Once the pageblocks are marked as MIGRATE_ISOLATE, we</i></td></tr>
<tr><th id="7544">7544</th><td><i>	 * migrate the pages from an unaligned range (ie. pages that</i></td></tr>
<tr><th id="7545">7545</th><td><i>	 * we are interested in).  This will put all the pages in</i></td></tr>
<tr><th id="7546">7546</th><td><i>	 * range back to page allocator as MIGRATE_ISOLATE.</i></td></tr>
<tr><th id="7547">7547</th><td><i>	 *</i></td></tr>
<tr><th id="7548">7548</th><td><i>	 * When this is done, we take the pages in range from page</i></td></tr>
<tr><th id="7549">7549</th><td><i>	 * allocator removing them from the buddy system.  This way</i></td></tr>
<tr><th id="7550">7550</th><td><i>	 * page allocator will never consider using them.</i></td></tr>
<tr><th id="7551">7551</th><td><i>	 *</i></td></tr>
<tr><th id="7552">7552</th><td><i>	 * This lets us mark the pageblocks back as</i></td></tr>
<tr><th id="7553">7553</th><td><i>	 * MIGRATE_CMA/MIGRATE_MOVABLE so that free pages in the</i></td></tr>
<tr><th id="7554">7554</th><td><i>	 * aligned range but not in the unaligned, original range are</i></td></tr>
<tr><th id="7555">7555</th><td><i>	 * put back to page allocator so that buddy can use them.</i></td></tr>
<tr><th id="7556">7556</th><td><i>	 */</i></td></tr>
<tr><th id="7557">7557</th><td></td></tr>
<tr><th id="7558">7558</th><td>	ret = start_isolate_page_range(pfn_max_align_down(start),</td></tr>
<tr><th id="7559">7559</th><td>				       pfn_max_align_up(end), migratetype,</td></tr>
<tr><th id="7560">7560</th><td>				       false);</td></tr>
<tr><th id="7561">7561</th><td>	<b>if</b> (ret)</td></tr>
<tr><th id="7562">7562</th><td>		<b>return</b> ret;</td></tr>
<tr><th id="7563">7563</th><td></td></tr>
<tr><th id="7564">7564</th><td>	<i>/*</i></td></tr>
<tr><th id="7565">7565</th><td><i>	 * In case of -EBUSY, we'd like to know which page causes problem.</i></td></tr>
<tr><th id="7566">7566</th><td><i>	 * So, just fall through. test_pages_isolated() has a tracepoint</i></td></tr>
<tr><th id="7567">7567</th><td><i>	 * which will report the busy page.</i></td></tr>
<tr><th id="7568">7568</th><td><i>	 *</i></td></tr>
<tr><th id="7569">7569</th><td><i>	 * It is possible that busy pages could become available before</i></td></tr>
<tr><th id="7570">7570</th><td><i>	 * the call to test_pages_isolated, and the range will actually be</i></td></tr>
<tr><th id="7571">7571</th><td><i>	 * allocated.  So, if we fall through be sure to clear ret so that</i></td></tr>
<tr><th id="7572">7572</th><td><i>	 * -EBUSY is not accidentally used or returned to caller.</i></td></tr>
<tr><th id="7573">7573</th><td><i>	 */</i></td></tr>
<tr><th id="7574">7574</th><td>	ret = __alloc_contig_migrate_range(&amp;cc, start, end);</td></tr>
<tr><th id="7575">7575</th><td>	<b>if</b> (ret &amp;&amp; ret != -EBUSY)</td></tr>
<tr><th id="7576">7576</th><td>		<b>goto</b> done;</td></tr>
<tr><th id="7577">7577</th><td>	ret =<var>0</var>;</td></tr>
<tr><th id="7578">7578</th><td></td></tr>
<tr><th id="7579">7579</th><td>	<i>/*</i></td></tr>
<tr><th id="7580">7580</th><td><i>	 * Pages from [start, end) are within a MAX_ORDER_NR_PAGES</i></td></tr>
<tr><th id="7581">7581</th><td><i>	 * aligned blocks that are marked as MIGRATE_ISOLATE.  What's</i></td></tr>
<tr><th id="7582">7582</th><td><i>	 * more, all pages in [start, end) are free in page allocator.</i></td></tr>
<tr><th id="7583">7583</th><td><i>	 * What we are going to do is to allocate all pages from</i></td></tr>
<tr><th id="7584">7584</th><td><i>	 * [start, end) (that is remove them from page allocator).</i></td></tr>
<tr><th id="7585">7585</th><td><i>	 *</i></td></tr>
<tr><th id="7586">7586</th><td><i>	 * The only problem is that pages at the beginning and at the</i></td></tr>
<tr><th id="7587">7587</th><td><i>	 * end of interesting range may be not aligned with pages that</i></td></tr>
<tr><th id="7588">7588</th><td><i>	 * page allocator holds, ie. they can be part of higher order</i></td></tr>
<tr><th id="7589">7589</th><td><i>	 * pages.  Because of this, we reserve the bigger range and</i></td></tr>
<tr><th id="7590">7590</th><td><i>	 * once this is done free the pages we are not interested in.</i></td></tr>
<tr><th id="7591">7591</th><td><i>	 *</i></td></tr>
<tr><th id="7592">7592</th><td><i>	 * We don't have to hold zone-&gt;lock here because the pages are</i></td></tr>
<tr><th id="7593">7593</th><td><i>	 * isolated thus they won't get removed from buddy.</i></td></tr>
<tr><th id="7594">7594</th><td><i>	 */</i></td></tr>
<tr><th id="7595">7595</th><td></td></tr>
<tr><th id="7596">7596</th><td>	lru_add_drain_all();</td></tr>
<tr><th id="7597">7597</th><td>	drain_all_pages(cc.zone);</td></tr>
<tr><th id="7598">7598</th><td></td></tr>
<tr><th id="7599">7599</th><td>	order = <var>0</var>;</td></tr>
<tr><th id="7600">7600</th><td>	outer_start = start;</td></tr>
<tr><th id="7601">7601</th><td>	<b>while</b> (!PageBuddy(pfn_to_page(outer_start))) {</td></tr>
<tr><th id="7602">7602</th><td>		<b>if</b> (++order &gt;= MAX_ORDER) {</td></tr>
<tr><th id="7603">7603</th><td>			outer_start = start;</td></tr>
<tr><th id="7604">7604</th><td>			<b>break</b>;</td></tr>
<tr><th id="7605">7605</th><td>		}</td></tr>
<tr><th id="7606">7606</th><td>		outer_start &amp;= ~<var>0UL</var> &lt;&lt; order;</td></tr>
<tr><th id="7607">7607</th><td>	}</td></tr>
<tr><th id="7608">7608</th><td></td></tr>
<tr><th id="7609">7609</th><td>	<b>if</b> (outer_start != start) {</td></tr>
<tr><th id="7610">7610</th><td>		order = page_order(pfn_to_page(outer_start));</td></tr>
<tr><th id="7611">7611</th><td></td></tr>
<tr><th id="7612">7612</th><td>		<i>/*</i></td></tr>
<tr><th id="7613">7613</th><td><i>		 * outer_start page could be small order buddy page and</i></td></tr>
<tr><th id="7614">7614</th><td><i>		 * it doesn't include start page. Adjust outer_start</i></td></tr>
<tr><th id="7615">7615</th><td><i>		 * in this case to report failed page properly</i></td></tr>
<tr><th id="7616">7616</th><td><i>		 * on tracepoint in test_pages_isolated()</i></td></tr>
<tr><th id="7617">7617</th><td><i>		 */</i></td></tr>
<tr><th id="7618">7618</th><td>		<b>if</b> (outer_start + (<var>1UL</var> &lt;&lt; order) &lt;= start)</td></tr>
<tr><th id="7619">7619</th><td>			outer_start = start;</td></tr>
<tr><th id="7620">7620</th><td>	}</td></tr>
<tr><th id="7621">7621</th><td></td></tr>
<tr><th id="7622">7622</th><td>	<i>/* Make sure the range is really isolated. */</i></td></tr>
<tr><th id="7623">7623</th><td>	<b>if</b> (test_pages_isolated(outer_start, end, false)) {</td></tr>
<tr><th id="7624">7624</th><td>		pr_info_ratelimited(<q>"%s: [%lx, %lx) PFNs busy\n"</q>,</td></tr>
<tr><th id="7625">7625</th><td>			<b>__func__</b>, outer_start, end);</td></tr>
<tr><th id="7626">7626</th><td>		ret = -EBUSY;</td></tr>
<tr><th id="7627">7627</th><td>		<b>goto</b> done;</td></tr>
<tr><th id="7628">7628</th><td>	}</td></tr>
<tr><th id="7629">7629</th><td></td></tr>
<tr><th id="7630">7630</th><td>	<i>/* Grab isolated pages from freelists. */</i></td></tr>
<tr><th id="7631">7631</th><td>	outer_end = isolate_freepages_range(&amp;cc, outer_start, end);</td></tr>
<tr><th id="7632">7632</th><td>	<b>if</b> (!outer_end) {</td></tr>
<tr><th id="7633">7633</th><td>		ret = -EBUSY;</td></tr>
<tr><th id="7634">7634</th><td>		<b>goto</b> done;</td></tr>
<tr><th id="7635">7635</th><td>	}</td></tr>
<tr><th id="7636">7636</th><td></td></tr>
<tr><th id="7637">7637</th><td>	<i>/* Free head and tail (if any) */</i></td></tr>
<tr><th id="7638">7638</th><td>	<b>if</b> (start != outer_start)</td></tr>
<tr><th id="7639">7639</th><td>		free_contig_range(outer_start, start - outer_start);</td></tr>
<tr><th id="7640">7640</th><td>	<b>if</b> (end != outer_end)</td></tr>
<tr><th id="7641">7641</th><td>		free_contig_range(end, outer_end - end);</td></tr>
<tr><th id="7642">7642</th><td></td></tr>
<tr><th id="7643">7643</th><td>done:</td></tr>
<tr><th id="7644">7644</th><td>	undo_isolate_page_range(pfn_max_align_down(start),</td></tr>
<tr><th id="7645">7645</th><td>				pfn_max_align_up(end), migratetype);</td></tr>
<tr><th id="7646">7646</th><td>	<b>return</b> ret;</td></tr>
<tr><th id="7647">7647</th><td>}</td></tr>
<tr><th id="7648">7648</th><td></td></tr>
<tr><th id="7649">7649</th><td><em>void</em> free_contig_range(<em>unsigned</em> <em>long</em> pfn, <em>unsigned</em> nr_pages)</td></tr>
<tr><th id="7650">7650</th><td>{</td></tr>
<tr><th id="7651">7651</th><td>	<em>unsigned</em> <em>int</em> count = <var>0</var>;</td></tr>
<tr><th id="7652">7652</th><td></td></tr>
<tr><th id="7653">7653</th><td>	<b>for</b> (; nr_pages--; pfn++) {</td></tr>
<tr><th id="7654">7654</th><td>		<b>struct</b> page *page = pfn_to_page(pfn);</td></tr>
<tr><th id="7655">7655</th><td></td></tr>
<tr><th id="7656">7656</th><td>		count += page_count(page) != <var>1</var>;</td></tr>
<tr><th id="7657">7657</th><td>		__free_page(page);</td></tr>
<tr><th id="7658">7658</th><td>	}</td></tr>
<tr><th id="7659">7659</th><td>	WARN(count != <var>0</var>, <q>"%d pages are still in use!\n"</q>, count);</td></tr>
<tr><th id="7660">7660</th><td>}</td></tr>
<tr><th id="7661">7661</th><td><u>#<span data-ppcond="7437">endif</span></u></td></tr>
<tr><th id="7662">7662</th><td></td></tr>
<tr><th id="7663">7663</th><td><u>#<span data-ppcond="7663">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMORY_HOTPLUG">CONFIG_MEMORY_HOTPLUG</span></u></td></tr>
<tr><th id="7664">7664</th><td><i>/*</i></td></tr>
<tr><th id="7665">7665</th><td><i> * The zone indicated has a new number of managed_pages; batch sizes and percpu</i></td></tr>
<tr><th id="7666">7666</th><td><i> * page high values need to be recalulated.</i></td></tr>
<tr><th id="7667">7667</th><td><i> */</i></td></tr>
<tr><th id="7668">7668</th><td><em>void</em> __meminit zone_pcp_update(<b>struct</b> zone *zone)</td></tr>
<tr><th id="7669">7669</th><td>{</td></tr>
<tr><th id="7670">7670</th><td>	<em>unsigned</em> cpu;</td></tr>
<tr><th id="7671">7671</th><td>	mutex_lock(&amp;pcp_batch_high_lock);</td></tr>
<tr><th id="7672">7672</th><td>	for_each_possible_cpu(cpu)</td></tr>
<tr><th id="7673">7673</th><td>		pageset_set_high_and_batch(zone,</td></tr>
<tr><th id="7674">7674</th><td>				per_cpu_ptr(zone-&gt;pageset, cpu));</td></tr>
<tr><th id="7675">7675</th><td>	mutex_unlock(&amp;pcp_batch_high_lock);</td></tr>
<tr><th id="7676">7676</th><td>}</td></tr>
<tr><th id="7677">7677</th><td><u>#<span data-ppcond="7663">endif</span></u></td></tr>
<tr><th id="7678">7678</th><td></td></tr>
<tr><th id="7679">7679</th><td><em>void</em> <dfn class="decl def fn" id="zone_pcp_reset" title='zone_pcp_reset' data-ref="zone_pcp_reset">zone_pcp_reset</dfn>(<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col3 decl" id="1253zone" title='zone' data-type='struct zone *' data-ref="1253zone">zone</dfn>)</td></tr>
<tr><th id="7680">7680</th><td>{</td></tr>
<tr><th id="7681">7681</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="1254flags" title='flags' data-type='unsigned long' data-ref="1254flags">flags</dfn>;</td></tr>
<tr><th id="7682">7682</th><td>	<em>int</em> <dfn class="local col5 decl" id="1255cpu" title='cpu' data-type='int' data-ref="1255cpu">cpu</dfn>;</td></tr>
<tr><th id="7683">7683</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#per_cpu_pageset" title='per_cpu_pageset' data-ref="per_cpu_pageset">per_cpu_pageset</a> *<dfn class="local col6 decl" id="1256pset" title='pset' data-type='struct per_cpu_pageset *' data-ref="1256pset">pset</dfn>;</td></tr>
<tr><th id="7684">7684</th><td></td></tr>
<tr><th id="7685">7685</th><td>	<i>/* avoid races with drain_pages()  */</i></td></tr>
<tr><th id="7686">7686</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#139" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = arch_local_irq_save(); } while (0); } while (0)" data-ref="_M/local_irq_save">local_irq_save</a>(<a class="local col4 ref" href="#1254flags" title='flags' data-ref="1254flags">flags</a>);</td></tr>
<tr><th id="7687">7687</th><td>	<b>if</b> (<a class="local col3 ref" href="#1253zone" title='zone' data-ref="1253zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a> != &amp;<a class="tu ref" href="#5160" title='boot_pageset' data-use='a' data-ref="boot_pageset">boot_pageset</a>) {</td></tr>
<tr><th id="7688">7688</th><td>		<a class="macro" href="../include/linux/cpumask.h.html#750" title="for (((cpu)) = -1; ((cpu)) = cpumask_next(((cpu)), (((const struct cpumask *)&amp;__cpu_online_mask))), ((cpu)) &lt; nr_cpu_ids;)" data-ref="_M/for_each_online_cpu">for_each_online_cpu</a>(<a class="local col5 ref" href="#1255cpu" title='cpu' data-ref="1255cpu">cpu</a>) {</td></tr>
<tr><th id="7689">7689</th><td>			<a class="local col6 ref" href="#1256pset" title='pset' data-ref="1256pset">pset</a> = <a class="macro" href="../include/linux/percpu-defs.h.html#220" title="({ do { const void *__vpp_verify = (typeof((zone-&gt;pageset) + 0))((void *)0); (void)__vpp_verify; } while (0); ({ unsigned long __ptr; __asm__ (&quot;&quot; : &quot;=r&quot;(__ptr) : &quot;0&quot;((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))); (typeof((typeof(*((zone-&gt;pageset))) *)((zone-&gt;pageset)))) (__ptr + (((__per_cpu_offset[(cpu)])))); }); })" data-ref="_M/per_cpu_ptr">per_cpu_ptr</a>(<a class="local col3 ref" href="#1253zone" title='zone' data-ref="1253zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>, <a class="local col5 ref" href="#1255cpu" title='cpu' data-ref="1255cpu">cpu</a>);</td></tr>
<tr><th id="7690">7690</th><td>			<a class="ref fn" href="../include/linux/vmstat.h.html#drain_zonestat" title='drain_zonestat' data-ref="drain_zonestat">drain_zonestat</a>(<a class="local col3 ref" href="#1253zone" title='zone' data-ref="1253zone">zone</a>, <a class="local col6 ref" href="#1256pset" title='pset' data-ref="1256pset">pset</a>);</td></tr>
<tr><th id="7691">7691</th><td>		}</td></tr>
<tr><th id="7692">7692</th><td>		<a class="ref fn" href="../include/linux/percpu.h.html#free_percpu" title='free_percpu' data-ref="free_percpu">free_percpu</a>(<a class="local col3 ref" href="#1253zone" title='zone' data-ref="1253zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a>);</td></tr>
<tr><th id="7693">7693</th><td>		<a class="local col3 ref" href="#1253zone" title='zone' data-ref="1253zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::pageset" title='zone::pageset' data-ref="zone::pageset">pageset</a> = &amp;<a class="tu ref" href="#5160" title='boot_pageset' data-use='a' data-ref="boot_pageset">boot_pageset</a>;</td></tr>
<tr><th id="7694">7694</th><td>	}</td></tr>
<tr><th id="7695">7695</th><td>	<a class="macro" href="../include/linux/irqflags.h.html#143" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); arch_local_irq_restore(flags); } while (0); } while (0)" data-ref="_M/local_irq_restore">local_irq_restore</a>(<a class="local col4 ref" href="#1254flags" title='flags' data-ref="1254flags">flags</a>);</td></tr>
<tr><th id="7696">7696</th><td>}</td></tr>
<tr><th id="7697">7697</th><td></td></tr>
<tr><th id="7698">7698</th><td><u>#<span data-ppcond="7698">ifdef</span> <span class="macro" data-ref="_M/CONFIG_MEMORY_HOTREMOVE">CONFIG_MEMORY_HOTREMOVE</span></u></td></tr>
<tr><th id="7699">7699</th><td><i>/*</i></td></tr>
<tr><th id="7700">7700</th><td><i> * All pages in the range must be in a single zone and isolated</i></td></tr>
<tr><th id="7701">7701</th><td><i> * before calling this.</i></td></tr>
<tr><th id="7702">7702</th><td><i> */</i></td></tr>
<tr><th id="7703">7703</th><td><em>void</em></td></tr>
<tr><th id="7704">7704</th><td>__offline_isolated_pages(<em>unsigned</em> <em>long</em> start_pfn, <em>unsigned</em> <em>long</em> end_pfn)</td></tr>
<tr><th id="7705">7705</th><td>{</td></tr>
<tr><th id="7706">7706</th><td>	<b>struct</b> page *page;</td></tr>
<tr><th id="7707">7707</th><td>	<b>struct</b> zone *zone;</td></tr>
<tr><th id="7708">7708</th><td>	<em>unsigned</em> <em>int</em> order, i;</td></tr>
<tr><th id="7709">7709</th><td>	<em>unsigned</em> <em>long</em> pfn;</td></tr>
<tr><th id="7710">7710</th><td>	<em>unsigned</em> <em>long</em> flags;</td></tr>
<tr><th id="7711">7711</th><td>	<i>/* find the first valid pfn */</i></td></tr>
<tr><th id="7712">7712</th><td>	<b>for</b> (pfn = start_pfn; pfn &lt; end_pfn; pfn++)</td></tr>
<tr><th id="7713">7713</th><td>		<b>if</b> (pfn_valid(pfn))</td></tr>
<tr><th id="7714">7714</th><td>			<b>break</b>;</td></tr>
<tr><th id="7715">7715</th><td>	<b>if</b> (pfn == end_pfn)</td></tr>
<tr><th id="7716">7716</th><td>		<b>return</b>;</td></tr>
<tr><th id="7717">7717</th><td>	offline_mem_sections(pfn, end_pfn);</td></tr>
<tr><th id="7718">7718</th><td>	zone = page_zone(pfn_to_page(pfn));</td></tr>
<tr><th id="7719">7719</th><td>	spin_lock_irqsave(&amp;zone-&gt;lock, flags);</td></tr>
<tr><th id="7720">7720</th><td>	pfn = start_pfn;</td></tr>
<tr><th id="7721">7721</th><td>	<b>while</b> (pfn &lt; end_pfn) {</td></tr>
<tr><th id="7722">7722</th><td>		<b>if</b> (!pfn_valid(pfn)) {</td></tr>
<tr><th id="7723">7723</th><td>			pfn++;</td></tr>
<tr><th id="7724">7724</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7725">7725</th><td>		}</td></tr>
<tr><th id="7726">7726</th><td>		page = pfn_to_page(pfn);</td></tr>
<tr><th id="7727">7727</th><td>		<i>/*</i></td></tr>
<tr><th id="7728">7728</th><td><i>		 * The HWPoisoned page may be not in buddy system, and</i></td></tr>
<tr><th id="7729">7729</th><td><i>		 * page_count() is not 0.</i></td></tr>
<tr><th id="7730">7730</th><td><i>		 */</i></td></tr>
<tr><th id="7731">7731</th><td>		<b>if</b> (unlikely(!PageBuddy(page) &amp;&amp; PageHWPoison(page))) {</td></tr>
<tr><th id="7732">7732</th><td>			pfn++;</td></tr>
<tr><th id="7733">7733</th><td>			SetPageReserved(page);</td></tr>
<tr><th id="7734">7734</th><td>			<b>continue</b>;</td></tr>
<tr><th id="7735">7735</th><td>		}</td></tr>
<tr><th id="7736">7736</th><td></td></tr>
<tr><th id="7737">7737</th><td>		BUG_ON(page_count(page));</td></tr>
<tr><th id="7738">7738</th><td>		BUG_ON(!PageBuddy(page));</td></tr>
<tr><th id="7739">7739</th><td>		order = page_order(page);</td></tr>
<tr><th id="7740">7740</th><td><u>#ifdef CONFIG_DEBUG_VM</u></td></tr>
<tr><th id="7741">7741</th><td>		pr_info(<q>"remove from free list %lx %d %lx\n"</q>,</td></tr>
<tr><th id="7742">7742</th><td>			pfn, <var>1</var> &lt;&lt; order, end_pfn);</td></tr>
<tr><th id="7743">7743</th><td><u>#endif</u></td></tr>
<tr><th id="7744">7744</th><td>		list_del(&amp;page-&gt;lru);</td></tr>
<tr><th id="7745">7745</th><td>		rmv_page_order(page);</td></tr>
<tr><th id="7746">7746</th><td>		zone-&gt;free_area[order].nr_free--;</td></tr>
<tr><th id="7747">7747</th><td>		<b>for</b> (i = <var>0</var>; i &lt; (<var>1</var> &lt;&lt; order); i++)</td></tr>
<tr><th id="7748">7748</th><td>			SetPageReserved((page+i));</td></tr>
<tr><th id="7749">7749</th><td>		pfn += (<var>1</var> &lt;&lt; order);</td></tr>
<tr><th id="7750">7750</th><td>	}</td></tr>
<tr><th id="7751">7751</th><td>	spin_unlock_irqrestore(&amp;zone-&gt;lock, flags);</td></tr>
<tr><th id="7752">7752</th><td>}</td></tr>
<tr><th id="7753">7753</th><td><u>#<span data-ppcond="7698">endif</span></u></td></tr>
<tr><th id="7754">7754</th><td></td></tr>
<tr><th id="7755">7755</th><td><a class="typedef" href="../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="decl def fn" id="is_free_buddy_page" title='is_free_buddy_page' data-ref="is_free_buddy_page">is_free_buddy_page</dfn>(<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col7 decl" id="1257page" title='page' data-type='struct page *' data-ref="1257page">page</dfn>)</td></tr>
<tr><th id="7756">7756</th><td>{</td></tr>
<tr><th id="7757">7757</th><td>	<b>struct</b> <a class="type" href="../include/linux/mmzone.h.html#zone" title='zone' data-ref="zone">zone</a> *<dfn class="local col8 decl" id="1258zone" title='zone' data-type='struct zone *' data-ref="1258zone">zone</dfn> = <a class="ref fn" href="../include/linux/mm.h.html#page_zone" title='page_zone' data-ref="page_zone">page_zone</a>(<a class="local col7 ref" href="#1257page" title='page' data-ref="1257page">page</a>);</td></tr>
<tr><th id="7758">7758</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="1259pfn" title='pfn' data-type='unsigned long' data-ref="1259pfn">pfn</dfn> = <a class="macro" href="../include/asm-generic/memory_model.h.html#81" title="__page_to_pfn" data-ref="_M/page_to_pfn">page_to_pfn</a>(<a class="local col7 ref" href="#1257page" title='page' data-ref="1257page">page</a>);</td></tr>
<tr><th id="7759">7759</th><td>	<em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="1260flags" title='flags' data-type='unsigned long' data-ref="1260flags">flags</dfn>;</td></tr>
<tr><th id="7760">7760</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="1261order" title='order' data-type='unsigned int' data-ref="1261order">order</dfn>;</td></tr>
<tr><th id="7761">7761</th><td></td></tr>
<tr><th id="7762">7762</th><td>	<a class="macro" href="../include/linux/spinlock.h.html#345" title="do { do { ({ unsigned long __dummy; typeof(flags) __dummy2; (void)(&amp;__dummy == &amp;__dummy2); 1; }); flags = _raw_spin_lock_irqsave(spinlock_check(&amp;zone-&gt;lock)); } while (0); } while (0)" data-ref="_M/spin_lock_irqsave">spin_lock_irqsave</a>(&amp;<a class="local col8 ref" href="#1258zone" title='zone' data-ref="1258zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col0 ref" href="#1260flags" title='flags' data-ref="1260flags">flags</a>);</td></tr>
<tr><th id="7763">7763</th><td>	<b>for</b> (<a class="local col1 ref" href="#1261order" title='order' data-ref="1261order">order</a> = <var>0</var>; <a class="local col1 ref" href="#1261order" title='order' data-ref="1261order">order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>; <a class="local col1 ref" href="#1261order" title='order' data-ref="1261order">order</a>++) {</td></tr>
<tr><th id="7764">7764</th><td>		<b>struct</b> <a class="type" href="../include/linux/mm_types.h.html#page" title='page' data-ref="page">page</a> *<dfn class="local col2 decl" id="1262page_head" title='page_head' data-type='struct page *' data-ref="1262page_head">page_head</dfn> = <a class="local col7 ref" href="#1257page" title='page' data-ref="1257page">page</a> - (<a class="local col9 ref" href="#1259pfn" title='pfn' data-ref="1259pfn">pfn</a> &amp; ((<var>1</var> &lt;&lt; <a class="local col1 ref" href="#1261order" title='order' data-ref="1261order">order</a>) - <var>1</var>));</td></tr>
<tr><th id="7765">7765</th><td></td></tr>
<tr><th id="7766">7766</th><td>		<b>if</b> (<a class="ref fn" href="../include/linux/page-flags.h.html#666" title='PageBuddy' data-ref="PageBuddy">PageBuddy</a>(<a class="local col2 ref" href="#1262page_head" title='page_head' data-ref="1262page_head">page_head</a>) &amp;&amp; <a class="ref fn" href="internal.h.html#page_order" title='page_order' data-ref="page_order">page_order</a>(<a class="local col2 ref" href="#1262page_head" title='page_head' data-ref="1262page_head">page_head</a>) &gt;= <a class="local col1 ref" href="#1261order" title='order' data-ref="1261order">order</a>)</td></tr>
<tr><th id="7767">7767</th><td>			<b>break</b>;</td></tr>
<tr><th id="7768">7768</th><td>	}</td></tr>
<tr><th id="7769">7769</th><td>	<a class="ref fn" href="../include/linux/spinlock.h.html#spin_unlock_irqrestore" title='spin_unlock_irqrestore' data-ref="spin_unlock_irqrestore">spin_unlock_irqrestore</a>(&amp;<a class="local col8 ref" href="#1258zone" title='zone' data-ref="1258zone">zone</a>-&gt;<a class="ref field" href="../include/linux/mmzone.h.html#zone::lock" title='zone::lock' data-ref="zone::lock">lock</a>, <a class="local col0 ref" href="#1260flags" title='flags' data-ref="1260flags">flags</a>);</td></tr>
<tr><th id="7770">7770</th><td></td></tr>
<tr><th id="7771">7771</th><td>	<b>return</b> <a class="local col1 ref" href="#1261order" title='order' data-ref="1261order">order</a> &lt; <a class="macro" href="../include/linux/mmzone.h.html#25" title="11" data-ref="_M/MAX_ORDER">MAX_ORDER</a>;</td></tr>
<tr><th id="7772">7772</th><td>}</td></tr>
<tr><th id="7773">7773</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Aug-03</em> from project linux-4.14.y revision <em>linux-4.14.y</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
