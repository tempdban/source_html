<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>resource.c source code [linux-4.14.y/security/apparmor/resource.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux-4.14.y/security/apparmor/resource.c'; var root_path = '../../..'; var data_path = '../../../../data';</script>
<script src='../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../..'>linux-4.14.y</a>/<a href='..'>security</a>/<a href='./'>apparmor</a>/<a href='resource.c.html'>resource.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * AppArmor security module</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * This file contains AppArmor resource mediation and attachment</i></td></tr>
<tr><th id="5">5</th><td><i> *</i></td></tr>
<tr><th id="6">6</th><td><i> * Copyright (C) 1998-2008 Novell/SUSE</i></td></tr>
<tr><th id="7">7</th><td><i> * Copyright 2009-2010 Canonical Ltd.</i></td></tr>
<tr><th id="8">8</th><td><i> *</i></td></tr>
<tr><th id="9">9</th><td><i> * This program is free software; you can redistribute it and/or</i></td></tr>
<tr><th id="10">10</th><td><i> * modify it under the terms of the GNU General Public License as</i></td></tr>
<tr><th id="11">11</th><td><i> * published by the Free Software Foundation, version 2 of the</i></td></tr>
<tr><th id="12">12</th><td><i> * License.</i></td></tr>
<tr><th id="13">13</th><td><i> */</i></td></tr>
<tr><th id="14">14</th><td></td></tr>
<tr><th id="15">15</th><td><u>#include <a href="../../include/linux/audit.h.html">&lt;linux/audit.h&gt;</a></u></td></tr>
<tr><th id="16">16</th><td><u>#include <a href="../../include/linux/security.h.html">&lt;linux/security.h&gt;</a></u></td></tr>
<tr><th id="17">17</th><td></td></tr>
<tr><th id="18">18</th><td><u>#include <a href="include/audit.h.html">"include/audit.h"</a></u></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="include/context.h.html">"include/context.h"</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="include/resource.h.html">"include/resource.h"</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="include/policy.h.html">"include/policy.h"</a></u></td></tr>
<tr><th id="22">22</th><td></td></tr>
<tr><th id="23">23</th><td><i>/*</i></td></tr>
<tr><th id="24">24</th><td><i> * Table of rlimit names: we generate it from resource.h.</i></td></tr>
<tr><th id="25">25</th><td><i> */</i></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="rlim_names.h.html">"rlim_names.h"</a></u></td></tr>
<tr><th id="27">27</th><td></td></tr>
<tr><th id="28">28</th><td><b>struct</b> <a class="type" href="include/apparmorfs.h.html#aa_sfs_entry" title='aa_sfs_entry' data-ref="aa_sfs_entry">aa_sfs_entry</a> <dfn class="decl def" id="aa_sfs_entry_rlimit" title='aa_sfs_entry_rlimit' data-ref="aa_sfs_entry_rlimit">aa_sfs_entry_rlimit</dfn>[] = {</td></tr>
<tr><th id="29">29</th><td>	<a class="macro" href="include/apparmorfs.h.html#50" title="{ .name = (&quot;mask&quot;), .mode = 0444, .v_type = AA_SFS_TYPE_STRING, .v.string = (&quot;cpu fsize data stack core rss nproc nofile memlock as locks sigpending msgqueue nice rtprio rttime&quot;), .file_ops = &amp;aa_sfs_seq_file_ops }" data-ref="_M/AA_SFS_FILE_STRING">AA_SFS_FILE_STRING</a>(<q>"mask"</q>, <a class="macro" href="rlim_names.h.html#37" title="&quot;cpu fsize data stack core rss nproc nofile memlock as locks sigpending msgqueue nice rtprio rttime&quot;" data-ref="_M/AA_SFS_RLIMIT_MASK">AA_SFS_RLIMIT_MASK</a>),</td></tr>
<tr><th id="30">30</th><td>	{ }</td></tr>
<tr><th id="31">31</th><td>};</td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><i  data-doc="audit_cb">/* audit callback for resource specific fields */</i></td></tr>
<tr><th id="34">34</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="audit_cb" title='audit_cb' data-type='void audit_cb(struct audit_buffer * ab, void * va)' data-ref="audit_cb">audit_cb</dfn>(<b>struct</b> <a class="type" href="../../include/linux/audit.h.html#audit_buffer" title='audit_buffer' data-ref="audit_buffer">audit_buffer</a> *<dfn class="local col1 decl" id="1ab" title='ab' data-type='struct audit_buffer *' data-ref="1ab">ab</dfn>, <em>void</em> *<dfn class="local col2 decl" id="2va" title='va' data-type='void *' data-ref="2va">va</dfn>)</td></tr>
<tr><th id="35">35</th><td>{</td></tr>
<tr><th id="36">36</th><td>	<b>struct</b> <a class="type" href="../../include/linux/lsm_audit.h.html#common_audit_data" title='common_audit_data' data-ref="common_audit_data">common_audit_data</a> *<dfn class="local col3 decl" id="3sa" title='sa' data-type='struct common_audit_data *' data-ref="3sa">sa</dfn> = <a class="local col2 ref" href="#2va" title='va' data-ref="2va">va</a>;</td></tr>
<tr><th id="37">37</th><td></td></tr>
<tr><th id="38">38</th><td>	<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" rlimit=%s value=%lu"</q>,</td></tr>
<tr><th id="39">39</th><td>			 <a class="ref" href="rlim_names.h.html#rlim_names" title='rlim_names' data-ref="rlim_names">rlim_names</a>[<a class="macro" href="include/audit.h.html#152" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::rlim' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim">rlim</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::rlim" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::rlim' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::rlim">rlim</a>], <a class="macro" href="include/audit.h.html#152" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::rlim' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim">rlim</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::max" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::max' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::max">max</a>);</td></tr>
<tr><th id="40">40</th><td>	<b>if</b> (<a class="macro" href="include/audit.h.html#152" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymous)::peer" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::peer' data-ref="apparmor_audit_data::(anonymousunion)::(anonymous)::peer">peer</a>) {</td></tr>
<tr><th id="41">41</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" peer="</q>);</td></tr>
<tr><th id="42">42</th><td>		<a class="ref fn" href="include/label.h.html#aa_label_xaudit" title='aa_label_xaudit' data-ref="aa_label_xaudit">aa_label_xaudit</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <a class="macro" href="include/label.h.html#153" title="(((((&amp;((((sa)-&gt;apparmor_audit_data)-&gt;label)-&gt;vec[0])))[(((((sa)-&gt;apparmor_audit_data)-&gt;label)-&gt;size)) - 1])-&gt;ns))" data-ref="_M/labels_ns">labels_ns</a>(<a class="macro" href="include/audit.h.html#152" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::label" title='apparmor_audit_data::label' data-ref="apparmor_audit_data::label">label</a>), <a class="macro" href="include/audit.h.html#152" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymous)::peer" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::peer' data-ref="apparmor_audit_data::(anonymousunion)::(anonymous)::peer">peer</a>,</td></tr>
<tr><th id="43">43</th><td>				<a class="macro" href="include/label.h.html#309" title="0" data-ref="_M/FLAGS_NONE">FLAGS_NONE</a>, <a class="macro" href="../../include/linux/gfp.h.html#277" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="44">44</th><td>	}</td></tr>
<tr><th id="45">45</th><td>}</td></tr>
<tr><th id="46">46</th><td></td></tr>
<tr><th id="47">47</th><td><i class="doc" data-doc="audit_resource">/**</i></td></tr>
<tr><th id="48">48</th><td><i class="doc" data-doc="audit_resource"> * audit_resource - audit setting resource limit</i></td></tr>
<tr><th id="49">49</th><td><i class="doc" data-doc="audit_resource"> *<span class="command"> @profile</span>: profile being enforced  (NOT NULL)</i></td></tr>
<tr><th id="50">50</th><td><i class="doc" data-doc="audit_resource"> *<span class="command"> @resoure</span>: rlimit being auditing</i></td></tr>
<tr><th id="51">51</th><td><i class="doc" data-doc="audit_resource"> * <span class="command">@value</span>: value being set</i></td></tr>
<tr><th id="52">52</th><td><i class="doc" data-doc="audit_resource"> *<span class="command"> @error</span>: error value</i></td></tr>
<tr><th id="53">53</th><td><i class="doc" data-doc="audit_resource"> *</i></td></tr>
<tr><th id="54">54</th><td><i class="doc" data-doc="audit_resource"> * Returns: 0 or sa-&gt;error else other error code on failure</i></td></tr>
<tr><th id="55">55</th><td><i class="doc" data-doc="audit_resource"> */</i></td></tr>
<tr><th id="56">56</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="audit_resource" title='audit_resource' data-type='int audit_resource(struct aa_profile * profile, unsigned int resource, unsigned long value, struct aa_label * peer, const char * info, int error)' data-ref="audit_resource">audit_resource</dfn>(<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col4 decl" id="4profile" title='profile' data-type='struct aa_profile *' data-ref="4profile">profile</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="5resource" title='resource' data-type='unsigned int' data-ref="5resource">resource</dfn>,</td></tr>
<tr><th id="57">57</th><td>			  <em>unsigned</em> <em>long</em> <dfn class="local col6 decl" id="6value" title='value' data-type='unsigned long' data-ref="6value">value</dfn>, <b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col7 decl" id="7peer" title='peer' data-type='struct aa_label *' data-ref="7peer">peer</dfn>,</td></tr>
<tr><th id="58">58</th><td>			  <em>const</em> <em>char</em> *<dfn class="local col8 decl" id="8info" title='info' data-type='const char *' data-ref="8info">info</dfn>, <em>int</em> <dfn class="local col9 decl" id="9error" title='error' data-type='int' data-ref="9error">error</dfn>)</td></tr>
<tr><th id="59">59</th><td>{</td></tr>
<tr><th id="60">60</th><td>	<a class="macro" href="include/audit.h.html#153" title="struct apparmor_audit_data sa_aad = { .op = (&quot;setrlimit&quot;), }; struct common_audit_data sa = { .type = (7), .u.tsk = ((void *)0), }; sa.apparmor_audit_data = &amp;(sa_aad)" data-ref="_M/DEFINE_AUDIT_DATA">DEFINE_AUDIT_DATA</a>(<dfn class="local col0 decl" id="10sa" title='sa' data-type='struct common_audit_data' data-ref="10sa"><a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a></dfn>, <a class="macro" href="../../include/linux/lsm_audit.h.html#69" title="7" data-ref="_M/LSM_AUDIT_DATA_NONE">LSM_AUDIT_DATA_NONE</a>, <a class="macro" href="include/audit.h.html#104" title="&quot;setrlimit&quot;" data-ref="_M/OP_SETRLIMIT">OP_SETRLIMIT</a>);</td></tr>
<tr><th id="61">61</th><td></td></tr>
<tr><th id="62">62</th><td>	<a class="macro" href="include/audit.h.html#152" title="((&amp;sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(&amp;<a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::rlim' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim">rlim</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::rlim" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::rlim' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::rlim">rlim</a> = <a class="local col5 ref" href="#5resource" title='resource' data-ref="5resource">resource</a>;</td></tr>
<tr><th id="63">63</th><td>	<a class="macro" href="include/audit.h.html#152" title="((&amp;sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(&amp;<a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::rlim' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::rlim">rlim</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::max" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::max' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::max">max</a> = <a class="local col6 ref" href="#6value" title='value' data-ref="6value">value</a>;</td></tr>
<tr><th id="64">64</th><td>	<a class="macro" href="include/audit.h.html#152" title="((&amp;sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(&amp;<a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymous)::peer" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::peer' data-ref="apparmor_audit_data::(anonymousunion)::(anonymous)::peer">peer</a> = <a class="local col7 ref" href="#7peer" title='peer' data-ref="7peer">peer</a>;</td></tr>
<tr><th id="65">65</th><td>	<a class="macro" href="include/audit.h.html#152" title="((&amp;sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(&amp;<a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::info" title='apparmor_audit_data::info' data-ref="apparmor_audit_data::info">info</a> = <a class="local col8 ref" href="#8info" title='info' data-ref="8info">info</a>;</td></tr>
<tr><th id="66">66</th><td>	<a class="macro" href="include/audit.h.html#152" title="((&amp;sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(&amp;<a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::error" title='apparmor_audit_data::error' data-ref="apparmor_audit_data::error">error</a> = <a class="local col9 ref" href="#9error" title='error' data-ref="9error">error</a>;</td></tr>
<tr><th id="67">67</th><td></td></tr>
<tr><th id="68">68</th><td>	<b>return</b> <a class="ref fn" href="include/audit.h.html#aa_audit" title='aa_audit' data-ref="aa_audit">aa_audit</a>(<a class="enum" href="include/audit.h.html#AUDIT_APPARMOR_AUTO" title='AUDIT_APPARMOR_AUTO' data-ref="AUDIT_APPARMOR_AUTO">AUDIT_APPARMOR_AUTO</a>, <a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>, &amp;<a class="local col0 ref" href="#60" title='sa' data-ref="10sa">sa</a>, <a class="tu ref fn" href="#audit_cb" title='audit_cb' data-use='r' data-ref="audit_cb">audit_cb</a>);</td></tr>
<tr><th id="69">69</th><td>}</td></tr>
<tr><th id="70">70</th><td></td></tr>
<tr><th id="71">71</th><td><i class="doc">/**</i></td></tr>
<tr><th id="72">72</th><td><i class="doc"> * aa_map_resouce - map compiled policy resource to internal #</i></td></tr>
<tr><th id="73">73</th><td><i class="doc"> *<span class="command"> @resource</span>: flattened policy resource number</i></td></tr>
<tr><th id="74">74</th><td><i class="doc"> *</i></td></tr>
<tr><th id="75">75</th><td><i class="doc"> * Returns: resource # for the current architecture.</i></td></tr>
<tr><th id="76">76</th><td><i class="doc"> *</i></td></tr>
<tr><th id="77">77</th><td><i class="doc"> * rlimit resource can vary based on architecture, map the compiled policy</i></td></tr>
<tr><th id="78">78</th><td><i class="doc"> * resource # to the internal representation for the architecture.</i></td></tr>
<tr><th id="79">79</th><td><i class="doc"> */</i></td></tr>
<tr><th id="80">80</th><td><em>int</em> <dfn class="decl def fn" id="aa_map_resource" title='aa_map_resource' data-ref="aa_map_resource">aa_map_resource</dfn>(<em>int</em> <dfn class="local col1 decl" id="11resource" title='resource' data-type='int' data-ref="11resource">resource</dfn>)</td></tr>
<tr><th id="81">81</th><td>{</td></tr>
<tr><th id="82">82</th><td>	<b>return</b> <a class="ref" href="rlim_names.h.html#rlim_map" title='rlim_map' data-ref="rlim_map">rlim_map</a>[<a class="local col1 ref" href="#11resource" title='resource' data-ref="11resource">resource</a>];</td></tr>
<tr><th id="83">83</th><td>}</td></tr>
<tr><th id="84">84</th><td></td></tr>
<tr><th id="85">85</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="profile_setrlimit" title='profile_setrlimit' data-type='int profile_setrlimit(struct aa_profile * profile, unsigned int resource, struct rlimit * new_rlim)' data-ref="profile_setrlimit">profile_setrlimit</dfn>(<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col2 decl" id="12profile" title='profile' data-type='struct aa_profile *' data-ref="12profile">profile</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="13resource" title='resource' data-type='unsigned int' data-ref="13resource">resource</dfn>,</td></tr>
<tr><th id="86">86</th><td>			     <b>struct</b> <a class="type" href="../../include/uapi/linux/resource.h.html#rlimit" title='rlimit' data-ref="rlimit">rlimit</a> *<dfn class="local col4 decl" id="14new_rlim" title='new_rlim' data-type='struct rlimit *' data-ref="14new_rlim">new_rlim</dfn>)</td></tr>
<tr><th id="87">87</th><td>{</td></tr>
<tr><th id="88">88</th><td>	<em>int</em> <dfn class="local col5 decl" id="15e" title='e' data-type='int' data-ref="15e">e</dfn> = <var>0</var>;</td></tr>
<tr><th id="89">89</th><td></td></tr>
<tr><th id="90">90</th><td>	<b>if</b> (<a class="local col2 ref" href="#12profile" title='profile' data-ref="12profile">profile</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::mask" title='aa_rlimit::mask' data-ref="aa_rlimit::mask">mask</a> &amp; (<var>1</var> &lt;&lt; <a class="local col3 ref" href="#13resource" title='resource' data-ref="13resource">resource</a>) &amp;&amp; <a class="local col4 ref" href="#14new_rlim" title='new_rlim' data-ref="14new_rlim">new_rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a> &gt;</td></tr>
<tr><th id="91">91</th><td>	    <a class="local col2 ref" href="#12profile" title='profile' data-ref="12profile">profile</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::limits" title='aa_rlimit::limits' data-ref="aa_rlimit::limits">limits</a>[<a class="local col3 ref" href="#13resource" title='resource' data-ref="13resource">resource</a>].<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>)</td></tr>
<tr><th id="92">92</th><td>		<a class="local col5 ref" href="#15e" title='e' data-ref="15e">e</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#17" title="13" data-ref="_M/EACCES">EACCES</a>;</td></tr>
<tr><th id="93">93</th><td>	<b>return</b> <a class="tu ref fn" href="#audit_resource" title='audit_resource' data-use='c' data-ref="audit_resource">audit_resource</a>(<a class="local col2 ref" href="#12profile" title='profile' data-ref="12profile">profile</a>, <a class="local col3 ref" href="#13resource" title='resource' data-ref="13resource">resource</a>, <a class="local col4 ref" href="#14new_rlim" title='new_rlim' data-ref="14new_rlim">new_rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>, <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="94">94</th><td>			      <a class="local col5 ref" href="#15e" title='e' data-ref="15e">e</a>);</td></tr>
<tr><th id="95">95</th><td>}</td></tr>
<tr><th id="96">96</th><td></td></tr>
<tr><th id="97">97</th><td><i class="doc">/**</i></td></tr>
<tr><th id="98">98</th><td><i class="doc"> * aa_task_setrlimit - test permission to set an rlimit</i></td></tr>
<tr><th id="99">99</th><td><i class="doc"> *<span class="command"> @label</span> - label confining the task  (NOT NULL)</i></td></tr>
<tr><th id="100">100</th><td><i class="doc"> *<span class="command"> @task</span> - task the resource is being set on</i></td></tr>
<tr><th id="101">101</th><td><i class="doc"> *<span class="command"> @resource</span> - the resource being set</i></td></tr>
<tr><th id="102">102</th><td><i class="doc"> *<span class="command"> @new</span>_rlim - the new resource limit  (NOT NULL)</i></td></tr>
<tr><th id="103">103</th><td><i class="doc"> *</i></td></tr>
<tr><th id="104">104</th><td><i class="doc"> * Control raising the processes hard limit.</i></td></tr>
<tr><th id="105">105</th><td><i class="doc"> *</i></td></tr>
<tr><th id="106">106</th><td><i class="doc"> * Returns: 0 or error code if setting resource failed</i></td></tr>
<tr><th id="107">107</th><td><i class="doc"> */</i></td></tr>
<tr><th id="108">108</th><td><em>int</em> <dfn class="decl def fn" id="aa_task_setrlimit" title='aa_task_setrlimit' data-ref="aa_task_setrlimit">aa_task_setrlimit</dfn>(<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col6 decl" id="16label" title='label' data-type='struct aa_label *' data-ref="16label">label</dfn>, <b>struct</b> <a class="type" href="../../include/linux/sched.h.html#task_struct" title='task_struct' data-ref="task_struct">task_struct</a> *<dfn class="local col7 decl" id="17task" title='task' data-type='struct task_struct *' data-ref="17task">task</dfn>,</td></tr>
<tr><th id="109">109</th><td>		      <em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="18resource" title='resource' data-type='unsigned int' data-ref="18resource">resource</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/resource.h.html#rlimit" title='rlimit' data-ref="rlimit">rlimit</a> *<dfn class="local col9 decl" id="19new_rlim" title='new_rlim' data-type='struct rlimit *' data-ref="19new_rlim">new_rlim</dfn>)</td></tr>
<tr><th id="110">110</th><td>{</td></tr>
<tr><th id="111">111</th><td>	<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col0 decl" id="20profile" title='profile' data-type='struct aa_profile *' data-ref="20profile">profile</dfn>;</td></tr>
<tr><th id="112">112</th><td>	<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col1 decl" id="21peer" title='peer' data-type='struct aa_label *' data-ref="21peer">peer</dfn>;</td></tr>
<tr><th id="113">113</th><td>	<em>int</em> <dfn class="local col2 decl" id="22error" title='error' data-type='int' data-ref="22error">error</dfn> = <var>0</var>;</td></tr>
<tr><th id="114">114</th><td></td></tr>
<tr><th id="115">115</th><td>	<a class="ref fn" href="../../include/linux/rcupdate.h.html#rcu_read_lock" title='rcu_read_lock' data-ref="rcu_read_lock">rcu_read_lock</a>();</td></tr>
<tr><th id="116">116</th><td>	<a class="local col1 ref" href="#21peer" title='peer' data-ref="21peer">peer</a> = <a class="ref fn" href="include/context.h.html#aa_get_newest_cred_label" title='aa_get_newest_cred_label' data-ref="aa_get_newest_cred_label">aa_get_newest_cred_label</a>(<a class="macro" href="../../include/linux/cred.h.html#297" title="({ typeof(*((task)-&gt;real_cred)) *________p1 = (typeof(*((task)-&gt;real_cred)) *)({ union { typeof(((task)-&gt;real_cred)) __val; char __c[1]; } __u; if (1) __read_once_size(&amp;(((task)-&gt;real_cred)), __u.__c, sizeof(((task)-&gt;real_cred))); else __read_once_size_nocheck(&amp;(((task)-&gt;real_cred)), __u.__c, sizeof(((task)-&gt;real_cred))); do { } while (0); __u.__val; }); do { } while (0); ; ((typeof(*((task)-&gt;real_cred)) *)(________p1)); })" data-ref="_M/__task_cred">__task_cred</a>(<a class="local col7 ref" href="#17task" title='task' data-ref="17task">task</a>));</td></tr>
<tr><th id="117">117</th><td>	<a class="ref fn" href="../../include/linux/rcupdate.h.html#rcu_read_unlock" title='rcu_read_unlock' data-ref="rcu_read_unlock">rcu_read_unlock</a>();</td></tr>
<tr><th id="118">118</th><td></td></tr>
<tr><th id="119">119</th><td>	<i>/* TODO: extend resource control to handle other (non current)</i></td></tr>
<tr><th id="120">120</th><td><i>	 * profiles.  AppArmor rules currently have the implicit assumption</i></td></tr>
<tr><th id="121">121</th><td><i>	 * that the task is setting the resource of a task confined with</i></td></tr>
<tr><th id="122">122</th><td><i>	 * the same profile or that the task setting the resource of another</i></td></tr>
<tr><th id="123">123</th><td><i>	 * task has CAP_SYS_RESOURCE.</i></td></tr>
<tr><th id="124">124</th><td><i>	 */</i></td></tr>
<tr><th id="125">125</th><td></td></tr>
<tr><th id="126">126</th><td>	<b>if</b> (<a class="local col6 ref" href="#16label" title='label' data-ref="16label">label</a> != <a class="local col1 ref" href="#21peer" title='peer' data-ref="21peer">peer</a> &amp;&amp;</td></tr>
<tr><th id="127">127</th><td>	    !<a class="ref fn" href="include/capability.h.html#aa_capable" title='aa_capable' data-ref="aa_capable">aa_capable</a>(<a class="local col6 ref" href="#16label" title='label' data-ref="16label">label</a>, <a class="macro" href="../../include/uapi/linux/capability.h.html#305" title="24" data-ref="_M/CAP_SYS_RESOURCE">CAP_SYS_RESOURCE</a>, <a class="macro" href="../../include/linux/security.h.html#61" title="0" data-ref="_M/SECURITY_CAP_NOAUDIT">SECURITY_CAP_NOAUDIT</a>))</td></tr>
<tr><th id="128">128</th><td>		<a class="local col2 ref" href="#22error" title='error' data-ref="22error">error</a> = <a class="macro" href="include/label.h.html#245" title="({ struct label_it i; int __E = 0; for ((i).i = 0; (((profile)) = ((label))-&gt;vec[(i).i]); ++((i).i)) { do { int __subE = ((audit_resource(profile, resource, new_rlim-&gt;rlim_max, peer, &quot;cap_sys_resoure&quot;, -13))); if (__subE) (__E) = __subE; } while (0); } __E; })" data-ref="_M/fn_for_each">fn_for_each</a>(<a class="local col6 ref" href="#16label" title='label' data-ref="16label">label</a>, <a class="local col0 ref" href="#20profile" title='profile' data-ref="20profile">profile</a>,</td></tr>
<tr><th id="129">129</th><td>				<a class="tu ref fn" href="#audit_resource" title='audit_resource' data-use='c' data-ref="audit_resource">audit_resource</a>(<a class="local col0 ref" href="#20profile" title='profile' data-ref="20profile">profile</a>, <a class="local col8 ref" href="#18resource" title='resource' data-ref="18resource">resource</a>,</td></tr>
<tr><th id="130">130</th><td>					       <a class="local col9 ref" href="#19new_rlim" title='new_rlim' data-ref="19new_rlim">new_rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>, <a class="local col1 ref" href="#21peer" title='peer' data-ref="21peer">peer</a>,</td></tr>
<tr><th id="131">131</th><td>					       <q>"cap_sys_resoure"</q>, -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#17" title="13" data-ref="_M/EACCES">EACCES</a>));</td></tr>
<tr><th id="132">132</th><td>	<b>else</b></td></tr>
<tr><th id="133">133</th><td>		<a class="local col2 ref" href="#22error" title='error' data-ref="22error">error</a> = <a class="macro" href="include/label.h.html#246" title="({ struct label_it i; int __E = 0; for ((i).i = aa_label_next_confined(((label)), 0); (((profile)) = ((label))-&gt;vec[(i).i]); (i).i = aa_label_next_confined(((label)), (i).i + 1)) { do { int __subE = ((profile_setrlimit(profile, resource, new_rlim))); if (__subE) (__E) = __subE; } while (0); } __E; })" data-ref="_M/fn_for_each_confined">fn_for_each_confined</a>(<a class="local col6 ref" href="#16label" title='label' data-ref="16label">label</a>, <a class="local col0 ref" href="#20profile" title='profile' data-ref="20profile">profile</a>,</td></tr>
<tr><th id="134">134</th><td>				<a class="tu ref fn" href="#profile_setrlimit" title='profile_setrlimit' data-use='c' data-ref="profile_setrlimit">profile_setrlimit</a>(<a class="local col0 ref" href="#20profile" title='profile' data-ref="20profile">profile</a>, <a class="local col8 ref" href="#18resource" title='resource' data-ref="18resource">resource</a>, <a class="local col9 ref" href="#19new_rlim" title='new_rlim' data-ref="19new_rlim">new_rlim</a>));</td></tr>
<tr><th id="135">135</th><td>	<a class="ref fn" href="include/label.h.html#aa_put_label" title='aa_put_label' data-ref="aa_put_label">aa_put_label</a>(<a class="local col1 ref" href="#21peer" title='peer' data-ref="21peer">peer</a>);</td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td>	<b>return</b> <a class="local col2 ref" href="#22error" title='error' data-ref="22error">error</a>;</td></tr>
<tr><th id="138">138</th><td>}</td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td><i class="doc">/**</i></td></tr>
<tr><th id="141">141</th><td><i class="doc"> * __aa_transition_rlimits - apply new profile rlimits</i></td></tr>
<tr><th id="142">142</th><td><i class="doc"> *<span class="command"> @old</span>_l: old label on task  (NOT NULL)</i></td></tr>
<tr><th id="143">143</th><td><i class="doc"> *<span class="command"> @new</span>_l: new label with rlimits to apply  (NOT NULL)</i></td></tr>
<tr><th id="144">144</th><td><i class="doc"> */</i></td></tr>
<tr><th id="145">145</th><td><em>void</em> <dfn class="decl def fn" id="__aa_transition_rlimits" title='__aa_transition_rlimits' data-ref="__aa_transition_rlimits">__aa_transition_rlimits</dfn>(<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col3 decl" id="23old_l" title='old_l' data-type='struct aa_label *' data-ref="23old_l">old_l</dfn>, <b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col4 decl" id="24new_l" title='new_l' data-type='struct aa_label *' data-ref="24new_l">new_l</dfn>)</td></tr>
<tr><th id="146">146</th><td>{</td></tr>
<tr><th id="147">147</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="25mask" title='mask' data-type='unsigned int' data-ref="25mask">mask</dfn> = <var>0</var>;</td></tr>
<tr><th id="148">148</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/resource.h.html#rlimit" title='rlimit' data-ref="rlimit">rlimit</a> *<dfn class="local col6 decl" id="26rlim" title='rlim' data-type='struct rlimit *' data-ref="26rlim">rlim</dfn>, *<dfn class="local col7 decl" id="27initrlim" title='initrlim' data-type='struct rlimit *' data-ref="27initrlim">initrlim</dfn>;</td></tr>
<tr><th id="149">149</th><td>	<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col8 decl" id="28old" title='old' data-type='struct aa_profile *' data-ref="28old">old</dfn>, *<dfn class="local col9 decl" id="29new" title='new' data-type='struct aa_profile *' data-ref="29new">new</dfn>;</td></tr>
<tr><th id="150">150</th><td>	<b>struct</b> <a class="type" href="include/label.h.html#label_it" title='label_it' data-ref="label_it">label_it</a> <dfn class="local col0 decl" id="30i" title='i' data-type='struct label_it' data-ref="30i">i</dfn>;</td></tr>
<tr><th id="151">151</th><td></td></tr>
<tr><th id="152">152</th><td>	<a class="local col8 ref" href="#28old" title='old' data-ref="28old">old</a> = <a class="macro" href="include/label.h.html#155" title="((old_l)-&gt;vec[(old_l)-&gt;size - 1])" data-ref="_M/labels_profile">labels_profile</a>(<a class="local col3 ref" href="#23old_l" title='old_l' data-ref="23old_l">old_l</a>);</td></tr>
<tr><th id="153">153</th><td>	<a class="local col9 ref" href="#29new" title='new' data-ref="29new">new</a> = <a class="macro" href="include/label.h.html#155" title="((new_l)-&gt;vec[(new_l)-&gt;size - 1])" data-ref="_M/labels_profile">labels_profile</a>(<a class="local col4 ref" href="#24new_l" title='new_l' data-ref="24new_l">new_l</a>);</td></tr>
<tr><th id="154">154</th><td></td></tr>
<tr><th id="155">155</th><td>	<i>/* for any rlimits the profile controlled, reset the soft limit</i></td></tr>
<tr><th id="156">156</th><td><i>	 * to the lesser of the tasks hard limit and the init tasks soft limit</i></td></tr>
<tr><th id="157">157</th><td><i>	 */</i></td></tr>
<tr><th id="158">158</th><td>	<a class="macro" href="include/label.h.html#195" title="for ((i).i = aa_label_next_confined((old_l), 0); ((old) = (old_l)-&gt;vec[(i).i]); (i).i = aa_label_next_confined((old_l), (i).i + 1))" data-ref="_M/label_for_each_confined">label_for_each_confined</a>(<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>, <a class="local col3 ref" href="#23old_l" title='old_l' data-ref="23old_l">old_l</a>, <a class="local col8 ref" href="#28old" title='old' data-ref="28old">old</a>) {</td></tr>
<tr><th id="159">159</th><td>		<b>if</b> (<a class="local col8 ref" href="#28old" title='old' data-ref="28old">old</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::mask" title='aa_rlimit::mask' data-ref="aa_rlimit::mask">mask</a>) {</td></tr>
<tr><th id="160">160</th><td>			<em>int</em> <dfn class="local col1 decl" id="31j" title='j' data-type='int' data-ref="31j">j</dfn>;</td></tr>
<tr><th id="161">161</th><td></td></tr>
<tr><th id="162">162</th><td>			<b>for</b> (<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a> = <var>0</var>, <a class="local col5 ref" href="#25mask" title='mask' data-ref="25mask">mask</a> = <var>1</var>; <a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a> &lt; <a class="macro" href="../../include/uapi/asm-generic/resource.h.html#49" title="16" data-ref="_M/RLIM_NLIMITS">RLIM_NLIMITS</a>; <a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>++,</td></tr>
<tr><th id="163">163</th><td>				     <a class="local col5 ref" href="#25mask" title='mask' data-ref="25mask">mask</a> &lt;&lt;= <var>1</var>) {</td></tr>
<tr><th id="164">164</th><td>				<b>if</b> (<a class="local col8 ref" href="#28old" title='old' data-ref="28old">old</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::mask" title='aa_rlimit::mask' data-ref="aa_rlimit::mask">mask</a> &amp; <a class="local col5 ref" href="#25mask" title='mask' data-ref="25mask">mask</a>) {</td></tr>
<tr><th id="165">165</th><td>					<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a> = <a class="macro" href="../../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../../include/linux/sched.h.html#task_struct::signal" title='task_struct::signal' data-ref="task_struct::signal">signal</a>-&gt;<a class="ref field" href="../../include/linux/sched/signal.h.html#signal_struct::rlim" title='signal_struct::rlim' data-ref="signal_struct::rlim">rlim</a> + <a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>;</td></tr>
<tr><th id="166">166</th><td>					<a class="local col7 ref" href="#27initrlim" title='initrlim' data-ref="27initrlim">initrlim</a> = <a class="ref" href="../../include/linux/sched/task.h.html#init_task" title='init_task' data-ref="init_task">init_task</a>.<a class="ref field" href="../../include/linux/sched.h.html#task_struct::signal" title='task_struct::signal' data-ref="task_struct::signal">signal</a>-&gt;<a class="ref field" href="../../include/linux/sched/signal.h.html#signal_struct::rlim" title='signal_struct::rlim' data-ref="signal_struct::rlim">rlim</a> + <a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>;</td></tr>
<tr><th id="167">167</th><td>					<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur">rlim_cur</a> = <a class="macro" href="../../include/linux/kernel.h.html#799" title="({ typeof(rlim-&gt;rlim_max) __UNIQUE_ID_min1_136 = (rlim-&gt;rlim_max); typeof(initrlim-&gt;rlim_cur) __UNIQUE_ID_min2_137 = (initrlim-&gt;rlim_cur); (void) (&amp;__UNIQUE_ID_min1_136 == &amp;__UNIQUE_ID_min2_137); __UNIQUE_ID_min1_136 &lt; __UNIQUE_ID_min2_137 ? __UNIQUE_ID_min1_136 : __UNIQUE_ID_min2_137; })" data-ref="_M/min">min</a>(<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>,</td></tr>
<tr><th id="168">168</th><td>							    <a class="local col7 ref" href="#27initrlim" title='initrlim' data-ref="27initrlim">initrlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur">rlim_cur</a>);</td></tr>
<tr><th id="169">169</th><td>				}</td></tr>
<tr><th id="170">170</th><td>			}</td></tr>
<tr><th id="171">171</th><td>		}</td></tr>
<tr><th id="172">172</th><td>	}</td></tr>
<tr><th id="173">173</th><td></td></tr>
<tr><th id="174">174</th><td>	<i>/* set any new hard limits as dictated by the new profile */</i></td></tr>
<tr><th id="175">175</th><td>	<a class="macro" href="include/label.h.html#195" title="for ((i).i = aa_label_next_confined((new_l), 0); ((new) = (new_l)-&gt;vec[(i).i]); (i).i = aa_label_next_confined((new_l), (i).i + 1))" data-ref="_M/label_for_each_confined">label_for_each_confined</a>(<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>, <a class="local col4 ref" href="#24new_l" title='new_l' data-ref="24new_l">new_l</a>, <a class="local col9 ref" href="#29new" title='new' data-ref="29new">new</a>) {</td></tr>
<tr><th id="176">176</th><td>		<em>int</em> <dfn class="local col2 decl" id="32j" title='j' data-type='int' data-ref="32j">j</dfn>;</td></tr>
<tr><th id="177">177</th><td></td></tr>
<tr><th id="178">178</th><td>		<b>if</b> (!<a class="local col9 ref" href="#29new" title='new' data-ref="29new">new</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::mask" title='aa_rlimit::mask' data-ref="aa_rlimit::mask">mask</a>)</td></tr>
<tr><th id="179">179</th><td>			<b>continue</b>;</td></tr>
<tr><th id="180">180</th><td>		<b>for</b> (<a class="local col2 ref" href="#32j" title='j' data-ref="32j">j</a> = <var>0</var>, <a class="local col5 ref" href="#25mask" title='mask' data-ref="25mask">mask</a> = <var>1</var>; <a class="local col2 ref" href="#32j" title='j' data-ref="32j">j</a> &lt; <a class="macro" href="../../include/uapi/asm-generic/resource.h.html#49" title="16" data-ref="_M/RLIM_NLIMITS">RLIM_NLIMITS</a>; <a class="local col2 ref" href="#32j" title='j' data-ref="32j">j</a>++, <a class="local col5 ref" href="#25mask" title='mask' data-ref="25mask">mask</a> &lt;&lt;= <var>1</var>) {</td></tr>
<tr><th id="181">181</th><td>			<b>if</b> (!(<a class="local col9 ref" href="#29new" title='new' data-ref="29new">new</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::mask" title='aa_rlimit::mask' data-ref="aa_rlimit::mask">mask</a> &amp; <a class="local col5 ref" href="#25mask" title='mask' data-ref="25mask">mask</a>))</td></tr>
<tr><th id="182">182</th><td>				<b>continue</b>;</td></tr>
<tr><th id="183">183</th><td></td></tr>
<tr><th id="184">184</th><td>			<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a> = <a class="macro" href="../../arch/x86/include/asm/current.h.html#18" title="get_current()" data-ref="_M/current">current</a>-&gt;<a class="ref field" href="../../include/linux/sched.h.html#task_struct::signal" title='task_struct::signal' data-ref="task_struct::signal">signal</a>-&gt;<a class="ref field" href="../../include/linux/sched/signal.h.html#signal_struct::rlim" title='signal_struct::rlim' data-ref="signal_struct::rlim">rlim</a> + <a class="local col2 ref" href="#32j" title='j' data-ref="32j">j</a>;</td></tr>
<tr><th id="185">185</th><td>			<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a> = <a class="macro" href="../../include/linux/kernel.h.html#799" title="({ typeof(rlim-&gt;rlim_max) __UNIQUE_ID_min1_140 = (rlim-&gt;rlim_max); typeof(new-&gt;rlimits.limits[j].rlim_max) __UNIQUE_ID_min2_141 = (new-&gt;rlimits.limits[j].rlim_max); (void) (&amp;__UNIQUE_ID_min1_140 == &amp;__UNIQUE_ID_min2_141); __UNIQUE_ID_min1_140 &lt; __UNIQUE_ID_min2_141 ? __UNIQUE_ID_min1_140 : __UNIQUE_ID_min2_141; })" data-ref="_M/min">min</a>(<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>,</td></tr>
<tr><th id="186">186</th><td>					     <a class="local col9 ref" href="#29new" title='new' data-ref="29new">new</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::rlimits" title='aa_profile::rlimits' data-ref="aa_profile::rlimits">rlimits</a>.<a class="ref field" href="include/resource.h.html#aa_rlimit::limits" title='aa_rlimit::limits' data-ref="aa_rlimit::limits">limits</a>[<a class="local col2 ref" href="#32j" title='j' data-ref="32j">j</a>].<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>);</td></tr>
<tr><th id="187">187</th><td>			<i>/* soft limit should not exceed hard limit */</i></td></tr>
<tr><th id="188">188</th><td>			<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur">rlim_cur</a> = <a class="macro" href="../../include/linux/kernel.h.html#799" title="({ typeof(rlim-&gt;rlim_cur) __UNIQUE_ID_min1_144 = (rlim-&gt;rlim_cur); typeof(rlim-&gt;rlim_max) __UNIQUE_ID_min2_145 = (rlim-&gt;rlim_max); (void) (&amp;__UNIQUE_ID_min1_144 == &amp;__UNIQUE_ID_min2_145); __UNIQUE_ID_min1_144 &lt; __UNIQUE_ID_min2_145 ? __UNIQUE_ID_min1_144 : __UNIQUE_ID_min2_145; })" data-ref="_M/min">min</a>(<a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur">rlim_cur</a>, <a class="local col6 ref" href="#26rlim" title='rlim' data-ref="26rlim">rlim</a>-&gt;<a class="ref field" href="../../include/uapi/linux/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a>);</td></tr>
<tr><th id="189">189</th><td>		}</td></tr>
<tr><th id="190">190</th><td>	}</td></tr>
<tr><th id="191">191</th><td>}</td></tr>
<tr><th id="192">192</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Aug-02</em> from project linux-4.14.y revision <em>linux-4.14.y</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
