<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>htirq.c source code [linux-4.14.y/arch/x86/kernel/apic/htirq.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux-4.14.y/arch/x86/kernel/apic/htirq.c'; var root_path = '../../../../..'; var data_path = '../../../../../../data';</script>
<script src='../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>linux-4.14.y</a>/<a href='../../..'>arch</a>/<a href='../..'>x86</a>/<a href='..'>kernel</a>/<a href='./'>apic</a>/<a href='htirq.c.html'>htirq.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * Support Hypertransport IRQ</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (C) 1997, 1998, 1999, 2000, 2009 Ingo Molnar, Hajnalka Szabo</i></td></tr>
<tr><th id="5">5</th><td><i> *	Moved from arch/x86/kernel/apic/io_apic.c.</i></td></tr>
<tr><th id="6">6</th><td><i> * Jiang Liu &lt;jiang.liu@linux.intel.com&gt;</i></td></tr>
<tr><th id="7">7</th><td><i> *	Add support of hierarchical irqdomain</i></td></tr>
<tr><th id="8">8</th><td><i> *</i></td></tr>
<tr><th id="9">9</th><td><i> * This program is free software; you can redistribute it and/or modify</i></td></tr>
<tr><th id="10">10</th><td><i> * it under the terms of the GNU General Public License version 2 as</i></td></tr>
<tr><th id="11">11</th><td><i> * published by the Free Software Foundation.</i></td></tr>
<tr><th id="12">12</th><td><i> */</i></td></tr>
<tr><th id="13">13</th><td><u>#include <a href="../../../../include/linux/mm.h.html">&lt;linux/mm.h&gt;</a></u></td></tr>
<tr><th id="14">14</th><td><u>#include <a href="../../../../include/linux/interrupt.h.html">&lt;linux/interrupt.h&gt;</a></u></td></tr>
<tr><th id="15">15</th><td><u>#include <a href="../../../../include/linux/init.h.html">&lt;linux/init.h&gt;</a></u></td></tr>
<tr><th id="16">16</th><td><u>#include <a href="../../../../include/linux/device.h.html">&lt;linux/device.h&gt;</a></u></td></tr>
<tr><th id="17">17</th><td><u>#include <a href="../../../../include/linux/pci.h.html">&lt;linux/pci.h&gt;</a></u></td></tr>
<tr><th id="18">18</th><td><u>#include <a href="../../../../include/linux/htirq.h.html">&lt;linux/htirq.h&gt;</a></u></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="../../include/asm/irqdomain.h.html">&lt;asm/irqdomain.h&gt;</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../../include/asm/hw_irq.h.html">&lt;asm/hw_irq.h&gt;</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="../../include/asm/apic.h.html">&lt;asm/apic.h&gt;</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="../../include/asm/hypertransport.h.html">&lt;asm/hypertransport.h&gt;</a></u></td></tr>
<tr><th id="23">23</th><td></td></tr>
<tr><th id="24">24</th><td><em>static</em> <b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain" title='irq_domain' data-ref="irq_domain">irq_domain</a> *<dfn class="tu decl def" id="htirq_domain" title='htirq_domain' data-type='struct irq_domain *' data-ref="htirq_domain">htirq_domain</dfn>;</td></tr>
<tr><th id="25">25</th><td></td></tr>
<tr><th id="26">26</th><td><i  data-doc="ht_set_affinity">/*</i></td></tr>
<tr><th id="27">27</th><td><i  data-doc="ht_set_affinity"> * Hypertransport interrupt support</i></td></tr>
<tr><th id="28">28</th><td><i  data-doc="ht_set_affinity"> */</i></td></tr>
<tr><th id="29">29</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="30">30</th><td><dfn class="tu decl def fn" id="ht_set_affinity" title='ht_set_affinity' data-type='int ht_set_affinity(struct irq_data * data, const struct cpumask * mask, bool force)' data-ref="ht_set_affinity">ht_set_affinity</dfn>(<b>struct</b> <a class="type" href="../../../../include/linux/irq.h.html#irq_data" title='irq_data' data-ref="irq_data">irq_data</a> *<dfn class="local col8 decl" id="18data" title='data' data-type='struct irq_data *' data-ref="18data">data</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../../../include/linux/cpumask.h.html#cpumask" title='cpumask' data-ref="cpumask">cpumask</a> *<dfn class="local col9 decl" id="19mask" title='mask' data-type='const struct cpumask *' data-ref="19mask">mask</dfn>, <a class="typedef" href="../../../../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool">bool</a> <dfn class="local col0 decl" id="20force" title='force' data-type='bool' data-ref="20force">force</dfn>)</td></tr>
<tr><th id="31">31</th><td>{</td></tr>
<tr><th id="32">32</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/irq.h.html#irq_data" title='irq_data' data-ref="irq_data">irq_data</a> *<dfn class="local col1 decl" id="21parent" title='parent' data-type='struct irq_data *' data-ref="21parent">parent</dfn> = <a class="local col8 ref" href="#18data" title='data' data-ref="18data">data</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::parent_data" title='irq_data::parent_data' data-ref="irq_data::parent_data">parent_data</a>;</td></tr>
<tr><th id="33">33</th><td>	<em>int</em> <dfn class="local col2 decl" id="22ret" title='ret' data-type='int' data-ref="22ret">ret</dfn>;</td></tr>
<tr><th id="34">34</th><td></td></tr>
<tr><th id="35">35</th><td>	<a class="local col2 ref" href="#22ret" title='ret' data-ref="22ret">ret</a> = <a class="local col1 ref" href="#21parent" title='parent' data-ref="21parent">parent</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::chip" title='irq_data::chip' data-ref="irq_data::chip">chip</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::irq_set_affinity" title='irq_chip::irq_set_affinity' data-ref="irq_chip::irq_set_affinity">irq_set_affinity</a>(<a class="local col1 ref" href="#21parent" title='parent' data-ref="21parent">parent</a>, <a class="local col9 ref" href="#19mask" title='mask' data-ref="19mask">mask</a>, <a class="local col0 ref" href="#20force" title='force' data-ref="20force">force</a>);</td></tr>
<tr><th id="36">36</th><td>	<b>if</b> (<a class="local col2 ref" href="#22ret" title='ret' data-ref="22ret">ret</a> &gt;= <var>0</var>) {</td></tr>
<tr><th id="37">37</th><td>		<b>struct</b> <a class="type" href="../../../../include/linux/htirq.h.html#ht_irq_msg" title='ht_irq_msg' data-ref="ht_irq_msg">ht_irq_msg</a> <dfn class="local col3 decl" id="23msg" title='msg' data-type='struct ht_irq_msg' data-ref="23msg">msg</dfn>;</td></tr>
<tr><th id="38">38</th><td>		<b>struct</b> <a class="type" href="../../include/asm/hw_irq.h.html#irq_cfg" title='irq_cfg' data-ref="irq_cfg">irq_cfg</a> *<dfn class="local col4 decl" id="24cfg" title='cfg' data-type='struct irq_cfg *' data-ref="24cfg">cfg</dfn> = <a class="ref fn" href="../../include/asm/hw_irq.h.html#irqd_cfg" title='irqd_cfg' data-ref="irqd_cfg">irqd_cfg</a>(<a class="local col8 ref" href="#18data" title='data' data-ref="18data">data</a>);</td></tr>
<tr><th id="39">39</th><td></td></tr>
<tr><th id="40">40</th><td>		<a class="ref fn" href="../../../../include/linux/htirq.h.html#fetch_ht_irq_msg" title='fetch_ht_irq_msg' data-ref="fetch_ht_irq_msg">fetch_ht_irq_msg</a>(<a class="local col8 ref" href="#18data" title='data' data-ref="18data">data</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::irq" title='irq_data::irq' data-ref="irq_data::irq">irq</a>, &amp;<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>);</td></tr>
<tr><th id="41">41</th><td>		<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_lo" title='ht_irq_msg::address_lo' data-ref="ht_irq_msg::address_lo">address_lo</a> &amp;= ~(<a class="macro" href="../../include/asm/hypertransport.h.html#12" title="0x00ff0000" data-ref="_M/HT_IRQ_LOW_VECTOR_MASK">HT_IRQ_LOW_VECTOR_MASK</a> |</td></tr>
<tr><th id="42">42</th><td>				    <a class="macro" href="../../include/asm/hypertransport.h.html#17" title="0x0000ff00" data-ref="_M/HT_IRQ_LOW_DEST_ID_MASK">HT_IRQ_LOW_DEST_ID_MASK</a>);</td></tr>
<tr><th id="43">43</th><td>		<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_lo" title='ht_irq_msg::address_lo' data-ref="ht_irq_msg::address_lo">address_lo</a> |= <a class="macro" href="../../include/asm/hypertransport.h.html#13" title="(((cfg-&gt;vector) &lt;&lt; 16) &amp; 0x00ff0000)" data-ref="_M/HT_IRQ_LOW_VECTOR">HT_IRQ_LOW_VECTOR</a>(<a class="local col4 ref" href="#24cfg" title='cfg' data-ref="24cfg">cfg</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_cfg::vector" title='irq_cfg::vector' data-ref="irq_cfg::vector">vector</a>) |</td></tr>
<tr><th id="44">44</th><td>				  <a class="macro" href="../../include/asm/hypertransport.h.html#18" title="(((cfg-&gt;dest_apicid) &lt;&lt; 8) &amp; 0x0000ff00)" data-ref="_M/HT_IRQ_LOW_DEST_ID">HT_IRQ_LOW_DEST_ID</a>(<a class="local col4 ref" href="#24cfg" title='cfg' data-ref="24cfg">cfg</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_cfg::dest_apicid" title='irq_cfg::dest_apicid' data-ref="irq_cfg::dest_apicid">dest_apicid</a>);</td></tr>
<tr><th id="45">45</th><td>		<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_hi" title='ht_irq_msg::address_hi' data-ref="ht_irq_msg::address_hi">address_hi</a> &amp;= ~(<a class="macro" href="../../include/asm/hypertransport.h.html#42" title="0x00ffffff" data-ref="_M/HT_IRQ_HIGH_DEST_ID_MASK">HT_IRQ_HIGH_DEST_ID_MASK</a>);</td></tr>
<tr><th id="46">46</th><td>		<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_hi" title='ht_irq_msg::address_hi' data-ref="ht_irq_msg::address_hi">address_hi</a> |= <a class="macro" href="../../include/asm/hypertransport.h.html#43" title="((((cfg-&gt;dest_apicid) &gt;&gt; 8) &lt;&lt; 0) &amp; 0x00ffffff)" data-ref="_M/HT_IRQ_HIGH_DEST_ID">HT_IRQ_HIGH_DEST_ID</a>(<a class="local col4 ref" href="#24cfg" title='cfg' data-ref="24cfg">cfg</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_cfg::dest_apicid" title='irq_cfg::dest_apicid' data-ref="irq_cfg::dest_apicid">dest_apicid</a>);</td></tr>
<tr><th id="47">47</th><td>		<a class="ref fn" href="../../../../include/linux/htirq.h.html#write_ht_irq_msg" title='write_ht_irq_msg' data-ref="write_ht_irq_msg">write_ht_irq_msg</a>(<a class="local col8 ref" href="#18data" title='data' data-ref="18data">data</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::irq" title='irq_data::irq' data-ref="irq_data::irq">irq</a>, &amp;<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>);</td></tr>
<tr><th id="48">48</th><td>	}</td></tr>
<tr><th id="49">49</th><td></td></tr>
<tr><th id="50">50</th><td>	<b>return</b> <a class="local col2 ref" href="#22ret" title='ret' data-ref="22ret">ret</a>;</td></tr>
<tr><th id="51">51</th><td>}</td></tr>
<tr><th id="52">52</th><td></td></tr>
<tr><th id="53">53</th><td><em>static</em> <b>struct</b> <a class="type" href="../../../../include/linux/irq.h.html#irq_chip" title='irq_chip' data-ref="irq_chip">irq_chip</a> <dfn class="tu decl def" id="ht_irq_chip" title='ht_irq_chip' data-type='struct irq_chip' data-ref="ht_irq_chip">ht_irq_chip</dfn> = {</td></tr>
<tr><th id="54">54</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::name" title='irq_chip::name' data-ref="irq_chip::name">name</a>			= <q>"PCI-HT"</q>,</td></tr>
<tr><th id="55">55</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::irq_mask" title='irq_chip::irq_mask' data-ref="irq_chip::irq_mask">irq_mask</a>		= <a class="ref fn" href="../../../../include/linux/htirq.h.html#mask_ht_irq" title='mask_ht_irq' data-ref="mask_ht_irq">mask_ht_irq</a>,</td></tr>
<tr><th id="56">56</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::irq_unmask" title='irq_chip::irq_unmask' data-ref="irq_chip::irq_unmask">irq_unmask</a>		= <a class="ref fn" href="../../../../include/linux/htirq.h.html#unmask_ht_irq" title='unmask_ht_irq' data-ref="unmask_ht_irq">unmask_ht_irq</a>,</td></tr>
<tr><th id="57">57</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::irq_ack" title='irq_chip::irq_ack' data-ref="irq_chip::irq_ack">irq_ack</a>		= <a class="ref fn" href="../../../../include/linux/irq.h.html#irq_chip_ack_parent" title='irq_chip_ack_parent' data-ref="irq_chip_ack_parent">irq_chip_ack_parent</a>,</td></tr>
<tr><th id="58">58</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::irq_set_affinity" title='irq_chip::irq_set_affinity' data-ref="irq_chip::irq_set_affinity">irq_set_affinity</a>	= <a class="tu ref fn" href="#ht_set_affinity" title='ht_set_affinity' data-ref="ht_set_affinity">ht_set_affinity</a>,</td></tr>
<tr><th id="59">59</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::irq_retrigger" title='irq_chip::irq_retrigger' data-ref="irq_chip::irq_retrigger">irq_retrigger</a>		= <a class="ref fn" href="../../../../include/linux/irq.h.html#irq_chip_retrigger_hierarchy" title='irq_chip_retrigger_hierarchy' data-ref="irq_chip_retrigger_hierarchy">irq_chip_retrigger_hierarchy</a>,</td></tr>
<tr><th id="60">60</th><td>	.<a class="ref field" href="../../../../include/linux/irq.h.html#irq_chip::flags" title='irq_chip::flags' data-ref="irq_chip::flags">flags</a>			= <a class="enum" href="../../../../include/linux/irq.h.html#IRQCHIP_SKIP_SET_WAKE" title='IRQCHIP_SKIP_SET_WAKE' data-ref="IRQCHIP_SKIP_SET_WAKE">IRQCHIP_SKIP_SET_WAKE</a>,</td></tr>
<tr><th id="61">61</th><td>};</td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="htirq_domain_alloc" title='htirq_domain_alloc' data-type='int htirq_domain_alloc(struct irq_domain * domain, unsigned int virq, unsigned int nr_irqs, void * arg)' data-ref="htirq_domain_alloc">htirq_domain_alloc</dfn>(<b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain" title='irq_domain' data-ref="irq_domain">irq_domain</a> *<dfn class="local col5 decl" id="25domain" title='domain' data-type='struct irq_domain *' data-ref="25domain">domain</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="26virq" title='virq' data-type='unsigned int' data-ref="26virq">virq</dfn>,</td></tr>
<tr><th id="64">64</th><td>			      <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="27nr_irqs" title='nr_irqs' data-type='unsigned int' data-ref="27nr_irqs">nr_irqs</dfn>, <em>void</em> *<dfn class="local col8 decl" id="28arg" title='arg' data-type='void *' data-ref="28arg">arg</dfn>)</td></tr>
<tr><th id="65">65</th><td>{</td></tr>
<tr><th id="66">66</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/htirq.h.html#ht_irq_cfg" title='ht_irq_cfg' data-ref="ht_irq_cfg">ht_irq_cfg</a> *<dfn class="local col9 decl" id="29ht_cfg" title='ht_cfg' data-type='struct ht_irq_cfg *' data-ref="29ht_cfg">ht_cfg</dfn>;</td></tr>
<tr><th id="67">67</th><td>	<b>struct</b> <a class="type" href="../../include/asm/hw_irq.h.html#irq_alloc_info" title='irq_alloc_info' data-ref="irq_alloc_info">irq_alloc_info</a> *<dfn class="local col0 decl" id="30info" title='info' data-type='struct irq_alloc_info *' data-ref="30info">info</dfn> = <a class="local col8 ref" href="#28arg" title='arg' data-ref="28arg">arg</a>;</td></tr>
<tr><th id="68">68</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/pci.h.html#pci_dev" title='pci_dev' data-ref="pci_dev">pci_dev</a> *<dfn class="local col1 decl" id="31dev" title='dev' data-type='struct pci_dev *' data-ref="31dev">dev</dfn>;</td></tr>
<tr><th id="69">69</th><td>	<a class="typedef" href="../../../../include/linux/types.h.html#irq_hw_number_t" title='irq_hw_number_t' data-type='unsigned long' data-ref="irq_hw_number_t">irq_hw_number_t</a> <dfn class="local col2 decl" id="32hwirq" title='hwirq' data-type='irq_hw_number_t' data-ref="32hwirq">hwirq</dfn>;</td></tr>
<tr><th id="70">70</th><td>	<em>int</em> <dfn class="local col3 decl" id="33ret" title='ret' data-type='int' data-ref="33ret">ret</dfn>;</td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td>	<b>if</b> (<a class="local col7 ref" href="#27nr_irqs" title='nr_irqs' data-ref="27nr_irqs">nr_irqs</a> &gt; <var>1</var> || !<a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>)</td></tr>
<tr><th id="73">73</th><td>		<b>return</b> -<a class="macro" href="../../../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="74">74</th><td></td></tr>
<tr><th id="75">75</th><td>	<a class="local col1 ref" href="#31dev" title='dev' data-ref="31dev">dev</a> = <a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_dev" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_dev' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_dev">ht_dev</a>;</td></tr>
<tr><th id="76">76</th><td>	<a class="local col2 ref" href="#32hwirq" title='hwirq' data-ref="32hwirq">hwirq</a> = (<a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_idx" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_idx' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_idx">ht_idx</a> &amp; <var>0xFF</var>) |</td></tr>
<tr><th id="77">77</th><td>		<a class="macro" href="../../../../include/linux/pci.h.html#51" title="((((u16)(dev-&gt;bus-&gt;number)) &lt;&lt; 8) | (dev-&gt;devfn))" data-ref="_M/PCI_DEVID">PCI_DEVID</a>(<a class="local col1 ref" href="#31dev" title='dev' data-ref="31dev">dev</a>-&gt;<a class="ref field" href="../../../../include/linux/pci.h.html#pci_dev::bus" title='pci_dev::bus' data-ref="pci_dev::bus">bus</a>-&gt;<a class="ref field" href="../../../../include/linux/pci.h.html#pci_bus::number" title='pci_bus::number' data-ref="pci_bus::number">number</a>, <a class="local col1 ref" href="#31dev" title='dev' data-ref="31dev">dev</a>-&gt;<a class="ref field" href="../../../../include/linux/pci.h.html#pci_dev::devfn" title='pci_dev::devfn' data-ref="pci_dev::devfn">devfn</a>) &lt;&lt; <var>8</var> |</td></tr>
<tr><th id="78">78</th><td>		(<a class="ref fn" href="../../include/asm/pci.h.html#pci_domain_nr" title='pci_domain_nr' data-ref="pci_domain_nr">pci_domain_nr</a>(<a class="local col1 ref" href="#31dev" title='dev' data-ref="31dev">dev</a>-&gt;<a class="ref field" href="../../../../include/linux/pci.h.html#pci_dev::bus" title='pci_dev::bus' data-ref="pci_dev::bus">bus</a>) &amp; <var>0xFFFFFFFF</var>) &lt;&lt; <var>24</var>;</td></tr>
<tr><th id="79">79</th><td>	<b>if</b> (<a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_find_mapping" title='irq_find_mapping' data-ref="irq_find_mapping">irq_find_mapping</a>(<a class="local col5 ref" href="#25domain" title='domain' data-ref="25domain">domain</a>, <a class="local col2 ref" href="#32hwirq" title='hwirq' data-ref="32hwirq">hwirq</a>) &gt; <var>0</var>)</td></tr>
<tr><th id="80">80</th><td>		<b>return</b> -<a class="macro" href="../../../../include/uapi/asm-generic/errno-base.h.html#21" title="17" data-ref="_M/EEXIST">EEXIST</a>;</td></tr>
<tr><th id="81">81</th><td></td></tr>
<tr><th id="82">82</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a> = <a class="ref fn" href="../../../../include/linux/slab.h.html#kmalloc" title='kmalloc' data-ref="kmalloc">kmalloc</a>(<b>sizeof</b>(*<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>), <a class="macro" href="../../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="83">83</th><td>	<b>if</b> (!<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>)</td></tr>
<tr><th id="84">84</th><td>		<b>return</b> -<a class="macro" href="../../../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td>	<a class="local col3 ref" href="#33ret" title='ret' data-ref="33ret">ret</a> = <a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_alloc_irqs_parent" title='irq_domain_alloc_irqs_parent' data-ref="irq_domain_alloc_irqs_parent">irq_domain_alloc_irqs_parent</a>(<a class="local col5 ref" href="#25domain" title='domain' data-ref="25domain">domain</a>, <a class="local col6 ref" href="#26virq" title='virq' data-ref="26virq">virq</a>, <a class="local col7 ref" href="#27nr_irqs" title='nr_irqs' data-ref="27nr_irqs">nr_irqs</a>, <a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>);</td></tr>
<tr><th id="87">87</th><td>	<b>if</b> (<a class="local col3 ref" href="#33ret" title='ret' data-ref="33ret">ret</a> &lt; <var>0</var>) {</td></tr>
<tr><th id="88">88</th><td>		<a class="ref fn" href="../../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>);</td></tr>
<tr><th id="89">89</th><td>		<b>return</b> <a class="local col3 ref" href="#33ret" title='ret' data-ref="33ret">ret</a>;</td></tr>
<tr><th id="90">90</th><td>	}</td></tr>
<tr><th id="91">91</th><td></td></tr>
<tr><th id="92">92</th><td>	<i>/* Initialize msg to a value that will never match the first write. */</i></td></tr>
<tr><th id="93">93</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>-&gt;<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_cfg::msg" title='ht_irq_cfg::msg' data-ref="ht_irq_cfg::msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_lo" title='ht_irq_msg::address_lo' data-ref="ht_irq_msg::address_lo">address_lo</a> = <var>0xffffffff</var>;</td></tr>
<tr><th id="94">94</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>-&gt;<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_cfg::msg" title='ht_irq_cfg::msg' data-ref="ht_irq_cfg::msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_hi" title='ht_irq_msg::address_hi' data-ref="ht_irq_msg::address_hi">address_hi</a> = <var>0xffffffff</var>;</td></tr>
<tr><th id="95">95</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>-&gt;<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_cfg::dev" title='ht_irq_cfg::dev' data-ref="ht_irq_cfg::dev">dev</a> = <a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_dev" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_dev' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_dev">ht_dev</a>;</td></tr>
<tr><th id="96">96</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>-&gt;<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_cfg::update" title='ht_irq_cfg::update' data-ref="ht_irq_cfg::update">update</a> = <a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_update" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_update' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_update">ht_update</a>;</td></tr>
<tr><th id="97">97</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>-&gt;<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_cfg::pos" title='ht_irq_cfg::pos' data-ref="ht_irq_cfg::pos">pos</a> = <a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_pos" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_pos' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_pos">ht_pos</a>;</td></tr>
<tr><th id="98">98</th><td>	<a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>-&gt;<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_cfg::idx" title='ht_irq_cfg::idx' data-ref="ht_irq_cfg::idx">idx</a> = <var>0x10</var> + (<a class="local col0 ref" href="#30info" title='info' data-ref="30info">info</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_idx" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_idx' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_idx">ht_idx</a> * <var>2</var>);</td></tr>
<tr><th id="99">99</th><td>	<a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_set_info" title='irq_domain_set_info' data-ref="irq_domain_set_info">irq_domain_set_info</a>(<a class="local col5 ref" href="#25domain" title='domain' data-ref="25domain">domain</a>, <a class="local col6 ref" href="#26virq" title='virq' data-ref="26virq">virq</a>, <a class="local col2 ref" href="#32hwirq" title='hwirq' data-ref="32hwirq">hwirq</a>, &amp;<a class="tu ref" href="#ht_irq_chip" title='ht_irq_chip' data-use='a' data-ref="ht_irq_chip">ht_irq_chip</a>, <a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>,</td></tr>
<tr><th id="100">100</th><td>			    <a class="ref fn" href="../../../../include/linux/irq.h.html#handle_edge_irq" title='handle_edge_irq' data-ref="handle_edge_irq">handle_edge_irq</a>, <a class="local col9 ref" href="#29ht_cfg" title='ht_cfg' data-ref="29ht_cfg">ht_cfg</a>, <q>"edge"</q>);</td></tr>
<tr><th id="101">101</th><td></td></tr>
<tr><th id="102">102</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="103">103</th><td>}</td></tr>
<tr><th id="104">104</th><td></td></tr>
<tr><th id="105">105</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="htirq_domain_free" title='htirq_domain_free' data-type='void htirq_domain_free(struct irq_domain * domain, unsigned int virq, unsigned int nr_irqs)' data-ref="htirq_domain_free">htirq_domain_free</dfn>(<b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain" title='irq_domain' data-ref="irq_domain">irq_domain</a> *<dfn class="local col4 decl" id="34domain" title='domain' data-type='struct irq_domain *' data-ref="34domain">domain</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="35virq" title='virq' data-type='unsigned int' data-ref="35virq">virq</dfn>,</td></tr>
<tr><th id="106">106</th><td>			      <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="36nr_irqs" title='nr_irqs' data-type='unsigned int' data-ref="36nr_irqs">nr_irqs</dfn>)</td></tr>
<tr><th id="107">107</th><td>{</td></tr>
<tr><th id="108">108</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/irq.h.html#irq_data" title='irq_data' data-ref="irq_data">irq_data</a> *<dfn class="local col7 decl" id="37irq_data" title='irq_data' data-type='struct irq_data *' data-ref="37irq_data">irq_data</dfn> = <a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_get_irq_data" title='irq_domain_get_irq_data' data-ref="irq_domain_get_irq_data">irq_domain_get_irq_data</a>(<a class="local col4 ref" href="#34domain" title='domain' data-ref="34domain">domain</a>, <a class="local col5 ref" href="#35virq" title='virq' data-ref="35virq">virq</a>);</td></tr>
<tr><th id="109">109</th><td></td></tr>
<tr><th id="110">110</th><td>	<a class="macro" href="../../../../include/asm-generic/bug.h.html#59" title="do { if (__builtin_expect(!!(nr_irqs != 1), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/home/tempdban/kernel/stable/arch/x86/kernel/apic/htirq.c&quot;), &quot;i&quot; (110), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (56)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col6 ref" href="#36nr_irqs" title='nr_irqs' data-ref="36nr_irqs">nr_irqs</a> != <var>1</var>);</td></tr>
<tr><th id="111">111</th><td>	<a class="ref fn" href="../../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col7 ref" href="#37irq_data" title='irq_data' data-ref="37irq_data">irq_data</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::chip_data" title='irq_data::chip_data' data-ref="irq_data::chip_data">chip_data</a>);</td></tr>
<tr><th id="112">112</th><td>	<a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_free_irqs_top" title='irq_domain_free_irqs_top' data-ref="irq_domain_free_irqs_top">irq_domain_free_irqs_top</a>(<a class="local col4 ref" href="#34domain" title='domain' data-ref="34domain">domain</a>, <a class="local col5 ref" href="#35virq" title='virq' data-ref="35virq">virq</a>, <a class="local col6 ref" href="#36nr_irqs" title='nr_irqs' data-ref="36nr_irqs">nr_irqs</a>);</td></tr>
<tr><th id="113">113</th><td>}</td></tr>
<tr><th id="114">114</th><td></td></tr>
<tr><th id="115">115</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="htirq_domain_activate" title='htirq_domain_activate' data-type='void htirq_domain_activate(struct irq_domain * domain, struct irq_data * irq_data)' data-ref="htirq_domain_activate">htirq_domain_activate</dfn>(<b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain" title='irq_domain' data-ref="irq_domain">irq_domain</a> *<dfn class="local col8 decl" id="38domain" title='domain' data-type='struct irq_domain *' data-ref="38domain">domain</dfn>,</td></tr>
<tr><th id="116">116</th><td>				  <b>struct</b> <a class="type" href="../../../../include/linux/irq.h.html#irq_data" title='irq_data' data-ref="irq_data">irq_data</a> *<dfn class="local col9 decl" id="39irq_data" title='irq_data' data-type='struct irq_data *' data-ref="39irq_data">irq_data</dfn>)</td></tr>
<tr><th id="117">117</th><td>{</td></tr>
<tr><th id="118">118</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/htirq.h.html#ht_irq_msg" title='ht_irq_msg' data-ref="ht_irq_msg">ht_irq_msg</a> <dfn class="local col0 decl" id="40msg" title='msg' data-type='struct ht_irq_msg' data-ref="40msg">msg</dfn>;</td></tr>
<tr><th id="119">119</th><td>	<b>struct</b> <a class="type" href="../../include/asm/hw_irq.h.html#irq_cfg" title='irq_cfg' data-ref="irq_cfg">irq_cfg</a> *<dfn class="local col1 decl" id="41cfg" title='cfg' data-type='struct irq_cfg *' data-ref="41cfg">cfg</dfn> = <a class="ref fn" href="../../include/asm/hw_irq.h.html#irqd_cfg" title='irqd_cfg' data-ref="irqd_cfg">irqd_cfg</a>(<a class="local col9 ref" href="#39irq_data" title='irq_data' data-ref="39irq_data">irq_data</a>);</td></tr>
<tr><th id="120">120</th><td></td></tr>
<tr><th id="121">121</th><td>	<a class="local col0 ref" href="#40msg" title='msg' data-ref="40msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_hi" title='ht_irq_msg::address_hi' data-ref="ht_irq_msg::address_hi">address_hi</a> = <a class="macro" href="../../include/asm/hypertransport.h.html#43" title="((((cfg-&gt;dest_apicid) &gt;&gt; 8) &lt;&lt; 0) &amp; 0x00ffffff)" data-ref="_M/HT_IRQ_HIGH_DEST_ID">HT_IRQ_HIGH_DEST_ID</a>(<a class="local col1 ref" href="#41cfg" title='cfg' data-ref="41cfg">cfg</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_cfg::dest_apicid" title='irq_cfg::dest_apicid' data-ref="irq_cfg::dest_apicid">dest_apicid</a>);</td></tr>
<tr><th id="122">122</th><td>	<a class="local col0 ref" href="#40msg" title='msg' data-ref="40msg">msg</a>.<a class="ref field" href="../../../../include/linux/htirq.h.html#ht_irq_msg::address_lo" title='ht_irq_msg::address_lo' data-ref="ht_irq_msg::address_lo">address_lo</a> =</td></tr>
<tr><th id="123">123</th><td>		<a class="macro" href="../../include/asm/hypertransport.h.html#9" title="0xf8000000" data-ref="_M/HT_IRQ_LOW_BASE">HT_IRQ_LOW_BASE</a> |</td></tr>
<tr><th id="124">124</th><td>		<a class="macro" href="../../include/asm/hypertransport.h.html#18" title="(((cfg-&gt;dest_apicid) &lt;&lt; 8) &amp; 0x0000ff00)" data-ref="_M/HT_IRQ_LOW_DEST_ID">HT_IRQ_LOW_DEST_ID</a>(<a class="local col1 ref" href="#41cfg" title='cfg' data-ref="41cfg">cfg</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_cfg::dest_apicid" title='irq_cfg::dest_apicid' data-ref="irq_cfg::dest_apicid">dest_apicid</a>) |</td></tr>
<tr><th id="125">125</th><td>		<a class="macro" href="../../include/asm/hypertransport.h.html#13" title="(((cfg-&gt;vector) &lt;&lt; 16) &amp; 0x00ff0000)" data-ref="_M/HT_IRQ_LOW_VECTOR">HT_IRQ_LOW_VECTOR</a>(<a class="local col1 ref" href="#41cfg" title='cfg' data-ref="41cfg">cfg</a>-&gt;<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_cfg::vector" title='irq_cfg::vector' data-ref="irq_cfg::vector">vector</a>) |</td></tr>
<tr><th id="126">126</th><td>		((<a class="ref" href="../../include/asm/apic.h.html#apic" title='apic' data-ref="apic">apic</a>-&gt;<a class="ref field" href="../../include/asm/apic.h.html#apic::irq_dest_mode" title='apic::irq_dest_mode' data-ref="apic::irq_dest_mode">irq_dest_mode</a> == <var>0</var>) ?</td></tr>
<tr><th id="127">127</th><td>			<a class="macro" href="../../include/asm/hypertransport.h.html#21" title="0x0000000" data-ref="_M/HT_IRQ_LOW_DM_PHYSICAL">HT_IRQ_LOW_DM_PHYSICAL</a> :</td></tr>
<tr><th id="128">128</th><td>			<a class="macro" href="../../include/asm/hypertransport.h.html#22" title="0x0000040" data-ref="_M/HT_IRQ_LOW_DM_LOGICAL">HT_IRQ_LOW_DM_LOGICAL</a>) |</td></tr>
<tr><th id="129">129</th><td>		<a class="macro" href="../../include/asm/hypertransport.h.html#24" title="0x0000000" data-ref="_M/HT_IRQ_LOW_RQEOI_EDGE">HT_IRQ_LOW_RQEOI_EDGE</a> |</td></tr>
<tr><th id="130">130</th><td>		((<a class="ref" href="../../include/asm/apic.h.html#apic" title='apic' data-ref="apic">apic</a>-&gt;<a class="ref field" href="../../include/asm/apic.h.html#apic::irq_delivery_mode" title='apic::irq_delivery_mode' data-ref="apic::irq_delivery_mode">irq_delivery_mode</a> != <a class="enum" href="../../include/asm/apicdef.h.html#dest_LowestPrio" title='dest_LowestPrio' data-ref="dest_LowestPrio">dest_LowestPrio</a>) ?</td></tr>
<tr><th id="131">131</th><td>			<a class="macro" href="../../include/asm/hypertransport.h.html#28" title="0x0000000" data-ref="_M/HT_IRQ_LOW_MT_FIXED">HT_IRQ_LOW_MT_FIXED</a> :</td></tr>
<tr><th id="132">132</th><td>			<a class="macro" href="../../include/asm/hypertransport.h.html#29" title="0x0000004" data-ref="_M/HT_IRQ_LOW_MT_ARBITRATED">HT_IRQ_LOW_MT_ARBITRATED</a>) |</td></tr>
<tr><th id="133">133</th><td>		<a class="macro" href="../../include/asm/hypertransport.h.html#38" title="0x0000001" data-ref="_M/HT_IRQ_LOW_IRQ_MASKED">HT_IRQ_LOW_IRQ_MASKED</a>;</td></tr>
<tr><th id="134">134</th><td>	<a class="ref fn" href="../../../../include/linux/htirq.h.html#write_ht_irq_msg" title='write_ht_irq_msg' data-ref="write_ht_irq_msg">write_ht_irq_msg</a>(<a class="local col9 ref" href="#39irq_data" title='irq_data' data-ref="39irq_data">irq_data</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::irq" title='irq_data::irq' data-ref="irq_data::irq">irq</a>, &amp;<a class="local col0 ref" href="#40msg" title='msg' data-ref="40msg">msg</a>);</td></tr>
<tr><th id="135">135</th><td>}</td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="htirq_domain_deactivate" title='htirq_domain_deactivate' data-type='void htirq_domain_deactivate(struct irq_domain * domain, struct irq_data * irq_data)' data-ref="htirq_domain_deactivate">htirq_domain_deactivate</dfn>(<b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain" title='irq_domain' data-ref="irq_domain">irq_domain</a> *<dfn class="local col2 decl" id="42domain" title='domain' data-type='struct irq_domain *' data-ref="42domain">domain</dfn>,</td></tr>
<tr><th id="138">138</th><td>				    <b>struct</b> <a class="type" href="../../../../include/linux/irq.h.html#irq_data" title='irq_data' data-ref="irq_data">irq_data</a> *<dfn class="local col3 decl" id="43irq_data" title='irq_data' data-type='struct irq_data *' data-ref="43irq_data">irq_data</dfn>)</td></tr>
<tr><th id="139">139</th><td>{</td></tr>
<tr><th id="140">140</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/htirq.h.html#ht_irq_msg" title='ht_irq_msg' data-ref="ht_irq_msg">ht_irq_msg</a> <dfn class="local col4 decl" id="44msg" title='msg' data-type='struct ht_irq_msg' data-ref="44msg">msg</dfn>;</td></tr>
<tr><th id="141">141</th><td></td></tr>
<tr><th id="142">142</th><td>	<a class="ref fn" href="../../include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(&amp;<a class="local col4 ref" href="#44msg" title='msg' data-ref="44msg">msg</a>, <var>0</var>, <b>sizeof</b>(<a class="local col4 ref" href="#44msg" title='msg' data-ref="44msg">msg</a>));</td></tr>
<tr><th id="143">143</th><td>	<a class="ref fn" href="../../../../include/linux/htirq.h.html#write_ht_irq_msg" title='write_ht_irq_msg' data-ref="write_ht_irq_msg">write_ht_irq_msg</a>(<a class="local col3 ref" href="#43irq_data" title='irq_data' data-ref="43irq_data">irq_data</a>-&gt;<a class="ref field" href="../../../../include/linux/irq.h.html#irq_data::irq" title='irq_data::irq' data-ref="irq_data::irq">irq</a>, &amp;<a class="local col4 ref" href="#44msg" title='msg' data-ref="44msg">msg</a>);</td></tr>
<tr><th id="144">144</th><td>}</td></tr>
<tr><th id="145">145</th><td></td></tr>
<tr><th id="146">146</th><td><em>static</em> <em>const</em> <b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain_ops" title='irq_domain_ops' data-ref="irq_domain_ops">irq_domain_ops</a> <dfn class="tu decl def" id="htirq_domain_ops" title='htirq_domain_ops' data-type='const struct irq_domain_ops' data-ref="htirq_domain_ops">htirq_domain_ops</dfn> = {</td></tr>
<tr><th id="147">147</th><td>	.<a class="ref field" href="../../../../include/linux/irqdomain.h.html#irq_domain_ops::alloc" title='irq_domain_ops::alloc' data-ref="irq_domain_ops::alloc">alloc</a>		= <a class="tu ref fn" href="#htirq_domain_alloc" title='htirq_domain_alloc' data-ref="htirq_domain_alloc">htirq_domain_alloc</a>,</td></tr>
<tr><th id="148">148</th><td>	.<a class="ref field" href="../../../../include/linux/irqdomain.h.html#irq_domain_ops::free" title='irq_domain_ops::free' data-ref="irq_domain_ops::free">free</a>		= <a class="tu ref fn" href="#htirq_domain_free" title='htirq_domain_free' data-ref="htirq_domain_free">htirq_domain_free</a>,</td></tr>
<tr><th id="149">149</th><td>	.<a class="ref field" href="../../../../include/linux/irqdomain.h.html#irq_domain_ops::activate" title='irq_domain_ops::activate' data-ref="irq_domain_ops::activate">activate</a>	= <a class="tu ref fn" href="#htirq_domain_activate" title='htirq_domain_activate' data-ref="htirq_domain_activate">htirq_domain_activate</a>,</td></tr>
<tr><th id="150">150</th><td>	.<a class="ref field" href="../../../../include/linux/irqdomain.h.html#irq_domain_ops::deactivate" title='irq_domain_ops::deactivate' data-ref="irq_domain_ops::deactivate">deactivate</a>	= <a class="tu ref fn" href="#htirq_domain_deactivate" title='htirq_domain_deactivate' data-ref="htirq_domain_deactivate">htirq_domain_deactivate</a>,</td></tr>
<tr><th id="151">151</th><td>};</td></tr>
<tr><th id="152">152</th><td></td></tr>
<tr><th id="153">153</th><td><em>void</em> <a class="macro" href="../../../../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="decl def fn" id="arch_init_htirq_domain" title='arch_init_htirq_domain' data-ref="arch_init_htirq_domain">arch_init_htirq_domain</dfn>(<b>struct</b> <a class="type" href="../../../../include/linux/irqdomain.h.html#irq_domain" title='irq_domain' data-ref="irq_domain">irq_domain</a> *<dfn class="local col5 decl" id="45parent" title='parent' data-type='struct irq_domain *' data-ref="45parent">parent</dfn>)</td></tr>
<tr><th id="154">154</th><td>{</td></tr>
<tr><th id="155">155</th><td>	<b>struct</b> <a class="type" href="../../../../include/linux/fwnode.h.html#fwnode_handle" title='fwnode_handle' data-ref="fwnode_handle">fwnode_handle</a> *<dfn class="local col6 decl" id="46fn" title='fn' data-type='struct fwnode_handle *' data-ref="46fn">fn</dfn>;</td></tr>
<tr><th id="156">156</th><td></td></tr>
<tr><th id="157">157</th><td>	<b>if</b> (<a class="ref" href="../../include/asm/apic.h.html#disable_apic" title='disable_apic' data-ref="disable_apic">disable_apic</a>)</td></tr>
<tr><th id="158">158</th><td>		<b>return</b>;</td></tr>
<tr><th id="159">159</th><td></td></tr>
<tr><th id="160">160</th><td>	<a class="local col6 ref" href="#46fn" title='fn' data-ref="46fn">fn</a> = <a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_alloc_named_fwnode" title='irq_domain_alloc_named_fwnode' data-ref="irq_domain_alloc_named_fwnode">irq_domain_alloc_named_fwnode</a>(<q>"PCI-HT"</q>);</td></tr>
<tr><th id="161">161</th><td>	<b>if</b> (!<a class="local col6 ref" href="#46fn" title='fn' data-ref="46fn">fn</a>)</td></tr>
<tr><th id="162">162</th><td>		<b>goto</b> <a class="lbl" href="#47warn" data-ref="47warn">warn</a>;</td></tr>
<tr><th id="163">163</th><td></td></tr>
<tr><th id="164">164</th><td>	<a class="tu ref" href="#htirq_domain" title='htirq_domain' data-use='w' data-ref="htirq_domain">htirq_domain</a> = <a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_create_tree" title='irq_domain_create_tree' data-ref="irq_domain_create_tree">irq_domain_create_tree</a>(<a class="local col6 ref" href="#46fn" title='fn' data-ref="46fn">fn</a>, &amp;<a class="tu ref" href="#htirq_domain_ops" title='htirq_domain_ops' data-use='a' data-ref="htirq_domain_ops">htirq_domain_ops</a>, <a class="macro" href="../../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="165">165</th><td>	<a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_free_fwnode" title='irq_domain_free_fwnode' data-ref="irq_domain_free_fwnode">irq_domain_free_fwnode</a>(<a class="local col6 ref" href="#46fn" title='fn' data-ref="46fn">fn</a>);</td></tr>
<tr><th id="166">166</th><td>	<b>if</b> (!<a class="tu ref" href="#htirq_domain" title='htirq_domain' data-use='r' data-ref="htirq_domain">htirq_domain</a>)</td></tr>
<tr><th id="167">167</th><td>		<b>goto</b> <a class="lbl" href="#47warn" data-ref="47warn">warn</a>;</td></tr>
<tr><th id="168">168</th><td></td></tr>
<tr><th id="169">169</th><td>	<a class="tu ref" href="#htirq_domain" title='htirq_domain' data-use='r' data-ref="htirq_domain">htirq_domain</a>-&gt;<a class="ref field" href="../../../../include/linux/irqdomain.h.html#irq_domain::parent" title='irq_domain::parent' data-ref="irq_domain::parent">parent</a> = <a class="local col5 ref" href="#45parent" title='parent' data-ref="45parent">parent</a>;</td></tr>
<tr><th id="170">170</th><td>	<b>return</b>;</td></tr>
<tr><th id="171">171</th><td></td></tr>
<tr><th id="172">172</th><td><dfn class="lbl" id="47warn" data-ref="47warn">warn</dfn>:</td></tr>
<tr><th id="173">173</th><td>	<a class="macro" href="../../../../include/linux/printk.h.html#305" title="pr_warning" data-ref="_M/pr_warn">pr_warn</a>(<q>"Failed to initialize irqdomain for HTIRQ.\n"</q>);</td></tr>
<tr><th id="174">174</th><td>}</td></tr>
<tr><th id="175">175</th><td></td></tr>
<tr><th id="176">176</th><td><em>int</em> <dfn class="decl def fn" id="arch_setup_ht_irq" title='arch_setup_ht_irq' data-ref="arch_setup_ht_irq">arch_setup_ht_irq</dfn>(<em>int</em> <dfn class="local col8 decl" id="48idx" title='idx' data-type='int' data-ref="48idx">idx</dfn>, <em>int</em> <dfn class="local col9 decl" id="49pos" title='pos' data-type='int' data-ref="49pos">pos</dfn>, <b>struct</b> <a class="type" href="../../../../include/linux/pci.h.html#pci_dev" title='pci_dev' data-ref="pci_dev">pci_dev</a> *<dfn class="local col0 decl" id="50dev" title='dev' data-type='struct pci_dev *' data-ref="50dev">dev</dfn>,</td></tr>
<tr><th id="177">177</th><td>		      <a class="typedef" href="../../../../include/linux/htirq.h.html#ht_irq_update_t" title='ht_irq_update_t' data-type='void (struct pci_dev *, int, struct ht_irq_msg *)' data-ref="ht_irq_update_t">ht_irq_update_t</a> *<dfn class="local col1 decl" id="51update" title='update' data-type='ht_irq_update_t *' data-ref="51update">update</dfn>)</td></tr>
<tr><th id="178">178</th><td>{</td></tr>
<tr><th id="179">179</th><td>	<b>struct</b> <a class="type" href="../../include/asm/hw_irq.h.html#irq_alloc_info" title='irq_alloc_info' data-ref="irq_alloc_info">irq_alloc_info</a> <dfn class="local col2 decl" id="52info" title='info' data-type='struct irq_alloc_info' data-ref="52info">info</dfn>;</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td>	<b>if</b> (!<a class="tu ref" href="#htirq_domain" title='htirq_domain' data-use='r' data-ref="htirq_domain">htirq_domain</a>)</td></tr>
<tr><th id="182">182</th><td>		<b>return</b> -<a class="macro" href="../../../../include/uapi/asm-generic/errno.h.html#18" title="38" data-ref="_M/ENOSYS">ENOSYS</a>;</td></tr>
<tr><th id="183">183</th><td></td></tr>
<tr><th id="184">184</th><td>	<a class="ref fn" href="../../include/asm/irqdomain.h.html#init_irq_alloc_info" title='init_irq_alloc_info' data-ref="init_irq_alloc_info">init_irq_alloc_info</a>(&amp;<a class="local col2 ref" href="#52info" title='info' data-ref="52info">info</a>, <a class="macro" href="../../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="185">185</th><td>	<a class="local col2 ref" href="#52info" title='info' data-ref="52info">info</a>.<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_idx" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_idx' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_idx">ht_idx</a> = <a class="local col8 ref" href="#48idx" title='idx' data-ref="48idx">idx</a>;</td></tr>
<tr><th id="186">186</th><td>	<a class="local col2 ref" href="#52info" title='info' data-ref="52info">info</a>.<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_pos" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_pos' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_pos">ht_pos</a> = <a class="local col9 ref" href="#49pos" title='pos' data-ref="49pos">pos</a>;</td></tr>
<tr><th id="187">187</th><td>	<a class="local col2 ref" href="#52info" title='info' data-ref="52info">info</a>.<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_dev" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_dev' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_dev">ht_dev</a> = <a class="local col0 ref" href="#50dev" title='dev' data-ref="50dev">dev</a>;</td></tr>
<tr><th id="188">188</th><td>	<a class="local col2 ref" href="#52info" title='info' data-ref="52info">info</a>.<a class="ref field" href="../../include/asm/hw_irq.h.html#irq_alloc_info::(anonymousunion)::(anonymous)::ht_update" title='irq_alloc_info::(anonymous union)::(anonymous struct)::ht_update' data-ref="irq_alloc_info::(anonymousunion)::(anonymous)::ht_update">ht_update</a> = <a class="local col1 ref" href="#51update" title='update' data-ref="51update">update</a>;</td></tr>
<tr><th id="189">189</th><td></td></tr>
<tr><th id="190">190</th><td>	<b>return</b> <a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_alloc_irqs" title='irq_domain_alloc_irqs' data-ref="irq_domain_alloc_irqs">irq_domain_alloc_irqs</a>(<a class="tu ref" href="#htirq_domain" title='htirq_domain' data-use='r' data-ref="htirq_domain">htirq_domain</a>, <var>1</var>, <a class="ref fn" href="../../../../include/linux/device.h.html#dev_to_node" title='dev_to_node' data-ref="dev_to_node">dev_to_node</a>(&amp;<a class="local col0 ref" href="#50dev" title='dev' data-ref="50dev">dev</a>-&gt;<a class="ref field" href="../../../../include/linux/pci.h.html#pci_dev::dev" title='pci_dev::dev' data-ref="pci_dev::dev">dev</a>),</td></tr>
<tr><th id="191">191</th><td>				     &amp;<a class="local col2 ref" href="#52info" title='info' data-ref="52info">info</a>);</td></tr>
<tr><th id="192">192</th><td>}</td></tr>
<tr><th id="193">193</th><td></td></tr>
<tr><th id="194">194</th><td><em>void</em> <dfn class="decl def fn" id="arch_teardown_ht_irq" title='arch_teardown_ht_irq' data-ref="arch_teardown_ht_irq">arch_teardown_ht_irq</dfn>(<em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="53irq" title='irq' data-type='unsigned int' data-ref="53irq">irq</dfn>)</td></tr>
<tr><th id="195">195</th><td>{</td></tr>
<tr><th id="196">196</th><td>	<a class="ref fn" href="../../../../include/linux/irqdomain.h.html#irq_domain_free_irqs" title='irq_domain_free_irqs' data-ref="irq_domain_free_irqs">irq_domain_free_irqs</a>(<a class="local col3 ref" href="#53irq" title='irq' data-ref="53irq">irq</a>, <var>1</var>);</td></tr>
<tr><th id="197">197</th><td>}</td></tr>
<tr><th id="198">198</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Aug-03</em> from project linux-4.14.y revision <em>linux-4.14.y</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
