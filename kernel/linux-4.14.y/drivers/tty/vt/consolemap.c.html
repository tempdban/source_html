<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>consolemap.c source code [linux-4.14.y/drivers/tty/vt/consolemap.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="uni_pagedir "/>
<link rel="stylesheet" href="../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux-4.14.y/drivers/tty/vt/consolemap.c'; var root_path = '../../../..'; var data_path = '../../../../../data';</script>
<script src='../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../..'>linux-4.14.y</a>/<a href='../..'>drivers</a>/<a href='..'>tty</a>/<a href='./'>vt</a>/<a href='consolemap.c.html'>consolemap.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * consolemap.c</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Mapping from internal code (such as Latin-1 or Unicode or IBM PC code)</i></td></tr>
<tr><th id="5">5</th><td><i> * to font positions.</i></td></tr>
<tr><th id="6">6</th><td><i> *</i></td></tr>
<tr><th id="7">7</th><td><i> * aeb, 950210</i></td></tr>
<tr><th id="8">8</th><td><i> *</i></td></tr>
<tr><th id="9">9</th><td><i> * Support for multiple unimaps by Jakub Jelinek &lt;jj@ultra.linux.cz&gt;, July 1998</i></td></tr>
<tr><th id="10">10</th><td><i> *</i></td></tr>
<tr><th id="11">11</th><td><i> * Fix bug in inverse translation. Stanislav Voronyi &lt;stas@cnti.uanet.kharkov.ua&gt;, Dec 1998</i></td></tr>
<tr><th id="12">12</th><td><i> *</i></td></tr>
<tr><th id="13">13</th><td><i> * In order to prevent the following circular lock dependency:</i></td></tr>
<tr><th id="14">14</th><td><i> *   &amp;mm-&gt;mmap_sem --&gt; cpu_hotplug.lock --&gt; console_lock --&gt; &amp;mm-&gt;mmap_sem</i></td></tr>
<tr><th id="15">15</th><td><i> *</i></td></tr>
<tr><th id="16">16</th><td><i> * We cannot allow page fault to happen while holding the console_lock.</i></td></tr>
<tr><th id="17">17</th><td><i> * Therefore, all the userspace copy operations have to be done outside</i></td></tr>
<tr><th id="18">18</th><td><i> * the console_lock critical sections.</i></td></tr>
<tr><th id="19">19</th><td><i> *</i></td></tr>
<tr><th id="20">20</th><td><i> * As all the affected functions are all called directly from vt_ioctl(), we</i></td></tr>
<tr><th id="21">21</th><td><i> * can allocate some small buffers directly on stack without worrying about</i></td></tr>
<tr><th id="22">22</th><td><i> * stack overflow.</i></td></tr>
<tr><th id="23">23</th><td><i> */</i></td></tr>
<tr><th id="24">24</th><td></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../../include/linux/module.h.html">&lt;linux/module.h&gt;</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../../include/linux/kd.h.html">&lt;linux/kd.h&gt;</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../../../include/linux/errno.h.html">&lt;linux/errno.h&gt;</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../../../include/linux/mm.h.html">&lt;linux/mm.h&gt;</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../../../include/linux/slab.h.html">&lt;linux/slab.h&gt;</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../../../include/linux/init.h.html">&lt;linux/init.h&gt;</a></u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../../../include/linux/tty.h.html">&lt;linux/tty.h&gt;</a></u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="../../../include/linux/uaccess.h.html">&lt;linux/uaccess.h&gt;</a></u></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="../../../include/linux/console.h.html">&lt;linux/console.h&gt;</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../../../include/linux/consolemap.h.html">&lt;linux/consolemap.h&gt;</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="../../../include/linux/vt_kern.h.html">&lt;linux/vt_kern.h&gt;</a></u></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="../../../include/linux/string.h.html">&lt;linux/string.h&gt;</a></u></td></tr>
<tr><th id="37">37</th><td></td></tr>
<tr><th id="38">38</th><td><em>static</em> <em>unsigned</em> <em>short</em> <dfn class="tu decl def" id="translations" title='translations' data-type='unsigned short [4][256]' data-ref="translations">translations</dfn>[][<var>256</var>] = {</td></tr>
<tr><th id="39">39</th><td>  <i>/* 8-bit Latin-1 mapped to Unicode -- trivial mapping */</i></td></tr>
<tr><th id="40">40</th><td>  {</td></tr>
<tr><th id="41">41</th><td>    <var>0x0000</var>, <var>0x0001</var>, <var>0x0002</var>, <var>0x0003</var>, <var>0x0004</var>, <var>0x0005</var>, <var>0x0006</var>, <var>0x0007</var>,</td></tr>
<tr><th id="42">42</th><td>    <var>0x0008</var>, <var>0x0009</var>, <var>0x000a</var>, <var>0x000b</var>, <var>0x000c</var>, <var>0x000d</var>, <var>0x000e</var>, <var>0x000f</var>,</td></tr>
<tr><th id="43">43</th><td>    <var>0x0010</var>, <var>0x0011</var>, <var>0x0012</var>, <var>0x0013</var>, <var>0x0014</var>, <var>0x0015</var>, <var>0x0016</var>, <var>0x0017</var>,</td></tr>
<tr><th id="44">44</th><td>    <var>0x0018</var>, <var>0x0019</var>, <var>0x001a</var>, <var>0x001b</var>, <var>0x001c</var>, <var>0x001d</var>, <var>0x001e</var>, <var>0x001f</var>,</td></tr>
<tr><th id="45">45</th><td>    <var>0x0020</var>, <var>0x0021</var>, <var>0x0022</var>, <var>0x0023</var>, <var>0x0024</var>, <var>0x0025</var>, <var>0x0026</var>, <var>0x0027</var>,</td></tr>
<tr><th id="46">46</th><td>    <var>0x0028</var>, <var>0x0029</var>, <var>0x002a</var>, <var>0x002b</var>, <var>0x002c</var>, <var>0x002d</var>, <var>0x002e</var>, <var>0x002f</var>,</td></tr>
<tr><th id="47">47</th><td>    <var>0x0030</var>, <var>0x0031</var>, <var>0x0032</var>, <var>0x0033</var>, <var>0x0034</var>, <var>0x0035</var>, <var>0x0036</var>, <var>0x0037</var>,</td></tr>
<tr><th id="48">48</th><td>    <var>0x0038</var>, <var>0x0039</var>, <var>0x003a</var>, <var>0x003b</var>, <var>0x003c</var>, <var>0x003d</var>, <var>0x003e</var>, <var>0x003f</var>,</td></tr>
<tr><th id="49">49</th><td>    <var>0x0040</var>, <var>0x0041</var>, <var>0x0042</var>, <var>0x0043</var>, <var>0x0044</var>, <var>0x0045</var>, <var>0x0046</var>, <var>0x0047</var>,</td></tr>
<tr><th id="50">50</th><td>    <var>0x0048</var>, <var>0x0049</var>, <var>0x004a</var>, <var>0x004b</var>, <var>0x004c</var>, <var>0x004d</var>, <var>0x004e</var>, <var>0x004f</var>,</td></tr>
<tr><th id="51">51</th><td>    <var>0x0050</var>, <var>0x0051</var>, <var>0x0052</var>, <var>0x0053</var>, <var>0x0054</var>, <var>0x0055</var>, <var>0x0056</var>, <var>0x0057</var>,</td></tr>
<tr><th id="52">52</th><td>    <var>0x0058</var>, <var>0x0059</var>, <var>0x005a</var>, <var>0x005b</var>, <var>0x005c</var>, <var>0x005d</var>, <var>0x005e</var>, <var>0x005f</var>,</td></tr>
<tr><th id="53">53</th><td>    <var>0x0060</var>, <var>0x0061</var>, <var>0x0062</var>, <var>0x0063</var>, <var>0x0064</var>, <var>0x0065</var>, <var>0x0066</var>, <var>0x0067</var>,</td></tr>
<tr><th id="54">54</th><td>    <var>0x0068</var>, <var>0x0069</var>, <var>0x006a</var>, <var>0x006b</var>, <var>0x006c</var>, <var>0x006d</var>, <var>0x006e</var>, <var>0x006f</var>,</td></tr>
<tr><th id="55">55</th><td>    <var>0x0070</var>, <var>0x0071</var>, <var>0x0072</var>, <var>0x0073</var>, <var>0x0074</var>, <var>0x0075</var>, <var>0x0076</var>, <var>0x0077</var>,</td></tr>
<tr><th id="56">56</th><td>    <var>0x0078</var>, <var>0x0079</var>, <var>0x007a</var>, <var>0x007b</var>, <var>0x007c</var>, <var>0x007d</var>, <var>0x007e</var>, <var>0x007f</var>,</td></tr>
<tr><th id="57">57</th><td>    <var>0x0080</var>, <var>0x0081</var>, <var>0x0082</var>, <var>0x0083</var>, <var>0x0084</var>, <var>0x0085</var>, <var>0x0086</var>, <var>0x0087</var>,</td></tr>
<tr><th id="58">58</th><td>    <var>0x0088</var>, <var>0x0089</var>, <var>0x008a</var>, <var>0x008b</var>, <var>0x008c</var>, <var>0x008d</var>, <var>0x008e</var>, <var>0x008f</var>,</td></tr>
<tr><th id="59">59</th><td>    <var>0x0090</var>, <var>0x0091</var>, <var>0x0092</var>, <var>0x0093</var>, <var>0x0094</var>, <var>0x0095</var>, <var>0x0096</var>, <var>0x0097</var>,</td></tr>
<tr><th id="60">60</th><td>    <var>0x0098</var>, <var>0x0099</var>, <var>0x009a</var>, <var>0x009b</var>, <var>0x009c</var>, <var>0x009d</var>, <var>0x009e</var>, <var>0x009f</var>,</td></tr>
<tr><th id="61">61</th><td>    <var>0x00a0</var>, <var>0x00a1</var>, <var>0x00a2</var>, <var>0x00a3</var>, <var>0x00a4</var>, <var>0x00a5</var>, <var>0x00a6</var>, <var>0x00a7</var>,</td></tr>
<tr><th id="62">62</th><td>    <var>0x00a8</var>, <var>0x00a9</var>, <var>0x00aa</var>, <var>0x00ab</var>, <var>0x00ac</var>, <var>0x00ad</var>, <var>0x00ae</var>, <var>0x00af</var>,</td></tr>
<tr><th id="63">63</th><td>    <var>0x00b0</var>, <var>0x00b1</var>, <var>0x00b2</var>, <var>0x00b3</var>, <var>0x00b4</var>, <var>0x00b5</var>, <var>0x00b6</var>, <var>0x00b7</var>,</td></tr>
<tr><th id="64">64</th><td>    <var>0x00b8</var>, <var>0x00b9</var>, <var>0x00ba</var>, <var>0x00bb</var>, <var>0x00bc</var>, <var>0x00bd</var>, <var>0x00be</var>, <var>0x00bf</var>,</td></tr>
<tr><th id="65">65</th><td>    <var>0x00c0</var>, <var>0x00c1</var>, <var>0x00c2</var>, <var>0x00c3</var>, <var>0x00c4</var>, <var>0x00c5</var>, <var>0x00c6</var>, <var>0x00c7</var>,</td></tr>
<tr><th id="66">66</th><td>    <var>0x00c8</var>, <var>0x00c9</var>, <var>0x00ca</var>, <var>0x00cb</var>, <var>0x00cc</var>, <var>0x00cd</var>, <var>0x00ce</var>, <var>0x00cf</var>,</td></tr>
<tr><th id="67">67</th><td>    <var>0x00d0</var>, <var>0x00d1</var>, <var>0x00d2</var>, <var>0x00d3</var>, <var>0x00d4</var>, <var>0x00d5</var>, <var>0x00d6</var>, <var>0x00d7</var>,</td></tr>
<tr><th id="68">68</th><td>    <var>0x00d8</var>, <var>0x00d9</var>, <var>0x00da</var>, <var>0x00db</var>, <var>0x00dc</var>, <var>0x00dd</var>, <var>0x00de</var>, <var>0x00df</var>,</td></tr>
<tr><th id="69">69</th><td>    <var>0x00e0</var>, <var>0x00e1</var>, <var>0x00e2</var>, <var>0x00e3</var>, <var>0x00e4</var>, <var>0x00e5</var>, <var>0x00e6</var>, <var>0x00e7</var>,</td></tr>
<tr><th id="70">70</th><td>    <var>0x00e8</var>, <var>0x00e9</var>, <var>0x00ea</var>, <var>0x00eb</var>, <var>0x00ec</var>, <var>0x00ed</var>, <var>0x00ee</var>, <var>0x00ef</var>,</td></tr>
<tr><th id="71">71</th><td>    <var>0x00f0</var>, <var>0x00f1</var>, <var>0x00f2</var>, <var>0x00f3</var>, <var>0x00f4</var>, <var>0x00f5</var>, <var>0x00f6</var>, <var>0x00f7</var>,</td></tr>
<tr><th id="72">72</th><td>    <var>0x00f8</var>, <var>0x00f9</var>, <var>0x00fa</var>, <var>0x00fb</var>, <var>0x00fc</var>, <var>0x00fd</var>, <var>0x00fe</var>, <var>0x00ff</var></td></tr>
<tr><th id="73">73</th><td>  }, </td></tr>
<tr><th id="74">74</th><td>  <i>/* VT100 graphics mapped to Unicode */</i></td></tr>
<tr><th id="75">75</th><td>  {</td></tr>
<tr><th id="76">76</th><td>    <var>0x0000</var>, <var>0x0001</var>, <var>0x0002</var>, <var>0x0003</var>, <var>0x0004</var>, <var>0x0005</var>, <var>0x0006</var>, <var>0x0007</var>,</td></tr>
<tr><th id="77">77</th><td>    <var>0x0008</var>, <var>0x0009</var>, <var>0x000a</var>, <var>0x000b</var>, <var>0x000c</var>, <var>0x000d</var>, <var>0x000e</var>, <var>0x000f</var>,</td></tr>
<tr><th id="78">78</th><td>    <var>0x0010</var>, <var>0x0011</var>, <var>0x0012</var>, <var>0x0013</var>, <var>0x0014</var>, <var>0x0015</var>, <var>0x0016</var>, <var>0x0017</var>,</td></tr>
<tr><th id="79">79</th><td>    <var>0x0018</var>, <var>0x0019</var>, <var>0x001a</var>, <var>0x001b</var>, <var>0x001c</var>, <var>0x001d</var>, <var>0x001e</var>, <var>0x001f</var>,</td></tr>
<tr><th id="80">80</th><td>    <var>0x0020</var>, <var>0x0021</var>, <var>0x0022</var>, <var>0x0023</var>, <var>0x0024</var>, <var>0x0025</var>, <var>0x0026</var>, <var>0x0027</var>,</td></tr>
<tr><th id="81">81</th><td>    <var>0x0028</var>, <var>0x0029</var>, <var>0x002a</var>, <var>0x2192</var>, <var>0x2190</var>, <var>0x2191</var>, <var>0x2193</var>, <var>0x002f</var>,</td></tr>
<tr><th id="82">82</th><td>    <var>0x2588</var>, <var>0x0031</var>, <var>0x0032</var>, <var>0x0033</var>, <var>0x0034</var>, <var>0x0035</var>, <var>0x0036</var>, <var>0x0037</var>,</td></tr>
<tr><th id="83">83</th><td>    <var>0x0038</var>, <var>0x0039</var>, <var>0x003a</var>, <var>0x003b</var>, <var>0x003c</var>, <var>0x003d</var>, <var>0x003e</var>, <var>0x003f</var>,</td></tr>
<tr><th id="84">84</th><td>    <var>0x0040</var>, <var>0x0041</var>, <var>0x0042</var>, <var>0x0043</var>, <var>0x0044</var>, <var>0x0045</var>, <var>0x0046</var>, <var>0x0047</var>,</td></tr>
<tr><th id="85">85</th><td>    <var>0x0048</var>, <var>0x0049</var>, <var>0x004a</var>, <var>0x004b</var>, <var>0x004c</var>, <var>0x004d</var>, <var>0x004e</var>, <var>0x004f</var>,</td></tr>
<tr><th id="86">86</th><td>    <var>0x0050</var>, <var>0x0051</var>, <var>0x0052</var>, <var>0x0053</var>, <var>0x0054</var>, <var>0x0055</var>, <var>0x0056</var>, <var>0x0057</var>,</td></tr>
<tr><th id="87">87</th><td>    <var>0x0058</var>, <var>0x0059</var>, <var>0x005a</var>, <var>0x005b</var>, <var>0x005c</var>, <var>0x005d</var>, <var>0x005e</var>, <var>0x00a0</var>,</td></tr>
<tr><th id="88">88</th><td>    <var>0x25c6</var>, <var>0x2592</var>, <var>0x2409</var>, <var>0x240c</var>, <var>0x240d</var>, <var>0x240a</var>, <var>0x00b0</var>, <var>0x00b1</var>,</td></tr>
<tr><th id="89">89</th><td>    <var>0x2591</var>, <var>0x240b</var>, <var>0x2518</var>, <var>0x2510</var>, <var>0x250c</var>, <var>0x2514</var>, <var>0x253c</var>, <var>0x23ba</var>,</td></tr>
<tr><th id="90">90</th><td>    <var>0x23bb</var>, <var>0x2500</var>, <var>0x23bc</var>, <var>0x23bd</var>, <var>0x251c</var>, <var>0x2524</var>, <var>0x2534</var>, <var>0x252c</var>,</td></tr>
<tr><th id="91">91</th><td>    <var>0x2502</var>, <var>0x2264</var>, <var>0x2265</var>, <var>0x03c0</var>, <var>0x2260</var>, <var>0x00a3</var>, <var>0x00b7</var>, <var>0x007f</var>,</td></tr>
<tr><th id="92">92</th><td>    <var>0x0080</var>, <var>0x0081</var>, <var>0x0082</var>, <var>0x0083</var>, <var>0x0084</var>, <var>0x0085</var>, <var>0x0086</var>, <var>0x0087</var>,</td></tr>
<tr><th id="93">93</th><td>    <var>0x0088</var>, <var>0x0089</var>, <var>0x008a</var>, <var>0x008b</var>, <var>0x008c</var>, <var>0x008d</var>, <var>0x008e</var>, <var>0x008f</var>,</td></tr>
<tr><th id="94">94</th><td>    <var>0x0090</var>, <var>0x0091</var>, <var>0x0092</var>, <var>0x0093</var>, <var>0x0094</var>, <var>0x0095</var>, <var>0x0096</var>, <var>0x0097</var>,</td></tr>
<tr><th id="95">95</th><td>    <var>0x0098</var>, <var>0x0099</var>, <var>0x009a</var>, <var>0x009b</var>, <var>0x009c</var>, <var>0x009d</var>, <var>0x009e</var>, <var>0x009f</var>,</td></tr>
<tr><th id="96">96</th><td>    <var>0x00a0</var>, <var>0x00a1</var>, <var>0x00a2</var>, <var>0x00a3</var>, <var>0x00a4</var>, <var>0x00a5</var>, <var>0x00a6</var>, <var>0x00a7</var>,</td></tr>
<tr><th id="97">97</th><td>    <var>0x00a8</var>, <var>0x00a9</var>, <var>0x00aa</var>, <var>0x00ab</var>, <var>0x00ac</var>, <var>0x00ad</var>, <var>0x00ae</var>, <var>0x00af</var>,</td></tr>
<tr><th id="98">98</th><td>    <var>0x00b0</var>, <var>0x00b1</var>, <var>0x00b2</var>, <var>0x00b3</var>, <var>0x00b4</var>, <var>0x00b5</var>, <var>0x00b6</var>, <var>0x00b7</var>,</td></tr>
<tr><th id="99">99</th><td>    <var>0x00b8</var>, <var>0x00b9</var>, <var>0x00ba</var>, <var>0x00bb</var>, <var>0x00bc</var>, <var>0x00bd</var>, <var>0x00be</var>, <var>0x00bf</var>,</td></tr>
<tr><th id="100">100</th><td>    <var>0x00c0</var>, <var>0x00c1</var>, <var>0x00c2</var>, <var>0x00c3</var>, <var>0x00c4</var>, <var>0x00c5</var>, <var>0x00c6</var>, <var>0x00c7</var>,</td></tr>
<tr><th id="101">101</th><td>    <var>0x00c8</var>, <var>0x00c9</var>, <var>0x00ca</var>, <var>0x00cb</var>, <var>0x00cc</var>, <var>0x00cd</var>, <var>0x00ce</var>, <var>0x00cf</var>,</td></tr>
<tr><th id="102">102</th><td>    <var>0x00d0</var>, <var>0x00d1</var>, <var>0x00d2</var>, <var>0x00d3</var>, <var>0x00d4</var>, <var>0x00d5</var>, <var>0x00d6</var>, <var>0x00d7</var>,</td></tr>
<tr><th id="103">103</th><td>    <var>0x00d8</var>, <var>0x00d9</var>, <var>0x00da</var>, <var>0x00db</var>, <var>0x00dc</var>, <var>0x00dd</var>, <var>0x00de</var>, <var>0x00df</var>,</td></tr>
<tr><th id="104">104</th><td>    <var>0x00e0</var>, <var>0x00e1</var>, <var>0x00e2</var>, <var>0x00e3</var>, <var>0x00e4</var>, <var>0x00e5</var>, <var>0x00e6</var>, <var>0x00e7</var>,</td></tr>
<tr><th id="105">105</th><td>    <var>0x00e8</var>, <var>0x00e9</var>, <var>0x00ea</var>, <var>0x00eb</var>, <var>0x00ec</var>, <var>0x00ed</var>, <var>0x00ee</var>, <var>0x00ef</var>,</td></tr>
<tr><th id="106">106</th><td>    <var>0x00f0</var>, <var>0x00f1</var>, <var>0x00f2</var>, <var>0x00f3</var>, <var>0x00f4</var>, <var>0x00f5</var>, <var>0x00f6</var>, <var>0x00f7</var>,</td></tr>
<tr><th id="107">107</th><td>    <var>0x00f8</var>, <var>0x00f9</var>, <var>0x00fa</var>, <var>0x00fb</var>, <var>0x00fc</var>, <var>0x00fd</var>, <var>0x00fe</var>, <var>0x00ff</var></td></tr>
<tr><th id="108">108</th><td>  },</td></tr>
<tr><th id="109">109</th><td>  <i>/* IBM Codepage 437 mapped to Unicode */</i></td></tr>
<tr><th id="110">110</th><td>  {</td></tr>
<tr><th id="111">111</th><td>    <var>0x0000</var>, <var>0x263a</var>, <var>0x263b</var>, <var>0x2665</var>, <var>0x2666</var>, <var>0x2663</var>, <var>0x2660</var>, <var>0x2022</var>, </td></tr>
<tr><th id="112">112</th><td>    <var>0x25d8</var>, <var>0x25cb</var>, <var>0x25d9</var>, <var>0x2642</var>, <var>0x2640</var>, <var>0x266a</var>, <var>0x266b</var>, <var>0x263c</var>,</td></tr>
<tr><th id="113">113</th><td>    <var>0x25b6</var>, <var>0x25c0</var>, <var>0x2195</var>, <var>0x203c</var>, <var>0x00b6</var>, <var>0x00a7</var>, <var>0x25ac</var>, <var>0x21a8</var>,</td></tr>
<tr><th id="114">114</th><td>    <var>0x2191</var>, <var>0x2193</var>, <var>0x2192</var>, <var>0x2190</var>, <var>0x221f</var>, <var>0x2194</var>, <var>0x25b2</var>, <var>0x25bc</var>,</td></tr>
<tr><th id="115">115</th><td>    <var>0x0020</var>, <var>0x0021</var>, <var>0x0022</var>, <var>0x0023</var>, <var>0x0024</var>, <var>0x0025</var>, <var>0x0026</var>, <var>0x0027</var>,</td></tr>
<tr><th id="116">116</th><td>    <var>0x0028</var>, <var>0x0029</var>, <var>0x002a</var>, <var>0x002b</var>, <var>0x002c</var>, <var>0x002d</var>, <var>0x002e</var>, <var>0x002f</var>,</td></tr>
<tr><th id="117">117</th><td>    <var>0x0030</var>, <var>0x0031</var>, <var>0x0032</var>, <var>0x0033</var>, <var>0x0034</var>, <var>0x0035</var>, <var>0x0036</var>, <var>0x0037</var>,</td></tr>
<tr><th id="118">118</th><td>    <var>0x0038</var>, <var>0x0039</var>, <var>0x003a</var>, <var>0x003b</var>, <var>0x003c</var>, <var>0x003d</var>, <var>0x003e</var>, <var>0x003f</var>,</td></tr>
<tr><th id="119">119</th><td>    <var>0x0040</var>, <var>0x0041</var>, <var>0x0042</var>, <var>0x0043</var>, <var>0x0044</var>, <var>0x0045</var>, <var>0x0046</var>, <var>0x0047</var>,</td></tr>
<tr><th id="120">120</th><td>    <var>0x0048</var>, <var>0x0049</var>, <var>0x004a</var>, <var>0x004b</var>, <var>0x004c</var>, <var>0x004d</var>, <var>0x004e</var>, <var>0x004f</var>,</td></tr>
<tr><th id="121">121</th><td>    <var>0x0050</var>, <var>0x0051</var>, <var>0x0052</var>, <var>0x0053</var>, <var>0x0054</var>, <var>0x0055</var>, <var>0x0056</var>, <var>0x0057</var>,</td></tr>
<tr><th id="122">122</th><td>    <var>0x0058</var>, <var>0x0059</var>, <var>0x005a</var>, <var>0x005b</var>, <var>0x005c</var>, <var>0x005d</var>, <var>0x005e</var>, <var>0x005f</var>,</td></tr>
<tr><th id="123">123</th><td>    <var>0x0060</var>, <var>0x0061</var>, <var>0x0062</var>, <var>0x0063</var>, <var>0x0064</var>, <var>0x0065</var>, <var>0x0066</var>, <var>0x0067</var>,</td></tr>
<tr><th id="124">124</th><td>    <var>0x0068</var>, <var>0x0069</var>, <var>0x006a</var>, <var>0x006b</var>, <var>0x006c</var>, <var>0x006d</var>, <var>0x006e</var>, <var>0x006f</var>,</td></tr>
<tr><th id="125">125</th><td>    <var>0x0070</var>, <var>0x0071</var>, <var>0x0072</var>, <var>0x0073</var>, <var>0x0074</var>, <var>0x0075</var>, <var>0x0076</var>, <var>0x0077</var>,</td></tr>
<tr><th id="126">126</th><td>    <var>0x0078</var>, <var>0x0079</var>, <var>0x007a</var>, <var>0x007b</var>, <var>0x007c</var>, <var>0x007d</var>, <var>0x007e</var>, <var>0x2302</var>,</td></tr>
<tr><th id="127">127</th><td>    <var>0x00c7</var>, <var>0x00fc</var>, <var>0x00e9</var>, <var>0x00e2</var>, <var>0x00e4</var>, <var>0x00e0</var>, <var>0x00e5</var>, <var>0x00e7</var>,</td></tr>
<tr><th id="128">128</th><td>    <var>0x00ea</var>, <var>0x00eb</var>, <var>0x00e8</var>, <var>0x00ef</var>, <var>0x00ee</var>, <var>0x00ec</var>, <var>0x00c4</var>, <var>0x00c5</var>,</td></tr>
<tr><th id="129">129</th><td>    <var>0x00c9</var>, <var>0x00e6</var>, <var>0x00c6</var>, <var>0x00f4</var>, <var>0x00f6</var>, <var>0x00f2</var>, <var>0x00fb</var>, <var>0x00f9</var>,</td></tr>
<tr><th id="130">130</th><td>    <var>0x00ff</var>, <var>0x00d6</var>, <var>0x00dc</var>, <var>0x00a2</var>, <var>0x00a3</var>, <var>0x00a5</var>, <var>0x20a7</var>, <var>0x0192</var>,</td></tr>
<tr><th id="131">131</th><td>    <var>0x00e1</var>, <var>0x00ed</var>, <var>0x00f3</var>, <var>0x00fa</var>, <var>0x00f1</var>, <var>0x00d1</var>, <var>0x00aa</var>, <var>0x00ba</var>,</td></tr>
<tr><th id="132">132</th><td>    <var>0x00bf</var>, <var>0x2310</var>, <var>0x00ac</var>, <var>0x00bd</var>, <var>0x00bc</var>, <var>0x00a1</var>, <var>0x00ab</var>, <var>0x00bb</var>,</td></tr>
<tr><th id="133">133</th><td>    <var>0x2591</var>, <var>0x2592</var>, <var>0x2593</var>, <var>0x2502</var>, <var>0x2524</var>, <var>0x2561</var>, <var>0x2562</var>, <var>0x2556</var>,</td></tr>
<tr><th id="134">134</th><td>    <var>0x2555</var>, <var>0x2563</var>, <var>0x2551</var>, <var>0x2557</var>, <var>0x255d</var>, <var>0x255c</var>, <var>0x255b</var>, <var>0x2510</var>,</td></tr>
<tr><th id="135">135</th><td>    <var>0x2514</var>, <var>0x2534</var>, <var>0x252c</var>, <var>0x251c</var>, <var>0x2500</var>, <var>0x253c</var>, <var>0x255e</var>, <var>0x255f</var>,</td></tr>
<tr><th id="136">136</th><td>    <var>0x255a</var>, <var>0x2554</var>, <var>0x2569</var>, <var>0x2566</var>, <var>0x2560</var>, <var>0x2550</var>, <var>0x256c</var>, <var>0x2567</var>,</td></tr>
<tr><th id="137">137</th><td>    <var>0x2568</var>, <var>0x2564</var>, <var>0x2565</var>, <var>0x2559</var>, <var>0x2558</var>, <var>0x2552</var>, <var>0x2553</var>, <var>0x256b</var>,</td></tr>
<tr><th id="138">138</th><td>    <var>0x256a</var>, <var>0x2518</var>, <var>0x250c</var>, <var>0x2588</var>, <var>0x2584</var>, <var>0x258c</var>, <var>0x2590</var>, <var>0x2580</var>,</td></tr>
<tr><th id="139">139</th><td>    <var>0x03b1</var>, <var>0x00df</var>, <var>0x0393</var>, <var>0x03c0</var>, <var>0x03a3</var>, <var>0x03c3</var>, <var>0x00b5</var>, <var>0x03c4</var>,</td></tr>
<tr><th id="140">140</th><td>    <var>0x03a6</var>, <var>0x0398</var>, <var>0x03a9</var>, <var>0x03b4</var>, <var>0x221e</var>, <var>0x03c6</var>, <var>0x03b5</var>, <var>0x2229</var>,</td></tr>
<tr><th id="141">141</th><td>    <var>0x2261</var>, <var>0x00b1</var>, <var>0x2265</var>, <var>0x2264</var>, <var>0x2320</var>, <var>0x2321</var>, <var>0x00f7</var>, <var>0x2248</var>,</td></tr>
<tr><th id="142">142</th><td>    <var>0x00b0</var>, <var>0x2219</var>, <var>0x00b7</var>, <var>0x221a</var>, <var>0x207f</var>, <var>0x00b2</var>, <var>0x25a0</var>, <var>0x00a0</var></td></tr>
<tr><th id="143">143</th><td>  }, </td></tr>
<tr><th id="144">144</th><td>  <i>/* User mapping -- default to codes for direct font mapping */</i></td></tr>
<tr><th id="145">145</th><td>  {</td></tr>
<tr><th id="146">146</th><td>    <var>0xf000</var>, <var>0xf001</var>, <var>0xf002</var>, <var>0xf003</var>, <var>0xf004</var>, <var>0xf005</var>, <var>0xf006</var>, <var>0xf007</var>,</td></tr>
<tr><th id="147">147</th><td>    <var>0xf008</var>, <var>0xf009</var>, <var>0xf00a</var>, <var>0xf00b</var>, <var>0xf00c</var>, <var>0xf00d</var>, <var>0xf00e</var>, <var>0xf00f</var>,</td></tr>
<tr><th id="148">148</th><td>    <var>0xf010</var>, <var>0xf011</var>, <var>0xf012</var>, <var>0xf013</var>, <var>0xf014</var>, <var>0xf015</var>, <var>0xf016</var>, <var>0xf017</var>,</td></tr>
<tr><th id="149">149</th><td>    <var>0xf018</var>, <var>0xf019</var>, <var>0xf01a</var>, <var>0xf01b</var>, <var>0xf01c</var>, <var>0xf01d</var>, <var>0xf01e</var>, <var>0xf01f</var>,</td></tr>
<tr><th id="150">150</th><td>    <var>0xf020</var>, <var>0xf021</var>, <var>0xf022</var>, <var>0xf023</var>, <var>0xf024</var>, <var>0xf025</var>, <var>0xf026</var>, <var>0xf027</var>,</td></tr>
<tr><th id="151">151</th><td>    <var>0xf028</var>, <var>0xf029</var>, <var>0xf02a</var>, <var>0xf02b</var>, <var>0xf02c</var>, <var>0xf02d</var>, <var>0xf02e</var>, <var>0xf02f</var>,</td></tr>
<tr><th id="152">152</th><td>    <var>0xf030</var>, <var>0xf031</var>, <var>0xf032</var>, <var>0xf033</var>, <var>0xf034</var>, <var>0xf035</var>, <var>0xf036</var>, <var>0xf037</var>,</td></tr>
<tr><th id="153">153</th><td>    <var>0xf038</var>, <var>0xf039</var>, <var>0xf03a</var>, <var>0xf03b</var>, <var>0xf03c</var>, <var>0xf03d</var>, <var>0xf03e</var>, <var>0xf03f</var>,</td></tr>
<tr><th id="154">154</th><td>    <var>0xf040</var>, <var>0xf041</var>, <var>0xf042</var>, <var>0xf043</var>, <var>0xf044</var>, <var>0xf045</var>, <var>0xf046</var>, <var>0xf047</var>,</td></tr>
<tr><th id="155">155</th><td>    <var>0xf048</var>, <var>0xf049</var>, <var>0xf04a</var>, <var>0xf04b</var>, <var>0xf04c</var>, <var>0xf04d</var>, <var>0xf04e</var>, <var>0xf04f</var>,</td></tr>
<tr><th id="156">156</th><td>    <var>0xf050</var>, <var>0xf051</var>, <var>0xf052</var>, <var>0xf053</var>, <var>0xf054</var>, <var>0xf055</var>, <var>0xf056</var>, <var>0xf057</var>,</td></tr>
<tr><th id="157">157</th><td>    <var>0xf058</var>, <var>0xf059</var>, <var>0xf05a</var>, <var>0xf05b</var>, <var>0xf05c</var>, <var>0xf05d</var>, <var>0xf05e</var>, <var>0xf05f</var>,</td></tr>
<tr><th id="158">158</th><td>    <var>0xf060</var>, <var>0xf061</var>, <var>0xf062</var>, <var>0xf063</var>, <var>0xf064</var>, <var>0xf065</var>, <var>0xf066</var>, <var>0xf067</var>,</td></tr>
<tr><th id="159">159</th><td>    <var>0xf068</var>, <var>0xf069</var>, <var>0xf06a</var>, <var>0xf06b</var>, <var>0xf06c</var>, <var>0xf06d</var>, <var>0xf06e</var>, <var>0xf06f</var>,</td></tr>
<tr><th id="160">160</th><td>    <var>0xf070</var>, <var>0xf071</var>, <var>0xf072</var>, <var>0xf073</var>, <var>0xf074</var>, <var>0xf075</var>, <var>0xf076</var>, <var>0xf077</var>,</td></tr>
<tr><th id="161">161</th><td>    <var>0xf078</var>, <var>0xf079</var>, <var>0xf07a</var>, <var>0xf07b</var>, <var>0xf07c</var>, <var>0xf07d</var>, <var>0xf07e</var>, <var>0xf07f</var>,</td></tr>
<tr><th id="162">162</th><td>    <var>0xf080</var>, <var>0xf081</var>, <var>0xf082</var>, <var>0xf083</var>, <var>0xf084</var>, <var>0xf085</var>, <var>0xf086</var>, <var>0xf087</var>,</td></tr>
<tr><th id="163">163</th><td>    <var>0xf088</var>, <var>0xf089</var>, <var>0xf08a</var>, <var>0xf08b</var>, <var>0xf08c</var>, <var>0xf08d</var>, <var>0xf08e</var>, <var>0xf08f</var>,</td></tr>
<tr><th id="164">164</th><td>    <var>0xf090</var>, <var>0xf091</var>, <var>0xf092</var>, <var>0xf093</var>, <var>0xf094</var>, <var>0xf095</var>, <var>0xf096</var>, <var>0xf097</var>,</td></tr>
<tr><th id="165">165</th><td>    <var>0xf098</var>, <var>0xf099</var>, <var>0xf09a</var>, <var>0xf09b</var>, <var>0xf09c</var>, <var>0xf09d</var>, <var>0xf09e</var>, <var>0xf09f</var>,</td></tr>
<tr><th id="166">166</th><td>    <var>0xf0a0</var>, <var>0xf0a1</var>, <var>0xf0a2</var>, <var>0xf0a3</var>, <var>0xf0a4</var>, <var>0xf0a5</var>, <var>0xf0a6</var>, <var>0xf0a7</var>,</td></tr>
<tr><th id="167">167</th><td>    <var>0xf0a8</var>, <var>0xf0a9</var>, <var>0xf0aa</var>, <var>0xf0ab</var>, <var>0xf0ac</var>, <var>0xf0ad</var>, <var>0xf0ae</var>, <var>0xf0af</var>,</td></tr>
<tr><th id="168">168</th><td>    <var>0xf0b0</var>, <var>0xf0b1</var>, <var>0xf0b2</var>, <var>0xf0b3</var>, <var>0xf0b4</var>, <var>0xf0b5</var>, <var>0xf0b6</var>, <var>0xf0b7</var>,</td></tr>
<tr><th id="169">169</th><td>    <var>0xf0b8</var>, <var>0xf0b9</var>, <var>0xf0ba</var>, <var>0xf0bb</var>, <var>0xf0bc</var>, <var>0xf0bd</var>, <var>0xf0be</var>, <var>0xf0bf</var>,</td></tr>
<tr><th id="170">170</th><td>    <var>0xf0c0</var>, <var>0xf0c1</var>, <var>0xf0c2</var>, <var>0xf0c3</var>, <var>0xf0c4</var>, <var>0xf0c5</var>, <var>0xf0c6</var>, <var>0xf0c7</var>,</td></tr>
<tr><th id="171">171</th><td>    <var>0xf0c8</var>, <var>0xf0c9</var>, <var>0xf0ca</var>, <var>0xf0cb</var>, <var>0xf0cc</var>, <var>0xf0cd</var>, <var>0xf0ce</var>, <var>0xf0cf</var>,</td></tr>
<tr><th id="172">172</th><td>    <var>0xf0d0</var>, <var>0xf0d1</var>, <var>0xf0d2</var>, <var>0xf0d3</var>, <var>0xf0d4</var>, <var>0xf0d5</var>, <var>0xf0d6</var>, <var>0xf0d7</var>,</td></tr>
<tr><th id="173">173</th><td>    <var>0xf0d8</var>, <var>0xf0d9</var>, <var>0xf0da</var>, <var>0xf0db</var>, <var>0xf0dc</var>, <var>0xf0dd</var>, <var>0xf0de</var>, <var>0xf0df</var>,</td></tr>
<tr><th id="174">174</th><td>    <var>0xf0e0</var>, <var>0xf0e1</var>, <var>0xf0e2</var>, <var>0xf0e3</var>, <var>0xf0e4</var>, <var>0xf0e5</var>, <var>0xf0e6</var>, <var>0xf0e7</var>,</td></tr>
<tr><th id="175">175</th><td>    <var>0xf0e8</var>, <var>0xf0e9</var>, <var>0xf0ea</var>, <var>0xf0eb</var>, <var>0xf0ec</var>, <var>0xf0ed</var>, <var>0xf0ee</var>, <var>0xf0ef</var>,</td></tr>
<tr><th id="176">176</th><td>    <var>0xf0f0</var>, <var>0xf0f1</var>, <var>0xf0f2</var>, <var>0xf0f3</var>, <var>0xf0f4</var>, <var>0xf0f5</var>, <var>0xf0f6</var>, <var>0xf0f7</var>,</td></tr>
<tr><th id="177">177</th><td>    <var>0xf0f8</var>, <var>0xf0f9</var>, <var>0xf0fa</var>, <var>0xf0fb</var>, <var>0xf0fc</var>, <var>0xf0fd</var>, <var>0xf0fe</var>, <var>0xf0ff</var></td></tr>
<tr><th id="178">178</th><td>  }</td></tr>
<tr><th id="179">179</th><td>};</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td><i>/* The standard kernel character-to-font mappings are not invertible</i></td></tr>
<tr><th id="182">182</th><td><i>   -- this is just a best effort. */</i></td></tr>
<tr><th id="183">183</th><td></td></tr>
<tr><th id="184">184</th><td><u>#define <dfn class="macro" id="_M/MAX_GLYPH" data-ref="_M/MAX_GLYPH">MAX_GLYPH</dfn> 512		/* Max possible glyph value */</u></td></tr>
<tr><th id="185">185</th><td></td></tr>
<tr><th id="186">186</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="inv_translate" title='inv_translate' data-type='int [63]' data-ref="inv_translate">inv_translate</dfn>[<a class="macro" href="../../../include/uapi/linux/vt.h.html#11" title="63" data-ref="_M/MAX_NR_CONSOLES">MAX_NR_CONSOLES</a>];</td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td><b>struct</b> <dfn class="type def" id="uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</dfn> {</td></tr>
<tr><th id="189">189</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> 		**<dfn class="decl field" id="uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</dfn>[<var>32</var>];</td></tr>
<tr><th id="190">190</th><td>	<em>unsigned</em> <em>long</em>	<dfn class="decl field" id="uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</dfn>;</td></tr>
<tr><th id="191">191</th><td>	<em>unsigned</em> <em>long</em>	<dfn class="decl field" id="uni_pagedir::sum" title='uni_pagedir::sum' data-ref="uni_pagedir::sum">sum</dfn>;</td></tr>
<tr><th id="192">192</th><td>	<em>unsigned</em> <em>char</em>	*<dfn class="decl field" id="uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</dfn>[<var>4</var>];</td></tr>
<tr><th id="193">193</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a>		*<dfn class="decl field" id="uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</dfn>;</td></tr>
<tr><th id="194">194</th><td>};</td></tr>
<tr><th id="195">195</th><td></td></tr>
<tr><th id="196">196</th><td><em>static</em> <b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="tu decl def" id="dflt" title='dflt' data-type='struct uni_pagedir *' data-ref="dflt">dflt</dfn>;</td></tr>
<tr><th id="197">197</th><td></td></tr>
<tr><th id="198">198</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="set_inverse_transl" title='set_inverse_transl' data-type='void set_inverse_transl(struct vc_data * conp, struct uni_pagedir * p, int i)' data-ref="set_inverse_transl">set_inverse_transl</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col1 decl" id="1conp" title='conp' data-type='struct vc_data *' data-ref="1conp">conp</dfn>, <b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col2 decl" id="2p" title='p' data-type='struct uni_pagedir *' data-ref="2p">p</dfn>, <em>int</em> <dfn class="local col3 decl" id="3i" title='i' data-type='int' data-ref="3i">i</dfn>)</td></tr>
<tr><th id="199">199</th><td>{</td></tr>
<tr><th id="200">200</th><td>	<em>int</em> <dfn class="local col4 decl" id="4j" title='j' data-type='int' data-ref="4j">j</dfn>, <dfn class="local col5 decl" id="5glyph" title='glyph' data-type='int' data-ref="5glyph">glyph</dfn>;</td></tr>
<tr><th id="201">201</th><td>	<em>unsigned</em> <em>short</em> *<dfn class="local col6 decl" id="6t" title='t' data-type='unsigned short *' data-ref="6t">t</dfn> = <a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="local col3 ref" href="#3i" title='i' data-ref="3i">i</a>];</td></tr>
<tr><th id="202">202</th><td>	<em>unsigned</em> <em>char</em> *<dfn class="local col7 decl" id="7q" title='q' data-type='unsigned char *' data-ref="7q">q</dfn>;</td></tr>
<tr><th id="203">203</th><td>	</td></tr>
<tr><th id="204">204</th><td>	<b>if</b> (!<a class="local col2 ref" href="#2p" title='p' data-ref="2p">p</a>) <b>return</b>;</td></tr>
<tr><th id="205">205</th><td>	<a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a> = <a class="local col2 ref" href="#2p" title='p' data-ref="2p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</a>[<a class="local col3 ref" href="#3i" title='i' data-ref="3i">i</a>];</td></tr>
<tr><th id="206">206</th><td></td></tr>
<tr><th id="207">207</th><td>	<b>if</b> (!<a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a>) {</td></tr>
<tr><th id="208">208</th><td>		<a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a> = <a class="local col2 ref" href="#2p" title='p' data-ref="2p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</a>[<a class="local col3 ref" href="#3i" title='i' data-ref="3i">i</a>] = <a class="ref fn" href="../../../include/linux/slab.h.html#kmalloc" title='kmalloc' data-ref="kmalloc">kmalloc</a>(<a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a>, <a class="macro" href="../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="209">209</th><td>		<b>if</b> (!<a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a>) <b>return</b>;</td></tr>
<tr><th id="210">210</th><td>	}</td></tr>
<tr><th id="211">211</th><td>	<a class="ref fn" href="../../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a>, <var>0</var>, <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a>);</td></tr>
<tr><th id="212">212</th><td></td></tr>
<tr><th id="213">213</th><td>	<b>for</b> (<a class="local col4 ref" href="#4j" title='j' data-ref="4j">j</a> = <var>0</var>; <a class="local col4 ref" href="#4j" title='j' data-ref="4j">j</a> &lt; <a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>; <a class="local col4 ref" href="#4j" title='j' data-ref="4j">j</a>++) {</td></tr>
<tr><th id="214">214</th><td>		<a class="local col5 ref" href="#5glyph" title='glyph' data-ref="5glyph">glyph</a> = <a class="ref fn" href="#conv_uni_to_pc" title='conv_uni_to_pc' data-ref="conv_uni_to_pc">conv_uni_to_pc</a>(<a class="local col1 ref" href="#1conp" title='conp' data-ref="1conp">conp</a>, <a class="local col6 ref" href="#6t" title='t' data-ref="6t">t</a>[<a class="local col4 ref" href="#4j" title='j' data-ref="4j">j</a>]);</td></tr>
<tr><th id="215">215</th><td>		<b>if</b> (<a class="local col5 ref" href="#5glyph" title='glyph' data-ref="5glyph">glyph</a> &gt;= <var>0</var> &amp;&amp; <a class="local col5 ref" href="#5glyph" title='glyph' data-ref="5glyph">glyph</a> &lt; <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a> &amp;&amp; <a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a>[<a class="local col5 ref" href="#5glyph" title='glyph' data-ref="5glyph">glyph</a>] &lt; <var>32</var>) {</td></tr>
<tr><th id="216">216</th><td>			<i>/* prefer '-' above SHY etc. */</i></td></tr>
<tr><th id="217">217</th><td>		  	<a class="local col7 ref" href="#7q" title='q' data-ref="7q">q</a>[<a class="local col5 ref" href="#5glyph" title='glyph' data-ref="5glyph">glyph</a>] = <a class="local col4 ref" href="#4j" title='j' data-ref="4j">j</a>;</td></tr>
<tr><th id="218">218</th><td>		}</td></tr>
<tr><th id="219">219</th><td>	}</td></tr>
<tr><th id="220">220</th><td>}</td></tr>
<tr><th id="221">221</th><td></td></tr>
<tr><th id="222">222</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="set_inverse_trans_unicode" title='set_inverse_trans_unicode' data-type='void set_inverse_trans_unicode(struct vc_data * conp, struct uni_pagedir * p)' data-ref="set_inverse_trans_unicode">set_inverse_trans_unicode</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col8 decl" id="8conp" title='conp' data-type='struct vc_data *' data-ref="8conp">conp</dfn>,</td></tr>
<tr><th id="223">223</th><td>				      <b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col9 decl" id="9p" title='p' data-type='struct uni_pagedir *' data-ref="9p">p</dfn>)</td></tr>
<tr><th id="224">224</th><td>{</td></tr>
<tr><th id="225">225</th><td>	<em>int</em> <dfn class="local col0 decl" id="10i" title='i' data-type='int' data-ref="10i">i</dfn>, <dfn class="local col1 decl" id="11j" title='j' data-type='int' data-ref="11j">j</dfn>, <dfn class="local col2 decl" id="12k" title='k' data-type='int' data-ref="12k">k</dfn>, <dfn class="local col3 decl" id="13glyph" title='glyph' data-type='int' data-ref="13glyph">glyph</dfn>;</td></tr>
<tr><th id="226">226</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col4 decl" id="14p1" title='p1' data-type='u16 **' data-ref="14p1">p1</dfn>, *<dfn class="local col5 decl" id="15p2" title='p2' data-type='u16 *' data-ref="15p2">p2</dfn>;</td></tr>
<tr><th id="227">227</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> *<dfn class="local col6 decl" id="16q" title='q' data-type='u16 *' data-ref="16q">q</dfn>;</td></tr>
<tr><th id="228">228</th><td></td></tr>
<tr><th id="229">229</th><td>	<b>if</b> (!<a class="local col9 ref" href="#9p" title='p' data-ref="9p">p</a>) <b>return</b>;</td></tr>
<tr><th id="230">230</th><td>	<a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a> = <a class="local col9 ref" href="#9p" title='p' data-ref="9p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</a>;</td></tr>
<tr><th id="231">231</th><td>	<b>if</b> (!<a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a>) {</td></tr>
<tr><th id="232">232</th><td>		<a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a> = <a class="local col9 ref" href="#9p" title='p' data-ref="9p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</a> =</td></tr>
<tr><th id="233">233</th><td>			<a class="ref fn" href="../../../include/linux/slab.h.html#kmalloc" title='kmalloc' data-ref="kmalloc">kmalloc</a>(<a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a> * <b>sizeof</b>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a>), <a class="macro" href="../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="234">234</th><td>		<b>if</b> (!<a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a>)</td></tr>
<tr><th id="235">235</th><td>			<b>return</b>;</td></tr>
<tr><th id="236">236</th><td>	}</td></tr>
<tr><th id="237">237</th><td>	<a class="ref fn" href="../../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a>, <var>0</var>, <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a> * <b>sizeof</b>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a>));</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td>	<b>for</b> (<a class="local col0 ref" href="#10i" title='i' data-ref="10i">i</a> = <var>0</var>; <a class="local col0 ref" href="#10i" title='i' data-ref="10i">i</a> &lt; <var>32</var>; <a class="local col0 ref" href="#10i" title='i' data-ref="10i">i</a>++) {</td></tr>
<tr><th id="240">240</th><td>		<a class="local col4 ref" href="#14p1" title='p1' data-ref="14p1">p1</a> = <a class="local col9 ref" href="#9p" title='p' data-ref="9p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col0 ref" href="#10i" title='i' data-ref="10i">i</a>];</td></tr>
<tr><th id="241">241</th><td>		<b>if</b> (!<a class="local col4 ref" href="#14p1" title='p1' data-ref="14p1">p1</a>)</td></tr>
<tr><th id="242">242</th><td>			<b>continue</b>;</td></tr>
<tr><th id="243">243</th><td>		<b>for</b> (<a class="local col1 ref" href="#11j" title='j' data-ref="11j">j</a> = <var>0</var>; <a class="local col1 ref" href="#11j" title='j' data-ref="11j">j</a> &lt; <var>32</var>; <a class="local col1 ref" href="#11j" title='j' data-ref="11j">j</a>++) {</td></tr>
<tr><th id="244">244</th><td>			<a class="local col5 ref" href="#15p2" title='p2' data-ref="15p2">p2</a> = <a class="local col4 ref" href="#14p1" title='p1' data-ref="14p1">p1</a>[<a class="local col1 ref" href="#11j" title='j' data-ref="11j">j</a>];</td></tr>
<tr><th id="245">245</th><td>			<b>if</b> (!<a class="local col5 ref" href="#15p2" title='p2' data-ref="15p2">p2</a>)</td></tr>
<tr><th id="246">246</th><td>				<b>continue</b>;</td></tr>
<tr><th id="247">247</th><td>			<b>for</b> (<a class="local col2 ref" href="#12k" title='k' data-ref="12k">k</a> = <var>0</var>; <a class="local col2 ref" href="#12k" title='k' data-ref="12k">k</a> &lt; <var>64</var>; <a class="local col2 ref" href="#12k" title='k' data-ref="12k">k</a>++) {</td></tr>
<tr><th id="248">248</th><td>				<a class="local col3 ref" href="#13glyph" title='glyph' data-ref="13glyph">glyph</a> = <a class="local col5 ref" href="#15p2" title='p2' data-ref="15p2">p2</a>[<a class="local col2 ref" href="#12k" title='k' data-ref="12k">k</a>];</td></tr>
<tr><th id="249">249</th><td>				<b>if</b> (<a class="local col3 ref" href="#13glyph" title='glyph' data-ref="13glyph">glyph</a> &gt;= <var>0</var> &amp;&amp; <a class="local col3 ref" href="#13glyph" title='glyph' data-ref="13glyph">glyph</a> &lt; <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a></td></tr>
<tr><th id="250">250</th><td>					       &amp;&amp; <a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a>[<a class="local col3 ref" href="#13glyph" title='glyph' data-ref="13glyph">glyph</a>] &lt; <var>32</var>)</td></tr>
<tr><th id="251">251</th><td>		  			<a class="local col6 ref" href="#16q" title='q' data-ref="16q">q</a>[<a class="local col3 ref" href="#13glyph" title='glyph' data-ref="13glyph">glyph</a>] = (<a class="local col0 ref" href="#10i" title='i' data-ref="10i">i</a> &lt;&lt; <var>11</var>) + (<a class="local col1 ref" href="#11j" title='j' data-ref="11j">j</a> &lt;&lt; <var>6</var>) + <a class="local col2 ref" href="#12k" title='k' data-ref="12k">k</a>;</td></tr>
<tr><th id="252">252</th><td>			}</td></tr>
<tr><th id="253">253</th><td>		}</td></tr>
<tr><th id="254">254</th><td>	}</td></tr>
<tr><th id="255">255</th><td>}</td></tr>
<tr><th id="256">256</th><td></td></tr>
<tr><th id="257">257</th><td><em>unsigned</em> <em>short</em> *<dfn class="decl def fn" id="set_translate" title='set_translate' data-ref="set_translate">set_translate</dfn>(<em>int</em> <dfn class="local col7 decl" id="17m" title='m' data-type='int' data-ref="17m">m</dfn>, <b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col8 decl" id="18vc" title='vc' data-type='struct vc_data *' data-ref="18vc">vc</dfn>)</td></tr>
<tr><th id="258">258</th><td>{</td></tr>
<tr><th id="259">259</th><td>	<a class="tu ref" href="#inv_translate" title='inv_translate' data-use='w' data-ref="inv_translate">inv_translate</a>[<a class="local col8 ref" href="#18vc" title='vc' data-ref="18vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_num" title='vc_data::vc_num' data-ref="vc_data::vc_num">vc_num</a>] = <a class="local col7 ref" href="#17m" title='m' data-ref="17m">m</a>;</td></tr>
<tr><th id="260">260</th><td>	<b>return</b> <a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="local col7 ref" href="#17m" title='m' data-ref="17m">m</a>];</td></tr>
<tr><th id="261">261</th><td>}</td></tr>
<tr><th id="262">262</th><td></td></tr>
<tr><th id="263">263</th><td><i>/*</i></td></tr>
<tr><th id="264">264</th><td><i> * Inverse translation is impossible for several reasons:</i></td></tr>
<tr><th id="265">265</th><td><i> * 1. The font&lt;-&gt;character maps are not 1-1.</i></td></tr>
<tr><th id="266">266</th><td><i> * 2. The text may have been written while a different translation map</i></td></tr>
<tr><th id="267">267</th><td><i> *    was active.</i></td></tr>
<tr><th id="268">268</th><td><i> * Still, it is now possible to a certain extent to cut and paste non-ASCII.</i></td></tr>
<tr><th id="269">269</th><td><i> */</i></td></tr>
<tr><th id="270">270</th><td><a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> <dfn class="decl def fn" id="inverse_translate" title='inverse_translate' data-ref="inverse_translate">inverse_translate</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col9 decl" id="19conp" title='conp' data-type='struct vc_data *' data-ref="19conp">conp</dfn>, <em>int</em> <dfn class="local col0 decl" id="20glyph" title='glyph' data-type='int' data-ref="20glyph">glyph</dfn>, <em>int</em> <dfn class="local col1 decl" id="21use_unicode" title='use_unicode' data-type='int' data-ref="21use_unicode">use_unicode</dfn>)</td></tr>
<tr><th id="271">271</th><td>{</td></tr>
<tr><th id="272">272</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col2 decl" id="22p" title='p' data-type='struct uni_pagedir *' data-ref="22p">p</dfn>;</td></tr>
<tr><th id="273">273</th><td>	<em>int</em> <dfn class="local col3 decl" id="23m" title='m' data-type='int' data-ref="23m">m</dfn>;</td></tr>
<tr><th id="274">274</th><td>	<b>if</b> (<a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a> &lt; <var>0</var> || <a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a> &gt;= <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a>)</td></tr>
<tr><th id="275">275</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="276">276</th><td>	<b>else</b> {</td></tr>
<tr><th id="277">277</th><td>		<a class="local col2 ref" href="#22p" title='p' data-ref="22p">p</a> = *<a class="local col9 ref" href="#19conp" title='conp' data-ref="19conp">conp</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="278">278</th><td>		<b>if</b> (!<a class="local col2 ref" href="#22p" title='p' data-ref="22p">p</a>)</td></tr>
<tr><th id="279">279</th><td>			<b>return</b> <a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a>;</td></tr>
<tr><th id="280">280</th><td>		<b>else</b> <b>if</b> (<a class="local col1 ref" href="#21use_unicode" title='use_unicode' data-ref="21use_unicode">use_unicode</a>) {</td></tr>
<tr><th id="281">281</th><td>			<b>if</b> (!<a class="local col2 ref" href="#22p" title='p' data-ref="22p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</a>)</td></tr>
<tr><th id="282">282</th><td>				<b>return</b> <a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a>;</td></tr>
<tr><th id="283">283</th><td>			<b>else</b></td></tr>
<tr><th id="284">284</th><td>				<b>return</b> <a class="local col2 ref" href="#22p" title='p' data-ref="22p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</a>[<a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a>];</td></tr>
<tr><th id="285">285</th><td>			} <b>else</b> {</td></tr>
<tr><th id="286">286</th><td>			<a class="local col3 ref" href="#23m" title='m' data-ref="23m">m</a> = <a class="tu ref" href="#inv_translate" title='inv_translate' data-use='r' data-ref="inv_translate">inv_translate</a>[<a class="local col9 ref" href="#19conp" title='conp' data-ref="19conp">conp</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_num" title='vc_data::vc_num' data-ref="vc_data::vc_num">vc_num</a>];</td></tr>
<tr><th id="287">287</th><td>			<b>if</b> (!<a class="local col2 ref" href="#22p" title='p' data-ref="22p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</a>[<a class="local col3 ref" href="#23m" title='m' data-ref="23m">m</a>])</td></tr>
<tr><th id="288">288</th><td>				<b>return</b> <a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a>;</td></tr>
<tr><th id="289">289</th><td>			<b>else</b></td></tr>
<tr><th id="290">290</th><td>				<b>return</b> <a class="local col2 ref" href="#22p" title='p' data-ref="22p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</a>[<a class="local col3 ref" href="#23m" title='m' data-ref="23m">m</a>][<a class="local col0 ref" href="#20glyph" title='glyph' data-ref="20glyph">glyph</a>];</td></tr>
<tr><th id="291">291</th><td>			}</td></tr>
<tr><th id="292">292</th><td>	}</td></tr>
<tr><th id="293">293</th><td>}</td></tr>
<tr><th id="294">294</th><td><a class="macro" href="../../../include/linux/export.h.html#106" title="extern typeof(inverse_translate) inverse_translate; static const char __kstrtab_inverse_translate[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;inverse_translate&quot;; static const struct kernel_symbol __ksymtab_inverse_translate __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;_gpl&quot; &quot;+&quot; &quot;inverse_translate&quot;), used)) = { (unsigned long)&amp;inverse_translate, __kstrtab_inverse_translate }" data-ref="_M/EXPORT_SYMBOL_GPL">EXPORT_SYMBOL_GPL</a>(<a class="decl fn" href="#inverse_translate" title='inverse_translate' data-ref="inverse_translate"><a class="ref fn" href="#inverse_translate" title='inverse_translate' data-ref="inverse_translate"><a class="ref fn" href="#inverse_translate" title='inverse_translate' data-ref="inverse_translate"><a class="ref fn" href="#inverse_translate" title='inverse_translate' data-ref="inverse_translate">inverse_translate</a></a></a></a>);</td></tr>
<tr><th id="295">295</th><td></td></tr>
<tr><th id="296">296</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="update_user_maps" title='update_user_maps' data-type='void update_user_maps()' data-ref="update_user_maps">update_user_maps</dfn>(<em>void</em>)</td></tr>
<tr><th id="297">297</th><td>{</td></tr>
<tr><th id="298">298</th><td>	<em>int</em> <dfn class="local col4 decl" id="24i" title='i' data-type='int' data-ref="24i">i</dfn>;</td></tr>
<tr><th id="299">299</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col5 decl" id="25p" title='p' data-type='struct uni_pagedir *' data-ref="25p">p</dfn>, *<dfn class="local col6 decl" id="26q" title='q' data-type='struct uni_pagedir *' data-ref="26q">q</dfn> = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="300">300</th><td>	</td></tr>
<tr><th id="301">301</th><td>	<b>for</b> (<a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a> = <var>0</var>; <a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a> &lt; <a class="macro" href="../../../include/uapi/linux/vt.h.html#11" title="63" data-ref="_M/MAX_NR_CONSOLES">MAX_NR_CONSOLES</a>; <a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a>++) {</td></tr>
<tr><th id="302">302</th><td>		<b>if</b> (!<a class="ref fn" href="../../../include/linux/vt_kern.h.html#vc_cons_allocated" title='vc_cons_allocated' data-ref="vc_cons_allocated">vc_cons_allocated</a>(<a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a>))</td></tr>
<tr><th id="303">303</th><td>			<b>continue</b>;</td></tr>
<tr><th id="304">304</th><td>		<a class="local col5 ref" href="#25p" title='p' data-ref="25p">p</a> = *<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="305">305</th><td>		<b>if</b> (<a class="local col5 ref" href="#25p" title='p' data-ref="25p">p</a> &amp;&amp; <a class="local col5 ref" href="#25p" title='p' data-ref="25p">p</a> != <a class="local col6 ref" href="#26q" title='q' data-ref="26q">q</a>) {</td></tr>
<tr><th id="306">306</th><td>			<a class="tu ref fn" href="#set_inverse_transl" title='set_inverse_transl' data-use='c' data-ref="set_inverse_transl">set_inverse_transl</a>(<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>, <a class="local col5 ref" href="#25p" title='p' data-ref="25p">p</a>, <a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>);</td></tr>
<tr><th id="307">307</th><td>			<a class="tu ref fn" href="#set_inverse_trans_unicode" title='set_inverse_trans_unicode' data-use='c' data-ref="set_inverse_trans_unicode">set_inverse_trans_unicode</a>(<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="local col4 ref" href="#24i" title='i' data-ref="24i">i</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>, <a class="local col5 ref" href="#25p" title='p' data-ref="25p">p</a>);</td></tr>
<tr><th id="308">308</th><td>			<a class="local col6 ref" href="#26q" title='q' data-ref="26q">q</a> = <a class="local col5 ref" href="#25p" title='p' data-ref="25p">p</a>;</td></tr>
<tr><th id="309">309</th><td>		}</td></tr>
<tr><th id="310">310</th><td>	}</td></tr>
<tr><th id="311">311</th><td>}</td></tr>
<tr><th id="312">312</th><td></td></tr>
<tr><th id="313">313</th><td><i>/*</i></td></tr>
<tr><th id="314">314</th><td><i> * Load customizable translation table</i></td></tr>
<tr><th id="315">315</th><td><i> * arg points to a 256 byte translation table.</i></td></tr>
<tr><th id="316">316</th><td><i> *</i></td></tr>
<tr><th id="317">317</th><td><i> * The "old" variants are for translation directly to font (using the</i></td></tr>
<tr><th id="318">318</th><td><i> * 0xf000-0xf0ff "transparent" Unicodes) whereas the "new" variants set</i></td></tr>
<tr><th id="319">319</th><td><i> * Unicodes explicitly.</i></td></tr>
<tr><th id="320">320</th><td><i> */</i></td></tr>
<tr><th id="321">321</th><td><em>int</em> <dfn class="decl def fn" id="con_set_trans_old" title='con_set_trans_old' data-ref="con_set_trans_old">con_set_trans_old</dfn>(<em>unsigned</em> <em>char</em> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> * <dfn class="local col7 decl" id="27arg" title='arg' data-type='unsigned char *' data-ref="27arg">arg</dfn>)</td></tr>
<tr><th id="322">322</th><td>{</td></tr>
<tr><th id="323">323</th><td>	<em>int</em> <dfn class="local col8 decl" id="28i" title='i' data-type='int' data-ref="28i">i</dfn>;</td></tr>
<tr><th id="324">324</th><td>	<em>unsigned</em> <em>short</em> <dfn class="local col9 decl" id="29inbuf" title='inbuf' data-type='unsigned short [256]' data-ref="29inbuf">inbuf</dfn>[<a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>];</td></tr>
<tr><th id="325">325</th><td>	<em>unsigned</em> <em>char</em> <dfn class="local col0 decl" id="30ubuf" title='ubuf' data-type='unsigned char [256]' data-ref="30ubuf">ubuf</dfn>[<a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>];</td></tr>
<tr><th id="326">326</th><td></td></tr>
<tr><th id="327">327</th><td>	<b>if</b> (<a class="ref fn" href="../../../include/linux/uaccess.h.html#copy_from_user" title='copy_from_user' data-ref="copy_from_user">copy_from_user</a>(<a class="local col0 ref" href="#30ubuf" title='ubuf' data-ref="30ubuf">ubuf</a>, <a class="local col7 ref" href="#27arg" title='arg' data-ref="27arg">arg</a>, <a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>))</td></tr>
<tr><th id="328">328</th><td>		<b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#18" title="14" data-ref="_M/EFAULT">EFAULT</a>;</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>	<b>for</b> (<a class="local col8 ref" href="#28i" title='i' data-ref="28i">i</a> = <var>0</var>; <a class="local col8 ref" href="#28i" title='i' data-ref="28i">i</a> &lt; <a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a> ; <a class="local col8 ref" href="#28i" title='i' data-ref="28i">i</a>++)</td></tr>
<tr><th id="331">331</th><td>		<a class="local col9 ref" href="#29inbuf" title='inbuf' data-ref="29inbuf">inbuf</a>[<a class="local col8 ref" href="#28i" title='i' data-ref="28i">i</a>] = <a class="macro" href="../../../include/uapi/linux/kd.h.html#78" title="0xF000" data-ref="_M/UNI_DIRECT_BASE">UNI_DIRECT_BASE</a> | <a class="local col0 ref" href="#30ubuf" title='ubuf' data-ref="30ubuf">ubuf</a>[<a class="local col8 ref" href="#28i" title='i' data-ref="28i">i</a>];</td></tr>
<tr><th id="332">332</th><td></td></tr>
<tr><th id="333">333</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="334">334</th><td>	<a class="macro" href="../../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(inbuf)); void *__ret; if (__builtin_constant_p(sizeof(inbuf)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((translations[3]), (inbuf), __len); else __ret = __builtin_memcpy((translations[3]), (inbuf), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>], <a class="local col9 ref" href="#29inbuf" title='inbuf' data-ref="29inbuf">inbuf</a>, <b>sizeof</b>(<a class="local col9 ref" href="#29inbuf" title='inbuf' data-ref="29inbuf">inbuf</a>));</td></tr>
<tr><th id="335">335</th><td>	<a class="tu ref fn" href="#update_user_maps" title='update_user_maps' data-use='c' data-ref="update_user_maps">update_user_maps</a>();</td></tr>
<tr><th id="336">336</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="337">337</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="338">338</th><td>}</td></tr>
<tr><th id="339">339</th><td></td></tr>
<tr><th id="340">340</th><td><em>int</em> <dfn class="decl def fn" id="con_get_trans_old" title='con_get_trans_old' data-ref="con_get_trans_old">con_get_trans_old</dfn>(<em>unsigned</em> <em>char</em> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> * <dfn class="local col1 decl" id="31arg" title='arg' data-type='unsigned char *' data-ref="31arg">arg</dfn>)</td></tr>
<tr><th id="341">341</th><td>{</td></tr>
<tr><th id="342">342</th><td>	<em>int</em> <dfn class="local col2 decl" id="32i" title='i' data-type='int' data-ref="32i">i</dfn>, <dfn class="local col3 decl" id="33ch" title='ch' data-type='int' data-ref="33ch">ch</dfn>;</td></tr>
<tr><th id="343">343</th><td>	<em>unsigned</em> <em>short</em> *<dfn class="local col4 decl" id="34p" title='p' data-type='unsigned short *' data-ref="34p">p</dfn> = <a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>];</td></tr>
<tr><th id="344">344</th><td>	<em>unsigned</em> <em>char</em> <dfn class="local col5 decl" id="35outbuf" title='outbuf' data-type='unsigned char [256]' data-ref="35outbuf">outbuf</dfn>[<a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>];</td></tr>
<tr><th id="345">345</th><td></td></tr>
<tr><th id="346">346</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="347">347</th><td>	<b>for</b> (<a class="local col2 ref" href="#32i" title='i' data-ref="32i">i</a> = <var>0</var>; <a class="local col2 ref" href="#32i" title='i' data-ref="32i">i</a> &lt; <a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a> ; <a class="local col2 ref" href="#32i" title='i' data-ref="32i">i</a>++)</td></tr>
<tr><th id="348">348</th><td>	{</td></tr>
<tr><th id="349">349</th><td>		<a class="local col3 ref" href="#33ch" title='ch' data-ref="33ch">ch</a> = <a class="ref fn" href="#conv_uni_to_pc" title='conv_uni_to_pc' data-ref="conv_uni_to_pc">conv_uni_to_pc</a>(<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="ref" href="../../../include/linux/vt_kern.h.html#fg_console" title='fg_console' data-ref="fg_console">fg_console</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>, <a class="local col4 ref" href="#34p" title='p' data-ref="34p">p</a>[<a class="local col2 ref" href="#32i" title='i' data-ref="32i">i</a>]);</td></tr>
<tr><th id="350">350</th><td>		<a class="local col5 ref" href="#35outbuf" title='outbuf' data-ref="35outbuf">outbuf</a>[<a class="local col2 ref" href="#32i" title='i' data-ref="32i">i</a>] = (<a class="local col3 ref" href="#33ch" title='ch' data-ref="33ch">ch</a> &amp; ~<var>0xff</var>) ? <var>0</var> : <a class="local col3 ref" href="#33ch" title='ch' data-ref="33ch">ch</a>;</td></tr>
<tr><th id="351">351</th><td>	}</td></tr>
<tr><th id="352">352</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="353">353</th><td></td></tr>
<tr><th id="354">354</th><td>	<b>return</b> <a class="ref fn" href="../../../include/linux/uaccess.h.html#copy_to_user" title='copy_to_user' data-ref="copy_to_user">copy_to_user</a>(<a class="local col1 ref" href="#31arg" title='arg' data-ref="31arg">arg</a>, <a class="local col5 ref" href="#35outbuf" title='outbuf' data-ref="35outbuf">outbuf</a>, <b>sizeof</b>(<a class="local col5 ref" href="#35outbuf" title='outbuf' data-ref="35outbuf">outbuf</a>)) ? -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#18" title="14" data-ref="_M/EFAULT">EFAULT</a> : <var>0</var>;</td></tr>
<tr><th id="355">355</th><td>}</td></tr>
<tr><th id="356">356</th><td></td></tr>
<tr><th id="357">357</th><td><em>int</em> <dfn class="decl def fn" id="con_set_trans_new" title='con_set_trans_new' data-ref="con_set_trans_new">con_set_trans_new</dfn>(<a class="typedef" href="../../../include/linux/types.h.html#ushort" title='ushort' data-type='unsigned short' data-ref="ushort">ushort</a> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> * <dfn class="local col6 decl" id="36arg" title='arg' data-type='ushort *' data-ref="36arg">arg</dfn>)</td></tr>
<tr><th id="358">358</th><td>{</td></tr>
<tr><th id="359">359</th><td>	<em>unsigned</em> <em>short</em> <dfn class="local col7 decl" id="37inbuf" title='inbuf' data-type='unsigned short [256]' data-ref="37inbuf">inbuf</dfn>[<a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>];</td></tr>
<tr><th id="360">360</th><td></td></tr>
<tr><th id="361">361</th><td>	<b>if</b> (<a class="ref fn" href="../../../include/linux/uaccess.h.html#copy_from_user" title='copy_from_user' data-ref="copy_from_user">copy_from_user</a>(<a class="local col7 ref" href="#37inbuf" title='inbuf' data-ref="37inbuf">inbuf</a>, <a class="local col6 ref" href="#36arg" title='arg' data-ref="36arg">arg</a>, <b>sizeof</b>(<a class="local col7 ref" href="#37inbuf" title='inbuf' data-ref="37inbuf">inbuf</a>)))</td></tr>
<tr><th id="362">362</th><td>		<b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#18" title="14" data-ref="_M/EFAULT">EFAULT</a>;</td></tr>
<tr><th id="363">363</th><td></td></tr>
<tr><th id="364">364</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="365">365</th><td>	<a class="macro" href="../../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(inbuf)); void *__ret; if (__builtin_constant_p(sizeof(inbuf)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((translations[3]), (inbuf), __len); else __ret = __builtin_memcpy((translations[3]), (inbuf), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>], <a class="local col7 ref" href="#37inbuf" title='inbuf' data-ref="37inbuf">inbuf</a>, <b>sizeof</b>(<a class="local col7 ref" href="#37inbuf" title='inbuf' data-ref="37inbuf">inbuf</a>));</td></tr>
<tr><th id="366">366</th><td>	<a class="tu ref fn" href="#update_user_maps" title='update_user_maps' data-use='c' data-ref="update_user_maps">update_user_maps</a>();</td></tr>
<tr><th id="367">367</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="368">368</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="369">369</th><td>}</td></tr>
<tr><th id="370">370</th><td></td></tr>
<tr><th id="371">371</th><td><em>int</em> <dfn class="decl def fn" id="con_get_trans_new" title='con_get_trans_new' data-ref="con_get_trans_new">con_get_trans_new</dfn>(<a class="typedef" href="../../../include/linux/types.h.html#ushort" title='ushort' data-type='unsigned short' data-ref="ushort">ushort</a> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> * <dfn class="local col8 decl" id="38arg" title='arg' data-type='ushort *' data-ref="38arg">arg</dfn>)</td></tr>
<tr><th id="372">372</th><td>{</td></tr>
<tr><th id="373">373</th><td>	<em>unsigned</em> <em>short</em> <dfn class="local col9 decl" id="39outbuf" title='outbuf' data-type='unsigned short [256]' data-ref="39outbuf">outbuf</dfn>[<a class="macro" href="../../../include/uapi/linux/kd.h.html#55" title="256" data-ref="_M/E_TABSZ">E_TABSZ</a>];</td></tr>
<tr><th id="374">374</th><td></td></tr>
<tr><th id="375">375</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="376">376</th><td>	<a class="macro" href="../../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(outbuf)); void *__ret; if (__builtin_constant_p(sizeof(outbuf)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((outbuf), (translations[3]), __len); else __ret = __builtin_memcpy((outbuf), (translations[3]), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col9 ref" href="#39outbuf" title='outbuf' data-ref="39outbuf">outbuf</a>, <a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>], <b>sizeof</b>(<a class="local col9 ref" href="#39outbuf" title='outbuf' data-ref="39outbuf">outbuf</a>));</td></tr>
<tr><th id="377">377</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="378">378</th><td></td></tr>
<tr><th id="379">379</th><td>	<b>return</b> <a class="ref fn" href="../../../include/linux/uaccess.h.html#copy_to_user" title='copy_to_user' data-ref="copy_to_user">copy_to_user</a>(<a class="local col8 ref" href="#38arg" title='arg' data-ref="38arg">arg</a>, <a class="local col9 ref" href="#39outbuf" title='outbuf' data-ref="39outbuf">outbuf</a>, <b>sizeof</b>(<a class="local col9 ref" href="#39outbuf" title='outbuf' data-ref="39outbuf">outbuf</a>)) ? -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#18" title="14" data-ref="_M/EFAULT">EFAULT</a> : <var>0</var>;</td></tr>
<tr><th id="380">380</th><td>}</td></tr>
<tr><th id="381">381</th><td></td></tr>
<tr><th id="382">382</th><td><i>/*</i></td></tr>
<tr><th id="383">383</th><td><i> * Unicode -&gt; current font conversion </i></td></tr>
<tr><th id="384">384</th><td><i> *</i></td></tr>
<tr><th id="385">385</th><td><i> * A font has at most 512 chars, usually 256.</i></td></tr>
<tr><th id="386">386</th><td><i> * But one font position may represent several Unicode chars.</i></td></tr>
<tr><th id="387">387</th><td><i> * A hashtable is somewhat of a pain to deal with, so use a</i></td></tr>
<tr><th id="388">388</th><td><i> * "paged table" instead.  Simulation has shown the memory cost of</i></td></tr>
<tr><th id="389">389</th><td><i> * this 3-level paged table scheme to be comparable to a hash table.</i></td></tr>
<tr><th id="390">390</th><td><i> */</i></td></tr>
<tr><th id="391">391</th><td></td></tr>
<tr><th id="392">392</th><td><b>extern</b> <a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8">u8</a> <dfn class="decl" id="dfont_unicount" title='dfont_unicount' data-ref="dfont_unicount">dfont_unicount</dfn>[];	<i>/* Defined in console_defmap.c */</i></td></tr>
<tr><th id="393">393</th><td><b>extern</b> <a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> <dfn class="decl" id="dfont_unitable" title='dfont_unitable' data-ref="dfont_unitable">dfont_unitable</dfn>[];</td></tr>
<tr><th id="394">394</th><td></td></tr>
<tr><th id="395">395</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="con_release_unimap" title='con_release_unimap' data-type='void con_release_unimap(struct uni_pagedir * p)' data-ref="con_release_unimap">con_release_unimap</dfn>(<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col0 decl" id="40p" title='p' data-type='struct uni_pagedir *' data-ref="40p">p</dfn>)</td></tr>
<tr><th id="396">396</th><td>{</td></tr>
<tr><th id="397">397</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col1 decl" id="41p1" title='p1' data-type='u16 **' data-ref="41p1">p1</dfn>;</td></tr>
<tr><th id="398">398</th><td>	<em>int</em> <dfn class="local col2 decl" id="42i" title='i' data-type='int' data-ref="42i">i</dfn>, <dfn class="local col3 decl" id="43j" title='j' data-type='int' data-ref="43j">j</dfn>;</td></tr>
<tr><th id="399">399</th><td></td></tr>
<tr><th id="400">400</th><td>	<b>if</b> (<a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a> == <a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>) <a class="tu ref" href="#dflt" title='dflt' data-use='w' data-ref="dflt">dflt</a> = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;  </td></tr>
<tr><th id="401">401</th><td>	<b>for</b> (<a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a> = <var>0</var>; <a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a> &lt; <var>32</var>; <a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a>++) {</td></tr>
<tr><th id="402">402</th><td>		<a class="local col1 ref" href="#41p1" title='p1' data-ref="41p1">p1</a> = <a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a>];</td></tr>
<tr><th id="403">403</th><td>		<b>if</b> (<a class="local col1 ref" href="#41p1" title='p1' data-ref="41p1">p1</a> != <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="404">404</th><td>			<b>for</b> (<a class="local col3 ref" href="#43j" title='j' data-ref="43j">j</a> = <var>0</var>; <a class="local col3 ref" href="#43j" title='j' data-ref="43j">j</a> &lt; <var>32</var>; <a class="local col3 ref" href="#43j" title='j' data-ref="43j">j</a>++)</td></tr>
<tr><th id="405">405</th><td>				<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col1 ref" href="#41p1" title='p1' data-ref="41p1">p1</a>[<a class="local col3 ref" href="#43j" title='j' data-ref="43j">j</a>]);</td></tr>
<tr><th id="406">406</th><td>			<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col1 ref" href="#41p1" title='p1' data-ref="41p1">p1</a>);</td></tr>
<tr><th id="407">407</th><td>		}</td></tr>
<tr><th id="408">408</th><td>		<a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a>] = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="409">409</th><td>	}</td></tr>
<tr><th id="410">410</th><td>	<b>for</b> (<a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a> = <var>0</var>; <a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a> &lt; <var>4</var>; <a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a>++) {</td></tr>
<tr><th id="411">411</th><td>		<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</a>[<a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a>]);</td></tr>
<tr><th id="412">412</th><td>		<a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_translations" title='uni_pagedir::inverse_translations' data-ref="uni_pagedir::inverse_translations">inverse_translations</a>[<a class="local col2 ref" href="#42i" title='i' data-ref="42i">i</a>] = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="413">413</th><td>	}</td></tr>
<tr><th id="414">414</th><td>	<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</a>);</td></tr>
<tr><th id="415">415</th><td>	<a class="local col0 ref" href="#40p" title='p' data-ref="40p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::inverse_trans_unicode" title='uni_pagedir::inverse_trans_unicode' data-ref="uni_pagedir::inverse_trans_unicode">inverse_trans_unicode</a> = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="416">416</th><td>}</td></tr>
<tr><th id="417">417</th><td></td></tr>
<tr><th id="418">418</th><td><i>/* Caller must hold the console lock */</i></td></tr>
<tr><th id="419">419</th><td><em>void</em> <dfn class="decl def fn" id="con_free_unimap" title='con_free_unimap' data-ref="con_free_unimap">con_free_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col4 decl" id="44vc" title='vc' data-type='struct vc_data *' data-ref="44vc">vc</dfn>)</td></tr>
<tr><th id="420">420</th><td>{</td></tr>
<tr><th id="421">421</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col5 decl" id="45p" title='p' data-type='struct uni_pagedir *' data-ref="45p">p</dfn>;</td></tr>
<tr><th id="422">422</th><td></td></tr>
<tr><th id="423">423</th><td>	<a class="local col5 ref" href="#45p" title='p' data-ref="45p">p</a> = *<a class="local col4 ref" href="#44vc" title='vc' data-ref="44vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="424">424</th><td>	<b>if</b> (!<a class="local col5 ref" href="#45p" title='p' data-ref="45p">p</a>)</td></tr>
<tr><th id="425">425</th><td>		<b>return</b>;</td></tr>
<tr><th id="426">426</th><td>	*<a class="local col4 ref" href="#44vc" title='vc' data-ref="44vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="427">427</th><td>	<b>if</b> (--<a class="local col5 ref" href="#45p" title='p' data-ref="45p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>)</td></tr>
<tr><th id="428">428</th><td>		<b>return</b>;</td></tr>
<tr><th id="429">429</th><td>	<a class="tu ref fn" href="#con_release_unimap" title='con_release_unimap' data-use='c' data-ref="con_release_unimap">con_release_unimap</a>(<a class="local col5 ref" href="#45p" title='p' data-ref="45p">p</a>);</td></tr>
<tr><th id="430">430</th><td>	<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col5 ref" href="#45p" title='p' data-ref="45p">p</a>);</td></tr>
<tr><th id="431">431</th><td>}</td></tr>
<tr><th id="432">432</th><td>  </td></tr>
<tr><th id="433">433</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="con_unify_unimap" title='con_unify_unimap' data-type='int con_unify_unimap(struct vc_data * conp, struct uni_pagedir * p)' data-ref="con_unify_unimap">con_unify_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col6 decl" id="46conp" title='conp' data-type='struct vc_data *' data-ref="46conp">conp</dfn>, <b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col7 decl" id="47p" title='p' data-type='struct uni_pagedir *' data-ref="47p">p</dfn>)</td></tr>
<tr><th id="434">434</th><td>{</td></tr>
<tr><th id="435">435</th><td>	<em>int</em> <dfn class="local col8 decl" id="48i" title='i' data-type='int' data-ref="48i">i</dfn>, <dfn class="local col9 decl" id="49j" title='j' data-type='int' data-ref="49j">j</dfn>, <dfn class="local col0 decl" id="50k" title='k' data-type='int' data-ref="50k">k</dfn>;</td></tr>
<tr><th id="436">436</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col1 decl" id="51q" title='q' data-type='struct uni_pagedir *' data-ref="51q">q</dfn>;</td></tr>
<tr><th id="437">437</th><td>	</td></tr>
<tr><th id="438">438</th><td>	<b>for</b> (<a class="local col8 ref" href="#48i" title='i' data-ref="48i">i</a> = <var>0</var>; <a class="local col8 ref" href="#48i" title='i' data-ref="48i">i</a> &lt; <a class="macro" href="../../../include/uapi/linux/vt.h.html#11" title="63" data-ref="_M/MAX_NR_CONSOLES">MAX_NR_CONSOLES</a>; <a class="local col8 ref" href="#48i" title='i' data-ref="48i">i</a>++) {</td></tr>
<tr><th id="439">439</th><td>		<b>if</b> (!<a class="ref fn" href="../../../include/linux/vt_kern.h.html#vc_cons_allocated" title='vc_cons_allocated' data-ref="vc_cons_allocated">vc_cons_allocated</a>(<a class="local col8 ref" href="#48i" title='i' data-ref="48i">i</a>))</td></tr>
<tr><th id="440">440</th><td>			<b>continue</b>;</td></tr>
<tr><th id="441">441</th><td>		<a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a> = *<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="local col8 ref" href="#48i" title='i' data-ref="48i">i</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="442">442</th><td>		<b>if</b> (!<a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a> || <a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a> == <a class="local col7 ref" href="#47p" title='p' data-ref="47p">p</a> || <a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a>-&gt;<a class="ref field" href="#uni_pagedir::sum" title='uni_pagedir::sum' data-ref="uni_pagedir::sum">sum</a> != <a class="local col7 ref" href="#47p" title='p' data-ref="47p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::sum" title='uni_pagedir::sum' data-ref="uni_pagedir::sum">sum</a>)</td></tr>
<tr><th id="443">443</th><td>			<b>continue</b>;</td></tr>
<tr><th id="444">444</th><td>		<b>for</b> (<a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a> = <var>0</var>; <a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a> &lt; <var>32</var>; <a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a>++) {</td></tr>
<tr><th id="445">445</th><td>			<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col2 decl" id="52p1" title='p1' data-type='u16 **' data-ref="52p1">p1</dfn>, **<dfn class="local col3 decl" id="53q1" title='q1' data-type='u16 **' data-ref="53q1">q1</dfn>;</td></tr>
<tr><th id="446">446</th><td>			<a class="local col2 ref" href="#52p1" title='p1' data-ref="52p1">p1</a> = <a class="local col7 ref" href="#47p" title='p' data-ref="47p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a>]; <a class="local col3 ref" href="#53q1" title='q1' data-ref="53q1">q1</a> = <a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a>];</td></tr>
<tr><th id="447">447</th><td>			<b>if</b> (!<a class="local col2 ref" href="#52p1" title='p1' data-ref="52p1">p1</a> &amp;&amp; !<a class="local col3 ref" href="#53q1" title='q1' data-ref="53q1">q1</a>)</td></tr>
<tr><th id="448">448</th><td>				<b>continue</b>;</td></tr>
<tr><th id="449">449</th><td>			<b>if</b> (!<a class="local col2 ref" href="#52p1" title='p1' data-ref="52p1">p1</a> || !<a class="local col3 ref" href="#53q1" title='q1' data-ref="53q1">q1</a>)</td></tr>
<tr><th id="450">450</th><td>				<b>break</b>;</td></tr>
<tr><th id="451">451</th><td>			<b>for</b> (<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a> = <var>0</var>; <a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a> &lt; <var>32</var>; <a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>++) {</td></tr>
<tr><th id="452">452</th><td>				<b>if</b> (!<a class="local col2 ref" href="#52p1" title='p1' data-ref="52p1">p1</a>[<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>] &amp;&amp; !<a class="local col3 ref" href="#53q1" title='q1' data-ref="53q1">q1</a>[<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>])</td></tr>
<tr><th id="453">453</th><td>					<b>continue</b>;</td></tr>
<tr><th id="454">454</th><td>				<b>if</b> (!<a class="local col2 ref" href="#52p1" title='p1' data-ref="52p1">p1</a>[<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>] || !<a class="local col3 ref" href="#53q1" title='q1' data-ref="53q1">q1</a>[<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>])</td></tr>
<tr><th id="455">455</th><td>					<b>break</b>;</td></tr>
<tr><th id="456">456</th><td>				<b>if</b> (<a class="ref fn" href="../../../arch/x86/include/asm/string_64.h.html#memcmp" title='memcmp' data-ref="memcmp">memcmp</a>(<a class="local col2 ref" href="#52p1" title='p1' data-ref="52p1">p1</a>[<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>], <a class="local col3 ref" href="#53q1" title='q1' data-ref="53q1">q1</a>[<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a>], <var>64</var>*<b>sizeof</b>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a>)))</td></tr>
<tr><th id="457">457</th><td>					<b>break</b>;</td></tr>
<tr><th id="458">458</th><td>			}</td></tr>
<tr><th id="459">459</th><td>			<b>if</b> (<a class="local col0 ref" href="#50k" title='k' data-ref="50k">k</a> &lt; <var>32</var>)</td></tr>
<tr><th id="460">460</th><td>				<b>break</b>;</td></tr>
<tr><th id="461">461</th><td>		}</td></tr>
<tr><th id="462">462</th><td>		<b>if</b> (<a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a> == <var>32</var>) {</td></tr>
<tr><th id="463">463</th><td>			<a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>++;</td></tr>
<tr><th id="464">464</th><td>			*<a class="local col6 ref" href="#46conp" title='conp' data-ref="46conp">conp</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> = <a class="local col1 ref" href="#51q" title='q' data-ref="51q">q</a>;</td></tr>
<tr><th id="465">465</th><td>			<a class="tu ref fn" href="#con_release_unimap" title='con_release_unimap' data-use='c' data-ref="con_release_unimap">con_release_unimap</a>(<a class="local col7 ref" href="#47p" title='p' data-ref="47p">p</a>);</td></tr>
<tr><th id="466">466</th><td>			<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col7 ref" href="#47p" title='p' data-ref="47p">p</a>);</td></tr>
<tr><th id="467">467</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="468">468</th><td>		}</td></tr>
<tr><th id="469">469</th><td>	}</td></tr>
<tr><th id="470">470</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="471">471</th><td>}</td></tr>
<tr><th id="472">472</th><td></td></tr>
<tr><th id="473">473</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="474">474</th><td><dfn class="tu decl def fn" id="con_insert_unipair" title='con_insert_unipair' data-type='int con_insert_unipair(struct uni_pagedir * p, u_short unicode, u_short fontpos)' data-ref="con_insert_unipair">con_insert_unipair</dfn>(<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col4 decl" id="54p" title='p' data-type='struct uni_pagedir *' data-ref="54p">p</dfn>, <a class="typedef" href="../../../include/linux/types.h.html#u_short" title='u_short' data-type='unsigned short' data-ref="u_short">u_short</a> <dfn class="local col5 decl" id="55unicode" title='unicode' data-type='u_short' data-ref="55unicode">unicode</dfn>, <a class="typedef" href="../../../include/linux/types.h.html#u_short" title='u_short' data-type='unsigned short' data-ref="u_short">u_short</a> <dfn class="local col6 decl" id="56fontpos" title='fontpos' data-type='u_short' data-ref="56fontpos">fontpos</dfn>)</td></tr>
<tr><th id="475">475</th><td>{</td></tr>
<tr><th id="476">476</th><td>	<em>int</em> <dfn class="local col7 decl" id="57i" title='i' data-type='int' data-ref="57i">i</dfn>, <dfn class="local col8 decl" id="58n" title='n' data-type='int' data-ref="58n">n</dfn>;</td></tr>
<tr><th id="477">477</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col9 decl" id="59p1" title='p1' data-type='u16 **' data-ref="59p1">p1</dfn>, *<dfn class="local col0 decl" id="60p2" title='p2' data-type='u16 *' data-ref="60p2">p2</dfn>;</td></tr>
<tr><th id="478">478</th><td></td></tr>
<tr><th id="479">479</th><td>	<a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a> = <a class="local col4 ref" href="#54p" title='p' data-ref="54p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col8 ref" href="#58n" title='n' data-ref="58n">n</a> = <a class="local col5 ref" href="#55unicode" title='unicode' data-ref="55unicode">unicode</a> &gt;&gt; <var>11</var>];</td></tr>
<tr><th id="480">480</th><td>	<b>if</b> (!<a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a>) {</td></tr>
<tr><th id="481">481</th><td>		<a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a> = <a class="local col4 ref" href="#54p" title='p' data-ref="54p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col8 ref" href="#58n" title='n' data-ref="58n">n</a>] = <a class="ref fn" href="../../../include/linux/slab.h.html#kmalloc" title='kmalloc' data-ref="kmalloc">kmalloc</a>(<var>32</var>*<b>sizeof</b>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> *), <a class="macro" href="../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="482">482</th><td>		<b>if</b> (!<a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a>) <b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="483">483</th><td>		<b>for</b> (<a class="local col7 ref" href="#57i" title='i' data-ref="57i">i</a> = <var>0</var>; <a class="local col7 ref" href="#57i" title='i' data-ref="57i">i</a> &lt; <var>32</var>; <a class="local col7 ref" href="#57i" title='i' data-ref="57i">i</a>++)</td></tr>
<tr><th id="484">484</th><td>			<a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a>[<a class="local col7 ref" href="#57i" title='i' data-ref="57i">i</a>] = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="485">485</th><td>	}</td></tr>
<tr><th id="486">486</th><td></td></tr>
<tr><th id="487">487</th><td>	<a class="local col0 ref" href="#60p2" title='p2' data-ref="60p2">p2</a> = <a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a>[<a class="local col8 ref" href="#58n" title='n' data-ref="58n">n</a> = (<a class="local col5 ref" href="#55unicode" title='unicode' data-ref="55unicode">unicode</a> &gt;&gt; <var>6</var>) &amp; <var>0x1f</var>];</td></tr>
<tr><th id="488">488</th><td>	<b>if</b> (!<a class="local col0 ref" href="#60p2" title='p2' data-ref="60p2">p2</a>) {</td></tr>
<tr><th id="489">489</th><td>		<a class="local col0 ref" href="#60p2" title='p2' data-ref="60p2">p2</a> = <a class="local col9 ref" href="#59p1" title='p1' data-ref="59p1">p1</a>[<a class="local col8 ref" href="#58n" title='n' data-ref="58n">n</a>] = <a class="ref fn" href="../../../include/linux/slab.h.html#kmalloc" title='kmalloc' data-ref="kmalloc">kmalloc</a>(<var>64</var>*<b>sizeof</b>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a>), <a class="macro" href="../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="490">490</th><td>		<b>if</b> (!<a class="local col0 ref" href="#60p2" title='p2' data-ref="60p2">p2</a>) <b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="491">491</th><td>		<a class="ref fn" href="../../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col0 ref" href="#60p2" title='p2' data-ref="60p2">p2</a>, <var>0xff</var>, <var>64</var>*<b>sizeof</b>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a>)); <i>/* No glyphs for the characters (yet) */</i></td></tr>
<tr><th id="492">492</th><td>	}</td></tr>
<tr><th id="493">493</th><td></td></tr>
<tr><th id="494">494</th><td>	<a class="local col0 ref" href="#60p2" title='p2' data-ref="60p2">p2</a>[<a class="local col5 ref" href="#55unicode" title='unicode' data-ref="55unicode">unicode</a> &amp; <var>0x3f</var>] = <a class="local col6 ref" href="#56fontpos" title='fontpos' data-ref="56fontpos">fontpos</a>;</td></tr>
<tr><th id="495">495</th><td>	</td></tr>
<tr><th id="496">496</th><td>	<a class="local col4 ref" href="#54p" title='p' data-ref="54p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::sum" title='uni_pagedir::sum' data-ref="uni_pagedir::sum">sum</a> += (<a class="local col6 ref" href="#56fontpos" title='fontpos' data-ref="56fontpos">fontpos</a> &lt;&lt; <var>20</var>) + <a class="local col5 ref" href="#55unicode" title='unicode' data-ref="55unicode">unicode</a>;</td></tr>
<tr><th id="497">497</th><td></td></tr>
<tr><th id="498">498</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="499">499</th><td>}</td></tr>
<tr><th id="500">500</th><td></td></tr>
<tr><th id="501">501</th><td><i  data-doc="con_do_clear_unimap">/* Caller must hold the lock */</i></td></tr>
<tr><th id="502">502</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="con_do_clear_unimap" title='con_do_clear_unimap' data-type='int con_do_clear_unimap(struct vc_data * vc)' data-ref="con_do_clear_unimap">con_do_clear_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col1 decl" id="61vc" title='vc' data-type='struct vc_data *' data-ref="61vc">vc</dfn>)</td></tr>
<tr><th id="503">503</th><td>{</td></tr>
<tr><th id="504">504</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col2 decl" id="62p" title='p' data-type='struct uni_pagedir *' data-ref="62p">p</dfn>, *<dfn class="local col3 decl" id="63q" title='q' data-type='struct uni_pagedir *' data-ref="63q">q</dfn>;</td></tr>
<tr><th id="505">505</th><td></td></tr>
<tr><th id="506">506</th><td>	<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a> = *<a class="local col1 ref" href="#61vc" title='vc' data-ref="61vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="507">507</th><td>	<b>if</b> (!<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a> || --<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>) {</td></tr>
<tr><th id="508">508</th><td>		<a class="local col3 ref" href="#63q" title='q' data-ref="63q">q</a> = <a class="ref fn" href="../../../include/linux/slab.h.html#kzalloc" title='kzalloc' data-ref="kzalloc">kzalloc</a>(<b>sizeof</b>(*<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>), <a class="macro" href="../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="509">509</th><td>		<b>if</b> (!<a class="local col3 ref" href="#63q" title='q' data-ref="63q">q</a>) {</td></tr>
<tr><th id="510">510</th><td>			<b>if</b> (<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>)</td></tr>
<tr><th id="511">511</th><td>				<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>++;</td></tr>
<tr><th id="512">512</th><td>			<b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="513">513</th><td>		}</td></tr>
<tr><th id="514">514</th><td>		<a class="local col3 ref" href="#63q" title='q' data-ref="63q">q</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>=<var>1</var>;</td></tr>
<tr><th id="515">515</th><td>		*<a class="local col1 ref" href="#61vc" title='vc' data-ref="61vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> = <a class="local col3 ref" href="#63q" title='q' data-ref="63q">q</a>;</td></tr>
<tr><th id="516">516</th><td>	} <b>else</b> {</td></tr>
<tr><th id="517">517</th><td>		<b>if</b> (<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a> == <a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>) <a class="tu ref" href="#dflt" title='dflt' data-use='w' data-ref="dflt">dflt</a> = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="518">518</th><td>		<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>++;</td></tr>
<tr><th id="519">519</th><td>		<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::sum" title='uni_pagedir::sum' data-ref="uni_pagedir::sum">sum</a> = <var>0</var>;</td></tr>
<tr><th id="520">520</th><td>		<a class="tu ref fn" href="#con_release_unimap" title='con_release_unimap' data-use='c' data-ref="con_release_unimap">con_release_unimap</a>(<a class="local col2 ref" href="#62p" title='p' data-ref="62p">p</a>);</td></tr>
<tr><th id="521">521</th><td>	}</td></tr>
<tr><th id="522">522</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="523">523</th><td>}</td></tr>
<tr><th id="524">524</th><td></td></tr>
<tr><th id="525">525</th><td><em>int</em> <dfn class="decl def fn" id="con_clear_unimap" title='con_clear_unimap' data-ref="con_clear_unimap">con_clear_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col4 decl" id="64vc" title='vc' data-type='struct vc_data *' data-ref="64vc">vc</dfn>)</td></tr>
<tr><th id="526">526</th><td>{</td></tr>
<tr><th id="527">527</th><td>	<em>int</em> <dfn class="local col5 decl" id="65ret" title='ret' data-type='int' data-ref="65ret">ret</dfn>;</td></tr>
<tr><th id="528">528</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="529">529</th><td>	<a class="local col5 ref" href="#65ret" title='ret' data-ref="65ret">ret</a> = <a class="tu ref fn" href="#con_do_clear_unimap" title='con_do_clear_unimap' data-use='c' data-ref="con_do_clear_unimap">con_do_clear_unimap</a>(<a class="local col4 ref" href="#64vc" title='vc' data-ref="64vc">vc</a>);</td></tr>
<tr><th id="530">530</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="531">531</th><td>	<b>return</b> <a class="local col5 ref" href="#65ret" title='ret' data-ref="65ret">ret</a>;</td></tr>
<tr><th id="532">532</th><td>}</td></tr>
<tr><th id="533">533</th><td>	</td></tr>
<tr><th id="534">534</th><td><em>int</em> <dfn class="decl def fn" id="con_set_unimap" title='con_set_unimap' data-ref="con_set_unimap">con_set_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col6 decl" id="66vc" title='vc' data-type='struct vc_data *' data-ref="66vc">vc</dfn>, <a class="typedef" href="../../../include/linux/types.h.html#ushort" title='ushort' data-type='unsigned short' data-ref="ushort">ushort</a> <dfn class="local col7 decl" id="67ct" title='ct' data-type='ushort' data-ref="67ct">ct</dfn>, <b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col8 decl" id="68list" title='list' data-type='struct unipair *' data-ref="68list">list</dfn>)</td></tr>
<tr><th id="535">535</th><td>{</td></tr>
<tr><th id="536">536</th><td>	<em>int</em> <dfn class="local col9 decl" id="69err" title='err' data-type='int' data-ref="69err">err</dfn> = <var>0</var>, <dfn class="local col0 decl" id="70err1" title='err1' data-type='int' data-ref="70err1">err1</dfn>, <dfn class="local col1 decl" id="71i" title='i' data-type='int' data-ref="71i">i</dfn>;</td></tr>
<tr><th id="537">537</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col2 decl" id="72p" title='p' data-type='struct uni_pagedir *' data-ref="72p">p</dfn>, *<dfn class="local col3 decl" id="73q" title='q' data-type='struct uni_pagedir *' data-ref="73q">q</dfn>;</td></tr>
<tr><th id="538">538</th><td>	<b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a> *<dfn class="local col4 decl" id="74unilist" title='unilist' data-type='struct unipair *' data-ref="74unilist">unilist</dfn>, *<dfn class="local col5 decl" id="75plist" title='plist' data-type='struct unipair *' data-ref="75plist">plist</dfn>;</td></tr>
<tr><th id="539">539</th><td></td></tr>
<tr><th id="540">540</th><td>	<b>if</b> (!<a class="local col7 ref" href="#67ct" title='ct' data-ref="67ct">ct</a>)</td></tr>
<tr><th id="541">541</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="542">542</th><td></td></tr>
<tr><th id="543">543</th><td>	<a class="local col4 ref" href="#74unilist" title='unilist' data-ref="74unilist">unilist</a> = <a class="ref fn" href="../../../include/linux/string.h.html#memdup_user" title='memdup_user' data-ref="memdup_user">memdup_user</a>(<a class="local col8 ref" href="#68list" title='list' data-ref="68list">list</a>, <a class="local col7 ref" href="#67ct" title='ct' data-ref="67ct">ct</a> * <b>sizeof</b>(<b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a>));</td></tr>
<tr><th id="544">544</th><td>	<b>if</b> (<a class="ref fn" href="../../../include/linux/err.h.html#IS_ERR" title='IS_ERR' data-ref="IS_ERR">IS_ERR</a>(<a class="local col4 ref" href="#74unilist" title='unilist' data-ref="74unilist">unilist</a>))</td></tr>
<tr><th id="545">545</th><td>		<b>return</b> <a class="ref fn" href="../../../include/linux/err.h.html#PTR_ERR" title='PTR_ERR' data-ref="PTR_ERR">PTR_ERR</a>(<a class="local col4 ref" href="#74unilist" title='unilist' data-ref="74unilist">unilist</a>);</td></tr>
<tr><th id="546">546</th><td></td></tr>
<tr><th id="547">547</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="548">548</th><td></td></tr>
<tr><th id="549">549</th><td>	<i>/* Save original vc_unipagdir_loc in case we allocate a new one */</i></td></tr>
<tr><th id="550">550</th><td>	<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a> = *<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="551">551</th><td></td></tr>
<tr><th id="552">552</th><td>	<b>if</b> (!<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>) {</td></tr>
<tr><th id="553">553</th><td>		<a class="local col9 ref" href="#69err" title='err' data-ref="69err">err</a> = -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="554">554</th><td></td></tr>
<tr><th id="555">555</th><td>		<b>goto</b> <a class="lbl" href="#76out_unlock" data-ref="76out_unlock">out_unlock</a>;</td></tr>
<tr><th id="556">556</th><td>	}</td></tr>
<tr><th id="557">557</th><td>	</td></tr>
<tr><th id="558">558</th><td>	<b>if</b> (<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a> &gt; <var>1</var>) {</td></tr>
<tr><th id="559">559</th><td>		<em>int</em> <dfn class="local col7 decl" id="77j" title='j' data-type='int' data-ref="77j">j</dfn>, <dfn class="local col8 decl" id="78k" title='k' data-type='int' data-ref="78k">k</dfn>;</td></tr>
<tr><th id="560">560</th><td>		<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col9 decl" id="79p1" title='p1' data-type='u16 **' data-ref="79p1">p1</dfn>, *<dfn class="local col0 decl" id="80p2" title='p2' data-type='u16 *' data-ref="80p2">p2</dfn>, <dfn class="local col1 decl" id="81l" title='l' data-type='u16' data-ref="81l">l</dfn>;</td></tr>
<tr><th id="561">561</th><td>		</td></tr>
<tr><th id="562">562</th><td>		<a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a> = <a class="tu ref fn" href="#con_do_clear_unimap" title='con_do_clear_unimap' data-use='c' data-ref="con_do_clear_unimap">con_do_clear_unimap</a>(<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>);</td></tr>
<tr><th id="563">563</th><td>		<b>if</b> (<a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a>) {</td></tr>
<tr><th id="564">564</th><td>			<a class="local col9 ref" href="#69err" title='err' data-ref="69err">err</a> = <a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a>;</td></tr>
<tr><th id="565">565</th><td>			<b>goto</b> <a class="lbl" href="#76out_unlock" data-ref="76out_unlock">out_unlock</a>;</td></tr>
<tr><th id="566">566</th><td>		}</td></tr>
<tr><th id="567">567</th><td>		</td></tr>
<tr><th id="568">568</th><td>		<i>/*</i></td></tr>
<tr><th id="569">569</th><td><i>		 * Since refcount was &gt; 1, con_clear_unimap() allocated a</i></td></tr>
<tr><th id="570">570</th><td><i>		 * a new uni_pagedir for this vc.  Re: p != q</i></td></tr>
<tr><th id="571">571</th><td><i>		 */</i></td></tr>
<tr><th id="572">572</th><td>		<a class="local col3 ref" href="#73q" title='q' data-ref="73q">q</a> = *<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="573">573</th><td></td></tr>
<tr><th id="574">574</th><td>		<i>/*</i></td></tr>
<tr><th id="575">575</th><td><i>		 * uni_pgdir is a 32*32*64 table with rows allocated</i></td></tr>
<tr><th id="576">576</th><td><i>		 * when its first entry is added.  The unicode value must</i></td></tr>
<tr><th id="577">577</th><td><i>		 * still be incremented for empty rows.  We are copying</i></td></tr>
<tr><th id="578">578</th><td><i>		 * entries from "p" (old) to "q" (new).</i></td></tr>
<tr><th id="579">579</th><td><i>		 */</i></td></tr>
<tr><th id="580">580</th><td>		<a class="local col1 ref" href="#81l" title='l' data-ref="81l">l</a> = <var>0</var>;		<i>/* unicode value */</i></td></tr>
<tr><th id="581">581</th><td>		<b>for</b> (<a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a> = <var>0</var>; <a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a> &lt; <var>32</var>; <a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a>++) {</td></tr>
<tr><th id="582">582</th><td>		<a class="local col9 ref" href="#79p1" title='p1' data-ref="79p1">p1</a> = <a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a>];</td></tr>
<tr><th id="583">583</th><td>		<b>if</b> (<a class="local col9 ref" href="#79p1" title='p1' data-ref="79p1">p1</a>)</td></tr>
<tr><th id="584">584</th><td>			<b>for</b> (<a class="local col7 ref" href="#77j" title='j' data-ref="77j">j</a> = <var>0</var>; <a class="local col7 ref" href="#77j" title='j' data-ref="77j">j</a> &lt; <var>32</var>; <a class="local col7 ref" href="#77j" title='j' data-ref="77j">j</a>++) {</td></tr>
<tr><th id="585">585</th><td>			<a class="local col0 ref" href="#80p2" title='p2' data-ref="80p2">p2</a> = <a class="local col9 ref" href="#79p1" title='p1' data-ref="79p1">p1</a>[<a class="local col7 ref" href="#77j" title='j' data-ref="77j">j</a>];</td></tr>
<tr><th id="586">586</th><td>			<b>if</b> (<a class="local col0 ref" href="#80p2" title='p2' data-ref="80p2">p2</a>) {</td></tr>
<tr><th id="587">587</th><td>				<b>for</b> (<a class="local col8 ref" href="#78k" title='k' data-ref="78k">k</a> = <var>0</var>; <a class="local col8 ref" href="#78k" title='k' data-ref="78k">k</a> &lt; <var>64</var>; <a class="local col8 ref" href="#78k" title='k' data-ref="78k">k</a>++, <a class="local col1 ref" href="#81l" title='l' data-ref="81l">l</a>++)</td></tr>
<tr><th id="588">588</th><td>				<b>if</b> (<a class="local col0 ref" href="#80p2" title='p2' data-ref="80p2">p2</a>[<a class="local col8 ref" href="#78k" title='k' data-ref="78k">k</a>] != <var>0xffff</var>) {</td></tr>
<tr><th id="589">589</th><td>					<i>/*</i></td></tr>
<tr><th id="590">590</th><td><i>					 * Found one, copy entry for unicode</i></td></tr>
<tr><th id="591">591</th><td><i>					 * l with fontpos value p2[k].</i></td></tr>
<tr><th id="592">592</th><td><i>					 */</i></td></tr>
<tr><th id="593">593</th><td>					<a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a> = <a class="tu ref fn" href="#con_insert_unipair" title='con_insert_unipair' data-use='c' data-ref="con_insert_unipair">con_insert_unipair</a>(<a class="local col3 ref" href="#73q" title='q' data-ref="73q">q</a>, <a class="local col1 ref" href="#81l" title='l' data-ref="81l">l</a>, <a class="local col0 ref" href="#80p2" title='p2' data-ref="80p2">p2</a>[<a class="local col8 ref" href="#78k" title='k' data-ref="78k">k</a>]);</td></tr>
<tr><th id="594">594</th><td>					<b>if</b> (<a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a>) {</td></tr>
<tr><th id="595">595</th><td>						<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>++;</td></tr>
<tr><th id="596">596</th><td>						*<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> = <a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>;</td></tr>
<tr><th id="597">597</th><td>						<a class="tu ref fn" href="#con_release_unimap" title='con_release_unimap' data-use='c' data-ref="con_release_unimap">con_release_unimap</a>(<a class="local col3 ref" href="#73q" title='q' data-ref="73q">q</a>);</td></tr>
<tr><th id="598">598</th><td>						<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col3 ref" href="#73q" title='q' data-ref="73q">q</a>);</td></tr>
<tr><th id="599">599</th><td>						<a class="local col9 ref" href="#69err" title='err' data-ref="69err">err</a> = <a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a>;</td></tr>
<tr><th id="600">600</th><td>						<b>goto</b> <a class="lbl" href="#76out_unlock" data-ref="76out_unlock">out_unlock</a>;</td></tr>
<tr><th id="601">601</th><td>					}</td></tr>
<tr><th id="602">602</th><td>				}</td></tr>
<tr><th id="603">603</th><td>			} <b>else</b> {</td></tr>
<tr><th id="604">604</th><td>				<i>/* Account for row of 64 empty entries */</i></td></tr>
<tr><th id="605">605</th><td>				<a class="local col1 ref" href="#81l" title='l' data-ref="81l">l</a> += <var>64</var>;</td></tr>
<tr><th id="606">606</th><td>			}</td></tr>
<tr><th id="607">607</th><td>		}</td></tr>
<tr><th id="608">608</th><td>		<b>else</b></td></tr>
<tr><th id="609">609</th><td>			<i>/* Account for empty table */</i></td></tr>
<tr><th id="610">610</th><td>			<a class="local col1 ref" href="#81l" title='l' data-ref="81l">l</a> += <var>32</var> * <var>64</var>;</td></tr>
<tr><th id="611">611</th><td>		}</td></tr>
<tr><th id="612">612</th><td></td></tr>
<tr><th id="613">613</th><td>		<i>/*</i></td></tr>
<tr><th id="614">614</th><td><i>		 * Finished copying font table, set vc_uni_pagedir to new table</i></td></tr>
<tr><th id="615">615</th><td><i>		 */</i></td></tr>
<tr><th id="616">616</th><td>		<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a> = <a class="local col3 ref" href="#73q" title='q' data-ref="73q">q</a>;</td></tr>
<tr><th id="617">617</th><td>	} <b>else</b> <b>if</b> (<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a> == <a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>) {</td></tr>
<tr><th id="618">618</th><td>		<a class="tu ref" href="#dflt" title='dflt' data-use='w' data-ref="dflt">dflt</a> = <a class="macro" href="../../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="619">619</th><td>	}</td></tr>
<tr><th id="620">620</th><td></td></tr>
<tr><th id="621">621</th><td>	<i>/*</i></td></tr>
<tr><th id="622">622</th><td><i>	 * Insert user specified unicode pairs into new table.</i></td></tr>
<tr><th id="623">623</th><td><i>	 */</i></td></tr>
<tr><th id="624">624</th><td>	<b>for</b> (<a class="local col5 ref" href="#75plist" title='plist' data-ref="75plist">plist</a> = <a class="local col4 ref" href="#74unilist" title='unilist' data-ref="74unilist">unilist</a>; <a class="local col7 ref" href="#67ct" title='ct' data-ref="67ct">ct</a>; <a class="local col7 ref" href="#67ct" title='ct' data-ref="67ct">ct</a>--, <a class="local col5 ref" href="#75plist" title='plist' data-ref="75plist">plist</a>++) {</td></tr>
<tr><th id="625">625</th><td>		<a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a> = <a class="tu ref fn" href="#con_insert_unipair" title='con_insert_unipair' data-use='c' data-ref="con_insert_unipair">con_insert_unipair</a>(<a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>, <a class="local col5 ref" href="#75plist" title='plist' data-ref="75plist">plist</a>-&gt;<a class="ref field" href="../../../include/uapi/linux/kd.h.html#unipair::unicode" title='unipair::unicode' data-ref="unipair::unicode">unicode</a>, <a class="local col5 ref" href="#75plist" title='plist' data-ref="75plist">plist</a>-&gt;<a class="ref field" href="../../../include/uapi/linux/kd.h.html#unipair::fontpos" title='unipair::fontpos' data-ref="unipair::fontpos">fontpos</a>);</td></tr>
<tr><th id="626">626</th><td>		<b>if</b> (<a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a>)</td></tr>
<tr><th id="627">627</th><td>			<a class="local col9 ref" href="#69err" title='err' data-ref="69err">err</a> = <a class="local col0 ref" href="#70err1" title='err1' data-ref="70err1">err1</a>;</td></tr>
<tr><th id="628">628</th><td>	}</td></tr>
<tr><th id="629">629</th><td>	</td></tr>
<tr><th id="630">630</th><td>	<i>/*</i></td></tr>
<tr><th id="631">631</th><td><i>	 * Merge with fontmaps of any other virtual consoles.</i></td></tr>
<tr><th id="632">632</th><td><i>	 */</i></td></tr>
<tr><th id="633">633</th><td>	<b>if</b> (<a class="tu ref fn" href="#con_unify_unimap" title='con_unify_unimap' data-use='c' data-ref="con_unify_unimap">con_unify_unimap</a>(<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>, <a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>))</td></tr>
<tr><th id="634">634</th><td>		<b>goto</b> <a class="lbl" href="#76out_unlock" data-ref="76out_unlock">out_unlock</a>;</td></tr>
<tr><th id="635">635</th><td></td></tr>
<tr><th id="636">636</th><td>	<b>for</b> (<a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a> = <var>0</var>; <a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a> &lt;= <var>3</var>; <a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a>++)</td></tr>
<tr><th id="637">637</th><td>		<a class="tu ref fn" href="#set_inverse_transl" title='set_inverse_transl' data-use='c' data-ref="set_inverse_transl">set_inverse_transl</a>(<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>, <a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>, <a class="local col1 ref" href="#71i" title='i' data-ref="71i">i</a>); <i>/* Update inverse translations */</i></td></tr>
<tr><th id="638">638</th><td>	<a class="tu ref fn" href="#set_inverse_trans_unicode" title='set_inverse_trans_unicode' data-use='c' data-ref="set_inverse_trans_unicode">set_inverse_trans_unicode</a>(<a class="local col6 ref" href="#66vc" title='vc' data-ref="66vc">vc</a>, <a class="local col2 ref" href="#72p" title='p' data-ref="72p">p</a>);</td></tr>
<tr><th id="639">639</th><td></td></tr>
<tr><th id="640">640</th><td><dfn class="lbl" id="76out_unlock" data-ref="76out_unlock">out_unlock</dfn>:</td></tr>
<tr><th id="641">641</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="642">642</th><td>	<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col4 ref" href="#74unilist" title='unilist' data-ref="74unilist">unilist</a>);</td></tr>
<tr><th id="643">643</th><td>	<b>return</b> <a class="local col9 ref" href="#69err" title='err' data-ref="69err">err</a>;</td></tr>
<tr><th id="644">644</th><td>}</td></tr>
<tr><th id="645">645</th><td></td></tr>
<tr><th id="646">646</th><td><i class="doc">/**</i></td></tr>
<tr><th id="647">647</th><td><i class="doc"> *	con_set_default_unimap	-	set default unicode map</i></td></tr>
<tr><th id="648">648</th><td><i class="doc"> *<span class="command">	@vc</span><span class="arg">:</span> the console we are updating</i></td></tr>
<tr><th id="649">649</th><td><i class="doc"> *</i></td></tr>
<tr><th id="650">650</th><td><i class="doc"> *	Loads the unimap for the hardware font, as defined in uni_hash.tbl.</i></td></tr>
<tr><th id="651">651</th><td><i class="doc"> *	The representation used was the most compact I could come up</i></td></tr>
<tr><th id="652">652</th><td><i class="doc"> *	with.  This routine is executed at video setup, and when the</i></td></tr>
<tr><th id="653">653</th><td><i class="doc"> *	PIO_FONTRESET ioctl is called. </i></td></tr>
<tr><th id="654">654</th><td><i class="doc"> *</i></td></tr>
<tr><th id="655">655</th><td><i class="doc"> *	The caller must hold the console lock</i></td></tr>
<tr><th id="656">656</th><td><i class="doc"> */</i></td></tr>
<tr><th id="657">657</th><td><em>int</em> <dfn class="decl def fn" id="con_set_default_unimap" title='con_set_default_unimap' data-ref="con_set_default_unimap">con_set_default_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col2 decl" id="82vc" title='vc' data-type='struct vc_data *' data-ref="82vc">vc</dfn>)</td></tr>
<tr><th id="658">658</th><td>{</td></tr>
<tr><th id="659">659</th><td>	<em>int</em> <dfn class="local col3 decl" id="83i" title='i' data-type='int' data-ref="83i">i</dfn>, <dfn class="local col4 decl" id="84j" title='j' data-type='int' data-ref="84j">j</dfn>, <dfn class="local col5 decl" id="85err" title='err' data-type='int' data-ref="85err">err</dfn> = <var>0</var>, <dfn class="local col6 decl" id="86err1" title='err1' data-type='int' data-ref="86err1">err1</dfn>;</td></tr>
<tr><th id="660">660</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> *<dfn class="local col7 decl" id="87q" title='q' data-type='u16 *' data-ref="87q">q</dfn>;</td></tr>
<tr><th id="661">661</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col8 decl" id="88p" title='p' data-type='struct uni_pagedir *' data-ref="88p">p</dfn>;</td></tr>
<tr><th id="662">662</th><td></td></tr>
<tr><th id="663">663</th><td>	<b>if</b> (<a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>) {</td></tr>
<tr><th id="664">664</th><td>		<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a> = *<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="665">665</th><td>		<b>if</b> (<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a> == <a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>)</td></tr>
<tr><th id="666">666</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="667">667</th><td></td></tr>
<tr><th id="668">668</th><td>		<a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>++;</td></tr>
<tr><th id="669">669</th><td>		*<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> = <a class="tu ref" href="#dflt" title='dflt' data-use='r' data-ref="dflt">dflt</a>;</td></tr>
<tr><th id="670">670</th><td>		<b>if</b> (<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a> &amp;&amp; !--<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>) {</td></tr>
<tr><th id="671">671</th><td>			<a class="tu ref fn" href="#con_release_unimap" title='con_release_unimap' data-use='c' data-ref="con_release_unimap">con_release_unimap</a>(<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>);</td></tr>
<tr><th id="672">672</th><td>			<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>);</td></tr>
<tr><th id="673">673</th><td>		}</td></tr>
<tr><th id="674">674</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="675">675</th><td>	}</td></tr>
<tr><th id="676">676</th><td>	</td></tr>
<tr><th id="677">677</th><td>	<i>/* The default font is always 256 characters */</i></td></tr>
<tr><th id="678">678</th><td></td></tr>
<tr><th id="679">679</th><td>	<a class="local col5 ref" href="#85err" title='err' data-ref="85err">err</a> = <a class="tu ref fn" href="#con_do_clear_unimap" title='con_do_clear_unimap' data-use='c' data-ref="con_do_clear_unimap">con_do_clear_unimap</a>(<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>);</td></tr>
<tr><th id="680">680</th><td>	<b>if</b> (<a class="local col5 ref" href="#85err" title='err' data-ref="85err">err</a>)</td></tr>
<tr><th id="681">681</th><td>		<b>return</b> <a class="local col5 ref" href="#85err" title='err' data-ref="85err">err</a>;</td></tr>
<tr><th id="682">682</th><td>    </td></tr>
<tr><th id="683">683</th><td>	<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a> = *<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="684">684</th><td>	<a class="local col7 ref" href="#87q" title='q' data-ref="87q">q</a> = <a class="ref" href="#dfont_unitable" title='dfont_unitable' data-ref="dfont_unitable">dfont_unitable</a>;</td></tr>
<tr><th id="685">685</th><td>	</td></tr>
<tr><th id="686">686</th><td>	<b>for</b> (<a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a> = <var>0</var>; <a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a> &lt; <var>256</var>; <a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a>++)</td></tr>
<tr><th id="687">687</th><td>		<b>for</b> (<a class="local col4 ref" href="#84j" title='j' data-ref="84j">j</a> = <a class="ref" href="#dfont_unicount" title='dfont_unicount' data-ref="dfont_unicount">dfont_unicount</a>[<a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a>]; <a class="local col4 ref" href="#84j" title='j' data-ref="84j">j</a>; <a class="local col4 ref" href="#84j" title='j' data-ref="84j">j</a>--) {</td></tr>
<tr><th id="688">688</th><td>			<a class="local col6 ref" href="#86err1" title='err1' data-ref="86err1">err1</a> = <a class="tu ref fn" href="#con_insert_unipair" title='con_insert_unipair' data-use='c' data-ref="con_insert_unipair">con_insert_unipair</a>(<a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>, *(<a class="local col7 ref" href="#87q" title='q' data-ref="87q">q</a>++), <a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a>);</td></tr>
<tr><th id="689">689</th><td>			<b>if</b> (<a class="local col6 ref" href="#86err1" title='err1' data-ref="86err1">err1</a>)</td></tr>
<tr><th id="690">690</th><td>				<a class="local col5 ref" href="#85err" title='err' data-ref="85err">err</a> = <a class="local col6 ref" href="#86err1" title='err1' data-ref="86err1">err1</a>;</td></tr>
<tr><th id="691">691</th><td>		}</td></tr>
<tr><th id="692">692</th><td>			</td></tr>
<tr><th id="693">693</th><td>	<b>if</b> (<a class="tu ref fn" href="#con_unify_unimap" title='con_unify_unimap' data-use='c' data-ref="con_unify_unimap">con_unify_unimap</a>(<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>, <a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>)) {</td></tr>
<tr><th id="694">694</th><td>		<a class="tu ref" href="#dflt" title='dflt' data-use='w' data-ref="dflt">dflt</a> = *<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="695">695</th><td>		<b>return</b> <a class="local col5 ref" href="#85err" title='err' data-ref="85err">err</a>;</td></tr>
<tr><th id="696">696</th><td>	}</td></tr>
<tr><th id="697">697</th><td></td></tr>
<tr><th id="698">698</th><td>	<b>for</b> (<a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a> = <var>0</var>; <a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a> &lt;= <var>3</var>; <a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a>++)</td></tr>
<tr><th id="699">699</th><td>		<a class="tu ref fn" href="#set_inverse_transl" title='set_inverse_transl' data-use='c' data-ref="set_inverse_transl">set_inverse_transl</a>(<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>, <a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>, <a class="local col3 ref" href="#83i" title='i' data-ref="83i">i</a>);	<i>/* Update all inverse translations */</i></td></tr>
<tr><th id="700">700</th><td>	<a class="tu ref fn" href="#set_inverse_trans_unicode" title='set_inverse_trans_unicode' data-use='c' data-ref="set_inverse_trans_unicode">set_inverse_trans_unicode</a>(<a class="local col2 ref" href="#82vc" title='vc' data-ref="82vc">vc</a>, <a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>);</td></tr>
<tr><th id="701">701</th><td>	<a class="tu ref" href="#dflt" title='dflt' data-use='w' data-ref="dflt">dflt</a> = <a class="local col8 ref" href="#88p" title='p' data-ref="88p">p</a>;</td></tr>
<tr><th id="702">702</th><td>	<b>return</b> <a class="local col5 ref" href="#85err" title='err' data-ref="85err">err</a>;</td></tr>
<tr><th id="703">703</th><td>}</td></tr>
<tr><th id="704">704</th><td><a class="macro" href="../../../include/linux/export.h.html#103" title="extern typeof(con_set_default_unimap) con_set_default_unimap; static const char __kstrtab_con_set_default_unimap[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;con_set_default_unimap&quot;; static const struct kernel_symbol __ksymtab_con_set_default_unimap __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;con_set_default_unimap&quot;), used)) = { (unsigned long)&amp;con_set_default_unimap, __kstrtab_con_set_default_unimap }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#con_set_default_unimap" title='con_set_default_unimap' data-ref="con_set_default_unimap"><a class="ref fn" href="#con_set_default_unimap" title='con_set_default_unimap' data-ref="con_set_default_unimap"><a class="ref fn" href="#con_set_default_unimap" title='con_set_default_unimap' data-ref="con_set_default_unimap"><a class="ref fn" href="#con_set_default_unimap" title='con_set_default_unimap' data-ref="con_set_default_unimap">con_set_default_unimap</a></a></a></a>);</td></tr>
<tr><th id="705">705</th><td></td></tr>
<tr><th id="706">706</th><td><i class="doc">/**</i></td></tr>
<tr><th id="707">707</th><td><i class="doc"> *	con_copy_unimap		-	copy unimap between two vts</i></td></tr>
<tr><th id="708">708</th><td><i class="doc"> *	<span class="command">@dst</span><span class="verb">_vc: target</span></i></td></tr>
<tr><th id="709">709</th><td><i class="doc"><span class="verb"></span> *<span class="verb">	@src_vt: source</span></i></td></tr>
<tr><th id="710">710</th><td><i class="doc"><span class="verb"></span> *<span class="verb"></span></i></td></tr>
<tr><th id="711">711</th><td><i class="doc"><span class="verb"></span> *<span class="verb">	The caller must hold the console lock when invoking this method</span></i></td></tr>
<tr><th id="712">712</th><td><i class="doc"><span class="verb"></span><span class="verb"> *</span>/</i><span class="verb"></span></td></tr>
<tr><th id="713">713</th><td><span class="verb"></span><em>int</em> <dfn class="decl def fn" id="con_copy_unimap" title='con_copy_unimap' data-ref="con_copy_unimap">con_copy_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col9 decl" id="89dst_vc" title='dst_vc' data-type='struct vc_data *' data-ref="89dst_vc">dst_vc</dfn>, <b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col0 decl" id="90src_vc" title='src_vc' data-type='struct vc_data *' data-ref="90src_vc">src_vc</dfn>)</td></tr>
<tr><th id="714">714</th><td>{</td></tr>
<tr><th id="715">715</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col1 decl" id="91q" title='q' data-type='struct uni_pagedir *' data-ref="91q">q</dfn>;</td></tr>
<tr><th id="716">716</th><td></td></tr>
<tr><th id="717">717</th><td>	<b>if</b> (!*<a class="local col0 ref" href="#90src_vc" title='src_vc' data-ref="90src_vc">src_vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>)</td></tr>
<tr><th id="718">718</th><td>		<b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="719">719</th><td>	<b>if</b> (*<a class="local col9 ref" href="#89dst_vc" title='dst_vc' data-ref="89dst_vc">dst_vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> == *<a class="local col0 ref" href="#90src_vc" title='src_vc' data-ref="90src_vc">src_vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>)</td></tr>
<tr><th id="720">720</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="721">721</th><td>	<a class="ref fn" href="#con_free_unimap" title='con_free_unimap' data-ref="con_free_unimap">con_free_unimap</a>(<a class="local col9 ref" href="#89dst_vc" title='dst_vc' data-ref="89dst_vc">dst_vc</a>);</td></tr>
<tr><th id="722">722</th><td>	<a class="local col1 ref" href="#91q" title='q' data-ref="91q">q</a> = *<a class="local col0 ref" href="#90src_vc" title='src_vc' data-ref="90src_vc">src_vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="723">723</th><td>	<a class="local col1 ref" href="#91q" title='q' data-ref="91q">q</a>-&gt;<a class="ref field" href="#uni_pagedir::refcount" title='uni_pagedir::refcount' data-ref="uni_pagedir::refcount">refcount</a>++;</td></tr>
<tr><th id="724">724</th><td>	*<a class="local col9 ref" href="#89dst_vc" title='dst_vc' data-ref="89dst_vc">dst_vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a> = <a class="local col1 ref" href="#91q" title='q' data-ref="91q">q</a>;</td></tr>
<tr><th id="725">725</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="726">726</th><td>}</td></tr>
<tr><th id="727">727</th><td><a class="macro" href="../../../include/linux/export.h.html#103" title="extern typeof(con_copy_unimap) con_copy_unimap; static const char __kstrtab_con_copy_unimap[] __attribute__((section(&quot;__ksymtab_strings&quot;), aligned(1))) = &quot;con_copy_unimap&quot;; static const struct kernel_symbol __ksymtab_con_copy_unimap __attribute__((__used__)) __attribute__((section(&quot;___ksymtab&quot; &quot;&quot; &quot;+&quot; &quot;con_copy_unimap&quot;), used)) = { (unsigned long)&amp;con_copy_unimap, __kstrtab_con_copy_unimap }" data-ref="_M/EXPORT_SYMBOL">EXPORT_SYMBOL</a>(<a class="decl fn" href="#con_copy_unimap" title='con_copy_unimap' data-ref="con_copy_unimap"><a class="ref fn" href="#con_copy_unimap" title='con_copy_unimap' data-ref="con_copy_unimap"><a class="ref fn" href="#con_copy_unimap" title='con_copy_unimap' data-ref="con_copy_unimap"><a class="ref fn" href="#con_copy_unimap" title='con_copy_unimap' data-ref="con_copy_unimap">con_copy_unimap</a></a></a></a>);</td></tr>
<tr><th id="728">728</th><td></td></tr>
<tr><th id="729">729</th><td><i class="doc">/**</i></td></tr>
<tr><th id="730">730</th><td><i class="doc"> *	con_get_unimap		-	get the unicode map</i></td></tr>
<tr><th id="731">731</th><td><i class="doc"> *<span class="command">	@vc</span><span class="arg">:</span> the console to read from</i></td></tr>
<tr><th id="732">732</th><td><i class="doc"> *</i></td></tr>
<tr><th id="733">733</th><td><i class="doc"> *	Read the console unicode data for this console. Called from the ioctl</i></td></tr>
<tr><th id="734">734</th><td><i class="doc"> *	handlers.</i></td></tr>
<tr><th id="735">735</th><td><i class="doc"> */</i></td></tr>
<tr><th id="736">736</th><td><em>int</em> <dfn class="decl def fn" id="con_get_unimap" title='con_get_unimap' data-ref="con_get_unimap">con_get_unimap</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col2 decl" id="92vc" title='vc' data-type='struct vc_data *' data-ref="92vc">vc</dfn>, <a class="typedef" href="../../../include/linux/types.h.html#ushort" title='ushort' data-type='unsigned short' data-ref="ushort">ushort</a> <dfn class="local col3 decl" id="93ct" title='ct' data-type='ushort' data-ref="93ct">ct</dfn>, <a class="typedef" href="../../../include/linux/types.h.html#ushort" title='ushort' data-type='unsigned short' data-ref="ushort">ushort</a> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col4 decl" id="94uct" title='uct' data-type='ushort *' data-ref="94uct">uct</dfn>, <b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a> <a class="macro" href="../../../include/linux/compiler_types.h.html#29" title="" data-ref="_M/__user">__user</a> *<dfn class="local col5 decl" id="95list" title='list' data-type='struct unipair *' data-ref="95list">list</dfn>)</td></tr>
<tr><th id="737">737</th><td>{</td></tr>
<tr><th id="738">738</th><td>	<em>int</em> <dfn class="local col6 decl" id="96i" title='i' data-type='int' data-ref="96i">i</dfn>, <dfn class="local col7 decl" id="97j" title='j' data-type='int' data-ref="97j">j</dfn>, <dfn class="local col8 decl" id="98k" title='k' data-type='int' data-ref="98k">k</dfn>, <dfn class="local col9 decl" id="99ret" title='ret' data-type='int' data-ref="99ret">ret</dfn> = <var>0</var>;</td></tr>
<tr><th id="739">739</th><td>	<a class="typedef" href="../../../include/linux/types.h.html#ushort" title='ushort' data-type='unsigned short' data-ref="ushort">ushort</a> <dfn class="local col0 decl" id="100ect" title='ect' data-type='ushort' data-ref="100ect">ect</dfn>;</td></tr>
<tr><th id="740">740</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col1 decl" id="101p1" title='p1' data-type='u16 **' data-ref="101p1">p1</dfn>, *<dfn class="local col2 decl" id="102p2" title='p2' data-type='u16 *' data-ref="102p2">p2</dfn>;</td></tr>
<tr><th id="741">741</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col3 decl" id="103p" title='p' data-type='struct uni_pagedir *' data-ref="103p">p</dfn>;</td></tr>
<tr><th id="742">742</th><td>	<b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a> *<dfn class="local col4 decl" id="104unilist" title='unilist' data-type='struct unipair *' data-ref="104unilist">unilist</dfn>;</td></tr>
<tr><th id="743">743</th><td></td></tr>
<tr><th id="744">744</th><td>	<a class="local col4 ref" href="#104unilist" title='unilist' data-ref="104unilist">unilist</a> = <a class="ref fn" href="../../../include/linux/slab.h.html#kmalloc_array" title='kmalloc_array' data-ref="kmalloc_array">kmalloc_array</a>(<a class="local col3 ref" href="#93ct" title='ct' data-ref="93ct">ct</a>, <b>sizeof</b>(<b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a>), <a class="macro" href="../../../include/linux/gfp.h.html#278" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="745">745</th><td>	<b>if</b> (!<a class="local col4 ref" href="#104unilist" title='unilist' data-ref="104unilist">unilist</a>)</td></tr>
<tr><th id="746">746</th><td>		<b>return</b> -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="747">747</th><td></td></tr>
<tr><th id="748">748</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_lock" title='console_lock' data-ref="console_lock">console_lock</a>();</td></tr>
<tr><th id="749">749</th><td></td></tr>
<tr><th id="750">750</th><td>	<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a> = <var>0</var>;</td></tr>
<tr><th id="751">751</th><td>	<b>if</b> (*<a class="local col2 ref" href="#92vc" title='vc' data-ref="92vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>) {</td></tr>
<tr><th id="752">752</th><td>		<a class="local col3 ref" href="#103p" title='p' data-ref="103p">p</a> = *<a class="local col2 ref" href="#92vc" title='vc' data-ref="92vc">vc</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="753">753</th><td>		<b>for</b> (<a class="local col6 ref" href="#96i" title='i' data-ref="96i">i</a> = <var>0</var>; <a class="local col6 ref" href="#96i" title='i' data-ref="96i">i</a> &lt; <var>32</var>; <a class="local col6 ref" href="#96i" title='i' data-ref="96i">i</a>++) {</td></tr>
<tr><th id="754">754</th><td>		<a class="local col1 ref" href="#101p1" title='p1' data-ref="101p1">p1</a> = <a class="local col3 ref" href="#103p" title='p' data-ref="103p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col6 ref" href="#96i" title='i' data-ref="96i">i</a>];</td></tr>
<tr><th id="755">755</th><td>		<b>if</b> (<a class="local col1 ref" href="#101p1" title='p1' data-ref="101p1">p1</a>)</td></tr>
<tr><th id="756">756</th><td>			<b>for</b> (<a class="local col7 ref" href="#97j" title='j' data-ref="97j">j</a> = <var>0</var>; <a class="local col7 ref" href="#97j" title='j' data-ref="97j">j</a> &lt; <var>32</var>; <a class="local col7 ref" href="#97j" title='j' data-ref="97j">j</a>++) {</td></tr>
<tr><th id="757">757</th><td>			<a class="local col2 ref" href="#102p2" title='p2' data-ref="102p2">p2</a> = *(<a class="local col1 ref" href="#101p1" title='p1' data-ref="101p1">p1</a>++);</td></tr>
<tr><th id="758">758</th><td>			<b>if</b> (<a class="local col2 ref" href="#102p2" title='p2' data-ref="102p2">p2</a>)</td></tr>
<tr><th id="759">759</th><td>				<b>for</b> (<a class="local col8 ref" href="#98k" title='k' data-ref="98k">k</a> = <var>0</var>; <a class="local col8 ref" href="#98k" title='k' data-ref="98k">k</a> &lt; <var>64</var>; <a class="local col8 ref" href="#98k" title='k' data-ref="98k">k</a>++, <a class="local col2 ref" href="#102p2" title='p2' data-ref="102p2">p2</a>++) {</td></tr>
<tr><th id="760">760</th><td>					<b>if</b> (*<a class="local col2 ref" href="#102p2" title='p2' data-ref="102p2">p2</a> &gt;= <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a>)</td></tr>
<tr><th id="761">761</th><td>						<b>continue</b>;</td></tr>
<tr><th id="762">762</th><td>					<b>if</b> (<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a> &lt; <a class="local col3 ref" href="#93ct" title='ct' data-ref="93ct">ct</a>) {</td></tr>
<tr><th id="763">763</th><td>						<a class="local col4 ref" href="#104unilist" title='unilist' data-ref="104unilist">unilist</a>[<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a>].<a class="ref field" href="../../../include/uapi/linux/kd.h.html#unipair::unicode" title='unipair::unicode' data-ref="unipair::unicode">unicode</a> =</td></tr>
<tr><th id="764">764</th><td>							(<a class="local col6 ref" href="#96i" title='i' data-ref="96i">i</a>&lt;&lt;<var>11</var>)+(<a class="local col7 ref" href="#97j" title='j' data-ref="97j">j</a>&lt;&lt;<var>6</var>)+<a class="local col8 ref" href="#98k" title='k' data-ref="98k">k</a>;</td></tr>
<tr><th id="765">765</th><td>						<a class="local col4 ref" href="#104unilist" title='unilist' data-ref="104unilist">unilist</a>[<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a>].<a class="ref field" href="../../../include/uapi/linux/kd.h.html#unipair::fontpos" title='unipair::fontpos' data-ref="unipair::fontpos">fontpos</a> = *<a class="local col2 ref" href="#102p2" title='p2' data-ref="102p2">p2</a>;</td></tr>
<tr><th id="766">766</th><td>					}</td></tr>
<tr><th id="767">767</th><td>					<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a>++;</td></tr>
<tr><th id="768">768</th><td>				}</td></tr>
<tr><th id="769">769</th><td>			}</td></tr>
<tr><th id="770">770</th><td>		}</td></tr>
<tr><th id="771">771</th><td>	}</td></tr>
<tr><th id="772">772</th><td>	<a class="ref fn" href="../../../include/linux/console.h.html#console_unlock" title='console_unlock' data-ref="console_unlock">console_unlock</a>();</td></tr>
<tr><th id="773">773</th><td>	<b>if</b> (<a class="ref fn" href="../../../include/linux/uaccess.h.html#copy_to_user" title='copy_to_user' data-ref="copy_to_user">copy_to_user</a>(<a class="local col5 ref" href="#95list" title='list' data-ref="95list">list</a>, <a class="local col4 ref" href="#104unilist" title='unilist' data-ref="104unilist">unilist</a>, <a class="macro" href="../../../include/linux/kernel.h.html#799" title="({ typeof(ect) __UNIQUE_ID_min1_36 = (ect); typeof(ct) __UNIQUE_ID_min2_37 = (ct); (void) (&amp;__UNIQUE_ID_min1_36 == &amp;__UNIQUE_ID_min2_37); __UNIQUE_ID_min1_36 &lt; __UNIQUE_ID_min2_37 ? __UNIQUE_ID_min1_36 : __UNIQUE_ID_min2_37; })" data-ref="_M/min">min</a>(<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a>, <a class="local col3 ref" href="#93ct" title='ct' data-ref="93ct">ct</a>) * <b>sizeof</b>(<b>struct</b> <a class="type" href="../../../include/uapi/linux/kd.h.html#unipair" title='unipair' data-ref="unipair">unipair</a>)))</td></tr>
<tr><th id="774">774</th><td>		<a class="local col9 ref" href="#99ret" title='ret' data-ref="99ret">ret</a> = -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#18" title="14" data-ref="_M/EFAULT">EFAULT</a>;</td></tr>
<tr><th id="775">775</th><td>	<a class="macro" href="../../../arch/x86/include/asm/uaccess.h.html#254" title="({ int __ret_pu; __typeof__(*(uct)) __pu_val; (void)0; might_fault(); __pu_val = ect; switch (sizeof(*(uct))) { case 1: asm volatile(&quot;call __put_user_&quot; &quot;1&quot; : &quot;=a&quot; (__ret_pu) : &quot;0&quot; ((typeof(*(uct)))(__pu_val)), &quot;c&quot; (uct) : &quot;ebx&quot;); break; case 2: asm volatile(&quot;call __put_user_&quot; &quot;2&quot; : &quot;=a&quot; (__ret_pu) : &quot;0&quot; ((typeof(*(uct)))(__pu_val)), &quot;c&quot; (uct) : &quot;ebx&quot;); break; case 4: asm volatile(&quot;call __put_user_&quot; &quot;4&quot; : &quot;=a&quot; (__ret_pu) : &quot;0&quot; ((typeof(*(uct)))(__pu_val)), &quot;c&quot; (uct) : &quot;ebx&quot;); break; case 8: asm volatile(&quot;call __put_user_&quot; &quot;8&quot; : &quot;=a&quot; (__ret_pu) : &quot;0&quot; ((typeof(*(uct)))(__pu_val)), &quot;c&quot; (uct) : &quot;ebx&quot;); break; default: asm volatile(&quot;call __put_user_&quot; &quot;X&quot; : &quot;=a&quot; (__ret_pu) : &quot;0&quot; ((typeof(*(uct)))(__pu_val)), &quot;c&quot; (uct) : &quot;ebx&quot;); break; } __builtin_expect(__ret_pu, 0); })" data-ref="_M/put_user">put_user</a>(<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a>, <a class="local col4 ref" href="#94uct" title='uct' data-ref="94uct">uct</a>);</td></tr>
<tr><th id="776">776</th><td>	<a class="ref fn" href="../../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree">kfree</a>(<a class="local col4 ref" href="#104unilist" title='unilist' data-ref="104unilist">unilist</a>);</td></tr>
<tr><th id="777">777</th><td>	<b>return</b> <a class="local col9 ref" href="#99ret" title='ret' data-ref="99ret">ret</a> ? <a class="local col9 ref" href="#99ret" title='ret' data-ref="99ret">ret</a> : (<a class="local col0 ref" href="#100ect" title='ect' data-ref="100ect">ect</a> &lt;= <a class="local col3 ref" href="#93ct" title='ct' data-ref="93ct">ct</a>) ? <var>0</var> : -<a class="macro" href="../../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="778">778</th><td>}</td></tr>
<tr><th id="779">779</th><td></td></tr>
<tr><th id="780">780</th><td><i>/*</i></td></tr>
<tr><th id="781">781</th><td><i> * Always use USER_MAP. These functions are used by the keyboard,</i></td></tr>
<tr><th id="782">782</th><td><i> * which shouldn't be affected by G0/G1 switching, etc.</i></td></tr>
<tr><th id="783">783</th><td><i> * If the user map still contains default values, i.e. the</i></td></tr>
<tr><th id="784">784</th><td><i> * direct-to-font mapping, then assume user is using Latin1.</i></td></tr>
<tr><th id="785">785</th><td><i> *</i></td></tr>
<tr><th id="786">786</th><td><i> * FIXME: at some point we need to decide if we want to lock the table</i></td></tr>
<tr><th id="787">787</th><td><i> * update element itself via the keyboard_event_lock for consistency with the</i></td></tr>
<tr><th id="788">788</th><td><i> * keyboard driver as well as the consoles</i></td></tr>
<tr><th id="789">789</th><td><i> */</i></td></tr>
<tr><th id="790">790</th><td><i>/* may be called during an interrupt */</i></td></tr>
<tr><th id="791">791</th><td><a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32">u32</a> <dfn class="decl def fn" id="conv_8bit_to_uni" title='conv_8bit_to_uni' data-ref="conv_8bit_to_uni">conv_8bit_to_uni</dfn>(<em>unsigned</em> <em>char</em> <dfn class="local col5 decl" id="105c" title='c' data-type='unsigned char' data-ref="105c">c</dfn>)</td></tr>
<tr><th id="792">792</th><td>{</td></tr>
<tr><th id="793">793</th><td>	<em>unsigned</em> <em>short</em> <dfn class="local col6 decl" id="106uni" title='uni' data-type='unsigned short' data-ref="106uni">uni</dfn> = <a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>][<a class="local col5 ref" href="#105c" title='c' data-ref="105c">c</a>];</td></tr>
<tr><th id="794">794</th><td>	<b>return</b> <a class="local col6 ref" href="#106uni" title='uni' data-ref="106uni">uni</a> == (<var>0xf000</var> | <a class="local col5 ref" href="#105c" title='c' data-ref="105c">c</a>) ? <a class="local col5 ref" href="#105c" title='c' data-ref="105c">c</a> : <a class="local col6 ref" href="#106uni" title='uni' data-ref="106uni">uni</a>;</td></tr>
<tr><th id="795">795</th><td>}</td></tr>
<tr><th id="796">796</th><td></td></tr>
<tr><th id="797">797</th><td><em>int</em> <dfn class="decl def fn" id="conv_uni_to_8bit" title='conv_uni_to_8bit' data-ref="conv_uni_to_8bit">conv_uni_to_8bit</dfn>(<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32">u32</a> <dfn class="local col7 decl" id="107uni" title='uni' data-type='u32' data-ref="107uni">uni</dfn>)</td></tr>
<tr><th id="798">798</th><td>{</td></tr>
<tr><th id="799">799</th><td>	<em>int</em> <dfn class="local col8 decl" id="108c" title='c' data-type='int' data-ref="108c">c</dfn>;</td></tr>
<tr><th id="800">800</th><td>	<b>for</b> (<a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a> = <var>0</var>; <a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a> &lt; <var>0x100</var>; <a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a>++)</td></tr>
<tr><th id="801">801</th><td>		<b>if</b> (<a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>][<a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a>] == <a class="local col7 ref" href="#107uni" title='uni' data-ref="107uni">uni</a> ||</td></tr>
<tr><th id="802">802</th><td>		   (<a class="tu ref" href="#translations" title='translations' data-use='r' data-ref="translations">translations</a>[<a class="macro" href="../../../include/linux/consolemap.h.html#13" title="3" data-ref="_M/USER_MAP">USER_MAP</a>][<a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a>] == (<a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a> | <var>0xf000</var>) &amp;&amp; <a class="local col7 ref" href="#107uni" title='uni' data-ref="107uni">uni</a> == <a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a>))</td></tr>
<tr><th id="803">803</th><td>			<b>return</b> <a class="local col8 ref" href="#108c" title='c' data-ref="108c">c</a>;</td></tr>
<tr><th id="804">804</th><td>	<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="805">805</th><td>}</td></tr>
<tr><th id="806">806</th><td></td></tr>
<tr><th id="807">807</th><td><em>int</em></td></tr>
<tr><th id="808">808</th><td><dfn class="decl def fn" id="conv_uni_to_pc" title='conv_uni_to_pc' data-ref="conv_uni_to_pc">conv_uni_to_pc</dfn>(<b>struct</b> <a class="type" href="../../../include/linux/console_struct.h.html#vc_data" title='vc_data' data-ref="vc_data">vc_data</a> *<dfn class="local col9 decl" id="109conp" title='conp' data-type='struct vc_data *' data-ref="109conp">conp</dfn>, <em>long</em> <dfn class="local col0 decl" id="110ucs" title='ucs' data-type='long' data-ref="110ucs">ucs</dfn>) </td></tr>
<tr><th id="809">809</th><td>{</td></tr>
<tr><th id="810">810</th><td>	<em>int</em> <dfn class="local col1 decl" id="111h" title='h' data-type='int' data-ref="111h">h</dfn>;</td></tr>
<tr><th id="811">811</th><td>	<a class="typedef" href="../../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16">u16</a> **<dfn class="local col2 decl" id="112p1" title='p1' data-type='u16 **' data-ref="112p1">p1</dfn>, *<dfn class="local col3 decl" id="113p2" title='p2' data-type='u16 *' data-ref="113p2">p2</dfn>;</td></tr>
<tr><th id="812">812</th><td>	<b>struct</b> <a class="type" href="#uni_pagedir" title='uni_pagedir' data-ref="uni_pagedir">uni_pagedir</a> *<dfn class="local col4 decl" id="114p" title='p' data-type='struct uni_pagedir *' data-ref="114p">p</dfn>;</td></tr>
<tr><th id="813">813</th><td>  </td></tr>
<tr><th id="814">814</th><td>	<i>/* Only 16-bit codes supported at this time */</i></td></tr>
<tr><th id="815">815</th><td>	<b>if</b> (<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &gt; <var>0xffff</var>)</td></tr>
<tr><th id="816">816</th><td>		<b>return</b> -<var>4</var>;		<i>/* Not found */</i></td></tr>
<tr><th id="817">817</th><td>	<b>else</b> <b>if</b> (<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &lt; <var>0x20</var>)</td></tr>
<tr><th id="818">818</th><td>		<b>return</b> -<var>1</var>;		<i>/* Not a printable character */</i></td></tr>
<tr><th id="819">819</th><td>	<b>else</b> <b>if</b> (<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> == <var>0xfeff</var> || (<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &gt;= <var>0x200b</var> &amp;&amp; <a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &lt;= <var>0x200f</var>))</td></tr>
<tr><th id="820">820</th><td>		<b>return</b> -<var>2</var>;			<i>/* Zero-width space */</i></td></tr>
<tr><th id="821">821</th><td>	<i>/*</i></td></tr>
<tr><th id="822">822</th><td><i>	 * UNI_DIRECT_BASE indicates the start of the region in the User Zone</i></td></tr>
<tr><th id="823">823</th><td><i>	 * which always has a 1:1 mapping to the currently loaded font.  The</i></td></tr>
<tr><th id="824">824</th><td><i>	 * UNI_DIRECT_MASK indicates the bit span of the region.</i></td></tr>
<tr><th id="825">825</th><td><i>	 */</i></td></tr>
<tr><th id="826">826</th><td>	<b>else</b> <b>if</b> ((<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &amp; ~<a class="macro" href="../../../include/uapi/linux/kd.h.html#79" title="0x01FF" data-ref="_M/UNI_DIRECT_MASK">UNI_DIRECT_MASK</a>) == <a class="macro" href="../../../include/uapi/linux/kd.h.html#78" title="0xF000" data-ref="_M/UNI_DIRECT_BASE">UNI_DIRECT_BASE</a>)</td></tr>
<tr><th id="827">827</th><td>		<b>return</b> <a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &amp; <a class="macro" href="../../../include/uapi/linux/kd.h.html#79" title="0x01FF" data-ref="_M/UNI_DIRECT_MASK">UNI_DIRECT_MASK</a>;</td></tr>
<tr><th id="828">828</th><td>  </td></tr>
<tr><th id="829">829</th><td>	<b>if</b> (!*<a class="local col9 ref" href="#109conp" title='conp' data-ref="109conp">conp</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>)</td></tr>
<tr><th id="830">830</th><td>		<b>return</b> -<var>3</var>;</td></tr>
<tr><th id="831">831</th><td></td></tr>
<tr><th id="832">832</th><td>	<a class="local col4 ref" href="#114p" title='p' data-ref="114p">p</a> = *<a class="local col9 ref" href="#109conp" title='conp' data-ref="109conp">conp</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>;</td></tr>
<tr><th id="833">833</th><td>	<b>if</b> ((<a class="local col2 ref" href="#112p1" title='p1' data-ref="112p1">p1</a> = <a class="local col4 ref" href="#114p" title='p' data-ref="114p">p</a>-&gt;<a class="ref field" href="#uni_pagedir::uni_pgdir" title='uni_pagedir::uni_pgdir' data-ref="uni_pagedir::uni_pgdir">uni_pgdir</a>[<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &gt;&gt; <var>11</var>]) &amp;&amp;</td></tr>
<tr><th id="834">834</th><td>	    (<a class="local col3 ref" href="#113p2" title='p2' data-ref="113p2">p2</a> = <a class="local col2 ref" href="#112p1" title='p1' data-ref="112p1">p1</a>[(<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &gt;&gt; <var>6</var>) &amp; <var>0x1f</var>]) &amp;&amp;</td></tr>
<tr><th id="835">835</th><td>	    (<a class="local col1 ref" href="#111h" title='h' data-ref="111h">h</a> = <a class="local col3 ref" href="#113p2" title='p2' data-ref="113p2">p2</a>[<a class="local col0 ref" href="#110ucs" title='ucs' data-ref="110ucs">ucs</a> &amp; <var>0x3f</var>]) &lt; <a class="macro" href="#184" title="512" data-ref="_M/MAX_GLYPH">MAX_GLYPH</a>)</td></tr>
<tr><th id="836">836</th><td>		<b>return</b> <a class="local col1 ref" href="#111h" title='h' data-ref="111h">h</a>;</td></tr>
<tr><th id="837">837</th><td></td></tr>
<tr><th id="838">838</th><td>	<b>return</b> -<var>4</var>;		<i>/* not found */</i></td></tr>
<tr><th id="839">839</th><td>}</td></tr>
<tr><th id="840">840</th><td></td></tr>
<tr><th id="841">841</th><td><i>/*</i></td></tr>
<tr><th id="842">842</th><td><i> * This is called at sys_setup time, after memory and the console are</i></td></tr>
<tr><th id="843">843</th><td><i> * initialized.  It must be possible to call kmalloc(..., GFP_KERNEL)</i></td></tr>
<tr><th id="844">844</th><td><i> * from this function, hence the call from sys_setup.</i></td></tr>
<tr><th id="845">845</th><td><i> */</i></td></tr>
<tr><th id="846">846</th><td><em>void</em> <a class="macro" href="../../../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> </td></tr>
<tr><th id="847">847</th><td><dfn class="decl def fn" id="console_map_init" title='console_map_init' data-ref="console_map_init">console_map_init</dfn>(<em>void</em>)</td></tr>
<tr><th id="848">848</th><td>{</td></tr>
<tr><th id="849">849</th><td>	<em>int</em> <dfn class="local col5 decl" id="115i" title='i' data-type='int' data-ref="115i">i</dfn>;</td></tr>
<tr><th id="850">850</th><td>	</td></tr>
<tr><th id="851">851</th><td>	<b>for</b> (<a class="local col5 ref" href="#115i" title='i' data-ref="115i">i</a> = <var>0</var>; <a class="local col5 ref" href="#115i" title='i' data-ref="115i">i</a> &lt; <a class="macro" href="../../../include/uapi/linux/vt.h.html#11" title="63" data-ref="_M/MAX_NR_CONSOLES">MAX_NR_CONSOLES</a>; <a class="local col5 ref" href="#115i" title='i' data-ref="115i">i</a>++)</td></tr>
<tr><th id="852">852</th><td>		<b>if</b> (<a class="ref fn" href="../../../include/linux/vt_kern.h.html#vc_cons_allocated" title='vc_cons_allocated' data-ref="vc_cons_allocated">vc_cons_allocated</a>(<a class="local col5 ref" href="#115i" title='i' data-ref="115i">i</a>) &amp;&amp; !*<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="local col5 ref" href="#115i" title='i' data-ref="115i">i</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>-&gt;<a class="ref field" href="../../../include/linux/console_struct.h.html#vc_data::vc_uni_pagedir_loc" title='vc_data::vc_uni_pagedir_loc' data-ref="vc_data::vc_uni_pagedir_loc">vc_uni_pagedir_loc</a>)</td></tr>
<tr><th id="853">853</th><td>			<a class="ref fn" href="#con_set_default_unimap" title='con_set_default_unimap' data-ref="con_set_default_unimap">con_set_default_unimap</a>(<a class="ref" href="../../../include/linux/console_struct.h.html#vc_cons" title='vc_cons' data-ref="vc_cons">vc_cons</a>[<a class="local col5 ref" href="#115i" title='i' data-ref="115i">i</a>].<a class="ref field" href="../../../include/linux/console_struct.h.html#vc::d" title='vc::d' data-ref="vc::d">d</a>);</td></tr>
<tr><th id="854">854</th><td>}</td></tr>
<tr><th id="855">855</th><td></td></tr>
<tr><th id="856">856</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Aug-02</em> from project linux-4.14.y revision <em>linux-4.14.y</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
