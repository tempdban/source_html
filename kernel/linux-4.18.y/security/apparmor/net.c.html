<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>net.c source code [linux-4.18.y/security/apparmor/net.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux-4.18.y/security/apparmor/net.c'; var root_path = '../../..'; var data_path = '../../../../data';</script>
<script src='../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../..'>linux-4.18.y</a>/<a href='..'>security</a>/<a href='./'>apparmor</a>/<a href='net.c.html'>net.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * AppArmor security module</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * This file contains AppArmor network mediation</i></td></tr>
<tr><th id="5">5</th><td><i> *</i></td></tr>
<tr><th id="6">6</th><td><i> * Copyright (C) 1998-2008 Novell/SUSE</i></td></tr>
<tr><th id="7">7</th><td><i> * Copyright 2009-2017 Canonical Ltd.</i></td></tr>
<tr><th id="8">8</th><td><i> *</i></td></tr>
<tr><th id="9">9</th><td><i> * This program is free software; you can redistribute it and/or</i></td></tr>
<tr><th id="10">10</th><td><i> * modify it under the terms of the GNU General Public License as</i></td></tr>
<tr><th id="11">11</th><td><i> * published by the Free Software Foundation, version 2 of the</i></td></tr>
<tr><th id="12">12</th><td><i> * License.</i></td></tr>
<tr><th id="13">13</th><td><i> */</i></td></tr>
<tr><th id="14">14</th><td></td></tr>
<tr><th id="15">15</th><td><u>#include <a href="include/apparmor.h.html">"include/apparmor.h"</a></u></td></tr>
<tr><th id="16">16</th><td><u>#include <a href="include/audit.h.html">"include/audit.h"</a></u></td></tr>
<tr><th id="17">17</th><td><u>#include <a href="include/cred.h.html">"include/cred.h"</a></u></td></tr>
<tr><th id="18">18</th><td><u>#include <a href="include/label.h.html">"include/label.h"</a></u></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="include/net.h.html">"include/net.h"</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="include/policy.h.html">"include/policy.h"</a></u></td></tr>
<tr><th id="21">21</th><td></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="net_names.h.html">"net_names.h"</a></u></td></tr>
<tr><th id="23">23</th><td></td></tr>
<tr><th id="24">24</th><td></td></tr>
<tr><th id="25">25</th><td><b>struct</b> <a class="type" href="include/apparmorfs.h.html#aa_sfs_entry" title='aa_sfs_entry' data-ref="aa_sfs_entry">aa_sfs_entry</a> <dfn class="decl def" id="aa_sfs_entry_network" title='aa_sfs_entry_network' data-ref="aa_sfs_entry_network">aa_sfs_entry_network</dfn>[] = {</td></tr>
<tr><th id="26">26</th><td>	<a class="macro" href="include/apparmorfs.h.html#50" title="{ .name = (&quot;af_mask&quot;), .mode = 0444, .v_type = AA_SFS_TYPE_STRING, .v.string = (&quot;unspec unix inet ax25 ipx appletalk netrom bridge atmpvc x25 inet6 rose netbeui security key netlink packet ash econet atmsvc rds sna irda pppox wanpipe llc ib mpls can tipc bluetooth iucv rxrpc isdn phonet ieee802154 caif alg nfc vsock kcm qipcrtr smc xdp&quot;), .file_ops = &amp;aa_sfs_seq_file_ops }" data-ref="_M/AA_SFS_FILE_STRING">AA_SFS_FILE_STRING</a>(<q>"af_mask"</q>,	<a class="macro" href="net_names.h.html#47" title="&quot;unspec unix inet ax25 ipx appletalk netrom bridge atmpvc x25 inet6 rose netbeui security key netlink packet ash econet atmsvc rds sna irda pppox wanpipe llc ib mpls can tipc bluetooth iucv rxrpc isdn phonet ieee802154 caif alg nfc vsock kcm qipcrtr smc xdp&quot;" data-ref="_M/AA_SFS_AF_MASK">AA_SFS_AF_MASK</a>),</td></tr>
<tr><th id="27">27</th><td>	{ }</td></tr>
<tr><th id="28">28</th><td>};</td></tr>
<tr><th id="29">29</th><td></td></tr>
<tr><th id="30">30</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="net_mask_names" title='net_mask_names' data-type='const char *const [32]' data-ref="net_mask_names">net_mask_names</dfn>[] = {</td></tr>
<tr><th id="31">31</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="32">32</th><td>	<q>"send"</q>,</td></tr>
<tr><th id="33">33</th><td>	<q>"receive"</q>,</td></tr>
<tr><th id="34">34</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td>	<q>"create"</q>,</td></tr>
<tr><th id="37">37</th><td>	<q>"shutdown"</q>,</td></tr>
<tr><th id="38">38</th><td>	<q>"connect"</q>,</td></tr>
<tr><th id="39">39</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="40">40</th><td></td></tr>
<tr><th id="41">41</th><td>	<q>"setattr"</q>,</td></tr>
<tr><th id="42">42</th><td>	<q>"getattr"</q>,</td></tr>
<tr><th id="43">43</th><td>	<q>"setcred"</q>,</td></tr>
<tr><th id="44">44</th><td>	<q>"getcred"</q>,</td></tr>
<tr><th id="45">45</th><td></td></tr>
<tr><th id="46">46</th><td>	<q>"chmod"</q>,</td></tr>
<tr><th id="47">47</th><td>	<q>"chown"</q>,</td></tr>
<tr><th id="48">48</th><td>	<q>"chgrp"</q>,</td></tr>
<tr><th id="49">49</th><td>	<q>"lock"</q>,</td></tr>
<tr><th id="50">50</th><td></td></tr>
<tr><th id="51">51</th><td>	<q>"mmap"</q>,</td></tr>
<tr><th id="52">52</th><td>	<q>"mprot"</q>,</td></tr>
<tr><th id="53">53</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="54">54</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td>	<q>"accept"</q>,</td></tr>
<tr><th id="57">57</th><td>	<q>"bind"</q>,</td></tr>
<tr><th id="58">58</th><td>	<q>"listen"</q>,</td></tr>
<tr><th id="59">59</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td>	<q>"setopt"</q>,</td></tr>
<tr><th id="62">62</th><td>	<q>"getopt"</q>,</td></tr>
<tr><th id="63">63</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="64">64</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="65">65</th><td></td></tr>
<tr><th id="66">66</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="67">67</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="68">68</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="69">69</th><td>	<q>"unknown"</q>,</td></tr>
<tr><th id="70">70</th><td>};</td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><i>/* audit callback for net specific fields */</i></td></tr>
<tr><th id="74">74</th><td><em>void</em> <dfn class="decl def fn" id="audit_net_cb" title='audit_net_cb' data-ref="audit_net_cb">audit_net_cb</dfn>(<b>struct</b> <a class="type" href="../../include/linux/audit.h.html#audit_buffer" title='audit_buffer' data-ref="audit_buffer">audit_buffer</a> *<dfn class="local col1 decl" id="1ab" title='ab' data-type='struct audit_buffer *' data-ref="1ab">ab</dfn>, <em>void</em> *<dfn class="local col2 decl" id="2va" title='va' data-type='void *' data-ref="2va">va</dfn>)</td></tr>
<tr><th id="75">75</th><td>{</td></tr>
<tr><th id="76">76</th><td>	<b>struct</b> <a class="type" href="../../include/linux/lsm_audit.h.html#common_audit_data" title='common_audit_data' data-ref="common_audit_data">common_audit_data</a> *<dfn class="local col3 decl" id="3sa" title='sa' data-type='struct common_audit_data *' data-ref="3sa">sa</dfn> = <a class="local col2 ref" href="#2va" title='va' data-ref="2va">va</a>;</td></tr>
<tr><th id="77">77</th><td></td></tr>
<tr><th id="78">78</th><td>	<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" family="</q>);</td></tr>
<tr><th id="79">79</th><td>	<b>if</b> (<a class="ref" href="net_names.h.html#address_family_names" title='address_family_names' data-ref="address_family_names">address_family_names</a>[<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>-&gt;<a class="ref field" href="../../include/linux/lsm_audit.h.html#common_audit_data::u" title='common_audit_data::u' data-ref="common_audit_data::u">u</a>.<a class="ref field" href="../../include/linux/lsm_audit.h.html#common_audit_data::(anonymous)::net" title='common_audit_data::(anonymous union)::net' data-ref="common_audit_data::(anonymous)::net">net</a>-&gt;<a class="ref field" href="../../include/linux/lsm_audit.h.html#lsm_network_audit::family" title='lsm_network_audit::family' data-ref="lsm_network_audit::family">family</a>])</td></tr>
<tr><th id="80">80</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_string" title='audit_log_string' data-ref="audit_log_string">audit_log_string</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <a class="ref" href="net_names.h.html#address_family_names" title='address_family_names' data-ref="address_family_names">address_family_names</a>[<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>-&gt;<a class="ref field" href="../../include/linux/lsm_audit.h.html#common_audit_data::u" title='common_audit_data::u' data-ref="common_audit_data::u">u</a>.<a class="ref field" href="../../include/linux/lsm_audit.h.html#common_audit_data::(anonymous)::net" title='common_audit_data::(anonymous union)::net' data-ref="common_audit_data::(anonymous)::net">net</a>-&gt;<a class="ref field" href="../../include/linux/lsm_audit.h.html#lsm_network_audit::family" title='lsm_network_audit::family' data-ref="lsm_network_audit::family">family</a>]);</td></tr>
<tr><th id="81">81</th><td>	<b>else</b></td></tr>
<tr><th id="82">82</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>"\"unknown(%d)\""</q>, <a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>-&gt;<a class="ref field" href="../../include/linux/lsm_audit.h.html#common_audit_data::u" title='common_audit_data::u' data-ref="common_audit_data::u">u</a>.<a class="ref field" href="../../include/linux/lsm_audit.h.html#common_audit_data::(anonymous)::net" title='common_audit_data::(anonymous union)::net' data-ref="common_audit_data::(anonymous)::net">net</a>-&gt;<a class="ref field" href="../../include/linux/lsm_audit.h.html#lsm_network_audit::family" title='lsm_network_audit::family' data-ref="lsm_network_audit::family">family</a>);</td></tr>
<tr><th id="83">83</th><td>	<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" sock_type="</q>);</td></tr>
<tr><th id="84">84</th><td>	<b>if</b> (<a class="ref" href="net_names.h.html#sock_type_names" title='sock_type_names' data-ref="sock_type_names">sock_type_names</a>[<a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::net' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net">net</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::type" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::type' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::type">type</a>])</td></tr>
<tr><th id="85">85</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_string" title='audit_log_string' data-ref="audit_log_string">audit_log_string</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <a class="ref" href="net_names.h.html#sock_type_names" title='sock_type_names' data-ref="sock_type_names">sock_type_names</a>[<a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::net' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net">net</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::type" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::type' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::type">type</a>]);</td></tr>
<tr><th id="86">86</th><td>	<b>else</b></td></tr>
<tr><th id="87">87</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>"\"unknown(%d)\""</q>, <a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::net' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net">net</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::type" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::type' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::type">type</a>);</td></tr>
<tr><th id="88">88</th><td>	<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" protocol=%d"</q>, <a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::net' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymous)::net">net</a>.<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::protocol" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::(anonymous union)::(anonymous struct)::protocol' data-ref="apparmor_audit_data::(anonymousunion)::(anonymousstruct)::(anonymousunion)::(anonymous)::protocol">protocol</a>);</td></tr>
<tr><th id="89">89</th><td></td></tr>
<tr><th id="90">90</th><td>	<b>if</b> (<a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::request" title='apparmor_audit_data::request' data-ref="apparmor_audit_data::request">request</a> &amp; <a class="macro" href="include/net.h.html#40" title="(0x00000002 | 0x00000004 | 0x0010 | 0x0020 | 0x00200000 | 0x00400000 | 0x0040 | 0x00100000 | 0x0100 | 0x0200 | 0x01000000 | 0x02000000)" data-ref="_M/NET_PERMS_MASK">NET_PERMS_MASK</a>) {</td></tr>
<tr><th id="91">91</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" requested_mask="</q>);</td></tr>
<tr><th id="92">92</th><td>		<a class="ref fn" href="include/perms.h.html#aa_audit_perm_mask" title='aa_audit_perm_mask' data-ref="aa_audit_perm_mask">aa_audit_perm_mask</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::request" title='apparmor_audit_data::request' data-ref="apparmor_audit_data::request">request</a>, <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <var>0</var>,</td></tr>
<tr><th id="93">93</th><td>				   <a class="tu ref" href="#net_mask_names" title='net_mask_names' data-use='r' data-ref="net_mask_names">net_mask_names</a>, <a class="macro" href="include/net.h.html#40" title="(0x00000002 | 0x00000004 | 0x0010 | 0x0020 | 0x00200000 | 0x00400000 | 0x0040 | 0x00100000 | 0x0100 | 0x0200 | 0x01000000 | 0x02000000)" data-ref="_M/NET_PERMS_MASK">NET_PERMS_MASK</a>);</td></tr>
<tr><th id="94">94</th><td></td></tr>
<tr><th id="95">95</th><td>		<b>if</b> (<a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::denied" title='apparmor_audit_data::denied' data-ref="apparmor_audit_data::denied">denied</a> &amp; <a class="macro" href="include/net.h.html#40" title="(0x00000002 | 0x00000004 | 0x0010 | 0x0020 | 0x00200000 | 0x00400000 | 0x0040 | 0x00100000 | 0x0100 | 0x0200 | 0x01000000 | 0x02000000)" data-ref="_M/NET_PERMS_MASK">NET_PERMS_MASK</a>) {</td></tr>
<tr><th id="96">96</th><td>			<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" denied_mask="</q>);</td></tr>
<tr><th id="97">97</th><td>			<a class="ref fn" href="include/perms.h.html#aa_audit_perm_mask" title='aa_audit_perm_mask' data-ref="aa_audit_perm_mask">aa_audit_perm_mask</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::denied" title='apparmor_audit_data::denied' data-ref="apparmor_audit_data::denied">denied</a>, <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <var>0</var>,</td></tr>
<tr><th id="98">98</th><td>					   <a class="tu ref" href="#net_mask_names" title='net_mask_names' data-use='r' data-ref="net_mask_names">net_mask_names</a>, <a class="macro" href="include/net.h.html#40" title="(0x00000002 | 0x00000004 | 0x0010 | 0x0020 | 0x00200000 | 0x00400000 | 0x0040 | 0x00100000 | 0x0100 | 0x0200 | 0x01000000 | 0x02000000)" data-ref="_M/NET_PERMS_MASK">NET_PERMS_MASK</a>);</td></tr>
<tr><th id="99">99</th><td>		}</td></tr>
<tr><th id="100">100</th><td>	}</td></tr>
<tr><th id="101">101</th><td>	<b>if</b> (<a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymous)::peer" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::peer' data-ref="apparmor_audit_data::(anonymousunion)::(anonymous)::peer">peer</a>) {</td></tr>
<tr><th id="102">102</th><td>		<a class="ref fn" href="../../include/linux/audit.h.html#audit_log_format" title='audit_log_format' data-ref="audit_log_format">audit_log_format</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <q>" peer="</q>);</td></tr>
<tr><th id="103">103</th><td>		<a class="ref fn" href="include/label.h.html#aa_label_xaudit" title='aa_label_xaudit' data-ref="aa_label_xaudit">aa_label_xaudit</a>(<a class="local col1 ref" href="#1ab" title='ab' data-ref="1ab">ab</a>, <a class="macro" href="include/label.h.html#153" title="(((((&amp;((((sa)-&gt;apparmor_audit_data)-&gt;label)-&gt;vec[0])))[(((((sa)-&gt;apparmor_audit_data)-&gt;label)-&gt;size)) - 1])-&gt;ns))" data-ref="_M/labels_ns">labels_ns</a>(<a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::label" title='apparmor_audit_data::label' data-ref="apparmor_audit_data::label">label</a>), <a class="macro" href="include/audit.h.html#161" title="((sa)-&gt;apparmor_audit_data)" data-ref="_M/aad">aad</a>(<a class="local col3 ref" href="#3sa" title='sa' data-ref="3sa">sa</a>)-&gt;<a class="ref field" href="include/audit.h.html#apparmor_audit_data::(anonymousunion)::(anonymous)::peer" title='apparmor_audit_data::(anonymous union)::(anonymous struct)::peer' data-ref="apparmor_audit_data::(anonymousunion)::(anonymous)::peer">peer</a>,</td></tr>
<tr><th id="104">104</th><td>				<a class="macro" href="include/label.h.html#309" title="0" data-ref="_M/FLAGS_NONE">FLAGS_NONE</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x400000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="105">105</th><td>	}</td></tr>
<tr><th id="106">106</th><td>}</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td><i>/* Generic af perm */</i></td></tr>
<tr><th id="109">109</th><td><em>int</em> <dfn class="decl def fn" id="aa_profile_af_perm" title='aa_profile_af_perm' data-ref="aa_profile_af_perm">aa_profile_af_perm</dfn>(<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col4 decl" id="4profile" title='profile' data-type='struct aa_profile *' data-ref="4profile">profile</dfn>, <b>struct</b> <a class="type" href="../../include/linux/lsm_audit.h.html#common_audit_data" title='common_audit_data' data-ref="common_audit_data">common_audit_data</a> *<dfn class="local col5 decl" id="5sa" title='sa' data-type='struct common_audit_data *' data-ref="5sa">sa</dfn>,</td></tr>
<tr><th id="110">110</th><td>		       <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32">u32</a> <dfn class="local col6 decl" id="6request" title='request' data-type='u32' data-ref="6request">request</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='__u16' data-ref="u16">u16</a> <dfn class="local col7 decl" id="7family" title='family' data-type='u16' data-ref="7family">family</dfn>, <em>int</em> <dfn class="local col8 decl" id="8type" title='type' data-type='int' data-ref="8type">type</dfn>)</td></tr>
<tr><th id="111">111</th><td>{</td></tr>
<tr><th id="112">112</th><td>	<b>struct</b> <a class="type" href="include/perms.h.html#aa_perms" title='aa_perms' data-ref="aa_perms">aa_perms</a> <dfn class="local col9 decl" id="9perms" title='perms' data-type='struct aa_perms' data-ref="9perms">perms</dfn> = { };</td></tr>
<tr><th id="113">113</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="10state" title='state' data-type='unsigned int' data-ref="10state">state</dfn>;</td></tr>
<tr><th id="114">114</th><td>	<a class="typedef" href="../../include/uapi/linux/types.h.html#__be16" title='__be16' data-type='__u16' data-ref="__be16">__be16</a> <dfn class="local col1 decl" id="11buffer" title='buffer' data-type='__be16 [2]' data-ref="11buffer">buffer</dfn>[<var>2</var>];</td></tr>
<tr><th id="115">115</th><td></td></tr>
<tr><th id="116">116</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(family &gt;= <a class="macro" href="../../include/linux/socket.h.html#212" title="45" data-ref="_M/AF_MAX">AF_MAX</a>);</td></tr>
<tr><th id="117">117</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(type &lt; <var>0</var> || type &gt;= <a class="macro" href="../../include/linux/net.h.html#73" title="(SOCK_PACKET + 1)" data-ref="_M/SOCK_MAX">SOCK_MAX</a>);</td></tr>
<tr><th id="118">118</th><td></td></tr>
<tr><th id="119">119</th><td>	<b>if</b> (<a class="macro" href="include/policy.h.html#202" title="((profile)-&gt;mode == APPARMOR_UNCONFINED)" data-ref="_M/profile_unconfined">profile_unconfined</a>(<a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>))</td></tr>
<tr><th id="120">120</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="121">121</th><td>	<a class="local col0 ref" href="#10state" title='state' data-ref="10state">state</a> = <a class="macro" href="include/policy.h.html#217" title="((profile)-&gt;policy.start[(unsigned char) (14)])" data-ref="_M/PROFILE_MEDIATES">PROFILE_MEDIATES</a>(<a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>, <a class="macro" href="include/apparmor.h.html#33" title="14" data-ref="_M/AA_CLASS_NET">AA_CLASS_NET</a>);</td></tr>
<tr><th id="122">122</th><td>	<b>if</b> (!<a class="local col0 ref" href="#10state" title='state' data-ref="10state">state</a>)</td></tr>
<tr><th id="123">123</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="124">124</th><td></td></tr>
<tr><th id="125">125</th><td>	<a class="local col1 ref" href="#11buffer" title='buffer' data-ref="11buffer">buffer</a>[<var>0</var>] = <a class="macro" href="../../include/linux/byteorder/generic.h.html#96" title="__cpu_to_be16" data-ref="_M/cpu_to_be16">cpu_to_be16</a>(<a class="local col7 ref" href="#7family" title='family' data-ref="7family">family</a>);</td></tr>
<tr><th id="126">126</th><td>	<a class="local col1 ref" href="#11buffer" title='buffer' data-ref="11buffer">buffer</a>[<var>1</var>] = <a class="macro" href="../../include/linux/byteorder/generic.h.html#96" title="__cpu_to_be16" data-ref="_M/cpu_to_be16">cpu_to_be16</a>((<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='__u16' data-ref="u16">u16</a>) <a class="local col8 ref" href="#8type" title='type' data-ref="8type">type</a>);</td></tr>
<tr><th id="127">127</th><td>	<a class="local col0 ref" href="#10state" title='state' data-ref="10state">state</a> = <a class="ref fn" href="include/match.h.html#aa_dfa_match_len" title='aa_dfa_match_len' data-ref="aa_dfa_match_len">aa_dfa_match_len</a>(<a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::policy" title='aa_profile::policy' data-ref="aa_profile::policy">policy</a>.<a class="ref field" href="include/policy.h.html#aa_policydb::dfa" title='aa_policydb::dfa' data-ref="aa_policydb::dfa">dfa</a>, <a class="local col0 ref" href="#10state" title='state' data-ref="10state">state</a>, (<em>char</em> *) &amp;<a class="local col1 ref" href="#11buffer" title='buffer' data-ref="11buffer">buffer</a>,</td></tr>
<tr><th id="128">128</th><td>				 <var>4</var>);</td></tr>
<tr><th id="129">129</th><td>	<a class="ref fn" href="include/perms.h.html#aa_compute_perms" title='aa_compute_perms' data-ref="aa_compute_perms">aa_compute_perms</a>(<a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>-&gt;<a class="ref field" href="include/policy.h.html#aa_profile::policy" title='aa_profile::policy' data-ref="aa_profile::policy">policy</a>.<a class="ref field" href="include/policy.h.html#aa_policydb::dfa" title='aa_policydb::dfa' data-ref="aa_policydb::dfa">dfa</a>, <a class="local col0 ref" href="#10state" title='state' data-ref="10state">state</a>, &amp;<a class="local col9 ref" href="#9perms" title='perms' data-ref="9perms">perms</a>);</td></tr>
<tr><th id="130">130</th><td>	<a class="ref fn" href="include/perms.h.html#aa_apply_modes_to_perms" title='aa_apply_modes_to_perms' data-ref="aa_apply_modes_to_perms">aa_apply_modes_to_perms</a>(<a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>, &amp;<a class="local col9 ref" href="#9perms" title='perms' data-ref="9perms">perms</a>);</td></tr>
<tr><th id="131">131</th><td></td></tr>
<tr><th id="132">132</th><td>	<b>return</b> <a class="ref fn" href="include/perms.h.html#aa_check_perms" title='aa_check_perms' data-ref="aa_check_perms">aa_check_perms</a>(<a class="local col4 ref" href="#4profile" title='profile' data-ref="4profile">profile</a>, &amp;<a class="local col9 ref" href="#9perms" title='perms' data-ref="9perms">perms</a>, <a class="local col6 ref" href="#6request" title='request' data-ref="6request">request</a>, <a class="local col5 ref" href="#5sa" title='sa' data-ref="5sa">sa</a>, <a class="ref fn" href="#audit_net_cb" title='audit_net_cb' data-ref="audit_net_cb">audit_net_cb</a>);</td></tr>
<tr><th id="133">133</th><td>}</td></tr>
<tr><th id="134">134</th><td></td></tr>
<tr><th id="135">135</th><td><em>int</em> <dfn class="decl def fn" id="aa_af_perm" title='aa_af_perm' data-ref="aa_af_perm">aa_af_perm</dfn>(<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col2 decl" id="12label" title='label' data-type='struct aa_label *' data-ref="12label">label</dfn>, <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="13op" title='op' data-type='const char *' data-ref="13op">op</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32">u32</a> <dfn class="local col4 decl" id="14request" title='request' data-type='u32' data-ref="14request">request</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='__u16' data-ref="u16">u16</a> <dfn class="local col5 decl" id="15family" title='family' data-type='u16' data-ref="15family">family</dfn>,</td></tr>
<tr><th id="136">136</th><td>	       <em>int</em> <dfn class="local col6 decl" id="16type" title='type' data-type='int' data-ref="16type">type</dfn>, <em>int</em> <dfn class="local col7 decl" id="17protocol" title='protocol' data-type='int' data-ref="17protocol">protocol</dfn>)</td></tr>
<tr><th id="137">137</th><td>{</td></tr>
<tr><th id="138">138</th><td>	<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col8 decl" id="18profile" title='profile' data-type='struct aa_profile *' data-ref="18profile">profile</dfn>;</td></tr>
<tr><th id="139">139</th><td>	<a class="macro" href="include/net.h.html#60" title="struct lsm_network_audit sa_net = { .sk = (((void *)0)), .family = (family)}; struct apparmor_audit_data sa_aad = { .op = (op), }; struct common_audit_data sa = { .type = (((((void *)0)) &amp;&amp; (family) != 1) ? 2 : 7), .u.tsk = ((void *)0), }; sa.apparmor_audit_data = &amp;(sa_aad); sa.u.net = &amp;(sa_net); ((&amp;sa)-&gt;apparmor_audit_data)-&gt;net.type = (type); ((&amp;sa)-&gt;apparmor_audit_data)-&gt;net.protocol = (protocol)" data-ref="_M/DEFINE_AUDIT_NET">DEFINE_AUDIT_NET</a>(<dfn class="local col9 decl" id="19sa" title='sa' data-type='struct common_audit_data' data-ref="19sa"><a class="local col9 ref" href="#139" title='sa' data-ref="19sa"><a class="local col9 ref" href="#139" title='sa' data-ref="19sa"><a class="local col9 ref" href="#139" title='sa' data-ref="19sa"><a class="local col9 ref" href="#139" title='sa' data-ref="19sa">sa</a></a></a></a></dfn>, <a class="local col3 ref" href="#13op" title='op' data-ref="13op">op</a>, <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="local col5 ref" href="#15family" title='family' data-ref="15family">family</a>, <a class="local col6 ref" href="#16type" title='type' data-ref="16type">type</a>, <a class="local col7 ref" href="#17protocol" title='protocol' data-ref="17protocol">protocol</a>);</td></tr>
<tr><th id="140">140</th><td></td></tr>
<tr><th id="141">141</th><td>	<b>return</b> <a class="macro" href="include/label.h.html#246" title="({ struct label_it i; int __E = 0; for ((i).i = aa_label_next_confined(((label)), 0); (((profile)) = ((label))-&gt;vec[(i).i]); (i).i = aa_label_next_confined(((label)), (i).i + 1)) { do { int __subE = ((aa_profile_af_perm(profile, &amp;sa, request, family, type))); if (__subE) (__E) = __subE; } while (0); } __E; })" data-ref="_M/fn_for_each_confined">fn_for_each_confined</a>(<a class="local col2 ref" href="#12label" title='label' data-ref="12label">label</a>, <a class="local col8 ref" href="#18profile" title='profile' data-ref="18profile">profile</a>,</td></tr>
<tr><th id="142">142</th><td>			<a class="ref fn" href="#aa_profile_af_perm" title='aa_profile_af_perm' data-ref="aa_profile_af_perm">aa_profile_af_perm</a>(<a class="local col8 ref" href="#18profile" title='profile' data-ref="18profile">profile</a>, &amp;<a class="local col9 ref" href="#139" title='sa' data-ref="19sa">sa</a>, <a class="local col4 ref" href="#14request" title='request' data-ref="14request">request</a>, <a class="local col5 ref" href="#15family" title='family' data-ref="15family">family</a>,</td></tr>
<tr><th id="143">143</th><td>					   <a class="local col6 ref" href="#16type" title='type' data-ref="16type">type</a>));</td></tr>
<tr><th id="144">144</th><td>}</td></tr>
<tr><th id="145">145</th><td></td></tr>
<tr><th id="146">146</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="aa_label_sk_perm" title='aa_label_sk_perm' data-type='int aa_label_sk_perm(struct aa_label * label, const char * op, u32 request, struct sock * sk)' data-ref="aa_label_sk_perm">aa_label_sk_perm</dfn>(<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col0 decl" id="20label" title='label' data-type='struct aa_label *' data-ref="20label">label</dfn>, <em>const</em> <em>char</em> *<dfn class="local col1 decl" id="21op" title='op' data-type='const char *' data-ref="21op">op</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32">u32</a> <dfn class="local col2 decl" id="22request" title='request' data-type='u32' data-ref="22request">request</dfn>,</td></tr>
<tr><th id="147">147</th><td>			    <b>struct</b> <a class="type" href="../../include/net/sock.h.html#sock" title='sock' data-ref="sock">sock</a> *<dfn class="local col3 decl" id="23sk" title='sk' data-type='struct sock *' data-ref="23sk">sk</dfn>)</td></tr>
<tr><th id="148">148</th><td>{</td></tr>
<tr><th id="149">149</th><td>	<b>struct</b> <a class="type" href="include/policy.h.html#aa_profile" title='aa_profile' data-ref="aa_profile">aa_profile</a> *<dfn class="local col4 decl" id="24profile" title='profile' data-type='struct aa_profile *' data-ref="24profile">profile</dfn>;</td></tr>
<tr><th id="150">150</th><td>	<a class="macro" href="include/net.h.html#71" title="struct lsm_network_audit sa_net = { .sk = (sk), .family = ((sk)-&gt;__sk_common.skc_family)}; struct apparmor_audit_data sa_aad = { .op = (op), }; struct common_audit_data sa = { .type = (((sk) &amp;&amp; ((sk)-&gt;__sk_common.skc_family) != 1) ? 2 : 7), .u.tsk = ((void *)0), }; sa.apparmor_audit_data = &amp;(sa_aad); sa.u.net = &amp;(sa_net); ((&amp;sa)-&gt;apparmor_audit_data)-&gt;net.type = ((sk)-&gt;sk_type); ((&amp;sa)-&gt;apparmor_audit_data)-&gt;net.protocol = ((sk)-&gt;sk_protocol)" data-ref="_M/DEFINE_AUDIT_SK">DEFINE_AUDIT_SK</a>(<dfn class="local col5 decl" id="25sa" title='sa' data-type='struct common_audit_data' data-ref="25sa"><a class="local col5 ref" href="#150" title='sa' data-ref="25sa"><a class="local col5 ref" href="#150" title='sa' data-ref="25sa"><a class="local col5 ref" href="#150" title='sa' data-ref="25sa"><a class="local col5 ref" href="#150" title='sa' data-ref="25sa">sa</a></a></a></a></dfn>, <a class="local col1 ref" href="#21op" title='op' data-ref="21op">op</a>, <a class="local col3 ref" href="#23sk" title='sk' data-ref="23sk">sk</a>);</td></tr>
<tr><th id="151">151</th><td></td></tr>
<tr><th id="152">152</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(!label);</td></tr>
<tr><th id="153">153</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(!sk);</td></tr>
<tr><th id="154">154</th><td></td></tr>
<tr><th id="155">155</th><td>	<b>if</b> (<a class="macro" href="include/label.h.html#150" title="((label)-&gt;flags &amp; FLAG_UNCONFINED)" data-ref="_M/unconfined">unconfined</a>(<a class="local col0 ref" href="#20label" title='label' data-ref="20label">label</a>))</td></tr>
<tr><th id="156">156</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="157">157</th><td></td></tr>
<tr><th id="158">158</th><td>	<b>return</b> <a class="macro" href="include/label.h.html#246" title="({ struct label_it i; int __E = 0; for ((i).i = aa_label_next_confined(((label)), 0); (((profile)) = ((label))-&gt;vec[(i).i]); (i).i = aa_label_next_confined(((label)), (i).i + 1)) { do { int __subE = ((aa_profile_af_sk_perm(profile, &amp;sa, request, sk))); if (__subE) (__E) = __subE; } while (0); } __E; })" data-ref="_M/fn_for_each_confined">fn_for_each_confined</a>(<a class="local col0 ref" href="#20label" title='label' data-ref="20label">label</a>, <a class="local col4 ref" href="#24profile" title='profile' data-ref="24profile">profile</a>,</td></tr>
<tr><th id="159">159</th><td>			<a class="ref fn" href="include/net.h.html#aa_profile_af_sk_perm" title='aa_profile_af_sk_perm' data-ref="aa_profile_af_sk_perm">aa_profile_af_sk_perm</a>(<a class="local col4 ref" href="#24profile" title='profile' data-ref="24profile">profile</a>, &amp;<a class="local col5 ref" href="#150" title='sa' data-ref="25sa">sa</a>, <a class="local col2 ref" href="#22request" title='request' data-ref="22request">request</a>, <a class="local col3 ref" href="#23sk" title='sk' data-ref="23sk">sk</a>));</td></tr>
<tr><th id="160">160</th><td>}</td></tr>
<tr><th id="161">161</th><td></td></tr>
<tr><th id="162">162</th><td><em>int</em> <dfn class="decl def fn" id="aa_sk_perm" title='aa_sk_perm' data-ref="aa_sk_perm">aa_sk_perm</dfn>(<em>const</em> <em>char</em> *<dfn class="local col6 decl" id="26op" title='op' data-type='const char *' data-ref="26op">op</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32">u32</a> <dfn class="local col7 decl" id="27request" title='request' data-type='u32' data-ref="27request">request</dfn>, <b>struct</b> <a class="type" href="../../include/net/sock.h.html#sock" title='sock' data-ref="sock">sock</a> *<dfn class="local col8 decl" id="28sk" title='sk' data-type='struct sock *' data-ref="28sk">sk</dfn>)</td></tr>
<tr><th id="163">163</th><td>{</td></tr>
<tr><th id="164">164</th><td>	<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col9 decl" id="29label" title='label' data-type='struct aa_label *' data-ref="29label">label</dfn>;</td></tr>
<tr><th id="165">165</th><td>	<em>int</em> <dfn class="local col0 decl" id="30error" title='error' data-type='int' data-ref="30error">error</dfn>;</td></tr>
<tr><th id="166">166</th><td></td></tr>
<tr><th id="167">167</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(!sk);</td></tr>
<tr><th id="168">168</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(<a class="macro" href="../../include/linux/preempt.h.html#103" title="((preempt_count() &amp; ((((1UL &lt;&lt; (4))-1) &lt;&lt; ((0 + 8) + 8)) | (((1UL &lt;&lt; (8))-1) &lt;&lt; (0 + 8)) | (((1UL &lt;&lt; (1))-1) &lt;&lt; (((0 + 8) + 8) + 4)))))" data-ref="_M/in_interrupt">in_interrupt</a>());</td></tr>
<tr><th id="169">169</th><td></td></tr>
<tr><th id="170">170</th><td>	<i>/* TODO: switch to begin_current_label ???? */</i></td></tr>
<tr><th id="171">171</th><td>	<a class="local col9 ref" href="#29label" title='label' data-ref="29label">label</a> = <a class="ref fn" href="include/cred.h.html#begin_current_label_crit_section" title='begin_current_label_crit_section' data-ref="begin_current_label_crit_section">begin_current_label_crit_section</a>();</td></tr>
<tr><th id="172">172</th><td>	<a class="local col0 ref" href="#30error" title='error' data-ref="30error">error</a> = <a class="tu ref fn" href="#aa_label_sk_perm" title='aa_label_sk_perm' data-use='c' data-ref="aa_label_sk_perm">aa_label_sk_perm</a>(<a class="local col9 ref" href="#29label" title='label' data-ref="29label">label</a>, <a class="local col6 ref" href="#26op" title='op' data-ref="26op">op</a>, <a class="local col7 ref" href="#27request" title='request' data-ref="27request">request</a>, <a class="local col8 ref" href="#28sk" title='sk' data-ref="28sk">sk</a>);</td></tr>
<tr><th id="173">173</th><td>	<a class="ref fn" href="include/cred.h.html#end_current_label_crit_section" title='end_current_label_crit_section' data-ref="end_current_label_crit_section">end_current_label_crit_section</a>(<a class="local col9 ref" href="#29label" title='label' data-ref="29label">label</a>);</td></tr>
<tr><th id="174">174</th><td></td></tr>
<tr><th id="175">175</th><td>	<b>return</b> <a class="local col0 ref" href="#30error" title='error' data-ref="30error">error</a>;</td></tr>
<tr><th id="176">176</th><td>}</td></tr>
<tr><th id="177">177</th><td></td></tr>
<tr><th id="178">178</th><td></td></tr>
<tr><th id="179">179</th><td><em>int</em> <dfn class="decl def fn" id="aa_sock_file_perm" title='aa_sock_file_perm' data-ref="aa_sock_file_perm">aa_sock_file_perm</dfn>(<b>struct</b> <a class="type" href="include/label.h.html#aa_label" title='aa_label' data-ref="aa_label">aa_label</a> *<dfn class="local col1 decl" id="31label" title='label' data-type='struct aa_label *' data-ref="31label">label</dfn>, <em>const</em> <em>char</em> *<dfn class="local col2 decl" id="32op" title='op' data-type='const char *' data-ref="32op">op</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32">u32</a> <dfn class="local col3 decl" id="33request" title='request' data-type='u32' data-ref="33request">request</dfn>,</td></tr>
<tr><th id="180">180</th><td>		      <b>struct</b> <a class="type" href="../../include/linux/net.h.html#socket" title='socket' data-ref="socket">socket</a> *<dfn class="local col4 decl" id="34sock" title='sock' data-type='struct socket *' data-ref="34sock">sock</dfn>)</td></tr>
<tr><th id="181">181</th><td>{</td></tr>
<tr><th id="182">182</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(!label);</td></tr>
<tr><th id="183">183</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(!sock);</td></tr>
<tr><th id="184">184</th><td>	<a class="macro" href="include/lib.h.html#37" title="" data-ref="_M/AA_BUG">AA_BUG</a>(!sock-&gt;sk);</td></tr>
<tr><th id="185">185</th><td></td></tr>
<tr><th id="186">186</th><td>	<b>return</b> <a class="tu ref fn" href="#aa_label_sk_perm" title='aa_label_sk_perm' data-use='c' data-ref="aa_label_sk_perm">aa_label_sk_perm</a>(<a class="local col1 ref" href="#31label" title='label' data-ref="31label">label</a>, <a class="local col2 ref" href="#32op" title='op' data-ref="32op">op</a>, <a class="local col3 ref" href="#33request" title='request' data-ref="33request">request</a>, <a class="local col4 ref" href="#34sock" title='sock' data-ref="34sock">sock</a>-&gt;<a class="ref field" href="../../include/linux/net.h.html#socket::sk" title='socket::sk' data-ref="socket::sk">sk</a>);</td></tr>
<tr><th id="187">187</th><td>}</td></tr>
<tr><th id="188">188</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Oct-01</em> from project linux-4.18.y revision <em>linux-4.18.y</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
